/*! For license information please see mapsjs.js.LICENSE.txt */
"use strict";(self.webpackChunkinfine=self.webpackChunkinfine||[]).push([[496],{644:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__}),module=__webpack_require__.hmd(module),function(){var n,aa=[];function ba(t){return function(){return aa[t].apply(this,arguments)}}function ca(t,e){return aa[t]=e}function da(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function ea(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:da(t)}}function fa(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}var ha="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},ja="undefined"!=typeof window&&window===this?this:void 0!==__webpack_require__.g&&null!=__webpack_require__.g?__webpack_require__.g:this;function ka(t,e){if(e){var i=ja;t=t.split(".");for(var r=0;r<t.length-1;r++){var n=t[r];n in i||(i[n]={}),i=i[n]}(e=e(r=i[t=t[t.length-1]]))!=r&&null!=e&&ha(i,t,{configurable:!0,writable:!0,value:e})}}function la(){la=function(){},ja.Symbol||(ja.Symbol=ma)}function na(t,e){this.a=t,ha(this,"description",{configurable:!0,writable:!0,value:e})}ka("Array.prototype.find",(function(t){return t||function(t,e){t:{var i=this;i instanceof String&&(i=String(i));for(var r=i.length,n=0;n<r;n++){var o=i[n];if(t.call(e,o,n,i)){t=o;break t}}t=void 0}return t}})),na.prototype.toString=function(){return this.a};var ma=(b=0,function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new na("jscomp_symbol_"+(e||"")+"_"+b++,e)}),b,ra;function oa(){la();var t=ja.Symbol.iterator;t||(t=ja.Symbol.iterator=ja.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[t]&&ha(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return pa(da(this))}}),oa=function(){}}function pa(t){return oa(),(t={next:t})[ja.Symbol.iterator]=function(){return this},t}function qa(t,e){oa(),t instanceof String&&(t+="");var i=0,r={next:function(){if(i<t.length){var n=i++;return{value:e(n,t[n]),done:!1}}return r.next=function(){return{done:!0,value:void 0}},r.next()}};return r[Symbol.iterator]=function(){return r},r}if(ka("Array.prototype.keys",(function(t){return t||function(){return qa(this,(function(t){return t}))}})),"function"==typeof Object.setPrototypeOf)ra=Object.setPrototypeOf;else{var sa;t:{var ta={Ig:!0},ua={};try{ua.__proto__=ta,sa=ua.Ig;break t}catch(a){}sa=!1}ra=sa?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var va=ra;ka("Object.setPrototypeOf",(function(t){return t||va})),ka("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function i(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;i.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var n=ja.setTimeout;i.prototype.c=function(t){n(t,0)},i.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var i=t[e];t[e]=null;try{i()}catch(t){this.f(t)}}}this.a=null},i.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){i||(i=!0,t.call(e,r))}}var e=this,i=!1;return{resolve:t(this.U),reject:t(this.g)}},e.prototype.U=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.u(t);else{t:switch(typeof t){case"object":var i=null!=t;break t;case"function":i=!0;break t;default:i=!1}i?this.m(t):this.i(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.bb(e,t):this.i(t)},e.prototype.g=function(t){this.j(2,t)},e.prototype.i=function(t){this.j(1,t)},e.prototype.j=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.o()},e.prototype.o=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)o.b(this.a[t]);this.a=null}};var o=new i;return e.prototype.u=function(t){var e=this.f();t.zf(e.resolve,e.reject)},e.prototype.bb=function(t,e){var i=this.f();try{t.call(e,i.resolve,i.reject)}catch(t){i.reject(t)}},e.prototype.then=function(t,i){function r(t,e){return"function"==typeof t?function(e){try{n(t(e))}catch(t){o(t)}}:e}var n,o,a=new e((function(t,e){n=t,o=e}));return this.zf(r(t,n),r(i,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.zf=function(t,e){function i(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?o.b(i):this.a.push(i)},e.resolve=r,e.reject=function(t){return new e((function(e,i){i(t)}))},e.race=function(t){return new e((function(e,i){for(var n=ea(t),o=n.next();!o.done;o=n.next())r(o.value).zf(e,i)}))},e.all=function(t){var i=ea(t),n=i.next();return n.done?r([]):new e((function(t,e){function o(e){return function(i){a[e]=i,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(n.value).zf(o(a.length-1),e),n=i.next()}while(!n.done)}))},e})),ka("Object.entries",(function(t){return t||function(t){var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.push([e,t[e]]);return i}}));var wa="function"==typeof Object.assign?Object.assign:function(t,e){for(var i=1;i<arguments.length;i++){var r=arguments[i];if(r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t};ka("Object.assign",(function(t){return t||wa})),ka("Math.log2",(function(t){return t||function(t){return Math.log(t)/Math.LN2}}));var ya=this||self;function za(t,e,i){t=t.split("."),i=i||ya,t[0]in i||void 0===i.execScript||i.execScript("var "+t[0]);for(var r;t.length&&(r=t.shift());)t.length||void 0===e?i=i[r]&&i[r]!==Object.prototype[r]?i[r]:i[r]={}:i[r]=e}function Aa(){}function Ba(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var i=Object.prototype.toString.call(t);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function Ca(t){var e=Ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function Da(t){return"function"==Ba(t)}function Ea(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Fa="closure_uid_"+(1e9*Math.random()>>>0),Ga=0;function Ha(t,e,i){return t.call.apply(t.bind,arguments)}function Ia(t,e,i){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ja(t,e,i){return(Ja=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ha:Ia).apply(null,arguments)}function Ka(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function t(t,e){za(t,e,void 0)}function u(t,e){function i(){}i.prototype=e.prototype,t.l=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.$o=function(t,i,r){for(var n=Array(arguments.length-2),o=2;o<arguments.length;o++)n[o-2]=arguments[o];return e.prototype[i].apply(t,n)}}function La(t){if(Error.captureStackTrace)Error.captureStackTrace(this,La);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function Ma(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Na(){this.b=this.a=null}u(La,Error),La.prototype.name="CustomError",Ma.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t},Ma.prototype.put=function(t){this.f(t),100>this.b&&(this.b++,t.next=this.a,this.a=t)};var Pa=new Ma((function(){return new Oa}),(function(t){t.reset()}));function Oa(){this.next=this.b=this.a=null}Na.prototype.add=function(t,e){var i=Pa.get();i.set(t,e),this.b?this.b.next=i:this.a=i,this.b=i},Na.prototype.remove=function(){var t=null;return this.a&&(t=this.a,this.a=this.a.next,this.a||(this.b=null),t.next=null),t},Oa.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Oa.prototype.reset=function(){this.next=this.b=this.a=null};var Qa=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Ra(t,e){return-1!=t.indexOf(e)}function Sa(t,e){return t<e?-1:t>e?1:0}function Ta(t,e){for(var i in t)if(e.call(void 0,t[i],i,t))return!0;return!1}function Ua(t){for(var e in t)return!1;return!0}function Va(t){var e,i={};for(e in t)i[e]=t[e];return i}var Wa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ya;function Xa(t,e){for(var i,r,n=1;n<arguments.length;n++){for(i in r=arguments[n])t[i]=r[i];for(var o=0;o<Wa.length;o++)i=Wa[o],Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}}t:{var Za=ya.navigator;if(Za){var $a=Za.userAgent;if($a){Ya=$a;break t}}Ya=""}function ab(t){return Ra(Ya,t)}var bb=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function cb(t,e){this.b=t===db&&e||"",this.a=eb}var eb={},db={},fb=new cb(db,"");function gb(t,e){this.b=t===hb&&e||"",this.a=ib}gb.prototype.tc=function(){return 1};var ib={},hb={};function jb(){this.b="",this.c=kb,this.a=null}function lb(){var t=mb;return t instanceof jb&&t.constructor===jb&&t.c===kb?t.b:(Ba(t),"type_error:SafeHtml")}jb.prototype.tc=function(){return this.a};var kb={};function nb(t){var e=new jb;return e.b=t,e.a=0,e}nb("<!DOCTYPE html>");var mb=nb("");function ob(t){var e=new gb(hb,fb instanceof cb&&fb.constructor===cb&&fb.a===eb?fb.b:"type_error:Const");e instanceof gb&&e.constructor===gb&&e.a===ib?e=e.b:(Ba(e),e="type_error:TrustedResourceUrl"),t.src=e.toString()}function pb(t){return pb[" "](t),t}function qb(t,e){var i=rb;return Object.prototype.hasOwnProperty.call(i,t)?i[t]:i[t]=e(t)}nb("<br>"),pb[" "]=Aa;var sb=ab("Opera"),tb=ab("Trident")||ab("MSIE"),vb=ab("Edge"),wb=ab("Gecko")&&!(Ra(Ya.toLowerCase(),"webkit")&&!ab("Edge"))&&!(ab("Trident")||ab("MSIE"))&&!ab("Edge"),xb=Ra(Ya.toLowerCase(),"webkit")&&!ab("Edge"),zb,a;function yb(){var t=ya.document;return t?t.documentMode:void 0}t:{var Ab="",Bb=(a=Ya,wb?/rv:([^\);]+)(\)|;)/.exec(a):vb?/Edge\/([\d\.]+)/.exec(a):tb?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):xb?/WebKit\/(\S+)/.exec(a):sb?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(Bb&&(Ab=Bb?Bb[1]:""),tb){var Cb=yb();if(null!=Cb&&Cb>parseFloat(Ab)){zb=String(Cb);break t}}zb=Ab}var rb={},Eb,Hb,Kb;function Db(t){return qb(t,(function(){for(var e=0,i=Qa(String(zb)).split("."),r=Qa(String(t)).split("."),n=Math.max(i.length,r.length),o=0;0==e&&o<n;o++){var a=i[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Sa(e=0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Sa(0==a[2].length,0==s[2].length)||Sa(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}function Fb(t){var e=document;return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function Gb(t){ya.setTimeout((function(){throw t}),0)}function Ib(){var t=ya.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ab("Presto")&&(t=function(){var t=Fb("IFRAME");t.style.display="none",ob(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(lb()),t.close();var i="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=Ja((function(t){"*"!=r&&t.origin!=r||t.data!=i||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(i,r)}}}),void 0!==t&&!ab("Trident")&&!ab("MSIE")){var e=new t,i={},r=i;return e.port1.onmessage=function(){if(void 0!==i.next){var t=(i=i.next).gj;i.gj=null,t()}},function(t){r.next={gj:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in Fb("SCRIPT")?function(t){var e=Fb("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){ya.setTimeout(t,0)}}function Jb(t,e){Kb||Lb(),Mb||(Kb(),Mb=!0),Nb.add(t,e)}function Lb(){if(ya.Promise&&ya.Promise.resolve){var t=ya.Promise.resolve(void 0);Kb=function(){t.then(Ob)}}else Kb=function(){var t=Ob;!Da(ya.setImmediate)||ya.Window&&ya.Window.prototype&&!ab("Edge")&&ya.Window.prototype.setImmediate==ya.setImmediate?(Hb||(Hb=Ib()),Hb(t)):ya.setImmediate(t)}}Eb=ya.document&&tb?yb():void 0,!wb&&!tb||tb&&9<=Number(Eb)||wb&&Db("1.9.1"),tb&&Db("9");var Mb=!1,Nb=new Na;function Ob(){for(var t;t=Nb.remove();){try{t.a.call(t.b)}catch(t){Gb(t)}Pa.put(t)}Mb=!1}function Pb(t){if(this.a=Qb,this.j=void 0,this.f=this.b=this.c=null,this.g=this.i=!1,t!=Aa)try{var e=this;t.call(void 0,(function(t){Rb(e,Sb,t)}),(function(t){Rb(e,Tb,t)}))}catch(t){Rb(this,Tb,t)}}var Qb=0,Sb=2,Tb=3;function Ub(){this.next=this.c=this.b=this.f=this.a=null,this.g=!1}Ub.prototype.reset=function(){this.c=this.b=this.f=this.a=null,this.g=!1};var Vb=new Ma((function(){return new Ub}),(function(t){t.reset()}));function Wb(t,e,i){var r=Vb.get();return r.f=t,r.b=e,r.c=i,r}function Xb(t){if(t instanceof Pb)return t;var e=new Pb(Aa);return Rb(e,Sb,t),e}function Zb(t){return new Pb((function(e,i){i(t)}))}function $b(){var t,e;return new ac(new Pb((function(i,r){t=i,e=r})),t,e)}function dc(t,e){if(t.a==Qb)if(t.c){var i=t.c;if(i.b){for(var r=0,n=null,o=null,a=i.b;a&&(a.g||(r++,a.a==t&&(n=a),!(n&&1<r)));a=a.next)n||(o=a);n&&(i.a==Qb&&1==r?dc(i,e):(o?((r=o).next==i.f&&(i.f=r),r.next=r.next.next):ec(i),fc(i,n,Tb,e)))}t.c=null}else Rb(t,Tb,e)}function gc(t,e){t.b||t.a!=Sb&&t.a!=Tb||ic(t),t.f?t.f.next=e:t.b=e,t.f=e}function bc(t,e,i,r){var n=Wb(null,null,null);return n.a=new Pb((function(t,o){n.f=e?function(i){try{var n=e.call(r,i);t(n)}catch(t){o(t)}}:t,n.b=i?function(e){try{var n=i.call(r,e);void 0===n&&e instanceof cc?o(e):t(n)}catch(t){o(t)}}:o})),n.a.c=t,gc(t,n),n.a}function Rb(t,e,i){if(t.a==Qb){t===i&&(e=Tb,i=new TypeError("Promise cannot resolve to itself")),t.a=1;t:{var r=i,n=t.m,o=t.U;if(r instanceof Pb){gc(r,Wb(n||Aa,o||null,t));var a=!0}else{if(r)try{var s=!!r.$goog_Thenable}catch(t){s=!1}else s=!1;if(s)r.then(n,o,t),a=!0;else{if(Ea(r))try{var l=r.then;if(Da(l)){jc(r,l,n,o,t),a=!0;break t}}catch(e){o.call(t,e),a=!0;break t}a=!1}}}a||(t.j=i,t.a=e,t.c=null,ic(t),e!=Tb||i instanceof cc||kc(t,i))}}function jc(t,e,i,r,n){function o(t){a||(a=!0,r.call(n,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,i.call(n,t))}),o)}catch(t){o(t)}}function ic(t){t.i||(t.i=!0,Jb(t.o,t))}function ec(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function fc(t,e,i,r){if(i==Tb&&e.b&&!e.g)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,lc(e,i,r);else try{e.g?e.f.call(e.c):lc(e,i,r)}catch(t){mc.call(null,t)}Vb.put(e)}function lc(t,e,i){e==Sb?t.f.call(t.c,i):t.b&&t.b.call(t.c,i)}function kc(t,e){t.g=!0,Jb((function(){t.g&&mc.call(null,e)}))}Pb.prototype.then=function(t,e,i){return bc(this,Da(t)?t:null,Da(e)?e:null,i)},Pb.prototype.$goog_Thenable=!0,Pb.prototype.cancel=function(t){if(this.a==Qb){var e=new cc(t);Jb((function(){dc(this,e)}),this)}},Pb.prototype.m=function(t){this.a=Qb,Rb(this,Sb,t)},Pb.prototype.U=function(t){this.a=Qb,Rb(this,Tb,t)},Pb.prototype.o=function(){for(var t;t=ec(this);)fc(this,t,this.a,this.j);this.i=!1};var mc=Gb;function cc(t){La.call(this,t)}function ac(t,e,i){this.Jk=t,this.resolve=e,this.reject=i}u(cc,La),cc.prototype.name="cancel";var x=this;function nc(){return Object.create(y,void 0)}var A=Ja,oc=String,pc=x.Object.freeze||function(t){return t};function qc(t){for(var e,i=Object.keys(t),r=i.length;r--;)Ea(e=t[i[r]])&&qc(e);return pc(t)}function rc(t){var e=Ba(t);if("object"==e||"array"==e){if(Da(t.clone))return t.clone();for(var i in e="array"==e?[]:{},t)t.hasOwnProperty(i)&&(e[i]=rc(t[i]));return e}return t}var B=[].pop(),y=/x/.exec("");function sc(t,e){return oc(t).split(e!==B?e:" ")}var tc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(t,e,i,r,n){if(!(e=t instanceof e)&&i)throw new D(i,r,uc(n)?n:t);return e}function vc(t,e){if(!0===(C(t,e)&&t.constructor===e))throw new TypeError("Illegal constructor "+wc(e))}function xc(t,e,i,r,n){if(!(e=yc(t)===e)&&i)throw new D(i,r,uc(n)?n:t);return e}function zc(t,e,i,r){return xc(t,"Array",e,i,r)}function uc(t){return t!==B}function Ac(t){return"string"==typeof t}t("H.lang.isArray",zc),t("H.lang.isString",Ac);var Bc=parseInt,Cc=parseFloat,E=isNaN;function Dc(t){return t===+t}function Ec(t){return!E(+t)}function yc(t){var e=Object[tc[0]][tc[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:typeof t}t("H.lang.isNumber",Dc),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var Fc=[];function Gc(t){0>Fc.indexOf(t)&&Fc.push(t)}function wc(t,e,i,r){var n,o="",a=2>arguments.length;return a&&(e={H:x.H},i="",r=Fc.slice()),Hc(e,!0,(function(e,a){try{if(a=Ic(e,n=e[a]),!(Ea(n)&&n.window===n&&n.self===n||Ea(n)&&0<n.nodeType&&Da(n.cloneNode))&&Ea(n)){if(n===t)return o=i+"."+a,!0;if(0>r.indexOf(n)&&(r.push(n),o=wc(t,n,i+"."+a,r)))return!0}}catch(t){}})),a&&(o=o?o.substr(1).replace("."+tc[0]+".","#"):"~"+(Da(t)?Jc(t)+"()":yc(t))),o}function Ic(t,e){var i=[];return Hc(t,!1,(function(t,r){t[r]===e&&i.push(r)})),i.sort(Kc)[0]}function Kc(t,e){return e.length-t.length}Gc(Fc);var Lc=Object[tc[0]][tc[2]];function Hc(t,e,i){var r;if(t){for(n in t)if((!e||Lc.call(t,n))&&i(t,n,!0))return;for(r=tc.length;r--;){var n=tc[r];if((!e||Lc.call(t,n))&&i(t,n,!1))break}}}function Jc(t){return(t=/^\s*function ([^\( ]+)/.exec(t))?t[1]:"anonymous"}function Mc(t,e,i){i[e]="#"+e}var Nc=!!x.__karma__;function Oc(){throw Error("unimplemented method")}function Pc(t,e){"status"in(e=e||{})&&(this.status=+e.status),"statusText"in e&&(this.statusText=e.statusText),this.ok=200<=this.status&&300>this.status,this.bodyUsed=!1,t?"string"==typeof t?this.c=t:ArrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||t.buffer)?this.a=t.buffer||t:Blob.prototype.isPrototypeOf(t)&&(this.b=t):this.c=""}function Qc(t){if(t.bodyUsed)return Zb(new TypeError("Already read"));t.bodyUsed=!0}function Rc(t){var e=new FileReader;return e.readAsText(t),new Pb((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function Sc(t,e,i){var r,n,o,a,s,l=i&&i.headers||{},u={},c=this;if(!Da(e))throw new D(Sc,1,"function required");Xa(l,Vc.headers,l),Xa(u,Vc,i||{}),u.headers=l,this.c=e,this.a=r=new XMLHttpRequest,e=u.method;try{for(n in r.open(e,t,!0),l)l.hasOwnProperty(n)&&(o=l[n])&&r.setRequestHeader(n,o);r.withCredentials=!!u.withCredentials,a=A(c.b,c),s=+u.timeout||0,Tc?(Uc(c,"timeout",a),r.timeout=s):s&&(c.f=setTimeout((function(){r.abort(),c.b({type:"timeout"})}),s)),Uc(c,"error",a),Uc(c,"load",a),r.send(u.data)}catch(a){this.b({type:"cors"})}}t("H.net.Response",Pc),Pc.prototype.type="default",Pc.prototype.type=Pc.prototype.type,Pc.prototype.status=200,Pc.prototype.status=Pc.prototype.status,Pc.prototype.statusText="OK",Pc.prototype.statusText=Pc.prototype.statusText,Pc.error=function(){return Pc.a||(Pc.a=new Pc(null,{status:0,statusText:""}),Pc.a.type="error"),Pc.a},Pc.error=Pc.error,Pc.prototype.text=function(){var t=Qc(this);if(!t)if(this.c)t=Xb(this.c);else if(this.a){var e,i=(t=new Uint8Array(this.a)).length,r=Array(i);for(e=0;e<i;e++)r[e]=String.fromCharCode(t[e]);t=Xb(r.join(""))}else t=this.b?Rc(this.b):Zb("Unsupported response body");return t},Pc.prototype.json=function(){return this.text().then(x.JSON.parse)},Pc.prototype.blob=function(){var t,e=Qc(this);return e||(this.b?t=this.b:this.a&&(t=new Blob([this.a],{type:"application/octet-stream"}))),e||Xb(t)},Pc.prototype.arrayBuffer=function(){return this.a?Qc(this)||Xb(this.a.slice(0)):this.blob().then(Pc.b)},Pc.b=function(t){var e=new FileReader;return e.readAsArrayBuffer(t),new Pb((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))},!Nc&&x.Response&&x.Response.error&&(Pc=x.Response,Gc(Pc.prototype)),t("H.net.Xhr",Sc);var Vc={method:"GET",headers:{},data:null},Wc="withCredentials"in new XMLHttpRequest,Tc="timeout"in new XMLHttpRequest,Zc,$c,ad,cd,ed;function Uc(t,e,i){Wc?t.a.addEventListener(e,i):t.a["on"+e]=i}function Xc(t,e,i){Wc?t.a.removeEventListener(e,i):t.a["on"+e]=null}function Yc(t,e){var i=[];return t&&i.push(wc(t)),1<arguments.length&&i.push(""+e),i=Error(i.join(" ")),Object.setPrototypeOf(i,Yc.prototype),i}function D(t,e,i){var r=arguments.length;if((e=e!==B?+e:e)!==B){var n=(n=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?sc(n[1].replace(/\s+/g,""),","):[];n.forEach(Mc),n=n[e]||"#"+e}var o=t?wc(t):"";return r=2<r?oc(i):"",(n||r)&&(o+=" (Argument "+(n||"")+(r?" "+r:"")+")"),r=Error(o),Object.setPrototypeOf(r,D.prototype),r}function bd(){if(!Ac("STATIC_DB"))throw new D(this.constructor,0);if(this.g=x.indexedDB||x.So||x.fo||x.ho,!this.g)throw new Yc(this.constructor,"This browser does not support IndexedDB");this.a=[],this.c=[],this.ei=A(this.ei,this)}function jd(t,e,i){if(t.b)t.a?(t.a.push(e),i&&t.c.push(i)):t.f?i&&i(t.f):e(t.b.result);else{t.b=t.g.open(kd+"STATIC_DB",1),t.b.onupgradeneeded=t.ei;var r=t.b.onerror=function(){clearTimeout(t.i),t.f=this.error,t.c.forEach((function(e){e(t.f)})),t.a=t.c=null};t.i=setTimeout((function(){r.call({error:Error("DbOpenTimeoutError")})}),500),t.b.onsuccess=function(){clearTimeout(t.i),t.a?(t.a.forEach((function(t){t(this.result)}),this),t.a=t.c=null):(t.b=t.f=null,t.a=[],t.c=[])},t.a.push(e),i&&t.c.push(i)}}function gd(t,e,i){jd(t,(function(t){t=t.transaction(["data"],"readwrite"),e(t.objectStore("data"))}),i)}function hd(t,e,i){e&&(t.onsuccess=function(){e(this.result)}),i&&(t.onerror=function(){i(this.error)})}function fd(t){var e=Object.prototype.toString.call(t);return"[object Blob]"===e||"[object ArrayBuffer]"===e||Ac(t)||Ea(t)}function ld(){return cd||(cd=new bd),cd}Sc.prototype.abort=function(){this.a&&(this.a.abort(),this.a&&this.b({type:"abort"}))},Sc.prototype.abort=Sc.prototype.abort,Sc.prototype.b=function(t){var e,i,r=t.type;t=this.a,this.f&&clearTimeout(this.f),"load"===r?t instanceof XMLHttpRequest&&200!==t.status&&(e="network"):e=4===t.readyState&&0===t.status&&"error"==r?"cors":"error"!=r?r:"network",Xc(this,"timeout",r=this.b),Xc(this,"error",r),Xc(this,"load",r),i=0===t.status||e&&"network"!==e?Pc.error():new Pc(t.responseText||null,t),e=this.c,delete this.b,delete this.c,delete this.a,e(i)},u(Yc,Error),t("H.lang.IllegalOperationError",Yc),Yc.prototype.name="IllegalOperationError",u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError",n=bd.prototype,n.put=function(t,e,i,r){if(!Ac(t)&&!Dc(t))throw new D(this.put,0);if(!fd(e))throw new D(this.put,1);gd(this,(function(n){hd(n.put(e,t),i,r)}),r)},n.get=function(t,e,i){var r;if(!Ac(t)&&!Dc(t))throw new D(this.get,0);if(!Da(e))throw new D(this.get,1);return gd(this,(function(n){hd(r=n.get(t),e,i)}),i),{cancel:function(){r&&(r.onsuccess=id)}}},n.remove=function(t,e,i){if(!Ac(t)&&!Dc(t))throw new D(this.remove,0);gd(this,(function(r){hd(r.delete(t),e,i)}),i)},n.clear=function(t,e){gd(this,(function(i){hd(i.clear(),t,e)}),e)},n.ei=function(){var t=this.b.result;t.objectStoreNames.contains("data")||t.createObjectStore("data")},t("H.util.IndexedDBStorage.getInstance",ld);var kd="H_";function md(){var t="";if(!uc(ed))if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)ed=!1;else{try{var e=x.indexedDB||x.So||x.fo||x.ho;t=kd+"TEST_DB";var i=e&&e.open(t,1)}catch(t){}ed=!!i&&null===i.onupgradeneeded,i&&e.deleteDatabase&&e.deleteDatabase(t)}return ed}function nd(){0!=od&&(qd[this[Fa]||(this[Fa]=++Ga)]=this),this.Id=this.Id,this.bb=this.bb}t("H.util.IndexedDBStorage.isSupported",md);var od=0,qd={};function rd(t){t&&"function"==typeof t.B&&t.B()}function sd(t,e){this.type=t,this.currentTarget=this.target=e,this.f=this.a=!1,this.Sk=!0}function td(t,e,i){td.l.constructor.call(this,t,i),this.data=e}function ud(t,e,i){ud.l.constructor.call(this,t,i),this.message=e}nd.prototype.Id=!1,nd.prototype.B=function(){if(!this.Id&&(this.Id=!0,this.s(),0!=od)){var t=this[Fa]||(this[Fa]=++Ga);if(0!=od&&this.bb&&0<this.bb.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete qd[t]}},nd.prototype.xb=function(t,e){this.Id?void 0!==e?t.call(e):t():(this.bb||(this.bb=[]),this.bb.push(void 0!==e?Ja(t,e):t))},nd.prototype.s=function(){if(this.bb)for(;this.bb.length;)this.bb.shift()()},sd.prototype.stopPropagation=function(){this.a=!0},sd.prototype.preventDefault=function(){this.f=!0,this.Sk=!1},t("H.util.Event",sd),sd.prototype.stopPropagation=sd.prototype.stopPropagation,sd.prototype.stopPropagation=sd.prototype.stopPropagation,sd.prototype.CAPTURING_PHASE=1,sd.prototype.CAPTURING_PHASE=sd.prototype.CAPTURING_PHASE,sd.prototype.AT_TARGET=2,sd.prototype.AT_TARGET=sd.prototype.AT_TARGET,sd.prototype.BUBBLING_PHASE=3,sd.prototype.BUBBLING_PHASE=sd.prototype.BUBBLING_PHASE,sd.prototype.eventPhase=0,sd.prototype.eventPhase=sd.prototype.eventPhase,u(td,sd),t("H.util.DataEvent",td),u(ud,sd),t("H.util.ErrorEvent",ud);var vd=Math,wd=vd.min,xd=vd.max,yd=vd.round,zd=vd.floor,Ad=vd.ceil,Bd=vd.abs,Cd=vd.log,Dd=vd.sqrt,Ed=vd.pow,Fd=vd.exp,Gd=vd.sin,Hd=vd.asin,Id=vd.cos,Jd=vd.tan,Kd=vd.atan,Ld=vd.atan2,Md=vd.LN2,Nd=vd.PI,Od=Nd/2,Pd=Nd/4,Qd=2*Nd,Rd=3*Nd,Sd=Nd/180,Td=180/Nd,Ud=1/0,Vd=Ed(-2,53),Wd=Wd||function(t){return Cd(t)/Md};function Xd(t,e){var i;return 0>(i=t%e)==0>e?i:i+e}function Yd(t,e,i){return e-=i=i||0,(t-=i)-zd(t/e)*e+i}function Zd(t,e,i){return t>i?i:t<e?e:t}function $d(t,e,i,r){return r||(r=0),e<i?t>=e-r&&t<=i+r:t>=i-r&&t<=e+r}function ae(t,e,i,r,n,o){return Dd(Ed((t-n)*(r-o)-(e-o)*(i-n),2)/(Ed(i-n,2)+Ed(r-o,2)))}t("H.math.normalize",Yd),t("H.math.clamp",Zd);var be={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function ce(t,e,i,r,n,o){var a=i.length,s=a,l=i[0],u=0,c=0,h=0;r=r/2||0;var p=o||2;o=p*(n?0:1)+1;for(var f=p-2;1!=u&&s>o;){s-=f;var d=i[--s];p=i[--s];var y=i[s?s-f-1:(a+(s-f-1))%a],g=i[s?s-f-2:(a+(s-f-2))%a];p>=t-r&&p<=t+r&&d>=e-r&&d<=e+r||g>=t-r&&g<=t+r&&y>=e-r&&y<=e+r?u=1:u||p!==t?!u&&$d(t,p,g,r)&&((p<t&&g>t||p>t&&g<t)&&(c+=(l=d+(t-p)/(g-p)*(y-d))>e,h+=l<e),u=$d(e,d,y,r)&&ae(t,e,p,d,g,y)<=r?2:0):(g===t&&(d<e&&y>e||d>e&&y<e)||(l<=t&&g>t||l>=t&&g<t)&&(d>=e?++c:++h),u=$d(e,d,y,r)&&ae(t,e,p,d,g,y)<=r?2:0),l=p}return!u&&n&&0!==h&&0!=c%2&&(u=3),u}function de(t,e){return ce(t.x,t.y,e,0,!0)!==be.NONE}function ee(t){for(var e=t.length,i=new Float64Array(2*e),r=e&&uc(t[0].x);e--;){var n=t[e],o=e<<1;i[o]=r?n.x:n[0],i[o+1]=r?n.y:n[1]}return i}function fe(t,e,i){this.type=t,this.data=e,this.f=$b(),this.resolve=A(this.resolve,this),this.reject=A(this.reject,this),this.priority=ge,i!==B&&(this.priority=i),this.mh().add(this)}t("H.math.CoverType",be),t("H.math.isPointInsidePolygon",de),t("H.math.flatten",ee);var ge=1,he={Wo:0,Zo:ge,Vo:2};function ie(t){var e;for(e in this.a={},he)this.a[he[e]]=[];this.ff=t,this.ff.addEventListener("allocatable",A(this.b,this))}n=fe.prototype,n.then=function(t,e,i){return this.f.Jk.then(t,e,i)},n.resolve=function(t){this.he=3,this.f.resolve(t)},n.reject=function(t){this.he=5,this.f.reject(t)},n.he=0,n.cancel=function(){3>this.he&&(this.ze(),this.mh().remove(this),this.he=4)},t("H.util.JobManager",ie);var je=Object.keys(he).map((function(t){return he[t]})).sort().reverse();function ke(t,e,i){var r=[],n=arguments.length;return t&&r.push(wc(t)),1<n&&(n=2<n&&zc(i)?" out of ["+i[0]+"..."+i[1]+"]":"",r.push("("+e+n+")")),r=Error(r.join(" ")),Object.setPrototypeOf(r,ke.prototype),r}ie.prototype.add=function(t){C(t,fe,this.add,0),this.a[t.priority].push(t),this.b()},ie.prototype.contains=function(t){return-1<this.a[t.priority].indexOf(t)},ie.prototype.remove=function(t){var e=t.priority,i=this.a[e].indexOf(t);return-1<i?(this.a[e].splice(i,1),!0):(t.Qi&&this.ff.Gf(t.Qi),!1)},ie.prototype.b=function(){je.forEach((function(t){this.a[t]=this.a[t].filter((function(t){var e;if((e=this.ff.Og(t))===y)return!0;var i=A(this.ff.Gf,this.ff,e,t);t.Qi=e,t.then(i,i),t.he=t.vj(e)?1:5}),this)}),this)},u(ke,Error),t("H.lang.OutOfRangeError",ke),ke.prototype.name="OutOfRangeError";var le="closure_listenable_"+(1e6*Math.random()|0);function me(t){return!(!t||!t[le])}var ne=0;function oe(t,e,i,r,n){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!r,this.Uf=n,this.key=++ne,this.ke=this.yf=!1}function pe(t){t.ke=!0,t.listener=null,t.proxy=null,t.src=null,t.Uf=null}function qe(t){this.src=t,this.a={},this.b=0}function se(t,e){var i=e.type;if(!(i in t.a))return!1;var r,n=t.a[i],o=bb(n,e);return(r=0<=o)&&Array.prototype.splice.call(n,o,1),r&&(pe(e),0==t.a[i].length&&(delete t.a[i],t.b--)),r}function te(t,e){var i=void 0!==e,r=i?e.toString():"";return Ta(t.a,(function(t){for(var e=0;e<t.length;++e)if(!i||t[e].type==r)return!0;return!1}))}function re(t,e,i,r){for(var n=0;n<t.length;++n){var o=t[n];if(!o.ke&&o.listener==e&&o.capture==!!i&&o.Uf==r)return n}return-1}qe.prototype.add=function(t,e,i,r,n){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=re(t,e,r,n);return-1<a?(e=t[a],i||(e.yf=!1)):((e=new oe(e,this.src,o,!!r,n)).yf=i,t.push(e)),e},qe.prototype.remove=function(t,e,i,r){if(!((t=t.toString())in this.a))return!1;var n=this.a[t];return-1<(e=re(n,e,i,r))&&(pe(n[e]),Array.prototype.splice.call(n,e,1),0==n.length&&(delete this.a[t],this.b--),!0)},qe.prototype.qa=function(t){t=t&&t.toString();var e,i=0;for(e in this.a)if(!t||e==t){for(var r=this.a[e],n=0;n<r.length;n++)++i,pe(r[n]);delete this.a[e],this.b--}return i};var ue=!tb||9<=Number(Eb),ve=tb&&!Db("9");!xb||Db("528"),wb&&Db("1.9b")||tb&&Db("8")||sb&&Db("9.5")||xb&&Db("528"),wb&&!Db("8")||tb&&Db("9");var we=function(){if(!ya.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ya.addEventListener("test",Aa,e),ya.removeEventListener("test",Aa,e)}catch(t){}return t}();function xe(t,e){if(sd.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.b=null,t){var i=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(wb){t:{try{pb(e.nodeName);var n=!0;break t}catch(t){}n=!1}n||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ye[t.pointerType]||"",this.b=t,t.defaultPrevented&&this.preventDefault()}}u(xe,sd);var ye={2:"touch",3:"pen",4:"mouse"};xe.prototype.stopPropagation=function(){xe.l.stopPropagation.call(this),this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0},xe.prototype.preventDefault=function(){xe.l.preventDefault.call(this);var t=this.b;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ve)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ze="closure_lm_"+(1e6*Math.random()|0),Ae={},Be=0;function Ce(t,e,i,r,n){if(r&&r.once)return De(t,e,i,r,n);if("array"==Ba(e)){for(var o=0;o<e.length;o++)Ce(t,e[o],i,r,n);return null}return i=Ee(i),me(t)?t.U.add(String(e),i,!1,Ea(r)?!!r.capture:!!r,n):Fe(t,e,i,!1,r,n)}function Fe(t,e,i,r,n,o){if(!e)throw Error("Invalid event type");var a=Ea(n)?!!n.capture:!!n,s=Ge(t);if(s||(t[ze]=s=new qe(t)),(i=s.add(e,i,r,a,o)).proxy)return i;if(r=He(),i.proxy=r,r.src=t,r.listener=i,t.addEventListener)we||(n=a),void 0===n&&(n=!1),t.addEventListener(e.toString(),r,n);else if(t.attachEvent)t.attachEvent(Ie(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return Be++,i}function He(){var t=Je,e=ue?function(i){return t.call(e.src,e.listener,i)}:function(i){if(!(i=t.call(e.src,e.listener,i)))return i};return e}function De(t,e,i,r,n){if("array"==Ba(e)){for(var o=0;o<e.length;o++)De(t,e[o],i,r,n);return null}return i=Ee(i),me(t)?t.U.add(String(e),i,!0,Ea(r)?!!r.capture:!!r,n):Fe(t,e,i,!0,r,n)}function Ke(t,e,i,r,n){if("array"==Ba(e)){for(var o=0;o<e.length;o++)Ke(t,e[o],i,r,n);return null}return r=Ea(r)?!!r.capture:!!r,i=Ee(i),me(t)?t.U.remove(String(e),i,r,n):!!t&&!!((t=Ge(t))&&(e=t.a[e.toString()],t=-1,e&&(t=re(e,i,r,n)),i=-1<t?e[t]:null))&&Le(i)}function Le(t){if("number"==typeof t||!t||t.ke)return!1;var e=t.src;if(me(e))return se(e.U,t);var i=t.type,r=t.proxy;return e.removeEventListener?e.removeEventListener(i,r,t.capture):e.detachEvent?e.detachEvent(Ie(i),r):e.addListener&&e.removeListener&&e.removeListener(r),Be--,(i=Ge(e))?(se(i,t),0==i.b&&(i.src=null,e[ze]=null)):pe(t),!0}function Ie(t){return t in Ae?Ae[t]:Ae[t]="on"+t}function Me(t,e,i,r){var n=!0;if((t=Ge(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==i&&!o.ke&&(o=Ne(o,r),n=n&&!1!==o)}return n}function Ne(t,e){var i=t.listener,r=t.Uf||t.src;return t.yf&&Le(t),i.call(r,e)}function Je(t,e){if(t.ke)return!0;if(!ue){if(!e)t:{e=["window","event"];for(var i=ya,r=0;r<e.length;r++)if(null==(i=i[e[r]])){e=null;break t}e=i}if(e=new xe(r=e,this),i=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var n=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){n=!0}(n||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],n=e.currentTarget;n;n=n.parentNode)r.push(n);for(t=t.type,n=r.length-1;!e.a&&0<=n;n--){e.currentTarget=r[n];var o=Me(r[n],t,!0,e);i=i&&o}for(n=0;!e.a&&n<r.length;n++)e.currentTarget=r[n],o=Me(r[n],t,!1,e),i=i&&o}return i}return Ne(t,new xe(e,this))}function Ge(t){return(t=t[ze])instanceof qe?t:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ee(t){return Da(t)?t:(t[Pe]||(t[Pe]=function(e){return t.handleEvent(e)}),t[Pe])}function F(){nd.call(this),this.U=new qe(this),this.Jn=this,this.ah=null}function Qe(t){var e=(t=t||{}).callback;this.b=t.label,Da(e)&&(this.callback=e),this.a=!!t.disabled,Qe.l.constructor.call(this)}u(F,nd),F.prototype[le]=!0,n=F.prototype,n.Ob=function(){return this.ah},n.ja=function(t){this.ah=t},n.addEventListener=function(t,e,i,r){Ce(this,t,e,i,r)},n.removeEventListener=function(t,e,i,r){Ke(this,t,e,i,r)},n.dispatchEvent=function(t){var e,i=this.Ob();if(i)for(e=[];i;i=i.Ob())e.push(i);i=this.Jn;var r=t.type||t;if("string"==typeof t)t=new sd(t,i);else if(t instanceof sd)t.target=t.target||i;else{var n=t;Xa(t=new sd(r,i),n)}if(n=!0,e)for(var o=e.length-1;!t.a&&0<=o;o--){var a=t.currentTarget=e[o];n=a.qd(r,!0,t)&&n}if(t.a||(n=(a=t.currentTarget=i).qd(r,!0,t)&&n,t.a||(n=a.qd(r,!1,t)&&n)),e)for(o=0;!t.a&&o<e.length;o++)n=(a=t.currentTarget=e[o]).qd(r,!1,t)&&n;return n},n.s=function(){F.l.s.call(this),this.U&&this.U.qa(void 0),this.ah=null},n.qd=function(t,e,i){if(!(t=this.U.a[String(t)]))return!0;t=t.concat();for(var r=!0,n=0;n<t.length;++n){var o=t[n];if(o&&!o.ke&&o.capture==e){var a=o.listener,s=o.Uf||o.src;o.yf&&se(this.U,o),r=!1!==a.call(s,i)&&r}}return r&&0!=i.Sk},t("H.util.EventTarget",F),F.prototype.ja=F.prototype.ja,F.prototype.setParentEventTarget=F.prototype.ja,F.prototype.Ob=F.prototype.Ob,F.prototype.getParentEventTarget=F.prototype.Ob,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.B=F.prototype.B,F.prototype.dispose=F.prototype.B,F.prototype.xb=F.prototype.xb,F.prototype.addOnDisposeCallback=F.prototype.xb,F.prototype.Kn=F.prototype.qd,F.prototype.qd=function(t,e,i){var r,n,o=!0,a=i[i.currentTarget===i.target?"AT_TARGET":e?"CAPTURING_PHASE":(r=!0,"BUBBLING_PHASE")];return(!r||"pointerenter"!==(n=i.type)&&"pointerleave"!==n)&&(i.eventPhase=a,o=F.prototype.Kn.apply(this,arguments),r&&this.Ob&&null===this.Ob()&&delete i.eventPhase),o},u(Qe,F),t("H.util.ContextItem",Qe),Qe.prototype.Oe=function(){return this.b},Qe.prototype.getLabel=Qe.prototype.Oe,Qe.prototype.Kc=function(t){return this.b!==t&&(this.b=t,this.dispatchEvent("update")),this},Qe.prototype.setLabel=Qe.prototype.Kc,Qe.prototype.gc=function(){return this.a},Qe.prototype.isDisabled=Qe.prototype.gc,Qe.prototype.Ba=function(t){return t^this.a&&(this.a=t,this.dispatchEvent("update")),this},Qe.prototype.setDisabled=Qe.prototype.Ba;var Re=new Qe;function Se(){if(x.document){var t=document.createElement("canvas");return t.width=t.height=1,t.getContext("2d")}return null}function Te(){return window.devicePixelRatio||1}Qe.SEPARATOR=Re,t("H.util.getPixelRatio",Te);var Ue=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function Ve(t){var e=We[t],i=x.RegExp;return e||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(t){return t instanceof Number?Array(t):t.map((function(t){return Zd(yd(t),0,255)}))}),"none"===t?e=new Uint8ClampedArray([0,0,0,0]):(Xe.fillStyle="black",Xe.fillStyle=t,Ue.test(Xe.fillStyle)?e=new Uint8ClampedArray([i.$1,i.$2,i.$3,255*i.$4]):(Xe.clearRect(0,0,1,1),Xe.fillRect(0,0,1,1),e=Xe.getImageData(0,0,1,1).data)),We[t]=e),e}function Ye(t){return"none"!==t&&0<Ve(t)[3]}var We=nc(),Ze=!!x.VBArray;function $e(t,e){return t!==B?t:e}function af(t){return/^<svg/.test(t)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t):t}function bf(t){this.ic=0<t?vd.round(t):0}t("H.util.eval",(function(a){return eval(a)})),t("H.util.provide",(function(t){var e=ya.$jscomp;if(e&&"function"==typeof e.km&&e.km())throw Error("goog.provide cannot be used within a module.");za(t,void 0)})),bf.prototype.next=function(t){if(9007199254740992===this.ic)throw new ke(t,this.ic,[0,9007199254740991]);return this.ic++};var cf=new bf,df=A(cf.next,cf);function ef(){return!0}function ff(){return!1}function id(){}var gf=pc([]),hf=pc({});function jf(t){return"CANVAS"===t.tagName?[t]:t.getElementsByTagName("CANVAS")}function kf(t,e,i){var r;if(e=t.ownerDocument===e?t.cloneNode(!0):e.importNode(t,!0),i)for(t=jf(t),r=(i=jf(e)).length;r--;)i[r].getContext("2d").drawImage(t[r],0,0);return e}var Xe=Se(),lf=Se();function mf(t){var e=t.complete,i=0<t.naturalWidth;if(e&&!i&&Ze)try{lf.drawImage(t,0,0),i=!0}catch(t){}return e&&i}var nf=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function of(t,e){if(e=e||"",nf){var i=new nf;i.append(t),t=i.getBlob(e)}else t=new Blob([t],{type:e});return t}var pf=x.navigator;function qf(){var t=qf.a;return t||(t=this,qf.a=t,Gc(qf.a),F.call(t),rf(this)),t}function rf(t){t.g=10,t.i=6,t.a=nc(),t.b=nc(),t.c=0}function sf(t,e,i,r){if(!this.b[t])throw new D(sf,0,"Mime type is not supported");this.g=t,"crossOrigin"in(t=r?Va(r):{})||(t.crossOrigin="anonymous"),this.a=t,tf.href=e.toString(),fe.call(this,tf.protocol+"//"+tf.hostname,e,i)}$c=/Edge\/\d+/.test(pf.appVersion),ad=/(A|a)ndroid/.test(pf.appVersion),u(qf,F),qf.prototype.s=function(){qf.l.s.call(this),rf(this)},qf.prototype.Og=function(t){t=t.type;var e=this.a[t]||0;if(this.c<this.g&&e<this.i){var i=++this.f;return this.c++,this.a[t]=e+1,this.b[i+""]=t,i}return y},qf.prototype.Gf=function(t){var e=this.b[t];if(!uc(e)||!this.a[e])throw new Yc(this.Gf,"Unknown requestId");this.c--,this.a[e]--,this.a[e]||delete this.a[e],delete this.b[t],this.dispatchEvent("allocatable")},qf.prototype.f=-1,u(sf,fe),sf.prototype.vj=function(){return this.c=this.b[this.g].call(this),!0},sf.prototype.ze=function(){this.c&&(this.c.abort(),this.c=null)},sf.prototype.b={"application/json":function(){var t=this,e=uf(this.a),i=e.headers;return e.headers=i=i?Va(i):{},i.Accept="application/json",new Sc(this.data,(function(e){200<=e.status&&300>e.status?t.resolve(e.json()):t.reject(e)}),e)},"text/plain":function(){var t=this;return new Sc(this.data,(function(e){200<=e.status&&300>e.status?t.resolve(e.text()):t.reject(e)}),uf(this.a))},image:function(){var t=x.document.createElement("img"),e=this,i=this.data;return t.onload=A(this.resolve,this,t),t.onerror=function(){e.reject(Pc.error())},t.crossOrigin=this.a.crossOrigin,t.src=i,{abort:function(){t.onerror=t.onload=null,Ze&&mf(t)||t.removeAttribute("src")}}}},function(){try{var t=new XMLHttpRequest;t.open("get","/",!0)}catch(e){t={}}"response"in t&&(sf.prototype.b.arraybuffer=function(){var t,e=new XMLHttpRequest,i=this,r=this.a,n=r.headers;if(e.open("GET",this.data),vf(e,r),e.responseType="arraybuffer",n)for(t in n)e.setRequestHeader(t,n[t]);return e.onerror=e.ontimeout=function(){i.reject(Pc.error())},e.onload=function(){i.resolve(new Pc(e.response))},e.send(),e})}();var wf=new ie(new qf);sf.prototype.mh=function(){return wf};var tf=x.document.createElement("a");function uf(t){var e=Va(t);return delete e.crossOrigin,vf(e,t),e}function vf(t,e){t.withCredentials="use-credentials"===e.crossOrigin}function I(t,e){this.x=+t,this.y=+e}function xf(t){if(!t)throw Error("invalid argument");return t instanceof I?t:new I(t.x,t.y)}function yf(t){var e=zf[t];if(!e)if(t in Af)e=zf[t]=t;else{e=Bf.length;var i="",r=t.charAt(0).toUpperCase()+t.substr(1),n="",o=!1;Cf&&(o=(n=Cf+r)in Af);for(;e--&&!o;)o=(n=(i=Bf[e])+r)in Af;if(o&&(Cf=i),!(e=o?n:null))throw Error("Could not find any variant of CSS property ["+t+"]");zf[t]=e}return e}t("H.math.Point",I),I.prototype.set=I,I.prototype.set=I.prototype.set,I.prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new I(this.x,this.y),t},I.prototype.clone=I.prototype.clone,I.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},I.prototype.add=I.prototype.add,I.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},I.prototype.sub=I.prototype.sub,I.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},I.prototype.scale=I.prototype.scale,I.prototype.round=function(){return this.x=yd(this.x),this.y=yd(this.y),this},I.prototype.round=I.prototype.round,I.prototype.floor=function(){return this.x=zd(this.x),this.y=zd(this.y),this},I.prototype.floor=I.prototype.floor,I.prototype.ceil=function(){return this.x=Ad(this.x),this.y=Ad(this.y),this},I.prototype.ceil=I.prototype.ceil,I.prototype.na=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},I.prototype.equals=I.prototype.na,I.prototype.Hj=function(t,e){var i=e.x-t.x,r=e.y-t.y,n=t;if(i||r){var o=((this.x-t.x)*i+(this.y-t.y)*r)/(i*i+r*r);n=0>=o?t:1<=o?e:new I(t.x+o*i,t.y+o*r)}return n},I.prototype.getNearest=I.prototype.Hj,I.prototype.Ya=function(t){return Dd(Ed(this.x-t.x,2)+Ed(this.y-t.y,2))},I.prototype.distance=I.prototype.Ya,I.fromIPoint=xf,t("H.dom.cssPrefixer.prefix",yf);var Bf=["O","Ms","ms","Moz","Webkit"],zf={},Cf="",Af=document.createElement("span").style;function Df(t,e,i,r){if(!t||!e||!i)throw new D(Df,null,"Must specify name, version and revision parameter");this.name=t,this.version=e,this.revision=i,r&&Xa(this,r)}t("H.util.BuildInfo",Df),Df.prototype.toString=function(){var t,e=[];for(t in this)Ac(this[t])&&e.push(this[t]);return e.join(";")};var Ef={};function Ff(t,e,i,r){if(!t)throw new D(Ff,1,"Must specify a name parameter");return Ef[t]||(Ef[t]=new Df(t,e,i,r))}function Gf(){Gf.l.constructor.call(this),this.a=Hf(this),this.f=nc(),this.c=A(this.c,this),this.a.addEventListener("message",this.c),this.b={}}Df.get=Ff,u(Gf,F),Gf.prototype.s=function(){this.a.terminate()},Gf.prototype.g=function(t){var e=t.type,i=!!this.f[e],r=t.data,n=If++,o=r&&r.Po?r.Po:B,a=!0;return i?(this.b[n]=t,Jf(this,e,n,r&&r.message,o)):(t.reject(new D(this.g,0,"processor_not_found")),a=!1),a},Gf.prototype.c=function(t){t=t.data;var e=this.b[t.taskId],i=t.taskId,r=t.data,n=this;if(2===t.type)new sf("arraybuffer",r).then((function(t){return t.arrayBuffer()})).then((function(t){n.a.postMessage(["3",i,[t]],[t])}),(function(){n.a.postMessage(["3",i,[null,"ERROR"]])}));else{if(e){switch(t.type){case 1:e.resolve(r);break;case 0:e.reject(r)}delete this.b[i]}this.dispatchEvent(new sd(this.v.IDLE))}};var If=0,Of,Rf;function Kf(t,e,i){var r,n=If++;return t.b[n]=r=$b(),Jf(t,e,n,i),r.Jk}function Jf(t,e,i,r,n){r===B||Ca(r)||(r=[r]);try{t.a.postMessage([e,i,r],n)}catch(e){(t=t.b[i]).reject(e.message)}}function Hf(a){var b=x.H.__bootstrap__;if(b=Da(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(of(b,"application/javascript")))}catch(t){}return c||(a=new Lf(a),function(){eval("var self = arguments[0];"+b)}(a),c=new Mf(a)),c}function Mf(t){F.call(this),this.a=t}function Lf(a){F.call(this),this.a=a,this.addEventListener=A(this.addEventListener,this),this.removeEventListener=A(this.removeEventListener,this),this.postMessage=A(this.postMessage,this),this.eval=A(eval,this)}function Nf(){var t=Of;return t||(t=Of=this,F.call(t),Pf(this)),t}function Pf(t){var e,i=t.b;if(i)for(e=i.length;e--;)i[e].B();t.b=[],Gc(t.b),t.c=nc(),t.f=nc()}function Qf(t,e,i){fe.call(this,t,e,i)}function Sf(t,e,i){var r=Zd(+t,-90,90);if(e&&E(r))throw new D(e,i,t);return r}function Tf(t,e,i){var r=+t;if((-180>r||180<r)&&(r=Xd(r+180,360)-180),e&&E(r))throw new D(e,i,t);return r}function Uf(t,e,i){var r;if(t!==B&&E(r=+t)&&e)throw new D(e,i,t);return r}function Vf(t,e){return 0!=(0>t^0>e)&&180<Bd(e-t)}function Wf(){vc(this,Wf)}function Yf(t,e,i){this.lat=Sf(t,Yf,0),this.lng=Tf(e,Yf,1),i!==B&&(this.alt=Uf(i,Yf,2))}function Zf(t,e,i){var r=Ea(t)&&!(E(t.lat=Sf(t.lat))||E(t.lng=Tf(t.lng))||t.alt!==B&&E(t.alt=Uf(t.alt)));if(!r&&e)throw new D(e,i,t);return r}function $f(t){if(!t)throw new D($f,0,t);return new Yf(t.lat,t.lng,t.alt)}function K(t,e,i,r){ag(this,Sf(t,K,0),Tf(e,K,1),Sf(i,K,2),Tf(r,K,3))}function ag(t,e,i,r,n){return t.aa=i,t.ga=n,e<r&&(i=e,e=r,r=i),t.ka=e,t.ma=r,t.c=t.a=t.b=null,t}function cg(t,e){return(t=e-t)+(0>t?360:0)}function bg(t,e){return(t+=e/2)-(180<t?360:0)}function dg(t,e,i,r,n,o,a,s,l){i=wd(i,a),t=xd(t,n);var u=bg(e,n=cg(e,r)),c=bg(o,a=cg(o,s))-u;if(180>(c+=0>c-1e-6?360:0)-1e-6){u=e;var h=s}else c=360-c,u=o,h=r;return 360<=(c=c+n/2+a/2)+5e-7?(u=-180,h=180):c-5e-7<n?(u=e,h=r):c-5e-7<a&&(u=o,h=s),l?ag(l,t,u,i,h):new K(t,u,i,h)}function eg(t,e,i){return i||(Zf(t,eg,0),Zf(e,eg,1)),new K(t.lat,t.lng,e.lat,e.lng)}function fg(t,e){var i=1,r=t.length,n=null;if(!Ca(t))throw new D(fg,0,t);if(0<r){var o=t[0];for(n=eg(o,o,e);i<r;i++)o=t[i],n.cd(o.lat,o.lng,e,n)}return n}function gg(t,e){var i,r=3,n=t.length;if(!(e||t&&null!=t.length))throw new D(gg,0,t);if(0<n)for(i=new K(t[0],t[1],t[0],t[1]);r<n;r+=3)i.cd(t[r],t[r+1],e,i);return i}function hg(t,e){var i,r=1,n=t.length;if(e&&(!t||null==t.length))throw new D(hg,0,t);if(0<n)for(i=new K(t[0].ka,t[0].aa,t[0].ma,t[0].ga);r<n;r++)i.hc(t[r],e,i);return i}function ig(t,e,i,r,n,o){vc(this,ig),this.c=t||10,this.b=this.a=null,this.f=r||0,this.g=n||0,this.i=e||1,this.j=i||1,this.m=!!o,this.flush()}function jg(t){var e=t.b;if(t.m&&!e){var i=t.head;(i.entries||i[0]||i[1]||i[2]||i[3])&&(e=kg([e=[i],e,e,e],[i[6],i[7],i[4],i[5]]),t.b=e)}return e}function kg(t,e){var i,r,n,o,a=0;for(i=3;0<=i;i--){var s=i+4,l=0<i%3,u=[],c=e[i],h=t[i];for(r=h.length;r--;){var p=h[r];if(n=p.entries)for(o=n.length;o--;){var f=n[o].td(i);(l?f>c:f<c)&&(c=f)}for(o=4;o--;)(n=p[o])&&(l?n[s]>c:n[s]<c)&&u.push(n)}a+=u.length,e[i]=c,t[i]=u}return a&&(e=kg(t,e)),e}function lg(t,e,i){var r,n;if(t.m&&(r=t.b))for(n=3;0<=n;n--){var o=e.td(n);if(n%3?o>=r[n]:o<=r[n]){if(!i){t.b=null;break}r[n]=o}}}function ng(t,e){var i,r=t.head;if(e){var n=e;if(n!==r)for(r=n;n=n.parent;)(n.entries||1<n.a)&&(r=n)}else for(;!r.entries&&2>(i=r.a)&&i;)r=n;t.head=r}function og(t,e,i,r,n,o,a,s,l){var u,c=e.entries,h=e[7],p=e[4],f=e[5],d=e[6],y=e[8],g=e[9];if(c){var v=c.length;if(n>p||r>h||a<d||o<f)for(;v--;)p=(h=c[v]).td(3),f=h.td(0),d=h.td(1),h.td(2)>=n&&d>=r&&(f<a||s&&f==a)&&(p<o||l&&p==o)&&i.push(h);else for(;v--;)i.push(c[v])}(o>y||l&&o==y)&&(n<g&&(u=e[1])&&og(t,u,i,r,n,o,a,s,l),(a>g||s&&a==g)&&(u=e[3])&&og(t,u,i,r,n,o,a,s,l)),r<y&&(n<g&&(u=e[0])&&og(t,u,i,r,n,o,a,s,l),(a>g||s&&a==g)&&(u=e[2])&&og(t,u,i,r,n,o,a,s,l))}Gf.prototype.v={IDLE:"idle",Si:"error"},Gf.prototype.i=function(t,e){var i=this.j||(this.j=new sd(this.v.Si));i.data=e,delete this.f[t],this.dispatchEvent(i)},u(Mf,F),Mf.prototype.postMessage=function(t){x.setTimeout(A(this.b,this,t),0)},Mf.prototype.b=function(t){var e=new sd("message");e.data=t,this.a.dispatchEvent(e)},Mf.prototype.terminate=function(){this.a.B(),this.B()},u(Lf,F),Lf.prototype.postMessage=function(t){var e=new sd("message");e.data=t,x.setTimeout(A(this.a.c,this.a,e),0)},u(Nf,F),Nf.prototype.s=function(){Nf.l.s.call(this),Pf(this)},Nf.prototype.Og=function(t){var e;if(t=t.type,!(e=this.f[t]))throw new Yc(this.Og,'Unknown type "'+t+'"');var i=this.b,r=i[0];return r||(r=i[0]=new Gf,this.xb(Ka(rd,r)),Ua(this.c)||Kf(r,"0",i=x.Object.keys(this.c))),(i=r).f[t]||(i.f[t]=e,Kf(i,"1",[t,Da(e)?e+"":e]).then(id,A(i.i,i,t))),r},Nf.prototype.Gf=function(){},Nf.prototype.a=function(t,e){var i=this.f,r=i[t];if(r){if(e!==r)throw new Yc(this.a,'Type "'+t+'" is already registered')}else i[t]=e},u(Qf,fe),Qf.prototype.mh=function(){return Rf||(Rf=new ie(new Nf)),Rf},Qf.prototype.ze=function(){},Qf.prototype.vj=function(t){return t.g(this)},t("H.geo.isDBC",Vf),t("H.geo.AbstractGeometry",Wf),Wf.prototype.getBoundingBox=Wf.prototype.I,Wf.prototype.equals=Wf.prototype.na,Wf.prototype.qb="",Wf.prototype.Kb="",Wf.prototype.toString=function(){return this.Mc([this.qb.toUpperCase()," "]).join("")},Wf.prototype.toString=Wf.prototype.toString,Wf.prototype.Lc=function(){return{type:this.Kb,coordinates:this.hd()}},Wf.prototype.toGeoJSON=Wf.prototype.Lc,Wf.prototype.X=function(){return{type:this.qb,coordinates:this.sc(),boundingBox:this.I().X()}},Wf.prototype.forWorkerMessage=Wf.prototype.X,u(Yf,Wf),t("H.geo.Point",Yf),Yf.prototype.na=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},Yf.prototype.equals=Yf.prototype.na,Yf.prototype.Ya=function(t){if(this===t||this.lat===t.lat&&this.lng===t.lng)t=0;else{var e=this.lat*Sd,i=t.lat*Sd;t=12742001.58*Hd(wd(1,Dd(Ed(Gd((e-i)/2),2)+Id(e)*Id(i)*Ed(Gd((this.lng*Sd-t.lng*Sd)/2),2))))}return t},Yf.prototype.distance=Yf.prototype.Ya,Yf.prototype.Cg=function(t,e,i){if(i){if(e/=6371000.79){t*=Sd;var r=Sd*this.lat,n=Gd(r),o=Gd(e),a=Id(e),s=Sd*this.lng,l=Id(r);r=Hd(l*Id(t)*o+n*a),l=(t=(s+(t=Ld(Gd(t)*l*o,a-n*Gd(r)))+Nd)%(2*Nd)-Nd)*Td}return e?new Yf(r*Td,(l+540)%360-180):this}if(0==(90+(t=(t%360+360)%360))%180)return r=this.lng+e/(6371000.79*Qd*Id(this.lat*Sd))*(270===t?-360:360),new Yf(this.lat,(r+540)%360-180);if(e/=6371000.79){t*=Sd,s=this.lat*Sd,n=this.lng*Sd,a=(o=s+e*Id(t))-s,r=Cd(Jd(o/2+Pd)/Jd(s/2+Pd)),r=E(a/r)?Id(s):a/r;var u=e*Gd(t)/r;Bd(o)>Od&&(o=0<o?Nd-o:-(Nd+o))}return e?new Yf(o*Td,((n+u+Rd+(Bd(s+a)>Od?Nd:0))%Qd-Nd)*Td):this},Yf.prototype.walk=Yf.prototype.Cg,Yf.prototype.I=function(){return new K(this.lat,this.lng,this.lat,this.lng)},Yf.prototype.getBoundingBox=Yf.prototype.I,Yf.validate=Zf,Yf.fromIPoint=$f,n=Yf.prototype,n.qb="Point",n.Mc=function(t){return t.push("(",this.lng," ",this.lat,")"),t},n.Kb="Point",n.hd=function(){return[this.lng,this.lat,this.alt||0]},n.sc=function(){return[this.lat,this.lng,this.alt||0]},u(K,Wf),t("H.geo.Rect",K),K.prototype.qb="Polygon",K.prototype.Mc=function(t){var e=this.ka,i=this.aa,r=this.ma,n=this.ga;return t.push("(","(",i," ",e,",",n," ",e,",",n," ",r,",",i," ",r,",",i," ",e,")",")"),t},K.prototype.na=function(t){return this===t||!!t&&this.ka===t.ka&&this.aa===t.aa&&this.ma===t.ma&&this.ga===t.ga},K.prototype.equals=K.prototype.na,K.prototype.clone=function(){return new K(this.ka,this.aa,this.ma,this.ga)},K.prototype.clone=K.prototype.clone,K.prototype.Pb=function(){return this.c||(this.c=new Yf(this.ka,this.aa)),this.c},K.prototype.getTopLeft=K.prototype.Pb,K.prototype.Lb=function(){return this.a||(this.a=new Yf(this.ma,this.ga)),this.a},K.prototype.getBottomRight=K.prototype.Lb,K.prototype.on=function(){return this.ka},K.prototype.getTop=K.prototype.on,K.prototype.em=function(){return this.ma},K.prototype.getBottom=K.prototype.em,K.prototype.Km=function(){return this.aa},K.prototype.getLeft=K.prototype.Km,K.prototype.dn=function(){return this.ga},K.prototype.getRight=K.prototype.dn,K.prototype.fb=function(){return this.b||(this.b=new Yf(this.ma+(this.ka-this.ma)/2,bg(this.aa,this.Db()))),this.b},K.prototype.getCenter=K.prototype.fb,K.prototype.Db=function(){return cg(this.aa,this.ga)},K.prototype.getWidth=K.prototype.Db,K.prototype.Ud=function(){return this.ka-this.ma},K.prototype.getHeight=K.prototype.Ud,K.prototype.Eb=function(){return this.aa>this.ga},K.prototype.isCDB=K.prototype.Eb,K.prototype.Xf=function(){return!this.Db()&&!this.Ud()},K.prototype.isEmpty=K.prototype.Xf,K.prototype.I=function(){return new K(this.ka,this.aa,this.ma,this.ga)},K.prototype.getBoundingBox=K.prototype.I,K.prototype.Cf=function(t,e,i){var r=this.fb();return i||(t=Sf(t,this.Cf,0),e=Tf(e,this.Cf,1)),(t=(e=this.cd(t,e,i)).fb()).lat===r.lat&&t.lng===r.lng&&this.Ud()===e.Ud()&&this.Db()===e.Db()},K.prototype.containsLatLng=K.prototype.Cf,K.prototype.md=function(t,e){return e||Zf(t,this.md,0),this.Cf(t.lat,t.lng,e)},K.prototype.containsPoint=K.prototype.md,K.prototype.Vg=function(t,e){var i=this.fb();if(!e&&!C(t,K))throw new D(this.Vg,0,t);return(t=(e=this.hc(t,e)).fb()).lat===i.lat&&t.lng===i.lng&&this.Ud()===e.Ud()&&this.Db()===e.Db()},K.prototype.containsRect=K.prototype.Vg,K.prototype.cd=function(t,e,i,r){if(!i){if(E(t=Sf(t)))throw new D(this.cd,0,t);if(E(e=Tf(e)))throw new D(this.cd,1,e)}return dg(this.ka,this.aa,this.ma,this.ga,t,e,t,e,r)},K.prototype.mergeLatLng=K.prototype.cd,K.prototype.sk=function(t,e,i){return e||Zf(t,this.sk,0),this.cd(t.lat,t.lng,e,i)},K.prototype.mergePoint=K.prototype.sk,K.prototype.hc=function(t,e,i){if(!e&&!C(t,K))throw new D(this.hc,0,t);return dg(this.ka,this.aa,this.ma,this.ga,t.ka,t.aa,t.ma,t.ga,i)},K.prototype.mergeRect=K.prototype.hc,K.prototype.Cc=function(t,e,i,r,n,o){return n||(t=Sf(t,this.Cc,0),e=Tf(e,this.Cc,1),i=Sf(i,this.Cc,2),r=Tf(r,this.Cc,3)),dg(this.ka,this.aa,this.ma,this.ga,t,e,i,r,o)},K.prototype.mergeTopLeftBottomRight=K.prototype.Cc,K.prototype.wd=function(t,e){var i=this.aa<=this.ga,r=t.aa<=t.ga,n=this.aa<t.ga,o=t.aa<this.ga;if(!e&&!C(t,K))throw new D(this.wd,0,t);return this.ma<=t.ka&&t.ma<=this.ka&&(!i&&(!r||n||o)||!r&&(n||o)||n&&o)},K.prototype.intersects=K.prototype.wd,K.merge=dg,K.fromPoints=eg,K.coverPoints=fg,K.coverLatLngAlts=gg,K.coverRects=hg,K.prototype.Rk=function(t,e){var i=this.aa,r=this.ka,n=this.ga,o=this.ma,a=this.fb().lng;Zf(t,this.Rk,0);var s=t.lat-o-(r-o)/2,l=t.lng-a;return t=-180>(t=i+(0>(l=180<l||-180>l?-(a+t.lng):l)?2*l:0))?360+t:t,n=180<(n+=0<l?2*l:0)?n-360:n,90<=(r=0<s?r+2*s:r)&&(r=90),-90>=(o=0>s?o+2*s:o)&&(o=-90),e?ag(e,r,t,o,n):new K(r,t,o,n)},K.prototype.resizeToCenter=K.prototype.Rk,K.prototype.Kb="Polygon",K.prototype.hd=function(){return[[this.aa,this.ka,0],[this.ga,this.ka,0],[this.ga,this.ma,0],[this.aa,this.ma,0],[this.aa,this.ka,0]]},K.prototype.X=function(){return this.sc()},K.prototype.sc=function(){return[this.ka,this.aa,this.ma,this.ga]},ig.prototype.remove=function(t){var e,i,r,n=!1;return t&&(e=t.node)&&e.b===this&&(i=e.entries)&&0<=(r=i.indexOf(t))&&(i.splice(r,1),this.o(e),lg(this,t,!1),n=!0),n},ig.prototype.flush=function(){var t=new mg(null,NaN,this.f-this.i,this.g-this.j,this.f+this.i,this.g+this.j);t.b=this,this.head=this.a=t,this.b=null},ig.prototype.$a=function(t,e,i,r,n,o){var a=[],s=this.head,l=this.a;return t<=s[5]&&e<=s[6]&&(n?i>=s[7]:i>s[7])&&(o?r>=s[4]:r>s[4])&&og(this,s,a,t,e,i,r,o||r>=l[6],n||i>=l[5]),a},ig.prototype.Nc=ba(1);var pg=0;function mg(t,e,i,r,n,o){this.c=e,t&&(this.parent=t,this.b=t.b,1&e?(i=t[8],n=t[5]):(i=t[7],n=t[8]),2&e?(r=t[9],o=t[6]):(r=t[4],o=t[9])),this[7]=i,this[5]=n,this[8]=(i+n)/2,this[4]=r,this[6]=o,this[9]=(r+o)/2}function qg(t,e){return t[e]||(++t.a,t[e]=new mg(t,e))}function rg(t,e){(t.entries||(t.entries=[])).push(e),e.node=t}function sg(t,e,i,r,n){var o=t[5],a=t[6];return t[7]<=e&&t[4]<=i&&(o>r||o===r&&o===t.b.a[5])&&(a>n||a===n&&a===t.b.a[6])}function tg(t,e,i,r,n,o){tg.l.constructor.apply(this,arguments)}function ug(t,e,i,r,n){if(sg(t.a,e,i,r,n))return vg(t,t.a,e,i,r,n,t.c);throw Error("Coordinates out of bounds")}function vg(t,e,i,r,n,o,a){var s,l,u=e[8],c=e[9];return a&&(n<u||(s=i>=u))&&(o<c||(l=r>=c))?i=vg(t,qg(e,s|l<<1),i,r,n,o,a-1):(rg(e,i=new wg(i,r,n,o)),lg(t,i,!0),ng(t,e)),i}function wg(t,e,i,r){this.id=pg++,this[0]=e,this[1]=i,this[2]=r,this[3]=t}function xg(t){this.f=new tg(+t||10,180,90,0,0,!0),this.c=[],this.g=!1,this.a=this.b=this.O=null}function yg(t,e,i,r,n,o){return o?(o=new wg(n,-e,i+360,-r),t.c.push(o),t.g=!0,t.a&&t.a.Cc(e,i,r,n,!0,t.a)):(o=ug(t.f,i,-e,n,-r),t.b&&t.b.Cc(e,i,r,n,!0,t.b)),++t.Ih,t.O=null,o}function zg(t,e,i,r,n,o,a){var s,l=(t=t.c).length,u=[];if(l){var c=i+360;for(s=n+360;l--;){var h=t[l];(Ag(h,e,i,r,n,o,a)||Ag(h,e,c,r,s,o,a))&&u.push(h)}}return u}function Ag(t,e,i,r,n,o,a){var s=t[3],l=t[0],u=t[1];return t=t[2],(o?l<=r:l<r)&&(a?s<=n:s<n)&&t>=e&&u>=i}function Bg(t,e){var i,r,n;if(i=e.length){var o=t.length;for(r={};o--;)r[t[o].id]=1;for(;i--;)(n=e[i]).id in r||t.push(n)}}mg.prototype.a=0,mg.prototype.removeChild=function(t){var e=t.c;this[e]===t&&(delete this[e],delete t.parent,--this.a)},mg.prototype.Nc=ba(0),u(tg,ig),tg.prototype.o=function(t){for(var e,i,r=this.head;t;)(e=t.entries)&&e.length||(e&&delete t.entries,t.a||!(i=t.parent))?t=y:(i.removeChild(t),r===t&&(r=i),t=i);this.head!==r&&(this.head=r,ng(this))},tg.prototype.zc=function(t,e){return ug(this,t,e,t,e)},wg.prototype.td=function(t){return this[t]},t("H.geo.QuadTree",xg),n=xg.prototype,n.Ih=0,n.Xc=function(){return this.Ih},n.Eb=function(){return this.g},n.I=function(){var t,e;if(!this.O){var i,r,n,o=[];if(!this.b&&(t=jg(this.f))&&(this.b=new K(-t[0],t[3],-t[2],t[1])),(e=this.b)&&o.push(e),!this.a&&(n=(r=this.c).length)){t=90;var a=360,s=-90;for(i=0;n--;){var l=r[n];t=wd(t,l[0]),a=wd(a,l[3]),s=xd(s,l[2]),i=xd(i,l[1])}this.a=new K(-t,a,-s,i-360)}(e=this.a)&&o.push(e),(e=o[0])&&(o[1]&&(e=e.hc(o[1],!0)),this.O=e)}return this.O},n.zc=function(t){var e=t.lng;return yg(this,t=t.lat,e,t,e,!1)},n.Wj=function(t){var e=t.Pb(),i=t.Lb();return(t=t.Eb())?yg(this,e.lat,i.lng,i.lat,e.lng,t):yg(this,e.lat,e.lng,i.lat,i.lng,t)},xg.prototype.insertBoundingBox=xg.prototype.Wj,xg.prototype.remove=function(t){var e;if(t.node){var i=this.f.remove(t);this.b=null}else(i=0<=(t=(e=this.c).indexOf(t)))&&(e.splice(t,1),this.g=0<e.length,this.a=null);return i&&(--this.Ih,this.O=null),i},xg.prototype.remove=xg.prototype.remove,xg.prototype.Wf=function(t,e,i){var r=this.f,n=t.Pb(),o=t.Lb(),a=-n.lat;n=n.lng;var s=-o.lat;return o=o.lng,!e&&a===s||!i&&n===o?t=[]:t.Eb()?(Bg(t=r.$a(-180,a,o,s,i,e),r.$a(n,a,180,s,!1,e)),Bg(t,zg(this,a,o,s,n+360,e,i))):Bg(t=r.$a(n,a,o,s,i,e),zg(this,a,n,s,o,e,i)),t},xg.prototype.intersectBoundingBox=xg.prototype.Wf;var Cg=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Dg="undefined"!=typeof BigInt?BigInt:Number;function Eg(t){var e=Dg(0),i=Dg(0),r=[];if(t.split("").forEach((function(t){t=Dg(Cg[t.charCodeAt(0)-45]),e|=(t&Dg(31))<<i,(t&Dg(32))===Dg(0)?(r.push(e),e=Dg(0),i=Dg(0)):i+=Dg(5)})),0<i)throw Error("Invalid encoding");return r}function Fg(t){return t&Dg(1)&&(t=~t),+(t>>=Dg(1)).toString()}function Gg(t){var e=void 0===t.precision?5:t.precision,i=void 0===t.qf?0:t.qf,r=void 0===t.rf?0:t.rf;t=t.ii;var n=Math.pow(10,e),o=Math.pow(10,r);e=Hg(e,i,r);var a=[],s=Dg(0),l=Dg(0),u=Dg(0);return t.forEach((function(t){var e=Dg(Math.round(t[0]*n));a.push(Ig(e-s)),s=e,e=Dg(Math.round(t[1]*n)),a.push(Ig(e-l)),l=e,i&&(t=Dg(Math.round(t[2]*o)),a.push(Ig(t-u)),u=t)})),(e instanceof Array?e:fa(ea(e))).concat(a instanceof Array?a:fa(ea(a))).join("")}function Hg(t,e,i){if(0>t||15<t)throw Error("precision out of range. Should be between 0 and 15");if(0>i||15<i)throw Error("thirdDimPrecision out of range. Should be between 0 and 15");if(0>e||7<e||4===e||5===e)throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");return t|=i<<7|e<<4,Jg(1)+Jg(t)}function Jg(t){var e="";for(t=Dg(t);31<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[t&Dg(31)|Dg(32)],t>>=Dg(5);return e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[t]}function Ig(t){var e=0>(t=Dg(t));return t<<=Dg(1),e&&(t=~t),Jg(t)}function Kg(t){return Gg({ii:t.polyline,precision:t.precision,qf:t.thirdDim,rf:t.thirdDimPrecision})}function Lg(t){if(1!=+(t=Eg(t))[0].toString())throw Error("Invalid format version");var e=+t[1].toString();e={precision:15&e,qf:e>>4&7,rf:e>>7&15};for(var i=Math.pow(10,e.precision),r=Math.pow(10,e.rf),n=e.qf,o=0,a=0,s=0,l=[],u=2;u<t.length;){var c=Fg(t[u])/i;o+=c,a+=Fg(t[u+1])/i,n?(s+=c=Fg(t[u+2])/r,l.push([o,a,s]),u+=3):(l.push([o,a]),u+=2)}if(u!==t.length)throw Error("Invalid encoding. Premature ending reached");return{polyline:(t=Object.assign({},e,{ii:l})).ii,precision:t.precision,thirdDim:t.qf,thirdDimPrecision:t.rf}}function L(t){L.l.constructor.call(this),t&&Mg(t,L,0),this.Y=t||[],this.a=Ng(this,0,this.Y.length)}function Ng(t,e,i){t=t.Y;var r=0;for(e=xd(e,0),i=wd(i,t.length),i-=2,e+=1;e<i;)r+=Vf(t[e],t[e+=3]);return r}function Og(t,e,i,r,n){var o=t.Y.length;e=Sf(e,n),i=Tf(i,n),t.Y.push(Sf(e,n),Tf(i,n),r===B?0:Uf(r,n)),o&&(t.a+=Vf(t.Y[o-2],i)),delete t.O,delete t.b}function Mg(t,e,i){for(var r,n=t.length,o=!(n%3);o&&n;)o=!(E(t[--n]=Uf((r=t[n])===B?0:r))||E(t[--n]=Tf(t[n]))||E(t[--n]=Sf(t[n])));if(!o&&e)throw new D(e,i,t)}function Pg(t){var e=new L,i=0,r=t.length;if(r%2)throw new D(Pg,0,t);for(;i<r;)Og(e,t[i++],t[i++],0,Pg);return e}function Qg(t,e){return t.a-e.a}function Rg(t,e){var i,r=t.Y,n=-2,o=[],a=t.b;if(!a){a=t.b=new xg;var s=0,l=t.Y,u=l.length;for(i=0;i<u;i+=3){var c=l[i],h=l[i+1];if(i){if(f<h)var p=f,f=h;else p=h;if(y<c)var d=c;else{d=y;var y=c}(p=yg(a,d,p,y,f,180<f-p)).a=s++}y=c,f=h}}for(l=(a=a.Wf(e).sort(Qg)).length,e=0;e<l;e++){if(u=3*(s=(s=a[e]).a),s>n+1){var g=[r[u],r[u+1]];o.push(g)}n=s,g.push(r[u+3],r[u+4])}if(t.a){for(r=[],n=o.length,e=0;e<n;e++)if(a=(g=o[e]).length){for(l=[],t=0;t<a;t+=2)s=g[t],u=g[t+1],l.push(s,u),i=g[t-1],t&&Vf(u,i)&&(r.push(l),i+=0>i?360:-360,(l=[]).push(g[t-2],i,s,u));r.push(l)}o=r}return o}function Sg(t){var e=Lg(t);t=e.polyline;var i=e.thirdDim;if(e=2===i||3===i,i=0===i,!t)throw new D(Sg,0,"data");if(e||i){i=t.length;for(var r=Array(3*i),n=0,o=0;n<i;n++){var a=t[n];r[o++]=a[0],r[o++]=a[1],r[o++]=e?a[2]:0}}if(!r)throw new D(Sg,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(r)}function Tg(t){Tg.l.constructor.call(this),void 0!==t&&(this.data=t)}function Ug(){}t("H.util.flexiblePolyline.encode",Kg),t("H.util.flexiblePolyline.decode",Lg),u(L,Wf),t("H.geo.LineString",L),L.prototype.mi=function(t,e,i){Og(this,t,e,i,this.mi)},L.prototype.pushLatLngAlt=L.prototype.mi,L.prototype.nf=function(t,e,i){i&&Mg(i,this.nf,2),void 0===e&&(e=this.Y.length),e&&(this.a-=Ng(this,t-3,t+e+3));var r=i?this.Y.splice.apply(this.Y,[t,e].concat(i)):this.Y.splice(t,e);return i&&(this.a+=Ng(this,t-3,t+i.length+3)),e&&!i&&(this.a+=Ng(this,t-3,t-3)),delete this.O,delete this.b,r},L.prototype.spliceLatLngAlts=L.prototype.nf,L.prototype.Xj=function(t,e,i,r){this.nf(t,0,[e,i,r])},L.prototype.insertLatLngAlt=L.prototype.Xj,L.prototype.Nk=function(t){this.nf(t,3)},L.prototype.removeLatLngAlt=L.prototype.Nk,L.prototype.Bd=function(t){Og(this,t.lat,t.lng,t.alt,this.Bd)},L.prototype.pushPoint=L.prototype.Bd,L.prototype.zc=function(t,e){this.Xj(3*t,e.lat,e.lng,e.alt)},L.prototype.insertPoint=L.prototype.zc,L.prototype.df=function(t){this.Nk(3*t)},L.prototype.removePoint=L.prototype.df,L.prototype.Ge=function(t,e){var i=this.Y,r=3*t;t=i[r];var n=i[r+1];return i=i[r+2],e&&(e.lat=t,e.lng=n,e.alt=i),e||new Yf(t,n,i)},L.prototype.extractPoint=L.prototype.Ge,L.prototype.Ul=function(t,e,i){var r=this.Y;e=e||0,i=$e(i,r.length/3);for(var n=3*e;e<i;)t(r[n++],r[n++],r[n++],e++)},L.prototype.eachLatLngAlt=L.prototype.Ul,L.isDBC=Vf,L.prototype.kh=function(t){var e=this.a;return t&&(e+=Vf((t=this.Y)[t.length-2],t[1])),e},L.prototype.getDBCs=L.prototype.kh,L.prototype.Pe=function(){return this.Y.length/3},L.prototype.getPointCount=L.prototype.Pe,L.prototype.Im=function(){return this.Y},L.prototype.getLatLngAltArray=L.prototype.Im,L.prototype.O=y,L.prototype.I=function(){var t;if(!(t=this.O)){var e,i,r=(t=this.Y).length,n=3,o=y;if(3<=r){var a=e=t[0],s=i=t[1];for(o=new K(a,s,e,i);n<r;n+=3){if(a=t[n-3],s=t[n-2],e=t[n],s>(i=t[n+1])&&180<i-s||s<i&&-180>s-i||i<s&&180>Bd(i-s)){var l=s;s=i,i=l}a<e&&(l=a,a=e,e=l),dg(o.ka,o.aa,o.ma,o.ga,a,s,e,i,o)}}t=this.O=o}return t},L.prototype.getBoundingBox=L.prototype.I,L.prototype.zn=function(){return this.O!==y},L.prototype.hasBoundingBox=L.prototype.zn,L.fromLatLngArray=Pg,L.prototype.na=function(t){var e,i=this===t;if(!i&&(i=C(t,L))){var r=this.Y;for(t=t.Y,i=(e=r.length)===t.length;i&&e--;)i=r[e]==t[e]}return i},L.prototype.equals=L.prototype.na,n=L.prototype,n.qb="LineString",n.Mc=function(t,e){var i,r=this.Y,n=r.length;if(n){for(t.push("("),i=0;i<n;i+=3)i&&t.push(","),t.push(r[i+1]," ",r[i]);e&&(r[0]!==r[n-3]||r[1]!==r[n-2])&&t.push(",",r[1]," ",r[0]),t.push(")")}else t.push("EMPTY");return t},n.Kb="LineString",n.hd=function(){var t,e=[],i=this.Y,r=i.length;for(t=0;t<r;t+=3)e.push([i[t+1],i[t],i[t+2]]);return e},n.sc=function(){var t,e=this.Y;if(this.I().Eb()){var i=1;for(t=(e=e.slice()).length;i<t;i+=3)0>e[i]&&(e[i]+=360)}return e},n.No=function(t){t=void 0===t?5:t;for(var e=this.Y,i=e.length,r=[],n=0;n<i;n+=3)r.push([e[n],e[n+1],e[n+2]]);return Kg({polyline:r,precision:t,thirdDim:2,thirdDimPrecision:t})},L.prototype.toFlexiblePolyline=L.prototype.No,L.fromFlexiblePolyline=Sg,u(Tg,F),t("H.map.Feature",Tg),Tg.prototype.getData=function(){return this.data},Tg.prototype.getData=Tg.prototype.getData,Tg.prototype.s=function(){Tg.l.s.call(this),delete this.data},t("H.map.provider.Invalidations",Ug),Ug.MARK_INITIAL=Vd,Ug.prototype.update=function(t,e){e!==Vg.NONE&&(this.a=t,e&Vg.SPATIAL&&(this.f=t),e&Vg.VISUAL&&(this.g=t),e&Vg.ADD&&(this.b=t),e&Vg.REMOVE&&(this.c=t),e&Vg.Z_ORDER&&(this.j=t),e&Vg.VOLATILITY&&(this.i=t))},Ug.prototype.update=Ug.prototype.update,Ug.prototype.Om=function(){return this.a},Ug.prototype.getMark=Ug.prototype.Om,Ug.prototype.a=Vd,Ug.prototype.Dn=function(t){return this.a>t},Ug.prototype.isAny=Ug.prototype.Dn,Ug.prototype.g=Vd,Ug.prototype.ee=function(t){return this.g>t},Ug.prototype.isVisual=Ug.prototype.ee,Ug.prototype.f=Vd,Ug.prototype.Ch=function(t){return this.f>t},Ug.prototype.isSpatial=Ug.prototype.Ch,Ug.prototype.b=Vd,Ug.prototype.Yj=function(t){return this.b>t},Ug.prototype.isAdd=Ug.prototype.Yj,Ug.prototype.c=Vd,Ug.prototype.Yf=function(t){return this.c>t},Ug.prototype.isRemove=Ug.prototype.Yf,Ug.prototype.j=Vd,Ug.prototype.Dh=function(t){return this.j>t},Ug.prototype.isZOrder=Ug.prototype.Dh,Ug.prototype.i=Vd,Ug.prototype.In=function(t){return this.i>t},Ug.prototype.isVolatility=Ug.prototype.In;var Vg={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};function Wg(t,e,i){Wg.l.constructor.call(this,t),this.oldValue=i,this.newValue=e}function M(t){if(vc(this,M),M.l.constructor.call(this,t?t.data:B),this.R=Xg.next(),t){var e="min";Dc(t[e])&&(this.F=t[e]),Dc(t[e="max"])&&(this.u=t[e]),(e="visibility")in t&&(this.A=!!t[e]),(e="volatility")in t&&(this.P=!!t[e]),(e="zIndex")in t&&(this.m=+t[e]||0),(e="provider")in t&&!C(t[e],N)&&(this.pa=t[e],this.xa(Vg.ADD))}}Ug.Flag=Vg,u(Wg,sd),t("H.util.ChangeEvent",Wg),u(M,Tg),t("H.map.Object",M);var Xg=new bf(1),Yg={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};function Zg(t,e,i){var r,n;if(!i||t[0]|e[0]){var o=t.length,a=e.length,s=wd(o,a),l=1;for(n=1+i;l<s;l+=n)if(r=t[l]-e[l])return r}return i?0:o-a}function $g(t,e){return t.hj(e)}function ah(t,e,i){if(null===e||e===B)return null;if(0<=Object.keys(e).length&&"[object Object]"!==Object.prototype.toString.call(e))throw Error(bh(t,i));try{return JSON.stringify(e),e}catch(e){throw Error(bh(t,i))}}function bh(t,e){return"Object Remote-Id: "+t.o+" - "+(e?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}function ch(t){var e;if(t){var i=dh;for(e=C(t,ch);i--;){var r=eh[i];if(t.hasOwnProperty(r)){var n=t[r];if(e)this[r]=n;else{if((n=fh[i](n))===gh)throw new D(ch,0,r+": "+t[r]);n!==this[r]&&n!==B&&(this[r]=n)}}}(i=e?t.b:this.lineWidth&&Ye(this.strokeColor))||(this.b=i),(i=e?t.Qb:Ye(this.fillColor))||(this.Qb=i),(i=e?t.a:"none"!==this.strokeColor&&this.lineWidth)||(this.a=i)}pc(this)}M.Type=Yg,M.prototype.gb=function(){return this.R},M.prototype.getId=M.prototype.gb,M.prototype.Ei=function(t){if(!Dc(t)&&!Ac(t))throw new D(this.Ei,0,"id must be a number or a string");return this.o=t,this},M.prototype.setRemoteId=M.prototype.Ei,M.prototype.cn=function(){return this.o},M.prototype.getRemoteId=M.prototype.cn,M.prototype.F=-1/0,M.prototype.u=1/0,M.prototype.Ej=function(t){var e=this.u;if(t)for(t=this;t=t.Ia;)e=wd(e,t.u);return e},M.prototype.getMax=M.prototype.Ej,M.prototype.Gj=function(t){var e=this.F;if(t)for(t=this;t=t.Ia;)e=xd(e,t.F);return e},M.prototype.getMin=M.prototype.Gj,M.prototype.A=!0,M.prototype.vb=function(t){return(t=!!t)^this.A&&(this.A=t,this.invalidate(Vg.VISUAL)),this},M.prototype.setVisibility=M.prototype.vb,M.prototype.xc=function(t){for(var e,i=this;(e=i.A)&&t&&(i=i.Ia););return e},M.prototype.getVisibility=M.prototype.xc,M.prototype.P=!1,M.prototype.Tf=function(t){for(var e,i=this;!(e=i.P)&&t&&(i=i.Ia););return e},M.prototype.getVolatility=M.prototype.Tf,M.prototype.fl=function(t){var e=this.P;return e^t&&(this.P=!e,this.invalidate(Vg.VOLATILITY)),this},M.prototype.setVolatility=M.prototype.fl,M.prototype.m=B,M.prototype.Pj=function(){return this.m},M.prototype.getZIndex=M.prototype.Pj,M.prototype.qe=function(t){return t!==this.m&&(this.ef(),this.m=t,this.invalidate(Vg.Z_ORDER)),this},M.prototype.setZIndex=M.prototype.qe,M.prototype.L=B,M.prototype.$c=function(){var t,e,i=this.L;if(!i){var r=(t=this.m)!==B;(i=this.Ia)?(i=i.$c().slice())[0]|=r:i=[0|r],i.push(t||0,0>(e=this.Hi)?this.R:e),this.L=i}return i},M.prototype.getZInfo=M.prototype.$c,M.prototype.ef=function(){this.L=B},M.compareZInfo=Zg,M.compareZOrder=$g,M.prototype.hj=function(t){return this.Dg-t.Dg||Zg(this.$c(),t.$c(),!1)},M.prototype.compareZOrder=M.prototype.hj,n=M.prototype,n.previousSibling=y,n.nextSibling=y,n.Hi=-1,n.Ia=y,n.Sm=function(){return this.Ia},M.prototype.getParentGroup=M.prototype.Sm,M.prototype.ec=function(){for(var t,e=this;t=e.Ia;)e=t;return e},M.prototype.getRootGroup=M.prototype.ec,M.prototype.contains=function(t){return this===t},M.prototype.contains=M.prototype.contains,M.prototype.ja=function(t){if(this.Ia)throw new Yc(this.ja,"Not allowed for a child of a group");M.l.ja.call(this,t)},M.prototype.setParentEventTarget=M.prototype.ja,M.prototype.pa=y,M.prototype.ea=function(){return this.pa},M.prototype.getProvider=M.prototype.ea,M.prototype.pe=function(t,e){var i,r=this.pa;if(i=r!==t){if(e&&(r&&!C(r,N)||t&&!C(t,N)))throw new Yc(e,"Only LocalObjectProvider allows an object transfers");e=this.type!==Yg.GROUP,r&&(this.invalidate(Vg.REMOVE),e&&r.Ja(this)),(this.pa=t)&&(e&&t.ca(this),this.Da=y,this.invalidate(Vg.ADD))}return i},M.prototype.Nb=function(){return this.Da||(this.Da=new Ug)},M.prototype.getInvalidations=M.prototype.Nb,M.prototype.xa=function(t){var e,i=this.ea();return(e=!!i)&&i.invalidateObject(this,t),e},M.prototype.invalidate=M.prototype.xa,M.prototype.s=function(){this.Ia&&this.Ia.Ja(this),M.l.s.call(this)},M.prototype.setData=function(t){return this.data=t,this},M.prototype.setData=M.prototype.setData,M.prototype.Lc=function(t){if(t&&!Da(t))throw new D(M.prototype.Lc,0,"opt_callback must be a function");return t={type:"Feature",properties:ah(this,t?t(this.data):this.data,!!t),geometry:this.da().Lc()},this.o&&(t.id=this.o),t},M.prototype.toGeoJSON=M.prototype.Lc,M.prototype.X=function(){return{id:this.R,properties:{min:this.Gj(),max:this.Ej(),zIdx:this.m,sIdx:this.Hi,parent:this.Ia?this.Ia.gb():0,visible:this.xc(),volatile:this.Tf()},type:"Feature"}},M.prototype.forWorkerMessage=M.prototype.X,t("H.map.SpatialStyle",ch),ch.prototype.Qb=!0,ch.prototype.b=!0,ch.prototype.a=!0;var eh="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineHeadCap lineTailCap".split(" ");ch.prototype.strokeColor="rgba(0,85,170,.6)",ch.prototype.strokeColor=ch.prototype.strokeColor,ch.prototype.fillColor="rgba(0,85,170,.4)",ch.prototype.fillColor=ch.prototype.fillColor,ch.prototype.lineWidth=2,ch.prototype.lineWidth=ch.prototype.lineWidth,ch.prototype.lineCap="round",ch.prototype.lineCap=ch.prototype.lineCap,ch.prototype.lineJoin="miter",ch.prototype.lineJoin=ch.prototype.lineJoin,ch.prototype.miterLimit=1,ch.prototype.miterLimit=ch.prototype.miterLimit,ch.prototype.On=gf,ch.prototype.lineDash=ch.prototype.On,ch.prototype.lineDashOffset=0,ch.prototype.lineDashOffset=ch.prototype.lineDashOffset,ch.prototype.Pn=B,ch.prototype.lineHeadCap=ch.prototype.Pn,ch.prototype.Qn=B,ch.prototype.lineTailCap=ch.prototype.Qn;var dh=eh.length;ch.prototype.na=function(t){var e=this===t;if(!e&&t){for(e=0;e<dh;e++){var i=eh[e];if(this[i]!==t[i])break}e=e===dh}return e},ch.prototype.equals=ch.prototype.na,ch.prototype.Aj=function(t){if(t){var e={};Xa(e,this,t)}else e=this;return new ch(e)},ch.prototype.getCopy=ch.prototype.Aj;var gh=pc({}),fh=[function(t){return t?oc(t):gh},function(t){return t?oc(t):gh},function(t){return 0<=t&&100>=t?+t:gh},function(t){return"butt"===(t=oc(t))||"square"===t||"round"===t||"arrow-head"===t||"arrow-tail"===t?t:gh},function(t){return"round"===t||"bevel"===t||"miter"===t?t:gh},function(t){return 0<t&&100>=t?+t:gh},function(t){return t&&t.every&&t.every(Ec)?t:gh},function(t){return E(+t)?gh:+t},function(t){return uc(t)?fh[3](t):B},function(t){return uc(t)?fh[3](t):B}];ch.MAX_LINE_WIDTH=100;var hh=new ch;ch.DEFAULT_STYLE=hh;var ih="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");function jh(t){var e;if(t){var i=C(t,jh);for(e in t)if(e in this){var r=t[e];r!==this[e]&&("fillColor"===e||0<(r=+r))&&(this[e]=r)}(t=i?t.Qb:!!(Ye(this.fillColor)&&this.width&&this.width))||(this.Qb=t)}pc(this)}function kh(t,e){var i;kh.l.constructor.call(this,e),e&&this.lc(e.style),t&&(this.j=!0),e&&(i=e.arrows)&&this.Xk(i)}function lh(t,e){var i,r=!1,n=!1;if(e.length){for(r=0;r<e.length;r++)if(e[r]!==mh){n=!0;break}e=t.style,r=n?e.b||e.Qb&&t.j||(i=t.g||!1)&&e.a&&i.Qb:e.Qb}return r&&t.xc(!0)}function nh(t,e){nh.l.constructor.call(this,t,e)}function oh(t,e,i,r){var n,o=[],a=e.length;for(n=0;n<a;n++){var s=e[n];s.length&&o.push(ph(t,s,i,r))}return o}function ph(t,e,i,r){var n,o=[],a=e.length,s=0;for(t.la=0,n=n||0;s<a;)o.push(qh(t,e[s++],e[s++],n,r));return i&&o.push(qh(t,e[0],e[1],n,r)),o}function qh(t,e,i,r,n){var o=t.la;return o&&180<Bd(o-i)&&(i+=0>o?-360:360),t.la=i,n.Eh(e,i+r)}function rh(t,e,i){for(var r,n,o,a=e,s=t.length+e;a--;){for(n=(e=t[a]).length,r=Array(n);n--;)o=e[n],r[n]=new I(o.x+i,o.y);t[--s]=r}}ch.prototype.X=function(){for(var t,e={},i=ih.length;i--;)e[t=ih[i]]=this[t];return e},ch.prototype.forWorkerMessage=ch.prototype.X,t("H.map.ArrowStyle",jh),jh.prototype.Qb=!0,jh.prototype.fillColor="rgba(255,255,255,.75)",jh.prototype.width=1.2,jh.prototype.length=1.6,jh.prototype.frequency=5,jh.prototype.zj=function(){return new jh(this)},jh.prototype.na=function(t){var e=this===t;return!e&&t&&(e=t.width===this.width&&t.fillColor===this.fillColor&&t.length===this.length&&t.frequency===this.frequency),e},jh.prototype.equals=jh.prototype.na,u(kh,M),t("H.map.Spatial",kh),kh.prototype.type=Yg.SPATIAL,kh.prototype.Dg=0,kh.prototype.style=hh,kh.prototype.va=function(){return this.style},kh.prototype.getStyle=kh.prototype.va,kh.prototype.lc=function(t){var e=!0;return t?this.style=C(t,ch)?t:new ch(t):this.style?delete this.style:e=!1,e&&this.invalidate(Vg.VISUAL),this},kh.prototype.setStyle=kh.prototype.lc,kh.prototype.bm=function(){return this.g},kh.prototype.getArrows=kh.prototype.bm,kh.prototype.Xk=function(t){var e=this.g,i=!1;return!t&&e?(delete this.g,i=!0):!t||e&&e.na(t)||(this.g=new jh(t),i=!0),i&&"none"!==this.style.strokeColor&&this.xa(1),this},kh.prototype.setArrows=kh.prototype.Xk,kh.prototype.j=!1,kh.prototype.Fn=function(){return this.j},kh.prototype.isClosed=kh.prototype.Fn,kh.prototype.getGeometriesForTile=kh.prototype.Td,kh.prototype.nh=function(){return B},kh.prototype.getLabels=kh.prototype.nh,u(nh,kh),t("H.map.GeoShape",nh),nh.prototype.getBoundingBox=nh.prototype.I;var sh=new L([0,0,0,0,0,0,0,0,0]),Bh;function th(t){vc(this,th),th.l.constructor.call(this),this.oa=uh(this,t,this.constructor,0)}function uh(t,e,i,r){var n,o=[];if(!zc(e))throw new D(i,r);for(n=0;n<e.length;n++){if(!t.a(e[n]))throw new D(i,r);o.push(t.b(e[n]))}return o}function vh(t){vh.l.constructor.call(this,t)}function wh(t,e){wh.l.constructor.call(this,!1,e),this.ba(t)}function xh(t,e){if(!C(t,L)||2>t.Pe())throw new D(e,0)}function yh(t,e,i,r){var n=Rg(e,i.Pf());if(n.length&&(n=(t=oh(t,n,!1,e=i.Rf())).length)){var o=i.Re();e=e.w,i.x||rh(t,n,-e),i.x===(1<<i.z)-1&&rh(t,n,e),(i=zh(t,o.left,o.top,o.right,o.bottom,!1)).length&&r.push(new Ah(i))}}function Ch(t,e){if(x.URL)return new x.URL(t,e).toString();if(!t||!Dh(t))return t;if(!e||Dh(e))throw new TypeError("Failed to construct 'URL': Invalid base URL");Bh||Gc(Bh=document.createElement("a"));var i=Bh;return i.href=e,"/"!==t[0]?t=i.href.replace(/\/[^\/]*$/,"/")+t:((e=i.origin)||(e=i.protocol+"//"+i.host),t=e+t),t}function Dh(t){var e=!1;return"string"==typeof t&&(e=!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))),e}function Eh(t,e){var i,r,n,o=arguments.length;for(i=1;i<o;i++)if((r=arguments[i])&&r!==t&&r!==a){var a=r;for(n in r){var s=r[n];t[n]!==s&&(Fh(s)?Fh(t[n])?t[n]=Eh(t[n],s):t[n]=rc(s):void 0!==s&&(t[n]=rc(s)))}}return t}u(th,Wf),t("H.geo.MultiGeometry",th),th.prototype.splice=function(t,e,i){return t=[t],e!==B&&t.push(e),i&&(e=uh(this,i,this.splice,2),t=t.concat(e)),this.O=y,this.oa.splice.apply(this.oa,t)},th.prototype.splice=th.prototype.splice,th.prototype.jc=function(t){var e=this.oa.length;if(!(0<=t&&t<e))throw new ke(this.jc,t,[0,e-1]);return this.O=y,this.oa.splice(t,1)[0]},th.prototype.removeAt=th.prototype.jc,th.prototype.remove=function(t){if(0<=(t=this.oa.indexOf(t))){var e=this.oa.splice(t,1)[0];this.O=y}return e||y},th.prototype.remove=th.prototype.remove,th.prototype.zm=function(){return this.oa},th.prototype.getGeometries=th.prototype.zm,th.prototype.push=function(t){var e=uh(this,[t],this.push,0)[0];this.O&&(this.O=this.O.hc(t.I())),this.oa.push(e)},th.prototype.push=th.prototype.push,th.prototype.I=function(){var t,e,i;if(!(t=this.O)&&(t=y,this.oa.length))for(t=this.oa[0].I(),i=1;i<this.oa.length;i++)(e=this.oa[i].I())&&(t=t?t.hc(e):e);return this.O=t},th.prototype.getBoundingBox=th.prototype.I,th.prototype.O=y,th.prototype.b=function(t){return t},th.prototype.na=function(t){var e,i=this===t;if(!i&&(i=C(t,this.constructor))){var r=this.oa;for(t=t.oa,i=(e=r.length)===t.length;i&&e--;)i=r[e].na(t[e])}return i},th.prototype.equals=th.prototype.na,n=th.prototype,n.Mc=function(t){var e,i,r=this.oa,n=r.length,o=!1;if(n){for(t.push("("),e=0;e<n;e++)(i=0<e&&o)&&t.push(","),r[e].Mc(t),"EMPTY"===t[t.length-1]?t.splice(-1-i,1+i):o=!0;o?t.push(")"):t.splice(-1,1,"EMPTY")}else t.push("EMPTY");return t},n.toString=function(){return this.Mc([this.qb.toUpperCase()," "]).join("")},n.sc=function(){for(var t=[],e=this.oa,i=e.length;i--;)t[i]=e[i].sc();return t},n.X=function(){var t=th.l.X.call(this);return t.type=this.qb,t},n.hd=function(){for(var t=[],e=this.oa,i=e.length;i--;)t[i]=e[i].hd();return t},u(vh,th),t("H.geo.MultiLineString",vh),vh.prototype.a=function(t){return C(t,L)},vh.prototype.qb="Multi"+L.prototype.qb,vh.prototype.Kb="Multi"+L.prototype.Kb,u(wh,nh),t("H.map.Polyline",wh),wh.prototype.I=function(){return this.a.I()},wh.prototype.getBoundingBox=wh.prototype.I,wh.prototype.a=y,wh.prototype.ba=function(t){var e,i,r=this.ba;if(C(t,vh)){var n=t.oa;if(!(e=n.length))throw new D(r,0);for(i=0;i<e;i++)xh(n[i],r)}else xh(t,r);return this.f=!!n,this.a=t,this.xa(Vg.SPATIAL),this},wh.prototype.setGeometry=wh.prototype.ba,wh.prototype.da=function(){return this.a},wh.prototype.getGeometry=wh.prototype.da,wh.prototype.clip=function(t){var e=this.a;return Rg(this.f?e.oa[0]:e,t)},wh.prototype.clip=wh.prototype.clip,wh.prototype.Td=function(t){var e,i=this.a,r=[];if(this.f)for(e=(i=i.oa).length;e--;)yh(this,i[e],t,r);else yh(this,i,t,r);return r.length?r:B},wh.prototype.getGeometriesForTile=wh.prototype.Td,wh.prototype.X=function(){var t=wh.l.X.call(this),e=t.properties;return t.geometry=this.da().X(),e.style=this.va().X(),e.height=0,t},wh.prototype.forWorkerMessage=wh.prototype.X,t("H.util.webgl.mergeObjects",Eh);var Gh=nc();function Hh(t,e,i){var r=i[t];return e&&r in e&&0>tc.indexOf(r)?(e=e[r],++t<i.length?Hh(t,e,i):e):Gh}var Ih=Hh.bind(null,0),Jh={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},Kh={data:1,draw:1,enabled:1,filter:1,properties:1},Lh=Object.keys(Kh);function Mh(t,e,i,r,n,o){var a=r[t],s=i[a];if(++t<r.length){var l=e[a]||{};for(i=Lh.length;i--;){var u=Lh[i];if("draw"!==u||!o){var c=s[u];c!==B&&(l[u]=rc(c))}}Mh(t,l,s,r,n,o)}else n?l=rc(s):(l=s,delete i[a]);e[a]=e[a]?Eh(e[a],l):l}var Nh=Mh.bind(null,0);function Oh(t,e){t in Jh&&(e[t]=1)}function Ph(t,e,i){var r,n,o;for(r in t)if(Kh[r]){if("draw"===r){var a=t[r];for(n in a){var s=a[n];(o=s.style)?(s.style=e+o,Oh(o,i)):(delete a[n],a[e+n]=s,Oh(n,i))}}}else Ph(t[r],e,i)}function Qh(t,e){var i,r,n,o,a={};if(e+="_",i=(t=Eh({},t)).styles)for(r in i){var s=i[r];if(delete i[r],i[e+r]=s,n=s.mix)for(Ac(n)&&(n=[n]),o=n.length;o--;)Oh(n[o],a),n[o]=e+n[o];(o=s.base)&&(n||(n=s.mix=[]),n.unshift(e+o),delete s.base,Oh(o,a)),Oh(r,a)}else i=t.styles={};if(s=t.layers)for(r in s)n=s[r],delete s[r],(o=n.data)&&!o.layer&&(o.layer=r),s[e+r]=n,Ph(n,e,a);for(r in a)i[e+r]={base:r};return t}function Rh(t,e){var i,r=t.sources,n=Object.keys(r)[0],o=Eh(r[n],{uid:e});for(i in r=t.layers,t.sources={},t.sources[e]=o,r)(t=r[i]).data?t.data.source===n&&(t.data.source=e):t.data={source:e}}function Sh(t,e){var i,r=t.textures,n=t.fonts;for(i in r){var o=r[i];o.url&&(o.url=Ch(o.url,e))}for(i in n)if(zc(r=n[i]))for(o=0;o<r.length;o++){var a=r[o];a.url=a.url&&Ch(a.url,e)}else(a=t.fonts[i]).url=a.url&&Ch(a.url,e)}function Th(t,e){return"function(){return feature."+t+(e||"")+";}"}function Uh(t){return Th("style."+t,void 0)}function Vh(t,e,i,r){return t={base:t,blend:e,blend_order:i},r&&(t.clean_depth=!!r),t}function Wh(t){var e={};return e["translucent-"+(t?"extruded-":"")+"polygons"]={color:Uh("fillColor"),order:1,interactive:!0,extrude:t},e}function Xh(t,e,i,r){return t={data:{source:t,layer:e}},i&&(t.draw=i),r&&(t.filter=r),t}function Fh(t){return Ea(t)&&!zc(t)}function Yh(t,e){if(Yh.l.constructor.call(this),e&&Dh(e))throw new D(Yh,1,"Base URL must be absolute");this.i=Zh.INIT,this.a=null,this.o=e}u(Yh,F),t("H.map.render.Style",Yh),Yh.prototype.load=Yh.prototype.load,Yh.prototype.getState=function(){return this.i},Yh.prototype.getState=Yh.prototype.getState,Yh.prototype.N=function(t){this.i=t},Yh.prototype.setState=Yh.prototype.N,Yh.prototype.bc=function(){return this.o},Yh.prototype.getBaseUrl=Yh.prototype.bc,Yh.prototype.sd=function(){return rc(this.a)},Yh.prototype.getConfig=Yh.prototype.sd,Yh.prototype.im=function(){return this.a},Yh.prototype.getConfigReference=Yh.prototype.im,Yh.prototype.Gd=function(t){this.a=t},Yh.prototype.setConfig=Yh.prototype.Gd,Yh.prototype.Jb=function(t){this.a=null,this.N(Zh.ERROR);var e=$h;te(this.U,void 0!==e?String(e):void 0)?this.dispatchEvent(new ud($h,t,this)):console.error(t)},Yh.prototype.dispatchError=Yh.prototype.Jb,Yh.prototype.s=function(){Yh.l.s.call(this),this.a=null};var $h="error",ai={jd:"change",Si:$h},Zh={ERROR:-1,INIT:0,LOADING:1,READY:2};function bi(t,e){if(bi.l.constructor.call(this,t,e),Ac(t))ci.test(t)&&-1===t.indexOf("import:")?(this.c=t,e||(this.j=Dh(this.c)?B:this.c)):this.f=t;else{if(!Ea(t))throw new D(bi,0,di);this.Gd(rc(t))}}function ji(t){var e,i=t.a;if(Ea(i)){var r;if(r=t.g){for(var n in r=!1,i=i&&i.sources)if(i[n].type===t.g){r=!0;break}r=!(!i||r)}r&&(e="invalid source, the only valid type is "+t.g)}else e=di;return e&&t.Jb(e),!e}function hi(t){t.dispatchEvent(new sd("change",t))}function fi(t){if(t.getState()!==Zh.READY)throw new Yc(t.Ue,"style is not ready yet")}function gi(t,e,i,r){var n,o,a=[],s=zc(e)?e:[e];for(void 0===r&&(r=!0),s=s.sort().reverse();n=s.pop();){e=String(n).split(".");for(var l=t.a,u=e.length;u--&&!Kh[e[u]];);if(l&&0>u&&Fh(l=Ih(l.layers,e))||(l=Gh),l===Gh)throw new D(i,0,'Unresolvable layer ID "'+n+'"');if(a.push({id:e,hb:l}),r)for(o in l)!Kh[o]&&Fh(l[o])&&s.push(n+"."+o)}return a}function ii(t,e){var i,r=0;for(i=e.length;r!==i;){var n=e[r++],o=t;if(!(t=o[n]))break}return r===i?{node:t,parent:o,jg:n}:void 0}Yh.State=Zh,u(bi,Yh),t("H.map.render.webgl.Style",bi),bi.prototype.load=function(){var t=this,e=this.bc();this.c?(this.N(Zh.LOADING),new sf("text/plain",this.c).then((function(t){var i={};return ei(t,e,!1,(i[e]=!0,i))})).then((function(e){return t.Gd(e)}),(function(e){return t.Jb(e.message)})),this.c=null):this.f&&(this.N(Zh.LOADING),ei(this.f,e).then((function(e){return t.Gd(e)}),(function(e){return t.Jb(e.message)})),this.f=null)},bi.prototype.cl=function(t,e,i){var r;for(fi(this),t=gi(this,t,this.cl,i),i=0;i<t.length;i++){var n=t[i].hb.draw;for(r in n){var o=n[r];Fh(o)&&(o.interactive=!!e)}}hi(this)},bi.prototype.setInteractive=bi.prototype.cl,bi.prototype.setProperty=function(t,e,i){var r,n=t.split("."),o=0,a=n.length;if(fi(this),!uc(e))throw new D(this.setProperty,1,"value");if(r=ii(this.a,n)){if(!(r.parent instanceof Object)||r.parent instanceof Array){if(!i)throw new D(this.setProperty,0,t+" property is not primitive type");n.pop(),n=ii(this.a,n),r.parent=n.parent[n.jg]={}}r.parent[r.jg]=e}else{for(r=this.a;o!==a-1;)r[n[o]]={},r=r[n[o++]];r[n[o]]=e}ji(this)&&hi(this)},bi.prototype.setProperty=bi.prototype.setProperty,bi.prototype.sh=function(t){return fi(this),(t=ii(this.a,t.split(".")))?rc(t.node):void 0},bi.prototype.getProperty=bi.prototype.sh,bi.prototype.removeProperty=function(t){fi(this),(t=ii(this.a,t.split(".")))&&t.parent&&t.parent.hasOwnProperty(t.jg)&&(delete t.parent[t.jg],ji(this)&&hi(this))},bi.prototype.removeProperty=bi.prototype.removeProperty,bi.prototype.Fe=function(t,e,i){var r;fi(this);var n=this.a,o=n.layers,a=gi(this,t,this.Fe,!1);for(t=a.length,r={};t--;)Nh(r,o,a[t].id,!!e,!!i);for(i={},t=(a=Object.keys(n)).length;t--;){var s=a[t],l=n[s];i[s]=l===o?r:rc(l)}return e||hi(this),i},bi.prototype.extractConfig=bi.prototype.Fe,bi.prototype.Ue=function(t){if(fi(this),!Ea(t))throw new D(this.Ue,0,"config");this.Gd(Eh(this.a,t))},bi.prototype.mergeConfig=bi.prototype.Ue,bi.prototype.b=ba(2),bi.prototype.toString=function(){return this.getState()===Zh.READY?x.H.gl.yaml.safeDump(this.a,{lineWidth:120}):""},bi.prototype.s=function(){bi.l.s.call(this),this.f=this.c=null};var ci=/^(http[s]?)?.*\.ya?ml/i,di="invalid style configuration";function ei(t,e,i,r){i=void 0!==i&&i,r=void 0===r?{}:r;try{var n=x.H.gl.yaml.safeLoad(t,{json:!0})}catch(t){return Promise.reject(t)}return n&&(Ac(t=n.import)&&(t=[t]),i&&e&&ki(n,e),delete n.import,zc(t)&&t.length)?(i=t.reduce((function(t,i){var n=e?Ch(i,e):i;return r[n]||(r[n]=!0,t.push(new sf("text/plain",n).then((function(t){return ei(t,n,!0,r)})))),t}),[]),Promise.all(i).then((function(t){var e={};return t.forEach((function(t){return t&&Eh(e,t)})),Eh(e,n),e}))):Promise.resolve(n)}function ki(t,e){function i(t){t.url&&(t.url=Ch(t.url,e))}var r=t&&t.fonts;if(r)for(var n in r)zc(r[n])?r[n].forEach(i):i(r[n]);if(t=t&&t.textures)for(var o in t)i(t[o])}function zh(t,e,i,r,n,o){var a,s,l,u,c=t.length;if(c)for(a=[];c--;){var h=t[c],p=h.length,f=0;for(l=1;l<p;l++)if(u=li(h[l-1],h[l],i,e,r,n)){var d=u[0],y=u[1];f&&f.na(d)?s.push(y):a.push(s=u),f=y,o&&(l=p,c=0)}}else a=t;return a}function li(t,e,i,r,n,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,i=-i,o=-o,a>s){if(s>n||a<r)return;var l=a,u=t;a=s,t=e,s=l,e=u,l=1}else if(a>n||s<r)return;if(t>e){if(e>i||t<o)return;var c=1;t=-t,e=-e,u=o,o=-i,i=-u}else if(t>i||e<o)return;if(a<r){if((t+=(r-a)*(e-t)/(s-a))>i)return;a=r}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>n)return;t=o}return s>n&&(e=t+(n-a)*(e-t)/(s-a),s=n),e>i&&(s=a+(i-t)*(s-a)/(e-t),e=i),c&&(t=-t,e=-e),l?[new I(s,-e),new I(a,-t)]:[new I(a,-t),new I(s,-e)]}function mi(t,e,i){var r,n;t=ni(t,!0),e=ni(e,!1);var o={},a=r=1;switch(~~(i||0)){case 1:a=r=0;break;case 2:r=0,a=1;break;case 3:r=1,a=0}i=r;var s=a;if(e&&t){for(e.Ef=oi(e.x,e.y,null,pi(e)),t.Ef=oi(t.x,t.y,null,pi(t)),a=e;a.next;a=a.next)if(!a.$a)for(r=t;r.next;r=r.next)if(!r.$a){var l=qi(a.next),u=qi(r.next);if(n=ri(a,l,r,u,o)){n=o.Fl;var c=o.Gl,h=o.To,p=o.Uo;si(n=oi(h,p,null,null,null,null,!0,0,0,n),a,l),si(l=oi(h,p,null,null,null,null,!0,0,0,c),r,u),n.Zh=l,l.Zh=n}}for(o=de(e,ti(t)),i&&(o=!o),a=e;a;a=a.next)a.$a&&(a.dh=o,o=!o);for(o=de(t,ti(e)),s&&(o=!o),r=t;r.next;r=r.next)r.$a&&(r.dh=o,o=!o);for(ui(e),ui(t);(t=vi(e))!=e;){for(i=null;!t.Bg;t=t.Zh){for(o=t.dh;(i=oi(t.x,t.y,i)).artificial=t.$a||t.En,t.Bg=1,t=o?t.next:t.Sb;)if(t.$a){t.Bg=1;break}if(!t)break}i.$h=f;var f=i}return f}}function oi(t,e,i,r,n,o,a,s,l,u){return t={x:t,y:e,next:i||null,Sb:r||null,$h:n||null,Zh:o||null,$a:!!a,dh:s||0,Bg:l||0,alpha:u||0},r&&(t.Sb.next=t),i&&(t.next.Sb=t),t}function qi(t){for(;t&&t.$a;)t=t.next;return t}function pi(t){if(t)for(;t.next;)t=t.next;return t}function vi(t){var e=t;if(e)do{e=e.next}while(e!=t&&(!e.$a||e.$a&&e.Bg));return e}function ui(t){var e=pi(t);e.Sb.next=t,t.Sb=e.Sb}function ri(t,e,i,r,n,o){var a,s=e.x-t.x,l=e.y-t.y,u=r.x-i.x,c=r.y-i.y,h=s*c-l*u;return h?(u=((i.x-t.x)*c-(i.y-t.y)*u)/h,h=(l*(i.x-t.x)-s*(i.y-t.y))/h,0>u||1<u||0>h||1<h?0:(0===u?a=t:1===u?a=e:0===h?a=i:1===h&&(a=r),a&&!o?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.Ef&&(a.Ef.x=a.x,a.Ef.y=a.y),ri(t,e,i,r,n)):(n.To=t.x+u*s,n.Uo=t.y+u*l,n.Fl=u,n.Gl=h,1))):0}function ti(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function si(t,e,i){for(e=e.next;e!==i&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.Sb=e.Sb,t.next.Sb=t,t.Sb.next=t}function ni(t,e){for(var i,r=null,n=0,o=t.length;n<o;n++)(i=oi(t[n].x,t[n].y,r)).En=e,(i.next=r)&&(r.Sb=i),r=i;return r}function O(t,e){var i;if(O.l.constructor.call(this),C(t,L,O,0),e!==B&&zc(e,O,1)){for(i=0;i<e.length;i++)C(e[i],L,O,1,"index "+i);this.Pa=e}else this.Pa=[];this.eb=t,this.a=[]}function wi(t){var e=O,i=L,r=t.ka,n=t.aa,o=t.ma,a=t.ga;return n=[r,n,B,r,a,B,o,a,B,o,n,B],180<=t.Db()&&(n.splice(9,0,o,t=t.fb().lng,B),n.splice(3,0,r,t,B)),new e(new i(n))}bi.normalize=ki,bi.prototype.Gd=function(t){bi.l.Gd.call(this,t),ji(this)&&(this.N(Zh.READY),hi(this))},bi.prototype.sd=function(){return bi.l.sd.call(this)},bi.prototype.bc=function(){return this.j||bi.l.bc.call(this)},t("H.map.Style",bi),bi.State=Zh,t("H.math.clipping.clipStrips",zh),t("H.math.clipping.clipPolygon",mi),u(O,Wf),t("H.geo.Polygon",O),O.fromRect=wi;var xi={NORTH:90,SOUTH:-90};function yi(t,e){var i,r,n;return(n=t.I())&&((i=t.kh(!0))&&(r=t.Pe())&&(n=n.hc(fg([t.Ge(0),t.Ge(r-1)],!0),!0)),360===n.Db()&&1==i%2&&(n=n.cd(e,0))),n}function zi(t,e,i,r){r=void 0===r||r;var n=t.Pa,o=Ai.bind(null,e,i);return!(ce(e,i,t.eb.Y,0,!0,3)===be.NONE||r&&n.some(o))}function Ai(t,e,i){return ce(t,e,i.Y,0,!0,3)===be.SURFACE}function Bi(t,e){e=e.Y,t=t.eb.Y;var i,r,n=e.length-3,o=t.length-3,a={};for(i=0;i<n;i+=3){var s=e[i],l=e[i+1],u=e[i+3],c=e[i+4];for(r=0;r<o;r+=3){var h=t[r],p=t[r+1],f=t[r+3];if(ri({x:l,y:s},{x:c,y:u},{x:p,y:h},{x:t[r+4],y:f},a,!0))return!0}}return!1}function Di(t,e){var i=e.eb,r=e.Pa,n=r.length,o=i.Y,a=o.length,s=t.eb.Y,l=s.length;if(Bi(t,i))return!0;for(i=0;i<a;i+=3)if(zi(t,o[i],o[i+1]))return!0;for(i=0;i<l;i+=3)if(zi(e,s[i],s[i+1]))return!0;for(i=0;i<n;i++)if(Bi(t,r[i]))return!0;return!1}function Ei(t){Ei.l.constructor.call(this,t)}function Ah(t,e,i){this.paths=this.a=t,e!==B&&(this.interiorsIndex=this.b=e),i!==B&&(this.outlinesIndex=this.c=i)}O.Direction=xi,O.prototype.yd=xi.NORTH,O.prototype.dl=function(t){return this.yd!==t&&(this.O=y,this.a.length=0,this.yd=t),this},O.prototype.setPoleCovering=O.prototype.dl,O.prototype.Xm=function(){return this.yd},O.prototype.getPoleCovering=O.prototype.Xm,O.prototype.tm=function(){return this.eb},O.prototype.getExterior=O.prototype.tm,O.prototype.al=function(t){if(!C(t,L))throw new D(this.al,0,t);this.eb=t,this.O=y},O.prototype.setExterior=O.prototype.al,O.prototype.Em=function(){return this.Pa},O.prototype.getInteriors=O.prototype.Em,O.prototype.Ag=function(t,e,i){var r,n=arguments.length;for(r=2;r<n;r++)C(arguments[r],L,this.Ag,r);var o=this.Pa.splice.apply(this.Pa,arguments);for(r=2;r<n;r++)arguments[r]=B;return this.a.splice.apply(this.a,arguments),o},O.prototype.spliceInteriors=O.prototype.Ag,O.prototype.wo=function(t){return this.Ag(t,1)[0]},O.prototype.removeInteriorAt=O.prototype.wo,O.prototype.vo=function(t){return 0>(t=this.Pa.indexOf(t))?B:this.Ag(t,1)[0]},O.prototype.removeInterior=O.prototype.vo,O.prototype.Kk=function(t){if(!C(t,L))throw new D(this.Kk,0,t);this.Pa.push(t)},O.prototype.pushInterior=O.prototype.Kk,O.prototype.I=function(){var t=this.O;return t||(this.O=t=yi(this.eb,this.yd)),t},O.prototype.getBoundingBox=O.prototype.I,n=O.prototype,n.yj=function(t){var e=this.Pa.length;if(0>t||t>=e)throw new ke(this.yj,t,[0,e-1]);return(e=this.a[t])||(this.a[t]=e=yi(this.Pa[t],this.yd)),e},n.eb=y,n.Pa=[],n.qb="Polygon",n.Mc=function(t){var e,i=this.Pa,r=i.length;if(this.eb.Pe()){for(t.push("("),this.eb.Mc(t,!0),e=0;e<r;e++)i[e].Pe()&&(t.push(","),i[e].Mc(t,!0));t.push(")")}else t.push("EMPTY");return t},n.Kb="Polygon",n.hd=function(){var t,e=[],i=this.Pa,r=this.eb.hd();for(r[0].toString()!==r[r.length-1].toString()&&r.push(r[0]),e.push(r),t=0;t<i.length;t++)(r=i[t].hd())[0].toString()!==r[r.length-1].toString()&&r.push(r[0]),e.push(r);return e},n.X=function(){var t=O.l.X.call(this);return this.I().Eb()&&(t.type="Multi"+t.type),t},n.sc=function(){var t=[],e=this.Pa,i=e.length;for(t.push(this.eb.sc());i--;)t[i+1]=e[i].sc();return this.I().Eb()?[t]:t},n.na=function(t){var e=!1;if(C(t,O)){var i=t.Pa,r=this.Pa.length;e=i.length;var n=0;for(e=this.eb.na(t.eb)&&r===e;e&&n<r;)e=e&&this.Pa[n].na(i[n]),n++}return e},u(Ei,th),t("H.geo.MultiPolygon",Ei),Ei.prototype.a=function(t){return C(t,O)},Ei.prototype.qb="Multi"+O.prototype.qb,Ei.prototype.Kb="Multi"+O.prototype.Kb,Ah.prototype.b=Ud,Ah.prototype.interiorsIndex=Ah.prototype.b,Ah.prototype.c=Ud,Ah.prototype.outlinesIndex=Ah.prototype.c;var mh=qc(new Ah([])),Fi=pc([]);function Gi(t,e){var i=e&&(+e.extrusion||+e.extrude),r=e&&+e.elevation,n=0;if(Gi.l.constructor.call(this,!0,e),0<r&&(n+=r,this.c=r),0<i&&(n+=i,this.i=i),n>Hi)throw new ke(Gi,n,[0,Hi]);C(t,L)?this.ba(new O(t)):this.ba(t)}u(Gi,nh),t("H.map.Polygon",Gi),Gi.prototype.i=0,Gi.prototype.c=0,Gi.prototype.a=y;var Hi=2047;function Ii(t,e,i,r){var n,o,a=0,s=!0;if(n=Ji(t,e.eb,i,r,e.I())){var l=new Ah(n),u=e.Pa;if(o=u.length)for(l.b=l.a.length;a<o;a++)(n=Ji(t,u[a],i,r,e.yj(a)))&&(l.a=l.a.concat(n));for(o=l.a.length,a=0;a<o;a++)if(l.a[a]!==Fi){s=!1;break}s&&(l=a%2?mh:B)}return l}function Ji(t,e,i,r,n){var o,a=i.Re(),s=n,l=s.Db(),u=[[]],c=e.Y,h=[],p=c.length,f=!1;for(o=0;o<p;o+=3){var d=c[o],y=c[o+1];f||180!=Bd(y)||(h.push(d),h.push(y),h.push(d),h.push(-y),f=!0),h.push(d),h.push(y)}if(c=h,360>l&&-180==s.aa&&(s=new K(s.ka,180,s.ma,s.ga)),360>l&&180==s.ga&&(s=new K(s.ka,s.aa,s.ma,-180)),s.Eb()){for(d=(l=c).length,c=-1,h=0;h<d-2;h+=2)if(Vf(l[h+1],l[h+3])){c=h+2;break}-1===c&&Vf(l[d-1],l[1])&&(c=d),-1!==c&&(p=l[c-2],h=l[c-1],o=l[c%d],f=l[(c+1)%d],180!==Bd(p)&&180!==Bd(o)&&(y=Bd(o-p),d=Bd(f-h),d+=180<d?-360:0,f=Bd(180-f),f+=180<f?-360:0,d&&f&&(y/=Bd(d)/Bd(f),p=o+(o>p?-y:y),h=0<h?180:-180,l.splice(c,0,p,h,p,-h)))),c=l}if(u[0]=Ki([].concat(c),s.aa),360>s.Db()&&s.md(new Yf(s.ka,180))&&(c=Ki([].concat(c),s.ga),u.push(c)),t=oh(t,u,!0,s=i.Rf()),360===n.Db()&&1==e.kh(!0)%2){for(e=t,t=i.Re(),e[0][1].x>e[0][e[0].length-1].x&&(e[0]=e[0].reverse()),c=[],l=e[0].length-1,u=0;u<l;u++)h=e[0][u],c[u]=new I(h.x-2*s.w,h.y),c[u+l]=new I(h.x-s.w,h.y),c[u+2*l]=new I(h.x,h.y),c[u+3*l]=new I(h.x+s.w,h.y),c[u+4*l]=new I(h.x+2*s.w,h.y);e[0]=c,(u=s.Eh(r,0)).y=2*t[r===xi.NORTH?"top":"bottom"],r=u.clone(),u.x=e[0][e[0].length-1].x+1,r.x=e[0][0].x-1,e[0].push(u,r),t=e}if(zh(t,r=a.left,e=a.top,u=a.right,a=a.bottom,!0).length){if(!i.Pf().Vg(n)){for(i=t,n=[new I(r,e),new I(u,e),new I(u,a),new I(r,a)],a=[],t=i.length;t--;)if(r=mi(n,i[t]))for(e=Li(r),a.push(e);r.$h;)e=Li(r=r.$h),a.push(e);t=a}}else i=Mi(r,e,t[0]),t[1]&&(i^=Mi(r,e,t[1])),t=i?[Fi]:B;return t}function Mi(t,e,i){var r,n,o,a=r=i[0].x,s=n=i[0].y,l=1;for(o=i.length;l<o;l++){var u=i[l].x,c=i[l].y;u>r?r=u:u<a&&(a=u),c>n?n=c:c<s&&(s=c)}return a<=t&&t<=r&&s<=e&&e<=n&&de({x:t,y:e},ee(i.concat(i[0])))}function Li(t){var e=[],i=t;do{var r=yd(100*(i.oo?i.oo:i.x))/100,n=yd(100*(i.po?i.po:i.y))/100;if(!o||.01<Dd(Ed(o.x-r,2)+Ed(o.y-n,2))){var o=new I(r,n);e.push(o)}i=i.next}while(i&&i!==t);return e}function Ki(t,e){var i,r=Number.POSITIVE_INFINITY,n=-1,o=t.length;for(i=0;i<o;i+=2){var a=Bd(t[i+1]-e);(a+=180<a?360-a:a)<r&&(r=a,n=i)}return 0<i?(e=t.splice(n,t.length-n)).concat(t):t}function Ni(t,e,i){Ni.l.constructor.call(this,sh,i),this.vg(t),this.Di(e),i&&"precision"in i&&this.Ci(i.precision)}function Oi(t){t.a!==y&&Ni.l.ba.call(t,Pi(t))}function Pi(t){var e=t.b,i=e.lat,r=t.ra,n=0,o=new L;if(90===Bd(i))for(i=e.Cg(0,r,!0).lat;360>n;n+=120)o.mi(i,n-180,B);else for(t=360/(t=t.T);360>n;n+=t)o.Bd(e.Cg(n,r,!0));return e=new O(o),0>i&&e.dl(xi.SOUTH),e}function Qi(t,e){if(!C(t,Element)){if(Ri.innerHTML=t,!(t=Ri.firstElementChild))throw new D(Qi,0,"No element data");Ri.removeChild(t);var i=!0;Ri.innerHTML=""}this.a=0!==jf(t).length,this.c=i?t:kf(t,x.document,this.a),e&&((i="onAttach")in e&&xc(t=e[i],"Function",Qi,1,i)&&(this.ai=t),(i="onDetach")in e&&xc(t=e[i],"Function",Qi,1,i)&&(this.b=t))}Gi.MAX_EXTRUDE_HEIGHT=Hi,Gi.prototype.ui=function(t){var e=+t;if(e!==t)throw new D(this.ui,0,t);if(0>e||this.c+e>Hi)throw new ke(this.ui,this.c+e,[0,Hi]);this.i=e,this.xa(Vg.SPATIAL)},Gi.prototype.setExtrusion=Gi.prototype.ui,Gi.prototype.um=function(){return this.i},Gi.prototype.getExtrusion=Gi.prototype.um,Gi.prototype.ti=function(t){var e=+t;if(e!==t)throw new D(this.ti,0,t);if(0>e||this.i+e>Hi)throw new ke(this.ti,this.i+e,[0,Hi]);this.c=e,this.xa(Vg.SPATIAL)},Gi.prototype.setElevation=Gi.prototype.ti,Gi.prototype.rm=function(){return this.c},Gi.prototype.getElevation=Gi.prototype.rm,Gi.prototype.da=function(){return this.a},Gi.prototype.getGeometry=Gi.prototype.da,Gi.prototype.ba=function(t){if(t===y||C(t,O))var e=!1;else C(t,Ei,this.ba,0),e=!0;return this.f=e,e=this.a,this.a=t,e!==y&&this.xa(Vg.SPATIAL),this},Gi.prototype.setGeometry=Gi.prototype.ba,Gi.prototype.I=function(){return this.da().I()},Gi.prototype.getBoundingBox=Gi.prototype.I,Gi.prototype.Td=function(t){var e,i,r,n=this.da();if(this.f){var o=0;for(r=(n=n.oa).length;o<r;o++)(i=Ii(this,n[o],t,n[o].yd))&&(e||(e=[]),e.push(i))}else(i=this.Ea)===B&&(i=this.f?xi.NORTH:this.da().yd),(i=Ii(this,n,t,i))&&(e=[i]);return e},Gi.prototype.getGeometriesForTile=Gi.prototype.Td,Gi.prototype.ha=y,Gi.prototype.X=function(){var t,e=Gi.l.X.call(this),i=this.da(),r=this.f?i.oa:[i],n=e.properties,o=e.geometry=i.X();if(n.style=this.va().X(),n.height=this.i+this.c,n.min_height=this.c,this.I().Eb()&&(o.type="MultiPolygon",this.f)){var a=[];r.forEach((function(e,i){t=o.coordinates[i],e.I().Eb()?a=a.concat(t):a.push(t)})),o.coordinates=a}return e},Gi.prototype.forWorkerMessage=Gi.prototype.X,u(Ni,Gi),t("H.map.Circle",Ni),Ni.prototype.vg=function(t){(t=$f(t)).na(this.b)||(this.b=t,Oi(this))},Ni.prototype.setCenter=Ni.prototype.vg,Ni.prototype.fb=function(){return this.b},Ni.prototype.getCenter=Ni.prototype.fb,Ni.prototype.Di=function(t){if(E(t=Zd(t,0,6371000.79*Nd/2)))throw new D(this.Di,0,t);this.ra!==t&&(this.ra=t,Oi(this))},Ni.prototype.setRadius=Ni.prototype.Di,Ni.prototype.bn=function(){return this.ra},Ni.prototype.getRadius=Ni.prototype.bn,Ni.prototype.T=60,Ni.prototype.Ci=function(t){if(!Dc(t))throw new D(this.Ci,0,t);this.T!==(t=Zd(yd(t),4,360))&&(this.T=t,Oi(this))},Ni.prototype.setPrecision=Ni.prototype.Ci,Ni.prototype.Zm=function(){return this.T},Ni.prototype.getPrecision=Ni.prototype.Zm,Ni.prototype.ba=function(){return this},Ni.prototype.setGeometry=Ni.prototype.ba,Ni.prototype.da=function(){return this.a||Ni.l.ba.call(this,Pi(this)),this.a},Ni.prototype.getGeometry=Ni.prototype.da,t("H.map.DomIcon",Qi);var Ri=document.createElement("DIV");function Si(t){Si.l.constructor.call(this,t)}function Ti(t,e){this.w=+t,this.h=+e}function Ui(t,e){var i,r=t,n=e||[];if(t!==Vi.NONE){if(e=i=n.length,-1===this.b.indexOf(r))throw new D(Ui,0,t);if(!n)throw new D(Ui,1,n);for(;i--;)if(E(n[i]))throw new D(Ui,1,n);if(r===Vi.RECT&&3<e&&(n=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]],r=Vi.POLYGON),r===Vi.CIRCLE&&2<e&&0<(t=n[2])){r=n[0];var o=n[1],a=360/(i=wd(2*Ad(t),40));for(n=[];i--;){var s=a*i*Sd;n.push(r+Gd(s)*t,o+Id(s)*t)}r=Vi.POLYGON}if(r!==Vi.POLYGON||!e||n.length%2)throw new D(Ui,1,n);this.a=n}}Qi.prototype.ai=null,Qi.prototype.b=null,Qi.prototype.zj=function(t){return kf(this.c,t,this.a)},Qi.prototype.a=!1,u(Si,th),t("H.geo.MultiPoint",Si),Si.prototype.a=function(t){return Zf(t)},Si.prototype.b=function(t){return C(t,Yf)?t:$f(t)},Si.prototype.qb="Multi"+Yf.prototype.qb,Si.prototype.Kb="Multi"+Yf.prototype.Kb,t("H.math.Size",Ti),t("H.map.HitArea",Ui);var Vi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};function Wi(t,e){var i;vc(this,Wi),Wi.l.constructor.call(this,e),this.ba(t),e&&"icon"in e&&(i=e.icon),this.Jc(i||Xi(this))}function Xi(t){var e=t.c;return e||(e=t.constructor.prototype.c=t.b(Yi)),e}Ui.ShapeType=Vi,Ui.prototype.b=[Vi.RECT,Vi.CIRCLE,Vi.POLYGON],Ui.prototype.Vf=function(t,e,i){return this.a?ce(t,e,this.a,i,!0):be.NONE},Ui.prototype.hitTest=Ui.prototype.Vf,u(Wi,M),t("H.map.AbstractMarker",Wi),Wi.prototype.da=function(){return this.a},Wi.prototype.getGeometry=Wi.prototype.da,Wi.prototype.ba=function(t){var e=this.a;return C(t,Yf)||C(t,Si)?this.a=t:(Zf(t,this.ba,0),this.a=$f(t)),e&&this.xa(Vg.SPATIAL),this},Wi.prototype.setGeometry=Wi.prototype.ba,Wi.prototype.I=function(){return this.a.I()},Wi.prototype.Ab=function(){return this.icon},Wi.prototype.getIcon=Wi.prototype.Ab,Wi.prototype.Jc=function(t){var e=this.icon,i=!e;if(e!==t){if(!this.ak(t)){if(i)throw new D(this.constructor,1,t);throw new D(this.Jc,0,t)}this.icon=t,i||this.xa(Vg.VISUAL)}return this},Wi.prototype.setIcon=Wi.prototype.Jc;var Yi={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Ti(38,47),anchor:new I(19,45),hitArea:new Ui(Vi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};function Zi(t,e){Zi.l.constructor.call(this,t,e)}function $i(t,e,i,r){$i.l.constructor.call(this,t,e,i),this.modifiers=r}Wi.prototype.X=function(){var t=Wi.l.X.call(this),e=this.Ab(),i=e.Bb(),r=e.rd();return t.geometry=this.da().X(),i&&((e=t.properties.icon={id:e.uid}).size={w:i.w,h:i.h},e.offset=[i.w/2-(r?r.x:0),i.h/2-(r?r.y:0)]),t},Wi.prototype.forWorkerMessage=Wi.prototype.X,u(Zi,Wi),t("H.map.DomMarker",Zi),Zi.prototype.type=Yg.DOM_MARKER,Zi.prototype.Dg=2,Zi.prototype.b=function(t){var e=new Qi(t.svg,t);return t=t.anchor,e.c.style.margin=-t.y+"px 0 0 -"+t.x+"px",e},Zi.prototype.ak=function(t){return C(t,Qi)},u($i,Wg),t("H.map.ChangeEvent",$i);var aj={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};function bj(){this.a=[],bj.l.constructor.call(this)}function cj(t,e,i){if(t=t.a.length,i)var r=t;else if(E(r=0>(r=+e)?xd(0,t+r):wd(t,r)))throw new ke(bj,e,[0,t-1]);return r}function ej(t,e){var i=t.a.splice(e,1)[0];return t.dispatchEvent(new dj(t,t.v.ve,e,null,i,null)),i}function dj(t,e,i,r,n,o){dj.l.constructor.call(this,e,t),this.idx=i,this.added=r,this.removed=n,this.moved=o}$i.Type=aj,$i.prototype.Al=aj.SIZE,$i.prototype.SIZE=$i.prototype.Al,$i.prototype.Zi=aj.POSITION,$i.prototype.POSITION=$i.prototype.Zi,$i.prototype.Ti=aj.HEADING,$i.prototype.HEADING=$i.prototype.Ti,$i.prototype.aj=aj.TILT,$i.prototype.TILT=$i.prototype.aj,$i.prototype.Ui=aj.INCLINE,$i.prototype.INCLINE=$i.prototype.Ui,$i.prototype.bj=aj.ZOOM,$i.prototype.ZOOM=$i.prototype.bj,$i.prototype.Ri=aj.BOUNDS,$i.prototype.BOUNDS=$i.prototype.Ri,u(bj,F),t("H.util.OList",bj),bj.prototype.add=function(t,e){e=cj(this,e,E(e)),this.a.splice(e,0,t),this.dispatchEvent(new dj(this,this.v.te,e,t,null,null))},bj.prototype.add=bj.prototype.add,bj.prototype.jc=function(t){return this.get(t),ej(this,t)},bj.prototype.removeAt=bj.prototype.jc,bj.prototype.remove=function(t){return 0<=(t=this.indexOf(t))&&(ej(this,t),!0)},bj.prototype.remove=bj.prototype.remove,bj.prototype.set=function(t,e){if(0!==this.a.length||0!==t){this.get(t),t=cj(this,t,!1);var i=this.a[t]}return this.a[t]=e,this.dispatchEvent(new dj(this,this.v.we,t,e,i,null)),i},bj.prototype.set=bj.prototype.set,bj.prototype.indexOf=function(t){return this.a.indexOf(t)},bj.prototype.indexOf=bj.prototype.indexOf,bj.prototype.get=function(t){var e=cj(this,t,!1),i=this.a;if(e>=i.length)throw new ke(this.get,t,[0,i.length-1]);return i[e]},bj.prototype.get=bj.prototype.get,bj.prototype.Lm=function(){return this.a.length},bj.prototype.getLength=bj.prototype.Lm,bj.prototype.Na=function(){return[].concat(this.a)},bj.prototype.asArray=bj.prototype.Na,bj.prototype.flush=function(){for(var t=this.a.length;t--;)ej(this,t)},bj.prototype.flush=bj.prototype.flush,bj.prototype.s=function(){this.flush(),bj.l.s.call(this)},bj.prototype.v={te:"add",ve:"remove",we:"set",Yo:"move"},u(dj,sd);var fj={};function gj(t,e){this.projection=t||fj,this.b=0,this.a=this.exp=Cd(e||256)/Md,hj(this),this.y=this.x=0}t("H.geo.mercator",fj),fj.a=function(t){return wd(1,xd(0,.5-Cd(Jd(Pd+Od*t/180))/Nd/2))},fj.b=function(t){return t/360+.5},fj.Zf=function(t,e,i){return i?(i.x=fj.b(e),i.y=fj.a(t)):i=new I(fj.b(e),fj.a(t)),i},fj.latLngToPoint=fj.Zf,fj.Vc=function(t,e){return fj.Zf(t.lat,t.lng,e)},fj.geoToPoint=fj.Vc,fj.f=function(t){return 0>=t?90:1<=t?-90:Td*(2*Kd(Fd(Nd*(1-2*t)))-Od)},fj.c=function(t){return 360*(1===t?1:Xd(t,1))-180},fj.Ra=function(t,e,i){return i?(i.lat=fj.f(e),i.lng=fj.c(t)):i=new Yf(fj.f(e),fj.c(t)),i},fj.xyToGeo=fj.Ra,fj.ig=function(t,e){return fj.Ra(t.x,t.y,e)},fj.pointToGeo=fj.ig,t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22),t("H.geo.PixelProjection",gj);var ij=Bd(24)+Bd(-8);function hj(t){t.a>ij&&(t.a=ij),t.w=Ed(2,t.a),t.h=Ed(2,t.a)}function jj(t){t=t||{},jj.l.constructor.call(this),this.min=0,this.max=22,this.Ol=this.dark=!!t.dark,t.min&&this.yi(t.min),t.max&&this.wi(t.max),this.pixelProjection=new gj(t.projection,t.minWorldSize),t.provider&&(this.pa=t.provider,this.Xa=A(this.Xa,this),this.pa.addEventListener(P.prototype.v.Ca,this.Xa,!1,this),this.cb=A(this.cb,this),this.pa.addEventListener(P.prototype.v.ue,this.cb,!1,this))}function kj(t,e,i){var r=t[e],n="min"===e,o=n?t.yi:t.wi;if(i!==r){if(!(n?i<=t.max:i>=t.min))throw new D(o,0,"Invalid condition min <= max");t[e]=i,t.Xa(),t.cb(),t.dispatchEvent(new Wg(n?t.v.Yi:t.v.Xi,i,r))}return t}function lj(t){var e;if(lj.l.constructor.call(this),this.dispatchEvent=A(this.dispatchEvent,this),t){var i=t.length;for(e=0;e<i;e++)this.add(t[e])}}function mj(t,e){var i=e.getProvider&&e.getProvider();i&&(nj[i.uid]=i),e.ja(t)}function oj(t){var e=t.getProvider&&t.getProvider();e&&delete nj[e.uid],t.ja(null)}gj.prototype.Ik=fj,gj.prototype.projection=gj.prototype.Ik,gj.prototype.x=0,gj.prototype.x=gj.prototype.x,gj.prototype.y=0,gj.prototype.y=gj.prototype.y,gj.prototype.Ro=Ed(2,ij),gj.prototype.w=gj.prototype.Ro,gj.prototype.xn=Ed(2,ij),gj.prototype.h=gj.prototype.xn,gj.prototype.Qa=function(t){if(E(t))throw new D(this.Qa,0,t);var e=this.x/this.w,i=this.y/this.h;this.b=t,this.a=this.exp+t,hj(this),this.x=e*this.w,this.y=i*this.h},gj.prototype.rescale=gj.prototype.Qa,gj.prototype.Qj=function(){return this.b||0},gj.prototype.getZoomScale=gj.prototype.Qj,gj.prototype.kb=function(t,e){return(t=this.projection.Zf(t.lat,t.lng,e)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},gj.prototype.geoToPixel=gj.prototype.kb,gj.prototype.Xe=function(t,e){return this.projection.Ra((t.x+this.x)/this.w,(t.y+this.y)/this.h,e)},gj.prototype.pixelToGeo=gj.prototype.Xe,gj.prototype.Ra=function(t,e,i){return this.projection.Ra((t+this.x)/this.w,(e+this.y)/this.h,i)},gj.prototype.xyToGeo=gj.prototype.Ra,gj.prototype.Eh=function(t,e,i){return(t=this.projection.Zf(t,e,i)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},gj.prototype.latLngToPixel=gj.prototype.Eh,gj.prototype.ie=function(t){return new I(t.x*this.w-this.x,t.y*this.h-this.y)},gj.prototype.pointToPixel=gj.prototype.ie,u(jj,F),t("H.map.layer.Layer",jj),jj.prototype.min=0,jj.prototype.min=jj.prototype.min,jj.prototype.max=22,jj.prototype.max=jj.prototype.max,jj.prototype.sa=y,jj.prototype.pixelProjection=jj.prototype.sa,jj.prototype.v={Ca:"update",ue:"configchange",Yi:"minchange",Xi:"maxchange"},jj.prototype.ea=function(){return this.pa},jj.prototype.getProvider=jj.prototype.ea,jj.prototype.Hn=function(t){return this.min<=t&&t<=this.max},jj.prototype.isValid=jj.prototype.Hn,jj.prototype.yi=function(t){return kj(this,"min",+t)},jj.prototype.setMin=jj.prototype.yi,jj.prototype.wi=function(t){return kj(this,"max",+t)},jj.prototype.setMax=jj.prototype.wi,jj.prototype.Xa=function(){this.dispatchEvent(this.v.Ca)},jj.prototype.cb=function(){this.dispatchEvent(this.v.ue)},jj.prototype.s=function(){jj.l.s.call(this)},jj.prototype.ua=function(){return null},jj.prototype.getCopyrights=jj.prototype.ua,u(lj,bj),t("H.map.DataModel",lj),lj.prototype.add=function(t,e){C(t,jj,this.add,0),mj(this,t),lj.l.add.call(this,t,e)},lj.prototype.add=lj.prototype.add,lj.prototype.set=function(t,e){return C(e,jj,this.set,0),mj(this,e),(t=lj.l.set.call(this,t,e))&&oj(t),t},lj.prototype.set=lj.prototype.set,lj.prototype.jc=function(t){var e;return(e=lj.l.jc.call(this,t))&&oj(e),e},lj.prototype.removeAt=lj.prototype.jc,lj.prototype.remove=function(t){var e;return(e=lj.l.remove.call(this,t))&&oj(t),e},lj.prototype.remove=lj.prototype.remove,lj.prototype.flush=function(){for(var t=this.a.length;t--;)this.jc(t);lj.l.flush.call(this)},lj.prototype.flush=lj.prototype.flush;var nj={};function pj(t,e,i){if(t=nj[t])return C(t[e],Function,pj,1,"invalid method"),t[e].apply(t,i)}function qj(t,e){Da(t)&&(this.j=t),Dc(e)&&(this.b=e)}Gc(nj),lj.invoke=pj,t("H.util.Request",qj),qj.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var rj=[0,1,2,3,4],zj;function sj(t,e){t.c<t.b&&(uc(e)||(e=2),0===e||1===e||0!==t.a&&1!==t.a||(t.c++,2!==e&&t.i++,t.N(t.c<t.b?1:2)))}function tj(){}function uj(t,e){var i=t.K(),r=i.ownerDocument;uj.l.constructor.call(this),this.a=t,this.S=i=i.appendChild(vj(r,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.xf=vj(r,"DIV","margin: 0 0 "+wj+"px "+wj+"px;display:inline-block;",xj,"H_logo"),i.appendChild(this.xf),i=i.appendChild(vj(r,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.g=i.appendChild(vj(r,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.g.target="_blank",this.f=i.appendChild(vj(r,"SPAN","margin:0px 8px")),this.j=Va(yj),this.zi(e),this.c=A(this.c,this),this.b=A(this.b,this),this.a.addEventListener(this.a.v.Wi,this.c),this.a.a.addEventListener("add",this.b),this.a.a.addEventListener("remove",this.b),this.a.a.addEventListener("set",this.b),this.b()}qj.prototype.a=0,qj.prototype.getState=function(){return this.a},qj.prototype.getState=qj.prototype.getState,qj.prototype.N=function(t){if(0>rj.indexOf(t))throw new D(this.N,0,t);(this.a!==t||1===t&&1<this.b)&&(this.a=t,this.j&&this.j(this))},qj.prototype.b=1,qj.prototype.pn=function(){return this.b},qj.prototype.getTotal=qj.prototype.pn,qj.prototype.c=0,qj.prototype.$m=function(){return this.c},qj.prototype.getProcessed=qj.prototype.$m,qj.prototype.i=0,qj.prototype.vm=function(){return this.i},qj.prototype.getFailed=qj.prototype.vm,qj.prototype.ze=function(){},qj.prototype.cancel=function(){3!==this.a&&(this.ze(),this.N(3))},qj.prototype.cancel=qj.prototype.cancel,t("H.util.ICapturable",tj),tj.prototype.capture=function(){},tj.prototype.capture=tj.prototype.capture,t("H.util.Disposable",nd),nd.prototype.xb=nd.prototype.xb,nd.prototype.addOnDisposeCallback=nd.prototype.xb,t("H.util.dispose",rd),nd.prototype.B=nd.prototype.B,nd.prototype.dispose=nd.prototype.B,nd.prototype.s=nd.prototype.s,u(uj,nd),t("H.map.Imprint",uj);var wj=16,yj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US"};function vj(t,e,i,r,n){return t=t.createElement(e),i&&(t.style.cssText=i),r&&(t.innerHTML=r),n&&(t.className=n),t}uj.prototype.zi=function(t){var e,i=this.xf.firstChild.firstChild.childNodes;t||(this.j=Va(yj));var r=this.j;for(e in r)t&&e in t&&(r[e]=t[e]);t=(this.Ah=t=r.invert)?Aj:Bj,i[0].style.fill=t.hl,i[0].style.fillOpacity=t.il,i[1].style.fill=t.ml,i[1].style.fillOpacity=t.nl,t=r.locale,Cj[t]||(t="en-US",r.locale=t),this.g.innerHTML=Cj[t],t=t.split("-"),this.g.href=r.href.replace("{LN}",t[0]).replace("{CN}",t[1].toLowerCase()),this.S.style.font=r.font},uj.prototype.setOptions=uj.prototype.zi,uj.prototype.K=function(){return this.S},uj.prototype.c=function(){this.f.innerHTML=this.i+" "+this.ua()},uj.prototype.b=function(){this.c(),setTimeout(this.c,5e3)};var xj='<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',Bj={ml:"#0F1621",nl:.3,hl:"#fff",il:.6},Aj={ml:"#fff",nl:1,hl:"#0F1621",il:.7},Dj="1987&ndash;"+xd(2015,(new Date).getFullYear())+" HERE";function Ej(t,e,i,r){Fj(A((function(t){t?this.Ah?i("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):i("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):((t=this.xf.cloneNode(!0)).firstChild.setAttribute("style","font:"+e),i(af(t.innerHTML)))}),t),r)}function Fj(t,e){var i="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(xj),r=zj;uc(r)?t(r):new sf("image",i).then((function(e){Xe.drawImage(e,0,0);try{Xe.getImageData(0,0,1,1),r=!1}catch(t){r=18===t.code}finally{zj=r,t(r)}}),e)}uj.prototype.ua=function(){var t,e,i,r=this.a,n=r.ub(),o=r.c.lb().bounds,a=(r=r.a).a.length,s={},l=0,u=[Dj];if(o)for(;l<a;l++)if(e=r.get(l).getCopyrights(o.I(),n))for(t=0;t<e.length;t++)s[i=e[t].label]||(u.push(i),s[i]=1);return u.join(", ")},uj.prototype.getCopyrights=uj.prototype.ua,uj.prototype.va=function(){return this.S.style},uj.prototype.i=String.fromCharCode(169),uj.prototype.s=function(){if(this.a.removeEventListener(this.a.v.Wi,this.c),this.a.a.removeEventListener("add",this.b),this.a.a.removeEventListener("remove",this.b),this.a.a.removeEventListener("set",this.b),this.S.parentNode){var t=this.S;t.parentNode.removeChild(t)}},uj.prototype.capture=function(t,e,i,r){var n,o=t.getContext("2d"),a=window.getComputedStyle(this.f.parentElement),s=2*Bc(a.paddingLeft,10),l=(this.f.offsetWidth+2*s)*e,u=this.f.offsetHeight*e,c=Cc(a.getPropertyValue("font-size")),h=this.S.ownerDocument,p=+t.width,f=+t.height,d=wj*e,y=this.xf.childNodes[0].getBoundingClientRect(),g=y.width*e,v=y.height*e,m=id;Da(r)&&(m=function(){r("capture_error")}),o.fillStyle=a.backgroundColor,o.fillRect(p-l,f-u,l,u),l=this.i+" "+((n=vj(h,"div",null,n=this.ua())).textContent||n.innerText||""),o.font=c*e+"px "+a.getPropertyValue("font-family"),o.fillStyle=a.getPropertyValue("color"),o.textBaseline="bottom",o.textAlign="right",o.fillText(l,p-s*e,f),Ej(this,o.font,(function(e){new sf("image",e).then((function(e){o.drawImage(e,d,f-(v+d),g,v),i(t)}),m)}),m)},uj.prototype.capture=uj.prototype.capture,uj.prototype.Ah=!1,uj.prototype.Dl=function(t,e){Cj[t]=e},uj.prototype.addL11NString=uj.prototype.Dl;var Cj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki świadczenia usługi","pt-BR":"Termos de serviço","pt-PT":"Termos do serviço","ru-RU":"Условия использования","tr-TR":"Servis Koşulları","zh-CN":"使用条款"};function Q(t){var e={};this.f=e.previousSibling=e.nextSibling=e,this.g=new bf,Q.l.constructor.call(this,t),t&&"objects"in t&&this.$b(t.objects)}function Gj(t,e,i){t.pe(i.pa)}function Hj(t){t.ef()}function Ij(t,e,i){t.xa(i.c)}function Jj(t){this.push(t)}function Kj(t,e){for(var i,r,n=0,o=e.length,a=[];n<o;n++)r={},(i=e[n])instanceof Q?(r.type="GeometryCollection",r.geometries=Kj(t,i.Ua())):r=i.da().Lc(),a.push(r);return a}u(Q,M),t("H.map.Group",Q),Q.prototype.type=Yg.GROUP,Q.prototype.pe=function(t,e){return this.b=!0,t=Q.l.pe.call(this,t,e),this.b=!1,t&&this.forEach(Gj,!0),t},Q.prototype.setProvider=Q.prototype.pe,Q.prototype.contains=function(t){var e=this===t;if(!e&&this.a&&C(t,M))for(;!e&&t;)t===this?e=!0:t=t.Ia;return e},Q.prototype.contains=Q.prototype.contains,Q.prototype.ef=function(){this.L=B,this.forEach(Hj,!0)},Q.prototype.resetZInfo=Q.prototype.ef,Q.prototype.b=!1,Q.prototype.xa=function(t){var e=Q.l.xa.call(this,t);return e&&!this.b&&(this.c=t,this.forEach(Ij,!0),delete this.c),e},Q.prototype.invalidate=Q.prototype.xa,Q.prototype.forEach=function(t,e,i){var r;if(this.a){var n=this.f,o=n.nextSibling;for(r=0;o!==n;){var a=o.nextSibling;t.call(i,o,r++,this),e&&C(o,Q)&&o.forEach(t,e,i),o=a}}},Q.prototype.forEach=Q.prototype.forEach,Q.prototype.Ua=function(t){var e=[];return this.forEach(Jj,t,e),e},Q.prototype.getObjects=Q.prototype.Ua,Q.prototype.I=function(){var t=null;return this.a&&this.forEach((function(e){(e=e.I())&&(t=t?t.hc(e):e)})),t},Q.prototype.getBoundingBox=Q.prototype.I,Q.prototype.a=0,Q.prototype.gm=function(){return this.a},Q.prototype.getChildCount=Q.prototype.gm,Q.prototype.ca=function(t){var e=this.f,i=e.previousSibling;if(C(t,M,this.ca,0),t.contains(this))throw new Yc(this.ca,"The new object contains the parent group");var r=t.Tf(!0),n=t.Ia;if(n!==this){if(n){n=t.previousSibling;var o=t.nextSibling;n.nextSibling=o,o.previousSibling=n}t.Ia=this,M.l.ja.call(t,this),i.nextSibling=t,t.previousSibling=i,t.nextSibling=e,e.previousSibling=t,this.a++}return t.Hi=this.g.next(),t.ef(),e=t.pe(this.pa,this.ca),t.Tf(!0)^r&&t.xa(Vg.VOLATILITY),e||t.xa(Vg.Z_ORDER),t},Q.prototype.addObject=Q.prototype.ca,Q.prototype.$b=function(t){var e;zc(t,this.$b,0);var i=t.length;for(e=0;e<i;e++)this.ca(t[e])},Q.prototype.addObjects=Q.prototype.$b,Q.prototype.Ja=function(t){if(!t||t.Ia!==this)throw new Yc(this.Ja,"object not found");var e=t.previousSibling,i=t.nextSibling;return e.nextSibling=i,i.previousSibling=e,t.Ia=null,M.l.ja.call(t,null),delete t.previousSibling,delete t.nextSibling,C(t.pa,N)&&t.pe(null,this.Ja),this.a--,t},Q.prototype.removeObject=Q.prototype.Ja,Q.prototype.Cd=function(t){var e;zc(t,this.Cd,0);var i=t.length;for(e=0;e<i;e++)this.Ja(t[e])},Q.prototype.removeObjects=Q.prototype.Cd,Q.prototype.qa=function(){var t=this.Ua();this.Cd(t)},Q.prototype.removeAll=Q.prototype.qa,Q.prototype.Lc=function(t){for(var e,i,r,n=this.Ua(),o=0,a=n.length,s=[];o<a;o++)(r=n[o])instanceof Q?(i=ah(this,e=t?t(r.getData()):r.getData(),!!t),(e={type:"Feature"}).properties=i,r.o&&(e.id=r.o),e.geometry={},e.geometry.type="GeometryCollection",e.geometry.geometries=Kj(this,r.Ua()),s.push(e)):s.push(r.Lc(t));return{type:"FeatureCollection",features:s}},Q.prototype.toGeoJSON=Q.prototype.Lc,Q.prototype.X=function(){var t=Q.l.X.call(this);return t.type="Group",t},Q.prototype.forWorkerMessage=Q.prototype.X;var Lj={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};function Mj(t,e,i,r,n){switch(e&&(this.b=e),uc(i)&&(this.Pg=!!i),this.Pg&&r&&(this.Qg=new Ti(r.w,r.h)),uc(n)&&(this.c={crossOrigin:n}),Nj[yc(t)]){case 2:this.zd=t,Oj(this,1);break;case 1:if(mf(t)){this.zd=t,Pj(this),Oj(this,1);break}t=t.src;case 0:if(t){t=af(t),this.a=new sf("image",t,B,this.c),this.a.then(A(this.lo,this),A(this.ko,this));break}default:throw Oj(this,-1),new D(Mj,0,"No image data")}}function Oj(t,e){t.Xh=e,delete t.a,t.b&&t.b(e,t)}function Pj(t){if(t.Pg){var e=t.zd,i=Qj(t),r=i&&i.w||+e.width,n=i&&i.h||+e.height,o=Te();if(C(e,x.HTMLCanvasElement))i=e;else{(i=e.ownerDocument.createElement("canvas")).width=Ad(r*o),i.height=Ad(n*o);var a=i.getContext("2d");a.scale(o,o),a.drawImage(e,0,0,r,n),$c&&(a.clearRect(0,0,r,n),a.drawImage(e,0,0,r,n))}t.zd=i}}t("H.map.provider.Capabilities",Lj),Lj.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Lj.PROVIDES_SPATIALS|Lj.PROVIDES_OVERLAYS|Lj.PROVIDES_MARKERS,n=Mj.prototype,n.Xh=0,n.getState=function(){return this.Xh},n.Pg=!0,n.zd=y,n.getData=function(){return this.zd};var Nj={String:0,HTMLImageElement:1,HTMLCanvasElement:2};function Qj(t){var e,i=t.Qg;if(!i){var r=t.zd;if(0===(i=r.naturalWidth||r.width)&&Ze&&1===Nj[yc(r)]){var n=!0;if(e=r.parentNode)var o=r.nextSibling;document.body.appendChild(r)}t.Qg=i=new Ti(r.naturalWidth||r.width,r.naturalHeight||r.height),n&&(e?e.insertBefore(r,o):document.body.removeChild(r))}return i}function Rj(t,e){var i,r="anonymous";if(this.uid=Sj.next(),Rj.l.constructor.call(this),e){var n="size";if(n in e){var o=e[n];if(!o||isNaN(o.w)||isNaN(o.h))throw new D(Rj,1,n);this.b=new Ti(o.w,o.h)}if((n="anchor")in e){if(!(o=e[n])||isNaN(o.x)||isNaN(o.y))throw new D(Rj,1,n);this.g=new I(o.x,o.y)}(n="hitArea")in e&&(C(o=e[n],Ui,Rj,1),this.f=e[n]),(n="asCanvas")in e&&(i=e[n]),(n="crossOrigin")in e&&(r=e[n]),(o=e.stickHeight)===+o&&0<o&&(this.Io=o),o=e[n="stickColor"],n in e&&Ac(o)&&(this.Ho=o)}t=new Mj(t,A(this.i,this),i,this.b,r),0!==(e=this.j=t.getState())?this.i(e,t):this.c=t}n=Mj.prototype,n.Qg=y,n.Bb=function(){return 1===this.Xh?Qj(this):y},n.lo=function(t){this.zd=t,Pj(this),Oj(this,1)},n.ko=function(){Oj(this,-1)},n.cancel=function(){this.a&&this.a.cancel()},u(Rj,F),t("H.map.Icon",Rj);var Sj=new bf;function Tj(t,e,i,r,n,o){Tj.l.constructor.call(this,isNaN(t)?15:t,e,i,r,n,o)}function Uj(t,e,i,r,n){var o=e.entries;if(n)if(e.a)o=Vj(t,e,i,r,n);else if(o){var a=qg(e,(o=o[0])[1]>=e[8]|(o[0]>=e[9])<<1);a.entries=e.entries,delete e.entries,o.node=a,ng(t,a),o=Vj(t,e,i,r,n)}else rg(e,o=new Wj(i,r)),ng(t,e),lg(t,o,!0);else o||ng(t,e),rg(e,o=new Wj(i,r)),lg(t,o,!0);return o}function Vj(t,e,i,r,n){return Uj(t,qg(e,i>=e[8]|(r>=e[9])<<1),i,r,n-1)}function Wj(t,e){this.id=pg++,this[0]=e,this[1]=t}function Xj(){this.a=new Tj(10,180,90,0,0,!0)}function Yj(t,e,i){this.c=t,this.a=e,this.g=i,this.f=this.c&Lj.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.b={}}function Zj(t,e,i,r){this.a=t,this.b=e,this.c=i,this.sf=r}function ak(t,e,i,r){return t={type:e,uid:t.b,tiled:i,max_zoom:t.c},r&&Xa(t,r),t}function bk(t){this.a=t}function ck(t,e,i,r,n){this.a=t,this.b=e,this.c=i,this.f=r,this.sf=n}function dk(t){if(t.a&Lj.PROVIDES_DOM_MARKERS&&!(t.a&Lj.PROVIDES_MARKERS))return{};var e=new Zj(t.a,t.b,t.c,t.sf),i=new bk(t.a);t=new Yj(t.a,t.b,t.f);var r={},n=e.b;if(e=e.a&Lj.PROVIDES_BY_VIEWPORT?ak(e,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(e.a&Lj.HAS_VOLATILE_DATA)}):e.a&Lj.PROVIDES_RASTERS?ak(e,"RemoteRasterTileSource",!0,{url:""}):ak(e,"ObjectTileSource",!0,{tile_size:e.sf}),r[n]=e,e={},i.a&Lj.PROVIDES_RASTERS&&(e={"translucent-raster":Vh("raster","inlay",1)}),i.a&Lj.PROVIDES_WEBGL_RENDERABLE_OBJECTS){n=!!(i.a&Lj.CROP_LINES_BY_TILE);var o={"translucent-polygons":Vh("polygons","inlay",2),"translucent-extruded-polygons":Vh("polygons","translucent",3),"translucent-pattern-lines":Vh("pattern-lines","translucent",4),"translucent-overlays":Vh("overlays","inlay",5),markers:Vh("custom_icons","overlay",6,!1)};o["translucent-polygons"].crop_by_tile=!!(i.a&Lj.CROP_POLYGONS_BY_TILE),o["translucent-pattern-lines"].crop_by_tile=n,o.markers.suppress_fade=!0,o.markers.stick=!0,Xa(e,o)}if(t.c&Lj.PROVIDES_RASTERS&&(t.b["tile_layer_"+t.a]=Xh(t.a,"_default",{"translucent-raster":{color:[1,1,1,t.g],order:0}})),t.c&Lj.PROVIDES_SPATIALS){i={"translucent-pattern-lines":{color:Uh("strokeColor"),width:Uh("lineWidth * $meters_per_pixel"),join:Uh("lineJoin"),cap:Uh("lineCap"),tail_cap:Uh("lineTailCap"),head_cap:Uh("lineHeadCap"),miter_limit:Uh("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:Uh("lineDash"),extrude:!0,dash_phase:Uh("lineDashOffset")}},n=t.b,o="polygon_layer_"+t.a;var a=Xh(t.a,"polygons",void 0,t.f);a.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:Wh(!1)},a.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:Wh(!0)},n[o]=a,t.b["outline_layer_"+t.a]=Xh(t.a,"outlines",i,t.f),t.b["polyline_layer_"+t.a]=Xh(t.a,"polylines",i,t.f)}return t.c&Lj.PROVIDES_OVERLAYS&&(t.b["overlay_layer_"+t.a]=Xh(t.a,"overlays",{"translucent-overlays":{color:[1,1,1,t.g],order:8190,interactive:!0}})),t.c&Lj.PROVIDES_MARKERS&&(t.b["marker_layer_"+t.a]=Xh(t.a,"markers",{markers:{sprite:Th("icon.id"),offset:Th("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:Th("icon.stick_color"),height:Th("icon.stick_height")}}},t.f)),{sources:r,styles:e,layers:t.b}}function P(t){var e,i=""+df();if(P.l.constructor.call(this),t=t||{},this.min=t.min||0,this.max=t.max||22,e=t.uri){if(/_/.test(e))throw new D(P,0,"uri "+e)}else e=i;if(this.uri=e||i,this.uid=i,t.getCopyrights&&xc(t.getCopyrights,"Function",P)&&(this.getCopyrights=t.getCopyrights),this.cb=this.cb.bind(this),this.ra=!0,this.c=t.engineType||ek.WEBGL,this.c===ek.HARP&&!H.map.render.harp)throw new D(P,0,"HARP engine is not supported, module not found")}function fk(t,e){e=Zd(e,0,1),E(e)&&(e=1),t.f!==e&&(t.f=e,t.ra&&gk(t),t.cb(),t.Xa())}function gk(t){if(t.c===ek.WEBGL){var e=new ck(t.getCapabilities(),t.uid,t.max,t.f,t.tileSize);t.a=new bi(dk(e))}else t.c===ek.HARP&&H.map.render.harp&&(t.a=new H.map.render.harp.Style({}));t.ra=!0}function ik(t){var e;for(e in vc(this,ik),ik.l.constructor.call(this,t),this.la=t=[],Yg)t[Yg[e]]=new Ug}function N(t){t=t||{},N.l.constructor.call(this,t),this.g=t=new Q({min:t.min,max:t.max}),t.pa=this,t.ja(this),t.xa(Vg.ADD),this.u=new xg,this.i=new xg,this.o=new Xj,this.m=new xg,this.A=new Xj,this.P=new xg}function jk(t,e,i,r,n,o,a){if(a=a||[],e.Xc())for(t=e!==t.o&&e!==t.m,n=!n,i=(e=e.Wf(i,o,o)).length,o=0;o<i;o++){var s,l=e[o].Pi;if(s=void 0!==r){for(var u=zd(r),c=l;(s=c.F<=u&&c.u>=u)&&(c=c.Ia););s=!s}s||!n&&!l.xc(!0)||(t||1===l.Ab().getState())&&a.push(l)}return a}function kk(t,e,i,r,n){var o=jk(t,t.o,e,i,r,n);return jk(t,t.m,e,i,r,n,o),o}function lk(t,e,i,r,n){var o=jk(t,t.A,e,i,r,n);return jk(t,t.P,e,i,r,n,o),o}function mk(t,e,i){var r,n=i.da(),o=nk.bind(null,t);t=ok.bind(null,t),C(i,wh)?r=C(n,L)?o(n):n.oa.some(o):C(i,Gi)?r=C(n,O)?t(n):n.oa.some(t):C(i,pk)&&(r=t(wi(n))),r&&e.push(i)}function nk(t,e){t:{var i=e.Y,r=Bi(t,e);if(!r){e=e.Y.length;for(var n=0;n<e;n+=3)if(zi(t,i[n],i[n+1])){t=!0;break t}}t=r}return t}function ok(t,e){return Di(t,e)}function qk(t,e,i){for(var r=t.length;r--;){var n=t[r],o=n.da();if(C(o,Si)){for(var a,s=(o=o.oa).length;s--;)if(zi(e,(a=o[s]).lat,a.lng)){i.push(n);break}}else zi(e,o.lat,o.lng)&&i.push(n)}}Rj.State={ERROR:-1,LOADING:0,READY:1},Rj.prototype.getState=function(){return this.j},Rj.prototype.getState=Rj.prototype.getState,Rj.prototype.i=function(t,e){if(this.a=e.getData(),1===t){var i=this.b;i||(i=this.b=e.Bb()),this.g||(this.g=new I(i.w/2|0,i.h))}this.c&&(this.j=t,delete this.c,this.dispatchEvent("statechange"))},Rj.prototype.a=y,Rj.prototype.Wc=function(){return this.a},Rj.prototype.getBitmap=Rj.prototype.Wc,Rj.prototype.b=y,Rj.prototype.Bb=function(){return this.b},Rj.prototype.getSize=Rj.prototype.Bb,Rj.prototype.g=y,Rj.prototype.rd=function(){return this.g},Rj.prototype.getAnchor=Rj.prototype.rd,Rj.prototype.f=y,Rj.prototype.Am=function(){return this.f},Rj.prototype.getHitArea=Rj.prototype.Am,Rj.prototype.s=function(){Rj.l.s.call(this),this.a?(this.a.removeAttribute("src"),delete this.a):(this.c.cancel(),delete this.c)},u(Tj,ig),Tj.prototype.o=function(t){for(var e,i,r,n=this.head;t;){if(e=t.entries)if(i=e.length){if(2>i&&(r=t.parent)&&1===r.a){r.removeChild(t),n===t&&(n=r),r.entries=e,t=e[0].node=r;continue}}else if(delete t.entries,(r=t.parent)&&(r.removeChild(t),n===t&&(n=r),1===r.a)){t=r.a?r[0]||r[1]||r[2]||r[3]:null;continue}t=y}this.head!==n&&(this.head=n,ng(this))},Tj.prototype.zc=function(t,e){if(sg(this.a,t,e,t,e))return Uj(this,this.a,t,e,this.c);throw Error("Coordinates out of bounds")},Wj.prototype.td=function(t){return this[t%2]},n=Xj.prototype,n.Hh=0,n.Xc=function(){return this.Hh},n.O=null,n.I=function(){var t,e=this.O;return!e&&(t=jg(this.a))&&(this.O=e=new K(-t[0],t[3],-t[2],t[1])),e},n.zc=function(t){return++this.Hh,this.O=null,this.a.zc(t.lng,-t.lat)},n.remove=function(t){return(t=this.a.remove(t))&&(--this.Hh,this.O=null),t},n.Wf=function(t,e,i){var r=this.a,n=t.Pb(),o=t.Lb(),a=-n.lat;n=n.lng;var s=-o.lat;return o=o.lng,t.Eb()?r.$a(-180,a,o,s,i,e).concat(r.$a(n,a,180,s,i,e)):r.$a(n,a,o,s,i,e)},u(P,F),t("H.map.provider.Provider",P),n=P.prototype,n.v={ue:"configchange",Ca:"update"},n.Xa=function(t,e){this.dispatchEvent(new td(this.v.Ca,e,t))},n.cb=function(){this.dispatchEvent(this.v.ue)},n.s=function(){F.prototype.s.call(this),this.a&&(this.a.removeEventListener("change",this.cb),this.a=null)},n.ua=function(){return null},P.prototype.getCopyrights=P.prototype.ua,P.prototype.getCapabilities=function(){var t=0;return this.ji()&&(t|=Lj.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(t|=Lj.PROVIDES_RASTERS),this.providesSpatials()&&(t|=Lj.PROVIDES_SPATIALS),this.providesOverlays()&&(t|=Lj.PROVIDES_OVERLAYS),this.providesMarkers()&&(t|=Lj.PROVIDES_MARKERS),this.providesDomMarkers()&&(t|=Lj.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(t|=Lj.PROVIDES_GEOJSON),this.providesOMV()&&(t|=Lj.PROVIDES_OMV),t},P.prototype.getCapabilities=P.prototype.getCapabilities,P.prototype.ji=ff,P.prototype.af=ff,P.prototype.providesRasters=P.prototype.af,P.prototype.Dc=ff,P.prototype.providesSpatials=P.prototype.Dc,P.prototype.li=ff,P.prototype.providesOverlays=P.prototype.li,P.prototype.Ub=ff,P.prototype.providesMarkers=P.prototype.Ub,P.prototype.Tb=ff,P.prototype.providesDomMarkers=P.prototype.Tb,P.prototype.ki=ff,P.prototype.providesGeoJSON=P.prototype.ki,P.prototype.Ad=ff,P.prototype.providesOMV=P.prototype.Ad,P.prototype.sm=function(){return this.c},P.prototype.getEngineType=P.prototype.sm,P.prototype.$e=id,P.prototype.preprocessData=P.prototype.$e,P.prototype.f=1,P.prototype.Rm=function(){return this.f},P.prototype.getOpacityInternal=P.prototype.Rm,P.prototype.Zb=function(t,e){var i=this;if(this.c===ek.WEBGL&&!C(t,bi)||this.c===ek.HARP&&!C(t,H.map.render.harp.Style))throw t=Object.entries(ek).find((function(t){return t[1]===i.c})),new D(this.Zb,0,"Invalid style for engineType "+t);this.a&&(this.a.removeEventListener("change",this.cb),this.a.removeEventListener($h,this.cb)),this.a=t,this.a.addEventListener("change",this.cb),this.a.addEventListener($h,this.cb),e||this.cb(),this.ra=!1},P.prototype.setStyleInternal=P.prototype.Zb,P.prototype.tb=function(){return this.a||gk(this),this.a},P.prototype.getStyleInternal=P.prototype.tb,P.prototype.Kj=function(){var t=this.getCapabilities(),e=hk.FEATURE;return t&Lj.PROVIDES_BY_VIEWPORT?e=hk.SOURCE:t&Lj.PROVIDES_RASTERS?e=null:t&Lj.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(e=hk.PROVIDER),e},P.prototype.getPickingMode=P.prototype.Kj,P.prototype.wm=function(){return!1},P.prototype.getFeatureProxy=P.prototype.wm,u(ik,P),t("H.map.provider.ObjectProvider",ik),ik.prototype.ji=ef,ik.prototype.providesByViewport=ik.prototype.ji,ik.prototype.Nb=function(t){return this.la[t||Yg.ANY]},ik.prototype.getInvalidations=ik.prototype.Nb,ik.prototype.ce=function(t,e){if(e!==Vg.NONE){var i=this.la[Yg.ANY],r=i.a+1;i.update(r,e),(i=this.la[t.type]).update(r,e),t.Nb().update(r,e),this.Xa(t)}},ik.prototype.invalidateObject=ik.prototype.ce,ik.prototype.requestOverlays=ik.prototype.Dd,ik.prototype.requestSpatials=ik.prototype.og,ik.prototype.requestSpatialsByTile=ik.prototype.pg,ik.prototype.Da=!1,ik.prototype.requestMarkers=ik.prototype.Fc,ik.prototype.requestDomMarkers=ik.prototype.Ec,u(N,ik),t("H.map.provider.LocalObjectProvider",N),N.prototype.getCapabilities=function(){return Lj.PROVIDES_BY_VIEWPORT|Lj.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Lj.PROVIDES_DOM_MARKERS|Lj.CROP_LINES_BY_TILE},N.prototype.tb=function(){if(!this.L){this.L=N.l.tb.call(this);var t=new ck(this.getCapabilities()|Lj.HAS_VOLATILE_DATA,this.uid+"_vol",this.max,this.f,this.tileSize);this.L.Ue(dk(t))}return this.L},N.prototype.ec=function(){return this.g},N.prototype.getRootGroup=N.prototype.ec,N.prototype.ce=function(t,e){e&Vg.SPATIAL&&this.ca(t),N.l.ce.call(this,t,e)},N.prototype.invalidateObject=N.prototype.ce,N.prototype.ca=function(t){var e;if(C(t,M,this.ca,0),t.pa!==this)throw new Yc(this.ca,"foreign object");this.Ja(t);var i=t.type;if(i===Yg.MARKER)if((e=t.da())instanceof Yf){var r=!0;i=this.o}else i=this.m;else i===Yg.DOM_MARKER?(e=t.da())instanceof Yf?(r=!0,i=this.A):i=this.P:i=i===Yg.OVERLAY?this.u:this.i;(r=r?i.zc(e):i.Wj(t.I())).Pi=t,t.W=r},N.prototype.Ja=function(t){var e;if(t)if(t.pa!==this){if(C(t,M))throw new Yc(this.Ja,"foreign object")}else if(e=t.W){var i=t.type;i===Yg.MARKER?this.o.remove(e)||this.m.remove(e):i===Yg.DOM_MARKER?this.A.remove(e)||this.P.remove(e):i===Yg.OVERLAY?this.u.remove(e):this.i.remove(e),delete e.Pi,delete t.W}},N.prototype.removeObject=N.prototype.Ja,N.prototype.li=function(){return 0<this.u.Xc()},N.prototype.providesOverlays=N.prototype.li,N.prototype.Dd=function(t,e,i){return jk(this,this.u,t,e,i,!1).filter((function(t){return t.Wc()}))},N.prototype.requestOverlays=N.prototype.Dd,N.prototype.Dc=function(){return 0<this.i.Xc()},N.prototype.providesSpatials=N.prototype.Dc,N.prototype.og=function(t,e,i){return jk(this,this.i,t,e,i,!1)},N.prototype.requestSpatials=N.prototype.og,N.prototype.pg=function(t,e){return jk(this,this.i,t.Pf(),t.zL,e,!1)},N.prototype.requestSpatialsByTile=N.prototype.pg,N.prototype.Ub=function(){return 0<this.o.Xc()+this.m.Xc()},N.prototype.providesMarkers=N.prototype.Ub,N.prototype.Fc=function(t,e,i){return kk(this,t,e,i,!1)},N.prototype.requestMarkers=N.prototype.Fc,N.prototype.Tb=function(){return 0<this.A.Xc()+this.P.Xc()},N.prototype.providesDomMarkers=N.prototype.Tb,N.prototype.Ec=function(t,e,i){return lk(this,t,e,i,!1)},N.prototype.requestDomMarkers=N.prototype.Ec,N.prototype.Ua=function(t,e,i,r,n){for(var o=this,a=t.I(),s=[],l=Xb(),u=1;u&Yg.ANY;){if(u&r)switch(u){case Yg.MARKER:l=l.then((function(){return kk(o,a,i,e,!0)})).then((function(e){return qk(e,t,s)}));break;case Yg.DOM_MARKER:l=l.then((function(){return lk(o,a,i,e,!0)})).then((function(e){return qk(e,t,s)}));break;case Yg.SPATIAL:l=l.then((function(){return jk(o,o.i,a,i,e,!0)})).then((function(e){e.forEach(mk.bind(null,t,s))}));break;case Yg.OVERLAY:l=l.then((function(){return jk(o,o.u,a,i,e,!0)})).then((function(e){e.forEach(mk.bind(null,t,s))}))}u<<=1}l.then((function(){return n(s)}))},N.prototype.s=function(){N.l.s.call(this),this.g.qa()};var rk={PENDING:0,ACTIVE:1,DONE:2};function sk(t,e){var i;if(e=e||{},!C(t,Element))throw new D(sk,0,t);var r=t.ownerDocument.createElement("div");this.S=t,sk.l.constructor.call(this),this.padding=new tk(0,0,0,0),this.center=new I(0,0),this.margin=0,this.element=r,r.style.zIndex=0,r.style.height=r.style.width="100%",r.style.direction="ltr",r.style.position="relative"===t.style.position?"absolute":"relative",this.resize(),t.appendChild(r),(i=e.padding)!==B&&this.Ai(i.top,i.right,i.bottom,i.left),this.vi((i=e.margin)!==B?i:0)}function uk(t){var e=t.padding;t.center.set((t.width+e.left-e.right)/2<<0,(t.height+e.top-e.bottom)/2<<0)}function vk(t,e,i,r,n,o){var a;for(a=[];r<=n;r++)a=a.concat(wk(t,i,r));for(t=a.length,qj.call(this,o,t),this.o=i=[],this.g=A(this.g,this),this.f=A(this.f,this),this.N(1);t--;)o=a[t],i.push(xk(e,o[0],o[1],o[2],this.g,this.f))}function yk(){}function zk(t,e){var i=this;if(!Da(e))throw new D(Ak,1,e);if(!Da(t.next||Da(t.cycle)))throw new D(zk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[],this.c=[],this.g=t,this.i=e,this.j=function(){Bk(i)},this.a=null,this.f=function(){i.a||(i.a=x.setTimeout(i.j,1))}}function Bk(t){var e=t.c,i=0,r=t.g;for(r.a(),t.a=null;i<e.length;){var n=e[i];n.$j?e.splice(i,1):i++}for(;n=r.next(t.b,t.c);)n.cancelled?n.done(null,"cancelled"):(e.push(n),t.i(n,n.data))}function Dk(){Ck(this,null,null,null)}function Ck(t,e,i,r){return t.data=e,t.cancelled=!1,t.$j=!1,t.b=i,t.c=r,t.a=null,t}function Ek(){}function Fk(t,e){Fk.l.constructor.call(this,new Gk(t),e)}function Gk(t){if(isNaN(t)||0>t)throw new D(Fk,1,'Argument "maxTime" must be a positive number');this.c=t,this.b=Hk()}function Ik(t){if(vc(this,Ik),Ik.l.constructor.call(this,t),t&&"tileSize"in t){var e=Cd(+t.tileSize)/Md;if(isNaN(e)||e%1||0>e||30<e)throw new D(Ik,0,"tileSize: "+t.tileSize);this.tileSize=+t.tileSize}}function Jk(t,e){return Wd(t)-8-yd(Wd(e))}function Kk(){}function Lk(t,e,i){if(this.g=[],e&&this.je(e),i&&!Da(i))throw new D(Lk,2,i);this.b=0,this.filter=i,this.a={},this.f=this.c=null,this.xi(t)}function Nk(t,e){return e&&(t.c=Ok(t,e,t.c)),e}function Pk(t){for(;t.b>t.i&&t.f;)Qk(t,t.f,!0)}function Ok(t,e,i){return i!==e&&((e.ic||e.ed)&&Qk(t,e,!1),(e.ic=i)&&(e.ed=i.ed,i.ed=e),e.ed||(t.c=e),e.ic||(t.f=e),t.b+=e.size),e}function Qk(t,e,i){var r=e.ed,n=e.ic;(r||n||e==t.c&&e==t.f)&&(r?r.ic=n:t.c=n,n?n.ed=r:t.f=r,t.b-=e.size,i&&(delete t.a[e.id],Mk(t,e))),e.ic=e.ed=null}function Mk(t,e){for(var i=t.g.length;i--;)t.g[i].call(t,e.id,e.data,e.size)}t("H.map.render.RenderState",rk),u(sk,F),t("H.map.ViewPort",sk),sk.prototype.v={Ca:"update",xe:"sync"},sk.prototype.vi=function(t){if(this.margin!==+t){if(E(this.margin=+t))throw new D(this.vi,0,t);uk(this),this.dispatchEvent(this.v.Ca)}},sk.prototype.setMargin=sk.prototype.vi,sk.prototype.Ai=function(t,e,i,r){var n=this.padding;if(n.top!==t||n.right!==e||n.bottom!==i||n.left!==r){if(E(t+e+i+r))throw new D(this.Ai);n.top=t,n.right=e,n.bottom=i,n.left=r,uk(this),this.dispatchEvent(this.v.Ca)}},sk.prototype.setPadding=sk.prototype.Ai,sk.prototype.resize=function(){var t=this.S.offsetWidth,e=this.S.offsetHeight;this.width===t&&this.height===e||(this.b=new Ti(this.width,this.height),this.width=t,this.height=e,uk(this),this.dispatchEvent(this.v.Ca))},sk.prototype.resize=sk.prototype.resize,sk.prototype.ab=function(t){this.dispatchEvent(new $i(this.v.xe,this.b,t,aj.SIZE))},sk.prototype.synchronize=sk.prototype.ab,sk.prototype.s=function(){x.clearTimeout(this.a),this.a=null,this.S.removeChild(this.element),this.element=this.S=null,sk.l.s.call(this)},sk.prototype.oc=Oc,sk.prototype.startInteraction=sk.prototype.oc,sk.prototype.fc=Oc,sk.prototype.interaction=sk.prototype.fc,sk.prototype.zb=Oc,sk.prototype.endInteraction=sk.prototype.zb,u(vk,qj),vk.prototype.g=function(){sj(this,2)},vk.prototype.f=function(){sj(this,4)},vk.prototype.ze=function(){for(var t=this.o,e=t.length;e--;)t[e].cancel();this.o=y},t("H.util.ICancelable",yk),yk.prototype.cancel=function(){},yk.prototype.cancel=yk.prototype.cancel,t("H.util.AsyncQueue",zk),zk.prototype.push=function(t,e){if(!Da(e))throw new D(this.push,1,e);return t=Ck(new Dk,t,this.f,e),this.b.push(t),this.f(),t},zk.prototype.push=zk.prototype.push,zk.Task=Dk,Dk.prototype.done=function(t,e){this.$j=!0,this.b(),this.c(this,t,e)},Dk.prototype.done=Dk.prototype.done,Dk.prototype.cancel=function(){this.a&&this.a(),this.cancelled=!0},Dk.prototype.cancel=Dk.prototype.cancel,Dk.prototype.Bo=function(t){return this.a=t,this},Dk.prototype.setCancelFn=Dk.prototype.Bo,zk.Mode=Ek,Ek.prototype.next=function(){},Ek.prototype.a=function(){},u(Fk,zk),t("H.util.SequentialQueue",Fk),Gk.prototype.next=function(t){return t.length&&Hk()-this.b<this.c?t=t.shift():null},Gk.prototype.a=function(){this.b=Hk()},u(Ik,P),t("H.map.provider.TileProvider",Ik),Ik.getZoomLevelOffset=Jk,Ik.prototype.vd=function(t,e,i){return this.uri.concat("_",t,"_",e,"_",i)},Ik.prototype.getTileKey=Ik.prototype.vd,Ik.prototype.sf=256,Ik.prototype.tileSize=Ik.prototype.sf,t("H.util.ICache",Kk),Kk.prototype.add=function(){},Kk.prototype.add=Kk.prototype.add,Kk.prototype.get=function(){},Kk.prototype.get=Kk.prototype.get,Kk.prototype.Hf=function(){},Kk.prototype.drop=Kk.prototype.Hf,Kk.prototype.forEach=function(){},Kk.prototype.forEach=Kk.prototype.forEach,Kk.prototype.qa=function(){},Kk.prototype.removeAll=Kk.prototype.qa,Kk.prototype.je=function(){},Kk.prototype.registerOnDrop=Kk.prototype.je,Kk.prototype.Zg=function(){},Kk.prototype.deRegisterOnDrop=Kk.prototype.Zg,t("H.util.Cache",Lk),Lk.prototype.add=function(t,e,i){var r,n;if(!Dc(i=+i)||0>i)throw new D(this.add,2,i);return t=String(t),(n=!this.filter||this.filter(t,e,i))&&((r=this.a[t])?(r.data!==e&&Mk(this,r),this.b+=i-r.size,r.size=i,r.data=e,Nk(this,r)):this.a[t]=Ok(this,{id:t,data:e,size:i,ic:null,ed:null},this.c),Pk(this)),n},Lk.prototype.add=Lk.prototype.add,Lk.prototype.je=function(t){if(!Da(t))throw new D(this.je,0,t);this.g.push(t)},Lk.prototype.registerOnDrop=Lk.prototype.je,Lk.prototype.Zg=function(t){this.g=this.g.filter((function(e){return e!==t}))},Lk.prototype.deRegisterOnDrop=Lk.prototype.Zg,Lk.prototype.get=function(t,e){return(t=e?this.a[t]:Nk(this,this.a[t]))&&t.data},Lk.prototype.get=Lk.prototype.get,Lk.prototype.Hf=function(t){var e;(e=this.a[t])&&Qk(this,e,!0)},Lk.prototype.drop=Lk.prototype.Hf,Lk.prototype.forEach=function(t,e,i){var r;for(r in this.a){var n=this.a[r];(!i||i(r,n.data,n.size))&&t.call(e,r,n.data,n.size)}},Lk.prototype.forEach=Lk.prototype.forEach,Lk.prototype.qa=function(t){var e;for(e in this.a){var i=this.a[e];(!t||t(e,i.data,i.size))&&Qk(this,this.a[e],!0)}},Lk.prototype.removeAll=Lk.prototype.qa,Lk.prototype.xi=function(t){if(!(0<+t))throw new D(Lk.prototype.xi,0,t);return this.i=+t,Pk(this),this},Lk.prototype.setMaxSize=Lk.prototype.xi,Lk.prototype.Pm=function(){return this.i},Lk.prototype.getMaxSize=Lk.prototype.Pm,Lk.prototype.mm=function(){return this.b},Lk.prototype.getCurrentSize=Lk.prototype.mm;var Rk,Sk=function(){function t(){}for(var e,i,r,n=sc("o ms moz webkit "),o=5;o--&&!e;)e=n[o],e=(i=x[e+(e?"R":"r")+"equestAnimationFrame"])&&!E(i.call(window,t))&&(r=x[e+(e?"C":"c")+"ancelAnimationFrame"]);return Rk=e?function(t){return i.call(x,t)}:function(t){return x.setTimeout(t,25)},e?function(t){return r.call(x,t)}:function(t){return x.clearTimeout(t)}}(),Hk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Tk(t,e,i,r){this.key="",this.x=t,this.y=e,this.z=i,this.data=r,this.valid=!0}function Uk(t,e,i,r){return(t-=i)*t+(e-=r)*e}function Vk(t,e,i){return Wk(t,e*e,i||0,0,t.length-1)}function Wk(t,e,i,r,n){var o=0,a=r,s=t[r].x,l=t[r].y,u=t[n].x,c=t[n].y,h=r+1,p=Uk(s,l,u,c);if(p)for(;h<n;){var f=t[h++],d=f.x,y=((d-s)*(u-s)+((f=f.y)-l)*(c-l))/p;(d=0>y?Uk(d,f,s,l):1<y?Uk(d,f,u,c):Uk(d,f,s+y*(u-s),l+y*(c-l)))>o&&(o=d,a=h-1)}else for(;h<n;)(d=Uk(d=(f=t[h++]).x,f=f.y,s,l))>o&&(o=d,a=h-1);return o>=e||0<i&&a-r?(--i,1<a-r?(r=Wk(t,e,i,r,a)).splice(r.length-1,1):r=[t[r]],r=1<n-a?r.concat(Wk(t,e,i,a,n)):r.concat(t.slice(a,n+1))):r=[t[r],t[n]],r}function Xk(t,e,i,r,n,o,a,s){Xk.l.constructor.call(this,e,i,r,null),this.key=t,this.U=s,this.a=n,this.g=o,this.i={},this.zL=a,this.m=Ad(ch.MAX_LINE_WIDTH/2*this.g+1)}function Yk(t){return t.U.getInvalidations(Yg.SPATIAL)}function Zk(t){var e,i=Yk(t),r=i.a,n=t.c,o=n===r;if(!(o||i.Yj(n)||i.Ch(n))){o=t.f;var a=t.i;if(i.Yf(n))for(e=o.length;e--;){var s=o[e];if(s.Nb().Yf(n)){o.splice(e,1);var l=l||$k(t,s.gb())}}if(i.Dh(n)){for(e=o.length;e--;)if((s=o[e]).Nb().Dh(n)){var u=1;if((s=a[s.gb()])&&s.a){l=1;break}}u&&o.sort(al)}if(!l&&i.ee(n))for(e=o.length;e--;)if(o[e].Nb().ee(n)){var c=1;break}t.u!==n||c||(t.u=r,t.b!==n||l||(t.b=r)),t.c=r,o=!0}return o}function bl(t,e){this.b=t,this.a=e}function $k(t,e){var i=(t=t.i)[e];if(i)return delete t[e],i.a}function cl(t){var e,i=Yk(t),r=t.c,n=t.f;if(!Zk(t)){for(e=n.length;e--;){var o=n[e],a=o.Nb();(a.Yf(r)||a.Ch(r))&&$k(t,o.gb())}t.f=t.U.requestSpatialsByTile(t,!1,!1).sort(al),t.c=i.a}}function al(t,e){return Zg(t.$c(),e.$c(),!1)}t("H.map.provider.Tile",Tk),t("H.math.simplifyDP",Vk),u(Xk,Tk),t("H.map.provider.SpatialTile",Xk),Xk.prototype.c=Vd,Xk.prototype.u=Vd,Xk.prototype.b=Vd,Xk.prototype.de=function(){var t=Yk(this),e=t.a,i=this.b,r=i===e;return r||(this.U.Da&&!t.ee(i)?r=!0:Zk(this)&&(r=this.b===e)),r},Xk.prototype.isCanvasValid=Xk.prototype.de,Object.defineProperty(Xk.prototype,"valid",{get:function(){return this.de()},set:id,configurable:!0}),Xk.prototype.f=gf,Xk.prototype.Ua=function(){return this.f},Xk.prototype.getObjects=Xk.prototype.Ua,Xk.prototype.mn=function(){return this.a},Xk.prototype.getTileSize=Xk.prototype.mn;var dl={};function fl(t,e,i,r,n,o,a,s,l){var u=t.a,c=-a;if(a=o+a,s=s||0,l===B&&(l=u.length),n&&t===mh)e.fillRect(0,0,o,o);else if(l>s){for(e.beginPath(),o=s;o<l;o++){var h=u[o],p=h.length;if(h===Fi)e.moveTo(c,c),e.lineTo(c,a),e.lineTo(a,a),e.lineTo(a,c);else{var f=h[0];for(e.moveTo(f.x,f.y),s=1;s<p;s++)f=h[s],e.lineTo(f.x,f.y)}i&&e.closePath()}i&&n&&e.fill(t.b!==Ud?"evenodd":"nonzero"),r&&e.stroke()}}function el(t,e,i){var r;t.strokeStyle=e.strokeColor,t.lineWidth=e.lineWidth*i,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.setLineDash&&(r=e.lineDash)!==gf&&(t.setLineDash(r),t.lineDashOffset=e.lineDashOffset)}function gl(t,e){t.fillStyle=e.fillColor}function hl(t,e,i,r,n,o){var a=n*r.width/2,s=(n=n*r.length/2)/2;r=2*n*r.frequency;var l=Dd(Ed(n,2)+Ed(a,2));t=new tk(l,l,t=t.a-l,t),i=i.a;var u,c,h,p,f,d,y,g=Nd/2;for(o=o||0,l=i.length;l-- >o;){var v=0,m=i[l];if(c=u=m.length){var _=m;for(c=_.length,h=0;--c;)h+=_[c].Ya(_[c-1]);c=(_=h)>=r}if(c)for(h=(c=_/((c=wd(zd(_/r),1e3))+1))/2;--u;){for(p=(f=m[u]).Ya(d=m[u-1]);h<=v+p;){var b=f.x+(d.x-f.x)*(y=(h-v)/p);y=f.y+(d.y-f.y)*y,t.Df(b,y)&&(e.save(),e.translate(b,y),e.rotate(-Kd((d.y-f.y)/(f.x-d.x))+(f.x<d.x?g:-g)),e.beginPath(),e.moveTo(-a,-n),e.lineTo(0,n),e.lineTo(a,-n),e.lineTo(0,-s),e.closePath(),e.fill(),e.restore()),h+=c}v+=p}}}Xk.prototype.Re=function(){var t=this.a+"_"+this.g,e=dl[t];if(!e){e=-this.m;var i=this.a-e;e=dl[t]=new tk(e,e,i,i)}return e},Xk.prototype.getPxClipRect=Xk.prototype.Re,Xk.prototype.Pf=function(){var t=this.bb;if(!t){var e=this.Rf();t=0;var i=this.a;this.z&&(i-=t+=this.Re().top),t=this.bb=eg(e.Xe(new I(t,t)),e.Xe(new I(i,i)))}return t},Xk.prototype.getGeoClipRect=Xk.prototype.Pf,Xk.prototype.Rf=function(){var t=this.F;if(!t){var e=this.a;(t=this.F=new gj(B,e)).Qa(this.z),t.x=this.x*e,t.y=this.y*e}return t},Xk.prototype.getPxProj=Xk.prototype.Rf,Xk.prototype.Za=function(){return this.g},Xk.prototype.getPixelRatio=Xk.prototype.Za,Xk.prototype.kg=function(){var t=this.data;return t&&(this.data=null,this.b=Vd),t},Xk.prototype.releaseCanvas=Xk.prototype.kg,Xk.prototype.mg=function(){this.i={},delete this.f,this.c=Vd},Xk.prototype.releaseData=Xk.prototype.mg,Xk.prototype.V=function(t){var e,i,r,n,o=t.getContext("2d"),a=0;if(cl(this),this.b<this.c){var s=this.f;if(e=s.length){t.width=t.height=this.a,o.clearRect(0,0,this.a,this.a);var l=this.i;for(i=0;i<e;i++){var u=s[i],c=u.gb();if(n=(r=l[c])?r.b:u.getGeometriesForTile(this)){if(r)u.Nb().ee(this.b)&&(r.a=lh(u,n)),r=r.a;else{var h;r=lh(u,n);for(var p=n,f=u.j?2:0,d=p.length;d--;){var y=p[d];if(y!==mh){var g=y.a;for(h=g.length;h--;)4<(y=g[h]).length&&(g[h]=Vk(y,.6,f))}}this.i[c]=new bl(n,r)}if(r){for(o.save(),p=u.j?this.A:this.T,c=0;c<n.length;c++)p.call(this,u,n[c],u.va(),o);if(n=u.getLabels(this))for(u=o,c=n.length;c--;)for(p=(f=n[c]).size,u.font=p+"px "+f.font,u.fillStyle=f.color,u.textAlign="center",u.translate(f.x,f.y),u.rotate(f.angle),p=f.lineHeight||1.375*p,f=(d=f.lines).length;f--;)u.fillText(d[f],0,f*p);o.restore()}a|=r}}}this.data=a?t:null,this.u=this.b=this.c}else this.data&&(a=1);return 0<a},Xk.prototype.render=Xk.prototype.V,Xk.prototype.data=null,Xk.prototype.T=function(t,e,i,r){var n;i.b&&(el(r,i,this.g),fl(e,r,!1,!0,!1,this.a,this.m)),i.a&&(n=t.g)&&n.Qb&&(gl(r,n),hl(this,r,e,n,i.lineWidth))},Xk.prototype.A=function(t,e,i,r){var n,o=i.Qb,a=i.b,s=this.a,l=this.m;if(e===mh)o&&(gl(r,i),r.fillRect(0,0,s,s));else{if(a&&el(r,i,this.g),i.a&&(n=t.g)){var u=i.lineWidth;n.Qb||(n=null)}(t=e.c)===Ud?((a||o)&&(gl(r,i),fl(e,r,!0,a,o,s,this.m)),n&&(gl(r,n),hl(this,r,e,n,u,0))):(o&&(gl(r,i),fl(e,r,!0,!1,o,s,l,0,t)),a&&fl(e,r,!1,a,!1,s,l,t),n&&(gl(r,n),hl(this,r,e,n,u,t)))}};var il=[];function jl(t,e){var i;jl.l.constructor.call(this,e),this.F=t,this.T=t=e.pixelRatio,this.tileSize=i=1<<yd(Wd((e.tileSize||256)*t)),this.P=Jk(i,t),this.Lh=A(this.Lh,this),this.bi=A(this.bi,this),this.Mh=A(this.Mh,this),this.Kh=A(this.Kh,this),this.m=A(this.m,this),this.F.addEventListener(P.prototype.v.Ca,this.m,!1,this),this.g=[],this.i=new Lk(e.tileCacheSize||256,this.Lh),this.o=new Lk(e.dataCacheSize||512,this.bi),this.A=new Fk(20,this.Mh),this.b={},this.u=Hk()}function kl(t,e){if(e=e||{},!t)throw new D(kl,0,t);this.tileSize=t.tileSize,this.a={},jj.call(this,{min:void 0!==e.min?e.min:t.min,max:void 0!==e.max?e.max:t.max,minWorldSize:this.tileSize,projection:e.Ik,dark:e.dark,provider:t})}function ml(t,e,i,r,n){r=zd(r);var o=Ed(2,r),a=e.left,s=e.top,l=e.right;i=l+(i?o+(l===e.left?0:1):1);var u=e.bottom,c=[];if(n)var h=a+(1+l-a)/2+n.x/t.tileSize-.5,p=s+(1+u-s)/2+n.y/t.tileSize-.5;for(;a<i;){for(s=e.top;s<=u;)t=a%o,c.push([t,s,r,n?Bd(h-a)+Bd(p-s):0]),s++;a++}return c}function wk(t,e,i){i=zd(i),t.pixelProjection.Qa(i),e=t.Je(e);var r=t.be(e,i);return ml(t,r,e.left>e.right,i)}function nl(t,e){return e[3]-t[3]}function R(t){vc(this,R),R.l.constructor.call(this,t),this.kd=new ol,this.ac=A(this.ac,this),this.F=pl,this.createTileInternal=this.od.bind(this)}Xk.prototype.Ha=function(t,e,i){for(var r,n,o,a,s,l,u,c=this.f,h=c.length,p=gf,f=this.g;h--;)if((n=c[h]).xc(!0)&&(o=this.i[n.gb()])&&(a=o.b)){for(l="none"!==(r=n.va()).fillColor&&n.j,u="none"===r.strokeColor?0:r.lineWidth*f,r=a.length;r--;){var d;if(s=a[r],!(d=l&&s===mh)&&(d=l||u)){var y;d=t;var g=e,v=l,m=u,_=s.b,b=s.c,w=b!==Ud,x=s.a,E=x.length,A=0,T=0,k=!1;for(s=0;s<E;s++){var S=x[s],M=s>=b,I=!M&&s>=_;if(S===Fi&&v)I?A++:T++;else{var O=S.length;for(il.length=2*O,y=0;y<O;y++){var L=S[y];il[2*y]=L.x,il[2*y+1]=L.y}if(y=v&&!M,M=w&&!M?0:m,y||M){if((M=ce(d,g,il,M,y))===be.EDGE||M===be.VERTEX){k=!0;break}if(M===be.SURFACE)if(I)A++;else if(T++,_===Ud)break}}}d=k||0<T&&!(A%2)}if(d){p===gf&&(p=[]),p.push(n);break}}if(i&&p.length)break}return p},u(jl,Ik),jl.prototype.m=function(t){t.target.type===Yg.SPATIAL&&this.Xa(t.target)},jl.prototype.jb=function(t,e,i,r){var n,o=this.getTileKey(t,e,i);if(n=this.i.get(o,r)){if(r||n.de())return n;r||this.i.Hf(o)}if((n=this.o.get(o,r))&&(r||Zk(n)))return t=this.g.pop()||document.createElement("canvas"),n.V(t)||this.g.push(t),this.i.add(o,n,1),n;r||((n=this.b[o])?n.count++:((n=this.A.push([o,t,e,i],this.Kh)).count=1,this.b[o]=n))},jl.prototype.requestTile=jl.prototype.jb,jl.prototype.od=function(){},jl.prototype.Sc=function(t,e,i){this.Af(this.getTileKey(t,e,i))},jl.prototype.cancelTile=jl.prototype.Sc,jl.prototype.Af=function(t){var e;(e=this.b[t])&&(e.count--,e.count||(e.cancel(),delete this.b[t]))},jl.prototype.cancelTileByKey=jl.prototype.Af,n=jl.prototype,n.Mh=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3];r=(i=this.i.get(i)||new Xk(i,r,n,o,this.tileSize,this.T,o+this.P,this.F)).data||this.g.pop()||document.createElement("canvas"),i.V(r)||this.g.push(r),e.push(i),t.done(i)},n.Kh=function(t,e){t=t.data[0],e&&this.i.add(t,e,1),delete this.b[t],this.Xa()},n.Lh=function(t,e){e.data&&this.g.push(e.kg()),this.o.add(t,e,1)},n.bi=function(t,e){e.mg()},n.s=function(){for(var t in this.b)this.b[t].cancel();this.i.qa(),this.o.qa(),this.g.length=0,jl.l.s.call(this)},u(kl,jj),t("H.map.layer.BaseTileLayer",kl),kl.prototype.Je=function(t,e){var i=this.pixelProjection;if(!C(t,K))throw new D(this.Je,0,t);if(!E(e)){var r=i.Qj();i.Qa(e)}return t=ll(i.kb(t.Pb()),i.kb(t.Lb())),!E(r)&&i.Qa(r),t},kl.prototype.geoRectToRect=kl.prototype.Je,kl.prototype.be=function(t,e){var i=Ed(2,zd(e)),r=this.tileSize;if(!C(t,tk))throw new D(this.be,0,t);if(E(e=+e))throw new D(this.be,1,e);(e=zd(t.left/r))===i&&--e;var n=zd(t.right/r);return n===i&&--n,new tk(e,Zd(zd(t.top/r),0,i-1),n,Zd(zd(t.bottom/r),0,i-1))},kl.prototype.getTileBounds=kl.prototype.be,kl.prototype.jb=function(t,e,i,r){return this.pa.requestTile(t,e,i,r)},kl.prototype.Sc=function(t,e,i){this.pa.cancelTile(t,e,i)},kl.prototype.cancelTile=kl.prototype.Sc,kl.prototype.ua=function(t,e){return this.pa.getCopyrights?this.pa.getCopyrights(t,e):null},kl.prototype.getCopyrights=kl.prototype.ua,kl.prototype.Qe=function(t,e,i,r,n,o){var a,s,l=[],u=this.pa;o=null!=o?o:"__default__";var c=u.requestTile;if(!C(t,tk))throw new D(this.Qe,0,t);if(E(i=+i))throw new D(this.Qe,1,i);if(r||(a={}),t=(e=ml(this,t,e,i,n)).length)for(r||e.sort(nl),i=t;i--;)n=e[i],r||(a[u.vd.apply(u,n)]=!0),n[3]=+r,(s=c.apply(u,n))&&l.push(s);if(!r){var h;for(h in r=a,a=this.a[o]||{})a.hasOwnProperty(h)&&a[h]&&!r[h]&&this.pa.cancelTileByKey(h);this.a[o]=r}return{total:t,tiles:l}},kl.prototype.getProviderTiles=kl.prototype.Qe,u(R,Ik),t("H.map.provider.RemoteTileProvider",R),R.prototype.Rd=function(){return 1},R.prototype.getEntryWeight=R.prototype.Rd;var pl=new Lk(65536);function xk(t,e,i,r,n,o){return r=~~r,t.requestInternal(e,i,r,(function(a,s){t.$d().put(t.vd(e,i,r),{raw:s&&s.raw||a,timestamp:x.Date.now()},n,o)}),o,0)}function rl(t,e){delete t.i[e],delete t.T[e]}function ql(t){for(var e in t.i)t.ac(e)&&t.cancelTileByKey(e)}R.prototype.i={},R.prototype.T={},R.prototype.Mb=function(){return this.F},R.prototype.getCache=R.prototype.Mb,R.prototype.o=ba(3),R.prototype.ac=function(t){var e=this.uri;return!t.indexOf(e)&&"_"===t.charAt(e.length)},R.prototype.cacheFilter=R.prototype.ac,R.prototype.ha=function(t,e){e.valid=!1},R.prototype.reload=function(t){var e=this.getCache();t?e.qa(this.ac):e.forEach(this.ha,this,this.ac),ql(this),this.Xa(this,{isReload:!0})},R.prototype.reload=R.prototype.reload,R.prototype.Tg=function(){return!1},R.prototype.MAX_STORE_TIME=1/0,R.prototype.$d=function(){return this.kd},R.prototype.P=function(t,e){e(t)},R.prototype.requestInternal=R.prototype.J,R.prototype.jb=function(t,e,i,r){var n=this,o=this.getCache();if(E(t=+t))throw new D(this.jb,0,t);if(E(e=+e))throw new D(this.jb,0,e);if(E(i=+i))throw new D(this.jb,0,i);i=~~i;var a=this.getTileKey(t,e,i);return(o=o.get(a))&&o.valid||r||this.i[a]||(o=B,this.requestTileAsPromise(t,e,i,r).then((function(t){n.Xa(t)}),id)),o},R.prototype.requestTile=R.prototype.jb,R.prototype.Qk=function(t,e,i,r){var n,o=this,a=this.getCache(),s=this.getTileKey(t,e,i),l=this.i,u=this.T,c=this.$d();return u[s]?u[s]:(u[s]=u=new Pb((function(u,h){function p(n){var p,f,d=function(r,n){(f=o.createTileInternal(t,e,i,r,n)).key=s,a.add(s,f,o.Rd(r)),u(f),rl(o,s)};n&&(p=x.Date.now()-n.timestamp),n&&p<o.MAX_STORE_TIME?o.P(n.raw,d):(p&&c.remove(s),(f=a.get(s))&&f.valid||r?u(f||null):l[s]=o.requestInternal(t,e,i,d,h))}n=c.get(s,p,p)})),l[s]||(l[s]=n),u.then((function(){rl(o,s)}),(function(){rl(o,s)})),u)},R.prototype.requestTileAsPromise=R.prototype.Qk,R.prototype.Pk=function(t,e){var i=this,r=t.id,n=t.tile.coords;return new Pb((function(t,o){i.Qk(n.x,n.y,n.z,e).then((function(e){for(var i,n=y,o=(e=e.Ua?e.Ua():e.data).length;o--;)if((i=e[o]).gb()===r){n=i;break}t(n)}),o)}))},R.prototype.requestObjectAsPromise=R.prototype.Pk;var sl={cancel:function(){}};function ol(){}function Ak(t){if(Ak.l.constructor.call(this,t),t&&(this.m={crossOrigin:t.crossOrigin||"anonymous",headers:t.headers||{}},this.g=t.getURL),!Da(this.g))throw new D(Ak,0,"getURL");if(fk(this,t.opacity),this.b=x.URL||x.webkitURL,!(t="anonymous"===(t=this.m.crossOrigin)||"use-credentials"===t)){t=this.g(0,0,0);var e=window.location,i=document.createElement("a");i.href=t,t=i.hostname===e.hostname&&i.port===e.port&&i.protocol===e.protocol}(this.A=t&&!!sf.prototype.b.arraybuffer&&!!this.b)&&this.Mb().je(A(this.R,this))}function tk(t,e,i,r){this.left=+t,this.top=+e,this.right=+i,this.bottom=+r}function ll(t,e){return new tk(t.x,t.y,e.x,e.y)}function tl(t,e){kl.call(this,t,e)}function ul(t,e){(e=e?Va(e):{}).tileSize=e.tileSize||256,e.pixelRatio=e.pixelRatio||Te(),e.max=24,this.a=new jl(t,e),this.b=new tl(this.a),e.minWorldSize=this.a.tileSize,e.provider=t,ul.l.constructor.call(this,e),this.tileSize=this.b.tileSize,this.c=A(this.c,this),this.a.addEventListener(this.a.v.Ca,this.c),t.addEventListener(t.v.Ca,this.c)}R.prototype.od=function(t,e,i,r){return new Tk(t,e,i,r)},R.prototype.Af=function(t){var e=this.i[t];e&&(e.cancel(),rl(this,t))},R.prototype.cancelTileByKey=R.prototype.Af,R.prototype.Sc=function(t,e,i){this.cancelTileByKey(this.getTileKey(t,e,i))},R.prototype.cancelTile=R.prototype.Sc,R.prototype.s=function(){R.l.s.call(this),this.getCache().qa(this.ac),ql(this)},R.NullStorage=ol,ol.prototype.get=function(t,e){return e(),sl},ol.prototype.get=ol.prototype.get,ol.prototype.put=function(t,e,i){i&&i()},ol.prototype.put=ol.prototype.put,ol.prototype.clear=function(t){t&&t()},ol.prototype.clear=ol.prototype.clear,ol.prototype.remove=function(t,e){e&&e()},ol.prototype.remove=ol.prototype.remove,u(Ak,R),t("H.map.provider.ImageTileProvider",Ak),Ak.prototype.kc=function(t){fk(this,t)},Ak.prototype.setOpacity=Ak.prototype.kc,Ak.prototype.Zc=function(){return this.f},Ak.prototype.getOpacity=Ak.prototype.Zc,Ak.prototype.af=ef,Ak.prototype.providesRasters=Ak.prototype.af,Ak.prototype.Rd=function(){return this.tileSize},Ak.prototype.getEntryWeight=Ak.prototype.Rd,Ak.prototype.J=function(t,e,i,r,n,o){var a,s=this,l=this.g(t,e,i);if(t=null,l){var u=x.setTimeout((function(){s.A?(a=new sf("arraybuffer",l,o,s.m)).then((function(t){return t.blob()})).then((function(t){var e=new Image;e.onload=A(r,null,e,{raw:t}),e.onerror=A(n,null,"bad url");try{e.src=s.b.createObjectURL(t)}catch(t){}}),n):(a=new sf("image",l,o,s.m)).then(r,n)}),150);t={cancel:function(){a?a.cancel():x.clearTimeout(u)}}}else r(null);return t},Ak.prototype.requestInternal=Ak.prototype.J,Ak.prototype.P=function(t,e){var i=new Image;i.onload=function(){e(this)},i.src=this.b.createObjectURL(t)},Ak.prototype.R=function(t,e){(t=e.data)&&t instanceof HTMLImageElement&&this.b.revokeObjectURL(t.src)},t("H.math.Rect",tk),tk.prototype.set=tk,tk.prototype.set=tk.prototype.set,tk.prototype.Pb=function(){return this.c||(this.c=new I(this.left,this.top))},tk.prototype.getTopLeft=tk.prototype.Pb,tk.prototype.Lb=function(){return this.a||(this.a=new I(this.right,this.bottom))},tk.prototype.getBottomRight=tk.prototype.Lb,tk.prototype.Df=function(t,e){return this.left<=t&&this.right>=t&&this.top<=e&&this.bottom>=e},tk.prototype.containsXY=tk.prototype.Df,tk.fromPoints=ll,tk.prototype.clone=function(){return new tk(this.left,this.top,this.right,this.bottom)},tk.prototype.clone=tk.prototype.clone,u(tl,kl),t("H.map.layer.TileLayer",tl),tl.prototype.Ed=function(t,e,i,r,n){if(!C(t,K))throw new D(this.Ed,0,t);if(E(e=+e))throw new D(this.Ed,1,e);e=zd(e),this.pixelProjection.Qa(e),t=this.Je(t);var o=this.be(t,e);return this.Qe(o,t.left>t.right,e,i,r,n)},tl.prototype.requestTiles=tl.prototype.Ed,u(ul,jj),t("H.map.layer.ObjectLayer",ul),ul.prototype.c=function(t){t.currentTarget!==this.a&&t.target.type===Yg.SPATIAL||this.Xa()};var vl={markers:gf,total:0};ul.prototype.Fc=function(t,e,i){var r,n=this.pa;return n.providesMarkers()&&(r=n.requestMarkers(t,e,!0,i)).length?{markers:r,total:r.length}:vl},ul.prototype.requestMarkers=ul.prototype.Fc,ul.prototype.Ec=function(t,e,i){var r,n=this.pa;return n.providesDomMarkers()&&(r=n.requestDomMarkers(t,e,!0,i)).length?{markers:r,total:r.length}:vl},ul.prototype.requestDomMarkers=ul.prototype.Ec;var wl={tiles:gf,total:0};ul.prototype.Ed=function(t,e,i,r){if(this.pa.providesSpatials()){var n=this.b.Ed(t,e,i,r);i||(i=this.a,33<(n=Hk())-i.u&&(Bk(i.A),i.u=n),n=this.b.Ed(t,e,!0,r))}else n=wl;return n},ul.prototype.requestTiles=ul.prototype.Ed,ul.prototype.jb=function(t,e,i,r){return this.b.jb(t,e,i,r)},ul.prototype.requestTile=ul.prototype.jb,ul.prototype.Sc=function(t,e,i){this.b.Sc(t,e,i)},ul.prototype.cancelTile=ul.prototype.Sc;var xl={overlays:gf,total:0};function yl(t,e,i,r){var n=new tk(0,0,0,0);if(yl.l.constructor.call(this),!t)throw new D(yl,0,t);if(!e)throw new D(yl,1,e);if(!i)throw new D(yl,2,i);if("object"!=typeof r)throw new D(yl,3,r+" is not an object");if("number"!=typeof r.pixelRatio)throw new D(yl,3,r.pixelRatio+" is not a number");this.ta=r.pixelRatio,this.zoom=0,this.ib=Cd(this.ta)/Md,this.sa=new gj,this.kd={1:n.clone(),2:n.clone(),4:n.clone()},this.o=new I(.5,.5),this.g=t,zl(this,this.ta),this.oc=A(this.oc,this),this.fc=A(this.fc,this),this.zb=A(this.zb,this),t.startInteraction=this.oc,t.interaction=this.fc,t.endInteraction=this.zb,t.addEventListener(t.v.Ca,this.R,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.se,this.relaunch=this.fa,this.dispose=this.B,this.screenToGeo=this.Va,this.geoToScreen=this.Ga,this.screenToLookAtData=this.sg,this.A=e,this.nc=A(this.nc,this),this.control=A(this.control,this),this.yb=A(this.yb,this),e.startControl=this.nc,e.control=this.control,e.endControl=this.yb,e.addEventListener(e.v.Ca,this.Xg,!1,this),this.c=i,this.dg=A(this.dg,this),this.Se=A(this.Se,this),this.Te=A(this.Te,this),this.cg=A(this.cg,this),i.addEventListener(jj.prototype.v.Ca,this.dg,!1,this),i.addEventListener(i.v.te,this.Se,!1,this),i.addEventListener(i.v.ve,this.Te,!1,this),i.addEventListener(i.v.we,this.cg,!1,this)}function zl(t,e){var i=t.g,r=i.width,n=i.height,o=i.padding,a=o.top,s=o.left,l=o.bottom;o=o.right,i=i.margin;var u=-(r+s-o)/2<<0,c=-(n+a-l)/2<<0;r+=u,n+=c,(t=t.kd)[1].set((u-i)*e,(c-i)*e,(r+i)*e,(n+i)*e),t[2].set(u*e,c*e,r*e,n*e),t[4].set((u+s)*e,(c+a)*e,(r-o)*e,(n-l)*e)}function Bl(t,e){t.style.transition="opacity 1.5s",De(t,"transitionend",e,!1),t.style.opacity=0}ul.prototype.Dd=function(t,e,i){var r=this.pa,n=xl;return r.providesOverlays&&r.providesOverlays()&&(e=(t=r.requestOverlays(t,e,!0,i)).length)&&(n={overlays:t,total:e}),n},ul.prototype.requestOverlays=ul.prototype.Dd,ul.prototype.s=function(){this.a.B(),this.b.B(),this.pa.dispose(),ul.l.s.call(this)},u(yl,F),t("H.map.render.RenderEngine",yl),yl.prototype.R=function(){zl(this,this.ta)},yl.prototype.s=function(){var t=this.g,e=this.A,i=this.c;t.removeEventListener(t.v.Ca,this.R,!1,this),t.startInteraction===this.oc&&(t.startInteraction=sk.prototype.oc),t.interaction===this.fc&&(t.interaction=sk.prototype.fc),t.endInteraction===this.zb&&(t.endInteraction=sk.prototype.zb),e.removeEventListener(e.v.Ca,this.Xg,!1,this),e.startControl===this.nc&&(e.startControl=Al.prototype.nc),e.control===this.control&&(e.control=Al.prototype.control),e.endControl===this.yb&&(e.endControl=Al.prototype.yb),i.removeEventListener(jj.prototype.v.Ca,this.dg,!1,this),i.removeEventListener(i.v.te,this.Se,!1,this),i.removeEventListener(i.v.ve,this.Te,!1,this),i.removeEventListener(i.v.we,this.cg,!1,this)},yl.prototype.ri=function(t){this.Hg=t},yl.prototype.setAnimationCallback=yl.prototype.ri,yl.prototype.ni=function(){this.Hg=void 0},yl.prototype.resetAnimationCallback=yl.prototype.ni,yl.prototype.control=function(){},yl.prototype.capture=function(){return Zb(Error("not implemented"))};var Cl={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};function Fl(t,e){return e.tilt=Gl(t,e.tilt),e.heading=Hl(t,e.heading),e.incline=t.getCapabilities().lookAt.incline.min,e}function El(t,e){var i=t.getCapabilities().lookAt.zoom;return Zd(e,xd(i.min,t.Jg),wd(i.max,t.Eg))}function Gl(t,e){return Zd(e,(t=t.getCapabilities().lookAt.tilt).min,t.max)}function Hl(t,e){return Zd((e%360+360)%360,(t=t.getCapabilities().lookAt.heading).min,t.max)}function Dl(t,e,i){(i=i?e.addEventListener:e.removeEventListener).call(e,e.v.Yi,t.di,!1,t),i.call(e,e.v.Xi,t.di,!1,t)}yl.InteractionModifiers=Cl,n=yl.prototype,n.v={$i:"render"},n.dg=function(t){this.wk(t),this.fa()},n.Se=function(t){this.Ve(t.idx,t.added)},n.Te=function(t){this.ci(t.idx,t.removed,t.type===this.c.v.we)},n.cg=function(t){t.removed&&this.Te(t),this.Se(t)},n.wk=id,n.Ve=function(t,e){this.yh(t,e),0===t&&this.Hb(),C(e,jj)&&Dl(this,e,!0),this.le(),this.fa()},n.Hb=function(){var t=this.c.Na();if(0<t.length){var e=t[0].max;this.Jg=t[0].min,this.Eg=e}else e=(t=this.getCapabilities().lookAt.zoom).max,this.Jg=t.min,this.Eg=e;(t=El(this,this.zoom))!==this.zoom&&(this.zoom=t,this.sa.Qa(t),this.ab())},n.ab=function(t){this.P=this.lb(),t&&(this.P.position=t),this.P.zoom=this.zoom-this.ib,this.P.position.alt=0},n.pl=0,n.heading=180,n.lb=function(){return Fl(this,{position:this.sa.projection.ig(this.o),zoom:this.zoom,tilt:this.pl,heading:this.heading})},n.yh=id,n.ci=id,n.Co=function(t,e){this.T={before:t,after:e}},yl.prototype.setOnRenderCallbacks=yl.prototype.Co;var Il={P2D:0,WEBGL:1,HARP:2};yl.EngineType=Il;var Jl={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:Cl.ZOOM,COORD:Cl.COORD},capture:!0};function Kl(t){var e,i=this,r=x.H.gl;Kl.l.constructor.call(this),this.a=e=r.Scene.create(x.URL.createObjectURL(of(JSON.stringify(Ll))),{viewport:t.viewport,container:t.pc,disableRenderLoop:!0,devicePixelRatio:t.devicePixelRatio,logLevel:"error"}),t.mo&&e.subscribe({load:t.mo}),e.subscribe({view_complete:function(){i.g=!0,t.yk()}});var n=e.requestRedraw;e.requestRedraw=function(){n.apply(e),t.yk()},this.i=A(this.i,this),this.f=A(this.f,this),this.j=0,this.c={},this.b={}}function Ml(t){var e;for(e in t=t.a.sources){var i=t[e];if(i.hasPendingCommands&&i.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}function Nl(t){t.g=!1,t.a.resetViewComplete()}function Ol(t){return t.a.view}function Pl(t,e){function i(){var i,n,o,a,s,l=e.Na(),u={},c={},h=++t.j;for(Eh(c,Ll),n=0;n<l.length;n++){var p=l[n];if(i=p.ea()){var f=i.tb();if(f.getState()===Zh.READY){var d=f.sd();if(!Ua(d)){for(o in delete d.cameras,delete d.camera,u[n]=d=Qh(d,n),!C(p,ul)&&d.sources&&Rh(d,i.uid),d.sources){var g=d.sources[o];g.max_zoom=wd(i.max,Jl.lookAt.zoom.max),g.max_display_zoom=p.max,g.min_display_zoom=p.min,(s=i.tileSize)&&(2<=r&&256<s&&i instanceof Ak&&(s/=2),g.tile_size=s)}(a=f.bc())&&Sh(d,a),Eh(c,d)}}}}return Eh(c.layers.skybox.draw.skybox.color,c.scene.sky),t.a.config=c,t.a.updateConfig().then((function(){var e,i,r={};if(h!==t.j)return!1;for(i in t.j=0,u){p=l[+i];var n=u[i].sources;for(e in n)(n=t.a.sources[e])&&(r[e]=n,n.initialize&&p.getProvider()&&n.initialize(p.getProvider(),t.i,t.a.getWorkers().length,n.tiled?B:t.a.tile_manager.getWorkerForTile(y,n)))}for(e in t.c)!r[e]&&t.c[e].dispose&&t.c[e].dispose();return t.c=r,!0}))}var r=t.a.pixelRatio();t.a.initialized?i():t.a.load(y,{blocking:!1}).then(i)}t("H.map.render.webgl.capabilities",Jl),u(Kl,nd),Kl.prototype.g=!1,Kl.prototype.V=function(){var t=x.H.gl.Task;return this.a.immediateRedraw(),t.setState({user_moving_view:this.a.view.user_input_active}),t.processAll(),this.g&&!this.a.dirty&&!this.a.building&&!Ml(this)&&!Object.keys(this.b).length},Kl.prototype.i=function(t,e,i){var r=this,n=this.a.sources[t],o=i&&i.isReload;e?!0!==this.b[t]&&(this.b[t]||(this.b[t]={ol:{},fj:[]}),C(e,Tk)?this.b[t].ol[e.x+"/"+e.y+"/"+e.z]=!0:(e=e.boundingBox,this.b[t].fj.push(new K(e[0],e[1],e[2],e[3])))):this.b[t]=!0,n&&n.has_volatile_data?Ql(this,o):(x.clearTimeout(this.o),this.o=x.setTimeout((function(){return Ql(r,o)}),Rl))};var Rl=100;function Ql(t,e){var i=t.a.tile_manager;i.removeTiles(t.f),i.updateTilesForView(),e&&i.removeCachedTiles(t.f),Nl(t),t.b={}}function Sl(t,e,i,r){t.a.getFeatureAt(e,i,r),t.a.update()}function Tl(t){return t.a.screenshot(void 0).then((function(t){return new Pb((function(e,i){new Mj(URL.createObjectURL(t.blob),(function(t,r){1===t?e(r.getData()):i()}),!1)}))}))}Kl.prototype.f=function(t){var e=!1,i=this.b[t.source.name],r=x.H.gl;if(i)if(!0===i)e=!0;else{var n=r.Tile.coord(r.Geo.wrapTile(t.coords));if(!(e=!!i.ol[n.key])){var o=r.Geo.getTileBoundingBox(n,t.source.tile_size,ch.MAX_LINE_WIDTH/2);o=eg(o.getTopLeft(),o.getBottomRight()),e=i.fj.some((function(t){return t.wd(o,!0)||o.md(t.fb(),!0)}))}}return e},Kl.prototype.sd=function(){return this.a.config},Kl.prototype.Za=function(){return this.a.pixelRatio()},Kl.prototype.s=function(){var t=this.c;Kl.l.s.call(this),this.a.destroy(),this.b={},t&&Object.keys(t).forEach((function(e){t[e].dispose()})),x.clearTimeout(this.o),this.c=this.a=null};var Ll={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}},hk={FEATURE:1,SOURCE:2,PROVIDER:3};function Ul(t){return t}function Vl(t){return-t*(t-2)}function Wl(t){return 1-Math.sqrt(1-t*t)}function Xl(t){return Dd(2*t-t*t)}function Yl(t){return 1-Math.cos(t*Math.PI/2)}function Zl(t){return Math.sin(t*Math.PI/2)}function $l(t,e){this.a={tilt:am(t.tilt,e.tilt),heading:am(t.heading,e.heading),zoom:e.zoom-t.zoom};var i=this.b=$f(t.position),r=e.position;t=r.lat*Sd;var n=i.lat*Sd;r=r.lng*Sd-i.lng*Sd,i=Gd(r)*Id(t),t=Id(n)*Gd(t)-Gd(n)*Id(t)*Id(r),t=Math.atan2(i,t),this.j=(0<=t?t:Qd+t)*Td,this.c=this.b.Ya(e.position),e=this.a.zoom,this.i=0===e?this.f:Object.assign({},this.f,{zoom:0>e?Xl:Wl,position:0>e?Yl:Zl}),this.g=Object.assign({},{tilt:0,heading:0,zoom:0})}function am(t,e){return-180<(t=e-t)&&180>=t?t:180<t?t-360:t+360}function bm(t,e){if(E(this.x=+t))throw new D(bm,0,t);if(E(this.y=+e))throw new D(bm,1,e)}function cm(t){return Dd(t.a(t))}function dm(t){t=t||hf,this.bb=uc(t.eo)?t.eo:3,this.U=uc(t.bo)?t.bo:300,this.u=uc(t.Qo)?t.Qo:3,this.F=uc(t.Lo)?t.Lo:50,this.f=[],this.clear()}function gm(t,e){t.i^=t.i&e}t("H.map.provider.PickingMode",hk),t("H.util.animation.ease.LINEAR",Ul),t("H.util.animation.ease.EASE_IN_QUAD",(function(t){return t*t})),t("H.util.animation.ease.EASE_OUT_QUAD",Vl),t("H.util.animation.ease.EASE_IN_OUT_QUINT",(function(t){return 1>(t*=2)?Ed(t,5)/2:Ed(t-=2,5)/2+1})),t("H.util.animation.ease.EASE_OUT_CIRC",Xl),$l.prototype.f={tilt:Ul,heading:Ul,zoom:Ul,position:Ul},bm.prototype.add=function(t){return new bm(this.x+t.x,this.y+t.y)},bm.prototype.a=function(t){if(!C(t,bm))throw new D(this.a,0,t);return(t=this.b(t)).x+t.y},bm.prototype.b=function(t){if(!C(t,bm))throw new D(this.b,0,t);return new bm(this.x*t.x,this.y*t.y)},bm.prototype.Qa=function(t){return new bm(this.x*t,this.y*t)},t("H.map.render.InteractionUtils",dm),dm.prototype.Gn=function(){return this.c},dm.prototype.isGestureDetected=dm.prototype.Gn,dm.prototype.start=function(t,e){var i=Cl.HEADING,r=Cl.TILT;this.a&&this.clear(),this.i=t,this.o=!!e,this.a=!0,this.c=!(t&(i|r))||t===i||t===r},dm.prototype.start=dm.prototype.start,dm.prototype.store=function(t,e,i,r,n){var o=!1;if(this.a){if(o=(t=new em(t,e,i,r,n)).c,this.m=this.b,this.b=t,this.g){if(this.j=!0,o){e=this.i;var a=this.c;if(!a&&this.j){n=Cl.HEADING;var s=Cl.TILT;i=Cl.COORD,r=Cl.ZOOM;var l=e&(i|s)?this.Wd(!0):fm,u=e&r?this.Kf(!0):1,c=e&n?Bd(this.ih(!0)):0,h=Bd(l.x),p=Bd(l.y);l=10<h||10<p,h=10<p&&p>3*h,u=.8>u||1.2<u,c=7<c,e&s&&(c||u||l&&!h?gm(this,s):h&&(gm(this,~s>>>0),a=!0)),!a&&e&n&&e&(i|r)&&(u||l?(gm(this,n),a=!0):c&&(gm(this,s),a=!0)),this.c=a}}}else this.g=t,o||(this.c=!0);this.o&&this.f.push(t)}return o},dm.prototype.store=dm.prototype.store,dm.prototype.clear=function(){this.f.length=0,this.a=this.o=this.j=this.c=!1,this.g=this.m=this.b=void 0},dm.prototype.clear=dm.prototype.clear,dm.prototype.Bc=function(t){return 0<(this.i&t)},dm.prototype.isModifierEnabled=dm.prototype.Bc,dm.prototype.wa=function(){return this.a},dm.prototype.isRunning=dm.prototype.wa;var fm=pc(new bm(0,0));function em(t,e,i,r,n){this.a=new I(t,e),i!==B&&(this.b=new I(i,r),this.c=!0),this.timestamp=n!==B?n:Hk()}function im(t){var e=t.a;return(t=t.b)?new I(e.x-(e.x-t.x)/2,e.y-(e.y-t.y)/2):B}function km(t,e){var i=t.a;return(t=t.b)&&t.Ya(e)<i.Ya(e)?t:i}function hm(t,e){var i=t.b,r=e.b;return r&&i?(e=im(e),t=im(t)):i?t=km(t,e=e.a):r?e=km(e,t=t.a):(e=e.a,t=t.a),new bm(e.x-t.x,e.y-t.y)}function jm(t){var e=t.b;return e?t.a.Ya(e):0}function lm(){F.call(this),this.reset()}function nm(t){nm.l.constructor.call(this,lm.prototype.v.Gg),this.c=t}function om(t){return x.Object.create(t.f)}function mm(t,e,i,r,n,o){this.mb=t,this.nb=e,this.ob=i,this.me=r,this.ne=n,this.gf=o}function pm(t,e,i,r){pm.l.constructor.call(this),this.pc=t,this.ta=r,this.a=t.appendChild(this.createElement(t.ownerDocument)),this.kf(e,i)}function qm(t,e,i,r){qm.l.constructor.apply(this,arguments)}function rm(t,e,i,r,n,o){var a=n||"2d";rm.l.constructor.apply(this,arguments),this.b=this.a.getContext(a,o),this.c="2d"===a,this.f=a,this.fk=o}function sm(t){this.hb=t}function tm(t){var e="dom";tm.l.constructor.call(this,t),C(this.hb,um)&&(e="2d"===t.Qd()?"2d":"webgl"),this.a=e}function vm(t,e,i,r,n){if(!Da(t.ri)||!Da(t.ni))throw new D(vm,0,t);if(this.c=t,!Da(this.j=e))throw new D(vm,1,e);if(E(this.i=+i))throw new D(vm,2,i);if(!Da(this.g=r)&&null!=r)throw new D(vm,3,r);if(!Da(this.f=n)&&null!=n)throw new D(vm,4,n);this.id=(new bf).next(),this.a=!1}function wm(t,e){wm.l.constructor.call(this,t),this.rc=!(!e||!e.rc),this.f={}}dm.prototype.tc=function(){var t;if(this.o){var e=this.f,i=e.length,r=0;for(t=new bm(0,0);--i&&r<this.u;)t=t.add(hm(e[i-1],e[i])),r++}else t=this.Wd();return 0!==(i=cm(e=t))?new bm(e.x/i,e.y/i):e},dm.prototype.getDirection=dm.prototype.tc,dm.prototype.Cb=function(t){var e,i;if(t=t||Hk(),this.o){var r=this.f,n=this.f.length,o=this.f[n-1];for(i=e=0;--n&&e<this.u;)i+=cm(hm(r[n],r[n-1])),e++;r=i/e}else o=this.b,r=cm(this.Wd());return r>=this.bb&&t-o.timestamp<=this.F?r>this.U?this.U:r:0},dm.prototype.getSpeed=dm.prototype.Cb,dm.prototype.Jf=function(){return this.b?im(this.b):B},dm.prototype.getBifocalCenter=dm.prototype.Jf,dm.prototype.Wd=function(t){return(t=t?this.g:this.m)?hm(t,this.b):new bm(0,0)},dm.prototype.getMoveVector=dm.prototype.Wd,dm.prototype.Kf=function(t){var e=1;if(this.j){var i=this.b;(t=jm(t=t?this.g:this.m))&&(i=jm(i))&&(e=i/t)}return e},dm.prototype.getBifocalScaling=dm.prototype.Kf,dm.prototype.ih=function(t){if(this.j){var e=t?this.g:this.m,i=this.b;t=e.b;var r=i.b,n=0;t&&r&&(e=e.a,i=i.a,n-=Ld(r.y-i.y,r.x-i.x)*Td-Ld(t.y-e.y,t.x-e.x)*Td),t=n}else t=0;return t},dm.prototype.getBifocalRotation=dm.prototype.ih,em.prototype.c=!1,u(lm,F),lm.prototype.start=function(t,e){this.a&&this.reset(),E(t-e)||(this.b=+t,this.c=+e),this.a=!0},lm.prototype.reset=function(){this.a=!1,this.b=this.c=B,this.f=new mm(0,0,0,0,0,0)},lm.prototype.wa=function(){return this.a},lm.prototype.v={Gg:"animationupdate"},u(nm,sd),lm.prototype.set=function(t,e,i,r,n,o){var a=this.f;this.a&&(t=new mm(t/1e3,e/1e3,i/1e3,r/1e3,n/1e3,o/1e3),a.na(t)||(this.f=t,this.dispatchEvent(new nm(om(this)))))},lm.prototype.Cb=function(){return om(this).Cb()},lm.prototype.tc=function(){var t=om(this),e=this.Cb()||1;return new mm(t.mb/e,t.nb/e,t.ob/e,t.me,t.ne,t.gf)},lm.prototype.s=function(){this.reset(),lm.l.s.call(this)},mm.prototype.Cb=function(){return Dd(this.mb*this.mb+this.nb*this.nb+this.ob*this.ob)},mm.prototype.tc=function(){var t=this.Cb()||1;return new mm(this.mb/t,this.nb/t,this.ob/t,this.me,this.ne,this.gf)},mm.prototype.na=function(t){return!!t&&this.mb===t.mb&&this.nb===t.nb&&this.ob===t.ob&&this.me===t.me&&this.ne===t.ne&&this.gf===t.gf},u(pm,nd),pm.prototype.K=function(){return this.a},pm.prototype.kf=function(t,e){this.size?(this.size.w=t,this.size.h=e):this.size=new Ti(t,e),this.el(this.a,this.a.style,t,e,this.ta)},pm.prototype.setSize=pm.prototype.kf,n=pm.prototype,n.Bb=function(){return this.size},n.Za=function(){return this.ta},n.bk=!0,n.vb=function(t){t!==this.bk&&(this.a.style.display=t?"block":"none",this.bk=t)},n.Nh=1,n.kc=function(t){this.Nh!==t&&(this.ek(t),this.Nh=t)},n.Zc=function(){return this.Nh},n.qe=function(t){this.a.style.zIndex=t},pm.prototype.setZIndex=pm.prototype.qe,n=pm.prototype,n.Pj=function(){return+this.a.style.zIndex},n.Uc=function(){},n.clear=function(){},n.s=function(){this.clear(),this.pc.removeChild(this.a),this.kf(0,0),this.a=this.pc=null,pm.l.s.call(this)},n.Mk=0,n.rg=function(){++this.Mk},n.release=function(){--this.Mk||this.B()},u(qm,pm),t("H.map.render.dom.Surface",qm),n=qm.prototype,n.Qd=function(){return"dom"},n.createElement=function(t){return(t=t.createElement("DIV")).style.position="absolute",t.style.pointerEvents="none",t},n.el=function(t,e,i,r){e.width=i+"px",e.height=r+"px"},n.ek=function(t){this.a.style.opacity=t},n.Uc=function(t,e,i){var r=this.ta,n=t.style;n[yf("transform")]="matrix(1,0,0,1,"+e/r+","+i/r+")",t.parentNode!==this.a&&(n.position="absolute",this.a.appendChild(t),this.a.style.pointerEvents="auto","auto"===getComputedStyle(t).pointerEvents&&(t.style.pointerEvents="all"),this.a.style.pointerEvents="none")},n.clear=function(t){t?this.a.removeChild(t):this.a.innerHTML=""},u(rm,pm),n=rm.prototype,n.createElement=function(t){var e=(t=t.createElement("canvas")).style;return e.position="absolute",e.top=e.left="0",t},n.el=function(t,e,i,r,n){t.width=xd(i,1),t.height=xd(r,1),e.width=yd(i/n)+"px",e.height=yd(r/n)+"px"},n.ek=function(t){this.b.globalAlpha=t},n.Uc=function(t,e,i,r,n){this.c&&this.b.drawImage(t,e,i,r,n)},n.getContextAttributes=function(){return this.fk},n.Qd=function(){return this.f},n.clear=function(t){var e,i;this.c&&(t?this.b.clearRect(e=t.left,i=t.top,t.right-e,t.bottom-i):this.a.width=this.size.w)},n.s=function(){this.a.width=this.a.height=0,this.b=y,rm.l.s.call(this)},u(sm,nd),sm.prototype.sb=function(){return this.hb},sm.prototype.getLayer=sm.prototype.sb,sm.prototype.kn=function(){return this.wb},sm.prototype.getSurface=sm.prototype.kn,sm.prototype.gd=function(t){var e=this.wb;t!==e&&(this.wb=t,t.rg(),e&&e.release())},sm.prototype.setSurface=sm.prototype.gd,sm.prototype.s=function(){this.wb.release()},sm.prototype.ae=function(){},sm.prototype.render=sm.prototype.V,u(tm,sm),tm.prototype.V=function(t,e,i,r,n,o,a,s){a=this.hb;var l=this.wb,u=!(C(l,rm)&&"2d"===l.Qd());return r>=a.min&&r<=a.max?(u&&l.vb(!0),a.V(l.K(),{boundingBox:t,zoom:r,screenCenter:e,priorityCenter:o,projection:i,cacheOnly:n,size:l.Bb(),pixelRatio:l.Za(),cameraMatrix:s})):(u&&l.vb(!1),rk.DONE)},tm.prototype.ae=function(){return this.a},t("H.util.animation.Animation",vm),vm.prototype.start=function(){var t=this;this.b=Hk(),this.a=!0;var e=this.b;this.c.ri((function(){if(t.a){var i=Hk(),r=i-t.b,n=r/t.i,o=!1;1<=n&&(n=1,o=!0),t.j(t.f?t.f(n):n,r,i-e,i),e=i,o&&t.stop()}else t.stop()}))},vm.prototype.start=vm.prototype.start,vm.prototype.stop=function(t){this.a=!1,this.c.ni(),t||this.g&&this.g(this)},vm.prototype.stop=vm.prototype.stop,vm.prototype.wa=function(){return this.a},vm.prototype.isRunning=vm.prototype.wa,u(wm,sm),wm.prototype.gd=function(t){wm.l.gd.call(this,t),this.g=t.pc.ownerDocument},wm.prototype.setSurface=wm.prototype.gd;var xm=function(t,e){return C(e=e.da(),th)?e.oa:(t[0]=e,t)}.bind(null,[]);function ym(t,e){var i=t[1].$c(),r=e[1].$c();return Zg(i,r,!0)||t[5]-e[5]||Zg(i,r,!1)}function zm(t,e){zm.l.constructor.apply(this,arguments),this.c=0,this.a=[],this.b=A(this.b,this)}wm.prototype.V=function(t,e,i,r,n,o,a){var s,l,u,c,h=this.hb;if(this.o=e=this.f,this.f=i={},r>=h.min&&r<=h.max){var p=this.wj(t,r,n,o),f=p.markers;if(t=f.length){for(r=[],n=this.wb,o=0;o<t;o++){h=f[o];var d=xm(h);for(s=d.length;s--;)(l=a(d[s]))&&((c=e[u=h.gb()+"_"+s])?delete e[u]:c={rk:h},i[u]=c,r.push([c,h,h.Ab(),n,l.x,l.y]))}for(r.sort(ym),t=r.length,o=0;o<t;o++)this.Ok.apply(this,r[o])}}return!p||p.requested&&p.requested===p.total||!p.requested&&f.length===p.total?rk.DONE:rk.PENDING},wm.prototype.render=wm.prototype.V,wm.prototype.Ha=function(){},wm.prototype.getObjectsAt=wm.prototype.Ha,u(zm,wm),t("H.map.render.dom.MarkerRenderer",zm),zm.prototype.wj=function(){return this.hb.Ec.apply(this.hb,arguments)},zm.prototype.V=function(t,e,i,r,n,o,a){this.b(),this.j=0;var s,l=zm.l.V.apply(this,arguments),u=this.wb,c=this.o;for(s in c)Am(this,u,c[s]);return 0===this.a.length&&l?rk.DONE:rk.PENDING},zm.prototype.render=zm.prototype.V,zm.prototype.gd=function(t){zm.l.gd.call(this,t),this.i=t.Za()},zm.prototype.setSurface=zm.prototype.gd,zm.prototype.b=function(){for(var t,e,i,r=this.a.length;r--;)t=(i=this.a[r]).tf,(e=i.tf.Ab()).ai(i,e,t);this.a.length=0},zm.prototype.Ok=function(t,e,i,r,n,o){var a,s=r.Za(),l=e.Nb();n*=s,o*=s,this.rc||(n=yd(n),o=yd(o)),t.detail&&(l.ee(t.Cn)?Am(this,r,t):a=t.detail),a||(t.detail=a=i.zj(this.g),this.c++,Da(i.ai)&&this.a.push(a)),t.Cn=l.a,a.style.zIndex=this.j++,a.tf=e,r.Uc(a,n,o,0,0)};var Bm,Cm="pointer-events",Dm,Em;function Am(t,e,i){e.clear(e=i.detail),delete e.tf,t.c--,(i=(t=i.rk).Ab()).b&&i.b(e,i,t)}function um(t,e){var i=e||{},r=i.contextType;if(i=i.contextAttributes,um.l.constructor.call(this,e),xc(t,"Function",um,0,"invalid render callback"),r){if(-1===Fm.indexOf(r))throw new D(um,1,"invalid context type");this.Jh=r}i&&(this.b=i),this.c=t}Ze&&(Ze&&Zc!==y&&(Zc=(Em=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+Em[2]:y),Dm=Zc,9===Dm?Cm="display":10===Dm&&(Cm="visibility")),Bm=Cm,zm.prototype.Ha=function(t,e,i){var r,n,o,a,s,l=this.i,u=gf;if(this.c){t/=l,e/=l;var c=(l=this.g).documentElement,h=this.wb.K(),p=h.getBoundingClientRect();for(t+=p.left,e+=p.top;(n=o=l.elementFromPoint(t,e))&&n!==h&&n!==c&&o!==f;){for(;(a=n.parentNode)&&(!Da(a.contains)||!a.contains(h));)n=a;if(a===h&&(n!==o||"svg"!==n.nodeName)&&0>u.indexOf(s=n.tf)&&(u===gf&&(u=[]),u.push(s),i))break;r||(r=[]);var f=n.style;r.push({kj:f.getPropertyValue(Bm),Bn:f.getPropertyPriority(Bm),style:f}),f.setProperty(Bm,"visibility"===Bm?"hidden":"none","important"),f=o}if(r)for(e=r.length;e--;)(t=r[e]).style.removeProperty(Bm),Ac(t.kj)&&t.style.setProperty(Bm,t.kj,t.Bn)}return u},zm.prototype.getObjectsAt=zm.prototype.Ha,zm.prototype.ae=function(){return"dom"},zm.prototype.s=function(){this.a.length=0;var t,e=this.wb,i=this.f;for(t in i)Am(this,e,i[t]);this.wb.B(),zm.l.s.call(this)},u(um,jj),t("H.map.layer.CanvasLayer",um);var Fm=["2d","webgl","webgl2","experimental-webgl"];function Gm(t,e){Gm.l.constructor.call(this,e),xc(t,"Function",Gm,0,"invalid render callback"),this.a=t}function Hm(t,e){if(E(this.b=+t))throw new D(Hm,0,t);this.a=0,e&&this.bl(e)}function Im(t,e){this.a=t,this.b=e}function Jm(t,e,i){var r=[],n={pc:t.a,width:e.w,height:e.h,ta:t.b};for(t=0;t<i.length;t++){var o=(e=i[t]).ae(),a={};Xa(a,n);var s=e.wb;switch(o){case"2d":if(C(e.sb(),um)&&(a.Wg=e.sb().getContextAttributes()),o=c&&"2d"===c.Qd()){o=a.Wg;var l=c.fk;o=!(l!==o&&(l&&!o?l.alpha||l.willReadFrequently:o&&!l?o.alpha||o.willReadFrequently:!o.alpha!=!o.alpha||!l.willReadFrequently!=!o.willReadFrequently))}if(o)var u=!1;else if(s&&!u){var c=s;u=!1}else c=new rm(a.pc,a.width,a.height,a.ta,"2d",a.Wg),u=!0;break;case"dom":c=s||new qm(a.pc,a.width,a.height,a.ta),u=!s;break;default:c=s||new rm(a.pc,a.width,a.height,a.ta,e.sb().Qd(),a.Wg),u=!s}r[r.length-1]!==c&&(c.qe(r.length),r.push(c)),e.gd(c)}return r}n=um.prototype,n.Jh="2d",n.Qd=function(){return this.Jh},n.getContextAttributes=function(){return this.b},n.V=function(t,e){return this.a&&this.a.canvas===t||(this.a=t.getContext(this.Jh,this.b)),this.c(this.a,e)},n.s=function(){um.l.s.call(this),this.a=B},u(Gm,jj),t("H.map.layer.DomLayer",Gm),Gm.prototype.V=function(t,e){return this.a(t,e)},t("H.util.kinetics.KineticMove",Hm),Hm.prototype.bl=function(t){return this.a=t,this},Hm.prototype.setInitialSpeed=Hm.prototype.bl,Hm.prototype.qm=function(){return Math.abs(this.a/this.b)},Hm.prototype.getDuration=Hm.prototype.qm,Hm.prototype.Me=function(t){return this.a+this.b*t},Hm.prototype.getCurrentSpeed=Hm.prototype.Me,Hm.prototype.lm=function(t){return this.a*t+this.b*t*t/2},Hm.prototype.getCurrentPath=Hm.prototype.lm,t("H.util.events.listenOnce",De),t("H.util.events.dispatchEvent",(function(t,e){return t.dispatchEvent(e)})),t("H.util.events.fireListeners",(function(t,e,i,r){return me(t)?t.qd(e,i,r):Me(t,e,i,r)})),t("H.util.events.listen",Ce),t("H.util.events.unlisten",Ke);var Km=Ne;function Al(){Al.l.constructor.call(this),this.b={},this.a={position:new Yf(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new O(Pg([90,-180,90,0,90,180,-90,180,-90,-180]))}}Ne=function(t,e){var i,r,n=!0,o=e[e.currentTarget===e.target?"AT_TARGET":t.capture?"CAPTURING_PHASE":(i=!0,"BUBBLING_PHASE")];return(!i||"pointerenter"!==(r=e.type)&&"pointerleave"!==r)&&(e.eventPhase=o,n=Km(t,e),i&&t.src&&t.src.Ob&&null===t.src.Ob()&&delete e.eventPhase),n},u(Al,F),t("H.map.ViewModel",Al),Al.prototype.v={Ca:"update",xe:"sync"},Al.prototype.Yb=function(t,e){if(!t)throw new D(this.Yb,0,t);var i=t[Lm];if(uc(i)&&!Zf(i))throw new D(this.Yb,0,Lm);if(uc(i=t[Mm])&&E(+i))throw new D(this.Yb,0,Mm);if(uc(i=t[Nm])&&!C(i,Wf))throw new D(this.Yb,0,Nm);return i=Om(t=x.Object.assign({},t),this.b,this.a),Pm(this,this.b,t),this.dispatchEvent(new Qm(this.b,i,e)),this},Al.prototype.setLookAtData=Al.prototype.Yb,Al.prototype.lb=function(){var t={};return t[Lm]=$f(this.a[Lm]),Pm(this,t,this.a,!0),t},Al.prototype.getLookAtData=Al.prototype.lb;var Lm="position",Mm="zoom",Nm="bounds",Rm={Zi:Lm,bj:Mm,Ti:"heading",aj:"tilt",Ui:"incline",Ri:Nm},Sm=Object.keys(Rm).map((function(t){return Rm[t]}));function Pm(t,e,i,r){t.g={},t.f={},t.c=[];for(var n,o,a,s=t.j,l=t.i,u=Sm.length;u--;)if(a=i[n=Sm[u]],null==(o=e[n])||!r)if(null!=a){uc(s)&&s.call(t,n,o,a);var c,h=n;if((c="position"!==n)||(c=!(!(c=a)||E(c.lat)||E(c.lng))),e[h]=c?a:$f(a),uc(l)){switch(n){case"position":o=a&&o&&(a.lat!==o.lat||a.lng!==o.lng);break;case"bounds":o=a&&o&&!a.na(o);break;default:o=a!==o}o&&l.call(t,n)}}else delete e[n]}Al.prototype.j=function(t,e,i){this.g[t]=e,this.f[t]=i},Al.prototype.i=function(t){this.c.push(Tm[t])};var Tm=Sm.reduce((function(t,e){return t[e]=aj[e.toUpperCase()],t}),{});function Om(t,e,i){var r=0;return["tilt","incline","heading",Mm].forEach((function(n){if(E(t[n])){var o=E(e[n])?i[n]:e[n];t[n]=o}else r|=Tm[n]})),[Lm,Nm].forEach((function(n){t[n]?r|=Tm[n]:t[n]=e[n]||i[n]})),r}function Um(t,e){return t|e}function Qm(t,e,i){Qm.l.constructor.call(this,Al.prototype.v.Ca,t,null,e),this.b=this.animate=!!i}function S(t,e,i,r){if(S.l.constructor.call(this,t,e,i,r),this.rb=new Lk(100),this.ha=new I(0,0),this.He=!!r.enableSubpixelRendering,this.Oc=Vm,this.m=new dm,this.i=r=new lm,this.Pc=A(this.Pc,this),r.addEventListener(r.v.Gg,this.Pc),r=t.element,this.L=t=r.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,r.insertBefore(t,r.firstChild),this.Kd=new Im(this.L,this.ta),this.W=e.lb().position,!(e=x.H.gl))throw new Yc(S,'"H-webgl" module is missing');for(this.a=new Kl({viewport:this.g,pc:this.L,devicePixelRatio:this.ta,yk:A(this.fa,this)}),e.WorkerBroker.addTarget("model",lj),t=0,r=(e=this.c.Na()).length,this.j={Tc:[],ia:[]},this.f=e;t<r;t++){var n=e[t];this.Ve(t,n),Dl(this,n,!0)}this.Hb(),this.Qc=A(this.Qc,this),this.Ph=A(this.Ph,this),this.Ga=A(this.Ga,this),i.addEventListener(jj.prototype.v.ue,this.Qc),this.ra=Wm,this.zoom=El(this,this.A.ub()),this.Hb(),this.R()}Al.prototype.ab=function(t){var e={},i={};Pm(this,this.a,t),this.b={},e.lookAt=this.f,i.lookAt=this.g,t=(t=this.c).length?t.reduce(Um):0,this.dispatchEvent(new $i(this.v.xe,e,i,t))},Al.prototype.synchronize=Al.prototype.ab,Al.prototype.lf=function(t,e){if(E(t=+t))throw new D(this.lf,0,Mm);this.Yb({zoom:t},e)},Al.prototype.ub=function(){return this.a.zoom},Al.prototype.nc=Oc,Al.prototype.startControl=Al.prototype.nc,Al.prototype.control=Oc,Al.prototype.control=Al.prototype.control,Al.prototype.yb=Oc,Al.prototype.endControl=Al.prototype.yb,u(Qm,$i),u(S,yl),t("H.map.render.webgl.RenderEngine",S),S.prototype.lb=function(){var t=this.W;return Fl(this,{position:{Nn:t.Nn,Rn:t.Rn},zoom:this.zoom,tilt:this.pl,heading:this.heading})},S.prototype.Qc=function(t){((t=(t=t.target.ea())&&t.tb())&&t.getState())===Zh.INIT?t.load():(Nl(this.a),Pl(this.a,this.c),this.fa())},S.prototype.type=Il.WEBGL;var Wm=2;function Xm(t,e,i){return(e=i-e)<(t=Ed(2,8+t.zoom))/2?e:e-t*i/Bd(i)}function Ym(t,e,i){function r(t){return n[t]+am(n[t],e[t])/2}if(!(i&aj.POSITION||i&aj.BOUNDS))return null;var n=Ol(t.a).getLookAtData();i=n.position;var o=e.position,a=e.bounds;return zi(n.bounds,o.lat,o.lng,!1)||a&&zi(a,i.lat,i.lng,!1)?null:((i=Zm(t,{tilt:r("tilt"),heading:r("heading"),incline:0,bounds:fg([i,o])})).zoom=El(t,i.zoom-.5),delete i.bounds,i)}function $m(t,e,i,r){return t=(t=t.getCapabilities().lookAt[r]).max-t.min,Bd("zoom"===r?i[r]-e[r]:am(e[r],i[r]))/t||0}function an(t,e,i){return Zd(3e3*(t=xd(8*$m(t,e,i,"zoom"),$m(t,e,i,"heading"),$m(t,e,i,"tilt")/2)),300,4e3)}function Zm(t,e){return en(e),Ol(t.a).getBestLookAtData(e)}function en(t){var e=t.bounds;!e||e instanceof O||(t.bounds=wi(e.I()))}function gn(t,e,i){Ol(t.a).setLookAtData(e),Nl(t.a),fn(t),t.fa(),i&&setTimeout(i,0)}function dn(t,e,i,r){var n=Ol(t.a).getLookAtData(),o=new $l(n,e);0!==o.a.tilt+o.a.heading+o.a.zoom+o.c?hn(t,(function(e){for(var i in o.a)if(0!==o.a[i]){var r=o.i[i](e);n[i]+=o.a[i]*(r-o.g[i]),o.g[i]=r}return 0!==o.c&&(n.position=o.b.Cg(o.j,o.c*o.i.position(e),!0)),gn(t,n)}),i,(function(){return gn(t,e,r)})):gn(t,e,r)}function jn(t,e){t.rb.qa((function(t,i){return i.Ob()===e}))}function kn(t){return!(C(t,Gm)||C(t,um))}function cn(t,e){var i=e.position;return Fl(t,{zoom:El(t,e.zoom),position:new Yf(i.lat,i.lng),tilt:e.tilt,heading:e.heading,bounds:e.bounds})}function fn(t){var e=Ol(t.a).getLookAtData();t.zoom=e.zoom,t.W=e.position}function mn(t,e){return new I((t=Ol(t.a).geoToMeters(e)).x/40075016.68557849+.5,1-(t.y/40075016.68557849+.5))}function nn(t,e){return e.sub(mn(t,t.W)).scale(Ed(2,8+t.zoom))}function on(t,e,i,r,n,o,a,s){var l,u,c,h=0,p=function(){0==--h&&o(n)};if(s&&s.features)for(h=u=s.features.length,c=0;c<u;c++){var f=s.features[c],d=f.id;if(l=t.a.a.sources[f.source_name]){var y=l.provider,g=y.Kj();if(g===hk.SOURCE){var v=f.source_layer;if("overlays"===v)pn(t,e,i,r,n,l,f.properties.overlays_config);else if(l=l.getMapObjectById(d))if("markers"!==v)n.push(l);else if(qn(t,e,i,l))n.push(l);else if(r&&!a){var m=!0;Sl(t.a,{x:e,y:i},{radius:rn,top_most_only:!1},(function(a){on(t,e,i,r,n,o,!0,a)}))}h--}else g===hk.FEATURE?(v=f.tile.coords,(m=y.getFeatureProxy(f.properties,v,(function(t){if(t){for(var e,i=t;i&&(e=i.Ob())&&e!==y;)i=e;e||i.ja(y),n.push(t)}p()})))||((l=t.rb.get(d))||((l=new Tg(f)).ja(y),t.rb.add(d,l,1)),n.push(l),h--)):g===hk.PROVIDER&&(m=!0,y.Pk(f,!1).then((function(t){t&&(!(t instanceof Wi)||qn(this,e,i,t))&&n.push(t),p()}),(function(){p()}),t))}}g&&(m||0!==h)||o(n)}function pn(t,e,i,r,n,o,a){var s;for(t=t.Va(e,i),e=a.length;e--&&(!(s=o.getMapObjectById(a[e].id))||0<=n.indexOf(s)||!s.da().md(t)||(n.push(s),!r)););}function qn(t,e,i,r){var n,o=r.Ab(),a=o.f,s=!a;if(a)if(e+=(o=o.rd()).x,i+=o.y,C(o=r.da(),Si))for(n=(r=o.oa).length;n--&&!s;)o=t.Ga(r[n]),s=a.Vf(e-o.x,i-o.y,0)!==be.NONE;else o=t.Ga(o),s=a.Vf(e-o.x,i-o.y,0)!==be.NONE;return s}function sn(t,e,i,r,n){for(var o,a=e.length;a--&&!((o=e[a])&&o.Ha&&(t=t.concat(o.Ha(i,r,n)),t.length&&n)););return t}function ln(t){return{w:(t=t.kd[2]).right-t.left,h:t.bottom-t.top}}function tn(t){t.b&&t.b.wa()||(Ml(t.a)||Hk()-t.Da<t.Oc)&&!t.F?t.$f||(t.$f=Rk(t.Ph)):(t.F&&(t.le(),un(t)),t.ra=Wm)}function un(t,e){t.ld||setTimeout(A(t.dispatchEvent,t,{type:t.v.$i,target:e||t}),1)}function wn(t,e,i){Ol(t.a).applyPxOffset([e,i]),fn(t),t.ha.set(0,0),Nl(t.a),t.fa()}function xn(t,e,i,r){Ol(t.a).setLookAtData({zoom:e},Dc(i)&&Dc(i)?[i,r]:B),fn(t),Nl(t.a),t.fa()}function bn(t){vn(t),t.i.wa()&&t.yb(!0),t.m.wa()&&t.zb(!0)}function yn(t,e){if(e){var i={};i.Ze=e.power,i.Ee=e.ease,i.duration=e.duration,t.u=i}}function An(t,e){var i=nn(t,mn(t,e.position)),r=i.y;i=i.x;var n=e.zoom,o=nn(t,mn(t,t.W));e=o.y;var a=o.x;o=t.zoom;var s=t.i.Cb(),l=t.i.b,u=t.i.c,c=0;if(i=Xm(t,a,i),e=Dd((i-=a)*i+(r-=e)*r+(o=n-o)*o),0!==s&&0!==e){var h=i/e,p=r/e,f=o/e,d=s*s/(2*e);hn(t,(function(e,i){var r;1!==e?((r=f*(i=(e=s*i-d*i*i/2)-c))&&(r=El(t,t.zoom+r),xn(t,r,l,u)),wn(t,yd(h*i),yd(p*i)),c=e):(xn(t,El(t,n),l,u),t.fa())}),2*e/s)}}function zn(t,e,i){i=i||0;var r=t.i,n=Ol(t.a),o=n.getLookAtData();e.ob&&xn(t,El(t,o.zoom+e.ob*i),r.b,r.c),n.setLookAtData({heading:Hl(t,o.heading+e.ne*i),tilt:Gl(t,o.tilt+e.me*i)}),fn(t),wn(t,e.mb*i,e.nb*i)}function hn(t,e,i,r,n){t.b&&t.b.wa()&&t.b.stop(!0),t.b=new vm(t,e,i,r,n),t.b.start()}function vn(t){t.b&&t.b.wa()&&t.b.stop(!0)}S.prototype.getState=function(){return this.ra},S.prototype.getState=S.prototype.getState,S.prototype.ld=!1,S.prototype.Xg=function(t){var e=this,i=t.newValue,r=t.modifiers,n=Ol(this.a);bn(this),this.ha.set(0,0);var o=cn(this,i);if(Sm.forEach((function(e){r&t[e.toUpperCase()]||delete o[e]})),t.b){n=Ol(this.a).getLookAtData();var a=Zm(this,o);i=Ym(this,a,r);var s=function(){return e.ld=!1};if(delete a.bounds,this.ld=!0,i){n=an(this,n,i);var l=an(this,i,a);dn(this,i,n,(function(){return dn(e,a,l,s)}))}else i=an(this,n,a),dn(this,a,i,s)}else en(o),n.setLookAtData(o);fn(this),Nl(this.a),this.fa()},S.prototype.tg=function(){},S.prototype.setAnimationDuration=S.prototype.tg,S.prototype.gh=function(){},S.prototype.getAnimationDuration=S.prototype.gh,S.prototype.ug=function(){},S.prototype.setAnimationEase=S.prototype.ug,S.prototype.hh=function(){},S.prototype.getAnimationEase=S.prototype.hh,S.prototype.qg=function(){},S.prototype.resetAnimationDefaults=S.prototype.qg,n=S.prototype,n.wk=function(t){jn(this,t.target.ea()),Nl(this.a),this.fa()},n.Ve=function(t,e){S.l.Ve.call(this,t,e),kn(e)&&(Nl(this.a),(t=(t=e.ea())&&t.tb())&&t.getState()===Zh.INIT&&t.load())},n.ci=function(t,e,i){var r;if(this.Da=Hk(),jn(this,e.ea()),e.requestDomMarkers||C(e,um)||C(e,Gm)){var n=this.j.ia;for(r=n.length;r--;){var o=n[r];if(o.sb()===e){n.splice(r,1),o.B();break}}}kn(e)&&Pl(this.a,this.c),this.f=this.c.Na(),0===t&&(Dl(this,e,!1),this.Hb()),Jm(this.Kd,ln(this),this.j.ia.filter(uc)),this.le(),i||this.fa()},n.di=function(){this.Hb()},n.Hb=function(){S.l.Hb.call(this);var t=this.getCapabilities().lookAt.zoom;Ol(this.a).setZoomConstraints(xd(t.min,this.Jg),wd(t.max,this.Eg))},n.yh=function(t,e){var i;if(e){if(t={rc:this.He,ib:this.ib},e.V?(C(e,um)||C(e,Gm))&&(i=new tm(e)):e.requestDomMarkers&&(i=new zm(e,t)),i){this.j.ia.push(i);var r=this.c.Na();this.j.ia.sort((function(t,e){return r.indexOf(t.hb)-r.indexOf(e.hb)})),Jm(this.Kd,ln(this),this.j.ia.filter(uc))}kn(e)&&Pl(this.a,this.c)}this.f=this.c.Na()},n.Ga=function(t){return Ol(this.a).geoToPixel(t)},S.prototype.geoToScreen=S.prototype.Ga,S.prototype.Va=function(t,e){return Ol(this.a).xyToGeo(t,e)},S.prototype.screenToGeo=S.prototype.Va,S.prototype.sg=function(t,e){return t=this.Va(t,e),(e=this.A.lb()).position=t,e},S.prototype.Ha=function(t,e,i,r){var n=this,o=[];o=sn(o,this.j.ia,t*this.ta,e*this.ta,i),i&&o.length?r(o):this.a.a.initialized?Sl(this.a,{x:t,y:e},{radius:rn,top_most_only:i},(function(a){on(n,t,e,i,o,r,!1,a)})):r(o)},S.prototype.getObjectsAt=S.prototype.Ha,S.prototype.Ea=y,S.prototype.R=function(){var t=this.j.ia.length;zl(this,this.ta),this.ha.set(0,0);var e=ln(this),i=e.w,r=e.h;for(this.a.a.handleViewportUpdate();t--;){var n=(e=this.j.ia[t].wb).Bb();n.w===i&&n.h===r||e.kf(i,r)}this.Ea=new Ti(i,r),Nl(this.a),this.fa()},S.prototype.getCapabilities=function(){return Jl},S.prototype.getCapabilities=S.prototype.getCapabilities,n=S.prototype,n.$f=0,n.le=function(){this.j.Tc.length=0},n.Ph=function(){this.$f=0,this.T&&this.T.before();var t=Ol(this.a),e=t.getLookAtData(!1),i=t.getLookAtData(!0);t=this.g.center.clone(),i=i.bounds.I();var r=this.zoom,n=this.ha,o=this.f,a=o.length;for(this.Oc=Vm;a--;){var s=o[a];C(s,jj)&&s.ea()&&s.ea().$e(i,r)}this.F=this.a.V(),this.A.ab(e),e=this.F,a=(o=this.j).ia.length;var l,u=!0;for(l=0;l<a;l++){s=o.ia[l];var c=o.Tc;if(s){var h=s.V(i,t,void 0,r,!1,n,this.Ga,this.a.a.getCameraMatrix());h===rk.ACTIVE&&(this.Oc=1/0),h!==rk.DONE||c[l]||(un(this,s.sb()),c[l]=!0),c[l]||(u=!1)}}this.F=e&u,this.Ea&&(this.g.ab(this.Ea),this.Ea=y),this.b&&this.b.wa()&&this.Hg(),this.T&&this.T.after(),tn(this)},n.s=function(){var t=this.c.Na()[0],e=this.g;Sk(this.$f),vn(this),t&&Dl(this,t,!1),this.j.ia.filter(uc).forEach((function(t){t.B()})),e.element&&e.element.removeChild(this.L),this.L=null,this.ra=3,this.a.B(),S.l.s.call(this)},n.fa=function(){this.Da=Hk(),this.ra===Wm&&(this.F=!1,this.ra=1,tn(this))},n.se=function(t,e,i){xn(this,t=El(this,El(this,t)),e,i)},S.prototype.zoomAt=S.prototype.se,S.prototype.oc=function(t,e){var i=!!(e||t&(Cl.HEADING|Cl.TILT));bn(this),yn(this,e),this.m.start(t,i),Ol(this.a).setPanning(!0)},S.prototype.startInteraction=S.prototype.oc,S.prototype.fc=function(t,e,i,r,n){var o=this.m,a=!1;if(o.wa()){var s=Ol(this.a),l=s.getLookAtData(),u=this.g.center;u=[u.x,u.y],e=o.store(t,e,i,r,n),i=o.Jf(),t=o.Wd(),n=this.m.Kf(),r=this.m.ih(),o.c&&(o.Bc(Cl.TILT)&&(s.setLookAtData({tilt:Gl(this,l.tilt+t.y/this.g.height*-180)},u),a=!0),e&&1!==n&&o.Bc(Cl.ZOOM)&&(a=o.Jf(),xn(this,El(this,n=Cd(Ed(2,this.zoom)*n)/Md),a.x,a.y),a=!0),o.Bc(Cl.COORD)&&0<cm(t)&&(wn(this,-t.x,-t.y),a=!0),o.Bc(Cl.HEADING)&&(e?s.setLookAtData({heading:l.heading+Hl(this,r)},[i.x,i.y]):t.x&&s.setLookAtData({heading:Hl(this,l.heading+t.x/this.g.width*360)},u),a=!0),a&&(Nl(this.a),this.fa()))}},S.prototype.interaction=S.prototype.fc,S.prototype.zb=function(t){var e=this;if(this.m.wa()&&!t){if(this.u){t=this.m.Cb();var i=this.m.tc(),r=this.u.duration,n=(this.u.Ze||1)*t,o=new Hm(-n/(0<r?r:1),n);!E(i.x)&&!E(i.y)&&0<n&&e.m.Bc(Cl.COORD)&&hn(this,(function(t){n=o.Me(t*r),E(n)||wn(e,yd(-i.x*n),yd(-i.y*n))}),r,void 0,this.u.Ee)}this.u=null,this.m.clear()}Ol(this.a).setPanning(!1),this.fa()},S.prototype.endInteraction=S.prototype.zb,S.prototype.nc=function(t,e,i){bn(this),this.i.start(e,i),yn(this,t),Ol(this.a).setPanning(!0)},S.prototype.startControl=S.prototype.nc,S.prototype.control=function(t,e,i,r,n,o){for(var a,s=0;s<arguments.length;s++)if((a=+arguments[s])!=a)throw new D(this.control,s,a);this.i.wa()&&this.i.set(t,e,i,r,n,o)},S.prototype.control=S.prototype.control,S.prototype.yb=function(t,e){var i,r=this;if(this.i.wa()){vn(this);var n=Hk(),o=n-this.la;if(1<=o&&zn(this,om(this.i),o),!this.u||t||e)"function"==typeof e&&(e(t=(t=Ol(this.a)).getLookAtData()),An(this,t));else{e=this.i.Cb();var a=this.i.tc(),s=this.u.duration,l=(this.u.Ze||1)*e,u=new Hm(-l/(0<s?s:1),l);!E(a.mb)&&!E(a.nb)&&0<l&&hn(this,(function(t,e,o,c){n&&(o=c-n,n=0),l=u.Me(t*s)*o,E(l)||((i=a.ob*l)&&xn(r,El(r,r.zoom+i),r.i.b,r.i.c),wn(r,yd(a.mb*l),yd(a.nb*l)))}),s,void 0,this.u.Ee)}this.i.reset(),Ol(this.a).setPanning(!1),this.fa()}},S.prototype.endControl=S.prototype.yb,S.prototype.Pc=function(t){var e=this,i=t.c;this.ha.set(0,0),i.mb||i.nb||i.ob||i.me||i.ne||i.gf?(this.la=Hk(),hn(this,(function(t,r,n,o){e.la=o,zn(e,i,n)}),Ud),this.fa()):vn(this)},S.prototype.bh=function(){},S.prototype.enter=S.prototype.bh,S.prototype.If=function(t){Bl(this.L,t)},S.prototype.exit=S.prototype.If,S.prototype.capture=function(t,e,i,r){var n=this;return Tl(n.a).then((function(o){var a=n.L.ownerDocument.createElement("canvas"),s=n.ta,l=a.getContext("2d"),u=n.a.Za()/s,c=(i-t)*s;return s*=r-e,a.width=c,a.height=s,l.drawImage(o,t*u,e*u,c*u,s*u,0,0,c,s),a}))},S.prototype.Yl=function(t){return Ol(this.a).geoToMeters(t)},S.prototype.geoToMeters=S.prototype.Yl,S.prototype.co=function(t){return Ol(this.a).metersToGeo(t)},S.prototype.metersToGeo=S.prototype.co;var Vm=5e3,rn=3.5;function T(t,e,i){var r={};if(T.l.constructor.call(this),this.P=A(T.prototype.P,this),this.j=Bn(i,T),this.c=i=new Al,this.L=!1,i.addEventListener(i.v.xe,this.la,!1,this),!C(t,Element))throw new D(T,0,t);var n=(i=this.S=t.ownerDocument.createElement("div")).style;if(n.position="relative",n.height=i.style.width="100%",n.overflow="hidden",n.webkitTapHighlightColor="transparent","transparent"!==n.webkitTapHighlightColor&&(n.webkitTapHighlightColor="rgba(0,0,0,0)"),t.appendChild(i),this.b=new sk(this.S,this.j),this.b.addEventListener(this.b.v.xe,this.la,!1,this),(t=this.a=new lj(this.j.layers)).addEventListener(t.v.we,this.R,!1,this),t.addEventListener(t.v.te,this.R,!1,this),t.addEventListener(t.v.ve,this.R,!1,this),!this.g&&Cn(this),this.f=null,this.a.add(e,0),this.i=this.A(null!=this.j.engineType?this.j.engineType:ek.WEBGL,this.j),this.F=A(this.F,this),this.T=A(this.T,this),(e=this.j.imprint)!==B&&"object"!=typeof e)throw new D(T,1,"imprint");this.m=null===e?e:new uj(this,e),e=this.j.autoColor,this.ha=e===B||!!e,Dn(this),(e=this.j.zoom)&&(r.zoom=e),(e=this.j.bounds)&&(r.bounds=e),(e=this.j.center)&&(r.position=e),this.c.Yb(r)}function Bn(t,e){if(t){var i=t.pixelRatio;if(i===B)t.pixelRatio=Te();else if(!(0<i))throw new D(e,0,"pixelRatio: "+i)}else(t={}).pixelRatio=Te();return t.renderBaseBackground||(t.renderBaseBackground={lower:3,higher:2}),t}function Dn(t){t.m&&t.ha&&t.m.zi({invert:t.f&&t.f.Ol})}function En(t,e,i){t.dispatchEvent(i?new $i(t.v.Vi,i.newValue,i.oldValue,i.modifiers):t.v.Vi+e)}function Fn(t){qj.call(this,t)}function Cn(t){t.o=new N({max:24}),t.g=new ul(t.o,t.j),t.a.add(t.g)}u(T,F),t("H.Map",T),T.prototype.s=function(){this.ha=!1,this.m&&this.m.B(),this.i.dispose(),this.c.B(),this.b.B(),this.g.B(),this.o.B(),this.a.B();var t=this.S;t.parentNode.removeChild(t),this.S=null,F.prototype.s.call(this)},T.prototype.K=function(){return this.S},T.prototype.getElement=T.prototype.K,T.prototype.Za=function(){return this.j.pixelRatio},T.prototype.getPixelRatio=T.prototype.Za,T.prototype.R=function(t){var e=t.added,i=t.removed;e&&e.ea()&&e.ea().ja(this),i&&i.ea()&&i.ea().ja(null),i===this.g&&(this.o=this.g=null),i===this.f&&(this.f=null),0===t.idx&&(this.dispatchEvent(new Wg(this.v.uf,this.f=t.type!==this.a.v.ve?e:0<this.a.a.length?this.a.get(0):y,t.type!==this.a.v.te?i:1<this.a.a.length?this.a.get(1):y)),Dn(this))},T.prototype.la=function(t){t.modifiers&&(this.L||(En(this,"start"),this.L=!0),En(this,"",t),this.W&&x.clearTimeout(this.W),this.W=x.setTimeout(this.T,333))},T.prototype.T=function(){En(this,"end"),this.L=!1},T.prototype.vg=function(t,e){return this.i.getCapabilities().lookAt&&this.c.Yb({position:t},!!e),this},T.prototype.setCenter=T.prototype.vg,T.prototype.fb=function(){var t=this.c.lb();return t?t.position:y},T.prototype.getCenter=T.prototype.fb,T.prototype.lf=function(t,e){return this.c.lf(t,!!e),this},T.prototype.setZoom=T.prototype.lf,T.prototype.ub=function(){return this.c.ub()},T.prototype.getZoom=T.prototype.ub,T.prototype.se=function(t,e,i){this.i.zoomAt(t,e,i)},T.prototype.zoomAt=T.prototype.se,T.prototype.un=function(){return this.b},T.prototype.getViewPort=T.prototype.un,T.prototype.tn=function(){return this.c},T.prototype.getViewModel=T.prototype.tn,T.prototype.Jm=function(){return this.a},T.prototype.getLayers=T.prototype.Jm,T.prototype.Dm=function(){return this.m},T.prototype.getImprint=T.prototype.Dm,T.prototype.capture=function(t,e,i,r,n,o){function a(t,e){d?t.cancel():(u.save(),e.capture(l,p,(function(e){u.restore(),t.done(e)}),(function(e){t.done(null,e),s(null)})))}function s(e){d||(d=!0,t(e))}var l,u,c=this.cc(),h=c.getCapabilities(),p=this.j.pixelRatio,f=this.b,d=!1,g=this;if(!Da(t))throw new D(this.capture,0,t);i=i||0,r=r||0,n=n||f.width,o=o||f.height;var v=xd(0,wd(i,n)),m=xd(0,wd(r,o));i=wd(f.width,xd(i,n)),r=wd(f.height,xd(r,o)),h.capture?c.capture(v,m,i,r).then((function(t){var i=g.m,r=e||[];u=(l=t).getContext("2d"),l.style.width=l.width/p+"px",l.style.height=l.height/p+"px";var n=new Fk(10,a);(r=r.concat(i).filter((function(t){return Da(t&&t.capture)}))).length?(t=r.pop(),r.forEach((function(t){n.push(t,id)})),n.push(t,A(s,g,l)),Bk(n)):s(l)}),(function(){s(y)})):t(null)},T.prototype.capture=T.prototype.capture,T.prototype.cc=function(){return this.u||this.i},T.prototype.getEngine=T.prototype.cc,T.prototype.$k=function(t){return this.i.type===t||this.ra||(this.ra=!0,this.u=this.A(t),this.u.addEventListener("render",this.F)),this},T.prototype.setEngineType=T.prototype.$k,T.prototype.F=function(t){t.target===this.u&&(this.u.removeEventListener("render",this.F),this.i.If(this.P))},T.prototype.P=function(){var t=this.i.type;this.i.B(),this.i=this.u,this.u=B,this.ra=!1,this.dispatchEvent(new Wg(this.v.wl,this.i.type,t))},T.prototype.A=function(t,e){if(e=e?Bn(e,this.A):this.j,Dn(this),t===ek.P2D)return new x.H.map.render.p2d.RenderEngine(this.b,this.c,this.a,e);if(t===ek.WEBGL)return new S(this.b,this.c,this.a,e);if(t===ek.HARP)return new x.H.map.render.harp.RenderEngine(this.b,this.c,this.a,e);throw new D(this.$k,0,t)},T.prototype.pf=function(t,e,i,r,n){if(e=uc(e)?C(e,K,this.pf,1,e)&&e:this.c.lb().bounds.I(),!C(n=n||this.f,kl))throw new D(this.pf,4);var o=n.ea(),a=this.Za(),s=n.tileSize;if(2<=a&&256<s&&o instanceof Ak&&(s/=2),a=this.ub(),s=Math.log2(s)-8,!((i=uc(i)?+i:a)<=(r=uc(r)?+r:a)))throw new D(this.pf,B,"!(min <= max)");a=o.min;var l=o.max,u=this.cc().type===ek.WEBGL?zd:yd;if(i=Zd(u(i)-s,a,l),r=Zd(u(r)-s,a,l),!(o&&C(o,R)&&md()&&o.Tg()))throw new Yc(this.pf,"Storing is not supported");return new vk(n,o,e,i,r,t)},T.prototype.storeContent=T.prototype.pf,u(Fn,qj),Fn.prototype.g=function(){sj(this,2)},Fn.prototype.f=function(){sj(this,4)},T.prototype.Nl=function(t){return t=new Fn(t),ld().clear(A(t.g,t),A(t.f,t)),t},T.prototype.clearContent=T.prototype.Nl,T.prototype.Mg=function(t,e){var i=this.a,r=i.indexOf(t),n=e!==+e;return e=n?i.a.length-1:e,0>r?i.add(t,e):r-e&&(i.jc(r),i.add(t,n?e-1:e)),this},T.prototype.addLayer=T.prototype.Mg,T.prototype.cf=function(t){var e=this.a.indexOf(t);return t!==this.f&&t!==this.g&&-1!==e&&this.a.jc(e),this},T.prototype.removeLayer=T.prototype.cf,T.prototype.Fd=function(t){return this.f!==t&&(this.a.a.length&&this.a.get(0)!==this.g?this.a.set(0,t):this.a.add(t,0),this.f=t),this},T.prototype.setBaseLayer=T.prototype.Fd,T.prototype.dm=function(){return this.f},T.prototype.getBaseLayer=T.prototype.dm,T.prototype.Ga=function(t){if(!Zf(t))throw new D(this.Ga,0,t);return(t=this.i.geoToScreen(t))?xf(t):y},T.prototype.geoToScreen=T.prototype.Ga,T.prototype.Va=function(t,e){var i;if(i=+E(t)||2*E(e))throw new D(this.Va,i-1,arguments[i-1]);return(i=this.i.screenToGeo(t,e))?$f(i):y},T.prototype.screenToGeo=T.prototype.Va,T.prototype.sg=function(t,e){return this.i.screenToLookAtData(t,e)},T.prototype.screenToLookAtData=T.prototype.sg,T.prototype.ca=function(t){if(!C(t,M))throw new D(this.ca,0,t);return!this.g&&Cn(this),this.o.ec().ca(t),t},T.prototype.addObject=T.prototype.ca,T.prototype.Ja=function(t){if(!C(t,M))throw new D(this.Ja,0,t);return!this.g&&Cn(this),this.o.ec().Ja(t),t},T.prototype.removeObject=T.prototype.Ja,T.prototype.Ua=function(t){return!this.g&&Cn(this),this.o.ec().Ua(t)},T.prototype.getObjects=T.prototype.Ua,T.prototype.$b=function(t){var e;zc(t,this.$b,0,t),!this.g&&Cn(this);var i=t.length;for(e=0;e<i;e++)this.ca(t[e]);return this},T.prototype.addObjects=T.prototype.$b,T.prototype.Cd=function(t){var e;zc(t,this.Cd,0,t),!this.g&&Cn(this);var i=t.length;for(e=0;e<i;e++)this.Ja(t[e]);return this},T.prototype.removeObjects=T.prototype.Cd,T.prototype.Xd=function(t,e,i){var r;if(r=+E(t)||2*E(e))throw new D(this.Xd,r-1,arguments[r-1]);this.i.getObjectsAt(t,e,!0,(function(t){i(t[0])}))},T.prototype.getObjectAt=T.prototype.Xd,T.prototype.Ha=function(t,e,i){var r;if(r=+E(t)||2*E(e))throw new D(this.Xd,r-1,arguments[r-1]);this.i.getObjectsAt(t,e,!1,i)},T.prototype.getObjectsAt=T.prototype.Ha,T.prototype.ph=function(t,e,i){var r=i||hf;i=r.visiblesOnly;var n=r.zoom;r=r.types;var o=Yg.ANY;C(t,O,this.ph,0,"area"),xc(e,"Function",this.ph,1,"callback"),this.o.Ua(t,!uc(i)||!!i,uc(n)?+n:this.c.ub(),uc(r)?r&o:o,e)},T.prototype.getObjectsWithin=T.prototype.ph;var ek={P2D:Il.P2D,WEBGL:Il.WEBGL};function Gn(t,e){Gn.l.constructor.call(this,t,e)}function Hn(t,e){Hn.l.constructor.call(this,sh,e),this.oe(t)}function pk(t,e,i){var r="anonymous",n=1;this.b=A(this.b,this),M.call(this,i),this.ba(t),i&&((t="crossOrigin")in i&&(r=i[t]),(t="opacity")in i&&(n=i[t])),this.Zk(e,r),this.kc(n)}function In(t){if(!t||!Da(t.requestData))throw new D(In,0,"options.requestData");In.l.constructor.call(this,t),this.L=t.requestData,this.A=!!t.providesDomMarkers}function Jn(t,e){Jn.l.constructor.call(this,t,e)}T.EngineType=ek,ek.HARP=Il.HARP,T.prototype.v={Xo:"mapviewchangestart",Vi:"mapviewchange",Wi:"mapviewchangeend",uf:"baselayerchange",wl:"enginechange"},u(Gn,Wi),t("H.map.Marker",Gn),n=Gn.prototype,n.type=Yg.MARKER,n.Dg=1,n.xa=function(t){if(t!==Vg.VISUAL||1===this.Hk||1===this.icon.getState())var e=Gn.l.xa.call(this,t);return e||!1},n.Hk=0,n.ak=function(t){return C(t,Rj)},n.Bh=!1,n.vk=function(){this.xa(Vg.VISUAL)},n.Jc=function(t){var e=this.icon;return this.Bh&&(e.removeEventListener("statechange",this.vk,!1,this),delete this.Bh),e&&(this.Hk=e.getState()),Gn.l.Jc.call(this,t),0===t.getState()&&(this.Bh=!0,De(t,"statechange",this.vk,!1,this)),this},Gn.prototype.setIcon=Gn.prototype.Jc,Gn.prototype.b=function(t){return new Rj(t.svg,t)},Gn.prototype.X=function(){var t=this.getIcon(),e=t.Io||0,i=Gn.l.forWorkerMessage.call(this),r=i.properties.icon;return r&&0<e&&Xa(r,{stick_color:t.Ho,stick_height:e}),i},Gn.prototype.forWorkerMessage=Gn.prototype.X,u(Hn,Gi),t("H.map.Rect",Hn),Hn.prototype.oe=function(t){if(!C(t,K))throw new D(this.oe,0,t);t.na(this.ha)||(this.ha=this.O=t,this.a!==y&&Hn.l.ba.call(this,wi(t)))},Hn.prototype.setBoundingBox=Hn.prototype.oe,Hn.prototype.I=function(){return this.O},Hn.prototype.getBoundingBox=Hn.prototype.I,Hn.prototype.ba=function(){return this},Hn.prototype.setGeometry=Hn.prototype.ba,Hn.prototype.da=function(){return this.a||Hn.l.ba.call(this,wi(this.ha)),this.a},Hn.prototype.getGeometry=Hn.prototype.da,u(pk,M),t("H.map.Overlay",pk),pk.prototype.type=Yg.OVERLAY,pk.prototype.I=function(){return this.O},pk.prototype.getBoundingBox=pk.prototype.I,pk.prototype.oe=function(t){return C(t,K,this.oe,0,t),this.ba(t)},pk.prototype.setBoundingBox=pk.prototype.oe,pk.prototype.da=function(){return this.O},pk.prototype.getGeometry=pk.prototype.da,pk.prototype.ba=function(t){var e=this.O,i=!e;return C(t,K,this.ba,0,t),!i&&e.na(t)||(this.O=t,i||this.xa(Vg.SPATIAL)),this},pk.prototype.setGeometry=pk.prototype.ba,pk.prototype.Wc=function(){return this.a.getData()},pk.prototype.getBitmap=pk.prototype.Wc,pk.prototype.Zk=function(t,e){var i=this.a;return i&&1!==i.getState()&&i.cancel(),this.a=new Mj(t,this.b,!0,B,e),this},pk.prototype.setBitmap=pk.prototype.Zk,pk.prototype.b=function(t,e){this.a=e,1===t&&this.xa(Vg.VISUAL)},pk.prototype.Zc=function(){return this.c},pk.prototype.getOpacity=pk.prototype.Zc,pk.prototype.kc=function(t){var e=this.c,i=2>e;if(!(0<=t&&1>=t))throw new D(this.kc,0);return t!==e&&(this.c=t,i&&this.xa(Vg.VISUAL)),this},pk.prototype.setOpacity=pk.prototype.kc,pk.prototype.X=function(){var t=pk.l.X.call(this);return t.geometry=wi(this.O).X(),t.properties.overlay=!0,t},pk.prototype.forWorkerMessage=pk.prototype.X,u(In,R),t("H.map.provider.MarkerTileProvider",In),In.prototype.Rd=function(t){return t?t.length+1:1},In.prototype.getEntryWeight=In.prototype.Rd,In.prototype.J=function(t,e,i,r,n){var o=this;return this.L(t,e,i,(function(n){for(var a,s,l=[],u=n.length;u--;)(s=n[u]).Ko=o.getTileKey(t,e,i),s.ja(o),a=s.Ab(),(C(s,Zi)||1===a.getState())&&l.push(n[u]);r(l)}),n)},In.prototype.requestInternal=In.prototype.J,In.prototype.ce=function(t,e){e===Vg.VISUAL&&(t=this.Mb().get(t.Ko))&&(t.valid=!1,this.Xa(t))},In.prototype.invalidateObject=In.prototype.ce,In.prototype.Tb=function(){return this.A},In.prototype.providesDomMarkers=In.prototype.Tb,In.prototype.Ub=ef,In.prototype.providesMarkers=In.prototype.Ub,u(Jn,kl),t("H.map.layer.MarkerTileLayer",Jn);var Kn={markers:[],total:0,requested:0};function Ln(t,e,i,r,n){var o,a=zd(i);for(t.pixelProjection.Qa(a),e=t.be(t.Je(e),a),i=t.Qe(e,e.left>e.right,~~i,r,n),t=i.tiles,i=i.total,r=t.length,n=[],o=0;o<r;o++)for(a=(e=t[o]).data.length;a--;)n.push(e.data[a]);return{markers:n,total:t.length,requested:i}}function Mn(t,e,i){var r,n=6;if(e){for(r=' expected close to: "'+e;n--;)-1!==(e=t.a.next())&&(r+=String.fromCharCode(e));r+='"'}throw new D(Nn,0,"- Malformed WKT: "+(r?i+r:"unexpected end of stream"))}Jn.prototype.Fc=function(t,e,i,r){return this.pa.providesDomMarkers()?Kn:Ln(this,t,e,i,r)},Jn.prototype.requestMarkers=Jn.prototype.Fc,Jn.prototype.Ec=function(t,e,i,r){return this.pa.providesDomMarkers()?Ln(this,t,e,i,r):Kn},Jn.prototype.requestDomMarkers=Jn.prototype.Ec;var On={Bl:" ",yl:"(",zl:")",vl:",",xl:""};function Pn(t,e){var i=t.next();i!==(e=e?")":"(")&&Mn(t,i,'"'+e+'"')}function Qn(t){return","===Rn(t)&&(t.next(),!0)}function Sn(t,e,i,r,n){var o,a,s=2+e+i;for(a=1;a<=s;a++)(i=t.next())?(o=+i)!==o?Mn(t,i,"number"):1===a?r[n+1]=o:2===a?r[n]=o:3===a&&(r[n+2]=o):Mn(t,i);e||(r[n+2]=0)}Object.keys(On).reduce((function(t,e){return t[On[e]]=!0,t}),nc());var Tn=[];function Un(t,e,i,r){return r||Pn(t,0),Sn(t,e,i,Tn,0),r||Pn(t,1),new Yf(Tn[0],Tn[1],e?Tn[2]:B)}function Vn(t,e,i){var r=[];Pn(t,0);do{Sn(t,e,i,r,r.length)}while(Qn(t));return Pn(t,1),new L(r)}function Wn(t,e,i){Pn(t,0);var r=Vn(t,e,i);if(Qn(t)){var n=[];do{n.push(Vn(t,e,i))}while(Qn(t))}return Pn(t,1),new O(r,n)}var Xn=[],Yn=[Wn],Zn=[Un],$n={POINT:Zn,LINESTRING:[Vn],POLYGON:Yn,MULTIPOINT:[Un,Si],MULTILINESTRING:[Vn,vh],MULTIPOLYGON:[Wn,Ei],GEOMETRY:Xn,GEOMETRYCOLLECTION:Xn,CIRCULARSTRING:Xn,COMPOUNDCURVE:Xn,CURVEPOLYGON:Xn,MULTICURVE:Xn,MULTISURFACE:Xn,CURVE:Xn,SURFACE:Xn,POLYHEDRALSURFACE:Xn,TIN:Xn,TRIANGLE:Xn},ao={Z:1,M:2,ZM:3};function Nn(t){var e,i=(t=new bo(t)).next();if((e=$n[i.toUpperCase()])||Mn(t,i,"type name"),e!==Xn){i=Rn(t);var r=1&(i=ao[i.toUpperCase()]),n=i>>1;if(r|n&&t.next(),"EMPTY"===(i=Rn(t)))if(t.next(),r=e[1])var o=new r([]);else e!==Zn&&(o=new L([]),e===Yn&&(o=new O(o)));else if("("===i){if(o=e[0],e=e[1]){var a=[];if(Pn(t,0),o===Un){var s="("!==Rn(t);do{a.push(o(t,r,n,s))}while(Qn(t))}else do{a.push(o(t,r,n))}while(Qn(t));Pn(t,1),r=new e(a)}else r=o(t,r,n);o=r}else Mn(t,i,'"Z", "M", "ZM", "(" or "EMPTY"');t.next()&&Mn(t,i,"end of stream")}return o||y}function bo(t){this.a=t}function Rn(t){var e=t.b;if(e===B){for(e=t.a;e.Rb()===co;)e.next();if(eo[e.Rb()])e=(e=e.next())===fo?"":String.fromCharCode(e);else{e.re();do{e.next()}while(!eo[e.Rb()]);e=String.fromCharCode.apply(null,e.Od())}t.b=e}return e}bo.prototype.next=function(){var t=Rn(this);return""!==t&&delete this.b,t};var co=32,fo=-1,go={Bl:co,yl:40,zl:41,vl:44,xl:fo},eo=Object.keys(go).reduce((function(t,e){return t[go[e]]=!0,t}),nc());function ho(){}function io(t){this.c=String(t),this.f=0,this.a=[],this.b=!1}t("H.util.ICharStream",ho),ho.prototype.next=function(){},ho.prototype.re=function(){},ho.prototype.Od=function(){},ho.prototype.Rb=function(){},t("H.util.CharStream",io),io.prototype.next=function(){var t=this.c.charCodeAt(this.f++);return t=isNaN(t)?-1:t,this.b&&this.a.push(t),t},io.prototype.re=function(){this.b=!0,this.a=[]},io.prototype.Od=function(){var t=this.a.slice();return this.b=!1,this.a=[],t},io.prototype.Rb=function(){var t=this.c.charCodeAt(this.f);return isNaN(t)?-1:t},t("H.util.wkt.toGeometry",(function(t){return Nn(new io(t))})),t("H.buildInfo",(function(){return Ff("H-core","1.30.9","f7490476")}));var jo,ko="maps".concat("js-"),lo,mo,no,oo,po;if(lo=x.document.querySelector('script[src*="'+ko+'"]'),!lo)for(mo=x.document.getElementsByTagName("script"),oo=new RegExp("^.*"+ko),po=0,no=mo.length;po<no;po++)if(oo.test(mo[po].src)){lo=mo[po];break}function qo(t,e){if(!t)throw new D(qo,0,t);qo.l.constructor.call(this,t),this.b={},this.c=!(!e||!e.rc),this.f=ro++}jo=lo?lo.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",(function(){return jo})),u(qo,sm);var ro=0;function so(t,e){e=e||{},C(t,ul,so,0),so.l.constructor.call(this,t),this.rc=!!e.rc,this.c=e.ib||0,this.a=[],this.b={}}qo.prototype.V=function(t,e,i,r,n,o){var a=yd(r),s=this.hb,l=a+(i.exp-s.pixelProjection.exp),u=s.min,c=s.max;r=s.tileSize;var h=s.ea().f,p=this.wb,f=p.Zc(),d=p.Bb().w,y=i.w,g=i.x,v=i.y,m={};if(a<u||a>c)return rk.DONE;for(t=(n=s.requestTiles(t,l,n,o,this.f)).total,o=(n=n.tiles).length,this.g=i,this.j=e,this.a=l,f!==h&&p.kc(h),i=r=r*y/(Ed(2,l)*r),this.c||(r%1&&(g/=y=i/(r=zd(r)),v/=y,y=Ed(2,l)*r),g=zd(g),v=zd(v)),this.i=i,l=-r,a=d+r,s=0;s<o;s++){if((u=(d=n[s]).data)&&u.tagName){for(i=e.x-(g-d.x*r),h=e.y-(v-d.y*r),p.Uc(u,i,h,r,r),f=i;(f-=y)>l;)p.Uc(u,f,h,r,r);for(f=i;(f+=y)<a;)p.Uc(u,f,h,r,r)}m[this.a+"_"+d.x+"_"+d.y]=d}return this.b=m,o===t?rk.DONE:rk.PENDING},qo.prototype.Ha=function(t,e,i){var r,n=this.i,o=n/this.hb.tileSize,a=this.g,s=this.j;if(uc(this.a)&&a){t=a.x+(t-s.x),e=a.y+(e-s.y);var l=zd(a.w/n),u=a=zd(t/n);s=zd(e/n),Bd(u)>=l&&(u%=l),0>u&&(u=l+u),(l=this.b[this.a+"_"+u+"_"+s])&&l.Ha&&(r=l.Ha((t-n*a)/o,(e-n*s)/o,i))}return r||gf},qo.prototype.ae=function(){return"2d"},u(so,sm),so.prototype.V=function(t,e,i,r,n,o){var a,s,l=this.hb;r-=this.c,this.a.length=0;var u=this.b;if(this.b=a={},r>=l.min&&r<=l.max){var c=l.Dd(t,r,n,o),h=c.overlays;if(t=h.length)for(h.sort($g),r=this.wb,n=this.rc,o=0;o<t;o++){var p=(l=h[o]).I(),f=i.kb(p.Pb()),d=i.kb(p.Lb());p=i.w,f.x>=d.x&&(f.x-=p),p=-((f.x+d.x)/p>>1)*p,f.x+=p,f.add(e),d.x+=p,d.add(e),n||(f.round(),d.round()),(p=u[s=l.gb()])?delete u[s]:p={qo:l},a[s]=p;var y=f.x;f=f.y;var g=d.x,v=g-y,m=(d=d.y)-f;r.kc(l.Zc()),r.Uc(l.Wc(),y,f,v,m),p.$g?p.$g.set(y,f,g,d):p.$g=new tk(y,f,g,d),this.a.push(p)}}return!c||c.requested&&c.requested===c.total||!c.requested&&h.length===c.total?rk.DONE:rk.PENDING},so.prototype.Ha=function(t,e,i){for(var r,n,o=this.a,a=o.length;a--;)if((r=o[a]).$g.Df(t,e))if(r=r.qo,n)n.push(r);else if(n=[r],i)break;return n||gf},so.prototype.ae=function(){return"2d"},so.prototype.s=function(){delete this.a,so.l.s.call(this)};var to={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:Cl.ZOOM,COORD:Cl.COORD},capture:!0};function uo(t,e){this.a=[],uo.l.constructor.apply(this,arguments)}function U(t,e,i,r){U.l.constructor.call(this,t,e,i,r),this.L=new I(0,0),(i=r.renderBaseBackground)&&(this.io=i.lower,this.Tn=i.higher),this.Ln=!!r.enableSubpixelRendering,this.ld=vo,this.Sj=0,this.He=this.xj=!1,this.i=new dm,this.a=r=new lm,this.Kd=A(this.Kd,this),r.addEventListener(r.v.Gg,this.Kd),this.Ga=A(this.Ga,this),r=t.element,this.Ea=t=r.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,r.insertBefore(t,r.firstChild),this.Uj=new Im(this.Ea,this.ta),this.m=[],wo(this),this.Oh=A(U.prototype.Oh,this),this.rb=xo,this.qg(),this.zoom=yo(this,this.A.ub()+this.ib),this.Hb(),zo(this,e.lb().position,this.zoom),this.ab(),this.R()}t("H.map.render.p2d.capabilities",to),u(uo,wm),n=uo.prototype,n.wj=function(){return this.hb.Fc.apply(this.hb,arguments)},n.V=function(t,e,i,r,n,o,a){return this.a=[],uo.l.V.apply(this,arguments)},n.hk=1,n.Ok=function(t,e,i,r,n,o){var a=this.hk=r.Za();n*=a,o*=a;var s=i.Bb();e=s.w*a,s=s.h*a;var l=i.rd();this.rc?(n-=l.x*a,o-=l.y*a):(n=yd(n-l.x*a),o=yd(o-l.y*a)),r.Uc(i.Wc(),n,o,e,s),t.detail?t.detail.set(n,o,n+e,o+s):t.detail=new tk(n,o,n+e,o+s),this.a.push(t)},n.Ha=function(t,e,i){for(var r,n,o,a=this.a,s=a.length,l=gf,u=this.hk;s--&&!((n=(r=a[s]).detail).Df(t,e)&&(r=r.rk,(!(o=r.Ab().f)||o.Vf((t-n.left)/u,(e-n.top)/u,0))&&0>l.indexOf(r)&&(l===gf&&(l=[]),l.push(r),i))););return l},n.ae=function(){return"2d"},n.s=function(){this.a=[],uo.l.s.call(this)},u(U,yl),t("H.map.render.p2d.RenderEngine",U),U.prototype.type=Il.P2D;var xo=2;function Ao(t,e,i){return Bd(e=i-e)<t.sa.w/2?e:e-t.sa.w*i/Bd(i)}function wo(t){var e=t.c.Na(),i=0,r=e.length;for([t.ha={},t.u={},t.W={},t.ra={}].forEach((function(t){t.Tc=[],t.ia=[]})),t.f=t.c.Na();i<r;i++)t.Ve(i,e[i]);t.Hb()}function Jo(t){var e=[];return(e=(e=(e=(e=e.concat(t.u.ia)).concat(t.ha.ia)).concat(t.W.ia)).concat(t.ra.ia)).filter(uc)}function Do(t,e){var i=El(t,El(t,e.zoom)+t.ib);return(t=Fl(t,e)).zoom=i,t}function zo(t,e,i){var r=t.sa;r.Qa(i),t.o=r.projection.Vc(e),r.x=r.w*t.o.x,r.y=r.h*t.o.y}function Io(t){return{w:(t=t.kd[2]).right-t.left,h:t.bottom-t.top}}function Ko(t){t.b&&t.b.wa()||Hk()-t.Da<t.ld&&!t.F?t.jo=Rk(t.Oh):(t.F&&(t.le(),Lo(t)),t.rb=xo)}function Lo(t,e){t.dispatchEvent({type:t.v.$i,target:e||t})}function Po(t,e,i){Fo(t,e*t.ta,i*t.ta),t.L.set(0,0),t.ab(),t.fa()}function Fo(t,e,i){var r=t.sa;t=t.o,r.x=Xd(r.x+e,r.w),r.y=xd(0,wd(r.w,r.y+i)),t.x=r.x/r.w,t.y=r.y/r.h}function Go(t,e,i,r){var n=t.ta,o=t.g.center;i===+i&&r===+r?(i=(i-o.x)*n,r=(r-o.y)*n,t.L.set(i,r),Fo(t,i,r),t.sa.Qa(e),Fo(t,-i,-r)):(t.L.set(0,0),t.sa.Qa(e)),t.zoom=e,t.ab(),t.fa()}function Bo(t,e,i,r){var n=t.getCapabilities().lookAt.zoom.max,o=e.fb(),a=r||o;if(e.Xf()||i&&r)i=i===B?n:i;else{var s=new gj(t.sa.projection);s.Qa(n);var l=s.kb(e.Pb()).round(),u=s.kb(e.Lb()).round();n=s.w,e.Eb()&&(l.x-=n),r?(o=s.kb(a),e=2*xd(o.x-l.x,u.x-o.x),l=2*xd(o.y-l.y,u.y-o.y)):(e=u.x-l.x,l=u.y-l.y,a=o),i===B&&(i=(o=t.kd[4]).right-o.left,o=o.bottom-o.top,i=El(t,i=-8+wd(Cd(i/e*n)/Md,Cd(o/l*n)/Md)-t.ib))}return{zoom:zd(i),position:a}}function Co(t){Ho(t,!0),t.a.wa()&&t.yb(!0),t.i.wa()&&t.zb(!0),Ho(t,!0)}function Qo(t,e){if(e){var i={};i.Ze=e.power,i.Ee=e.ease,i.duration=e.duration,t.j=i}}function yo(t,e){return El(t,El(t,e-t.ib)+t.ib)}function So(t,e){var i=t.o,r=t.sa.projection.Vc(e.position),n=t.sa.ie(r),o=n.y;n=n.x;var a=e.zoom;e=(i=t.sa.ie(i)).y;var s=i.x;i=t.zoom;var l=t.a.Cb(),u=t.a.b,c=t.a.c,h=0;if(n=Ao(t,s,n),e=Dd((n-=s)*n+(o-=e)*o+(i=a-i)*i),0!==l&&0!==e){var p=n/e,f=o/e,d=i/e,y=l*l/(2*e);Eo(t,(function(e,i){var n;1!==e?((n=d*(i=(e=l*i-y*i*i/2)-h))&&(n=yo(t,t.zoom+n),Go(t,yo(t,n),u,c)),Po(t,yd(p*i),yd(f*i)),h=e):(t.o=r,Go(t,yo(t,a),u,c),t.ab(),t.fa())}),2*e/l)}}function Ro(t,e,i){i=i||0,e.ob&&Go(t,yo(t,t.zoom+e.ob*i),t.a.atX,t.a.atY),Po(t,e.mb*i,e.nb*i)}function Eo(t,e,i,r,n){t.b&&t.b.wa()&&t.b.stop(!0),t.b=new vm(t,e,i,r,n),t.b.start()}function Ho(t,e){t.b&&t.b.wa()&&t.b.stop(e)}U.prototype.getState=function(){return this.rb},U.prototype.getState=U.prototype.getState,U.prototype.Xg=function(t){var e=this,i=t.b,r=t.newValue,n=t.modifiers;t=r.position;var o,a=r.bounds,s=this.zoom,l=this.o,u=0;if(n&aj.POSITION&&(o=e.sa.kb(t)),n&aj.BOUNDS)r=Bo(this,a.I(),n&aj.ZOOM?r.zoom:B,n&aj.POSITION?t:B),this.A.Yb(r,i);else{n&aj.POSITION||(o=e.sa.kb(r.position));var c=o.x,h=o.y;Co(this),this.L.set(0,0);var p=(r=Do(this,r)).zoom,f=r.position;if(i){var d=p-s,y={x:l.x,y:l.y};i=this.sa.ie(y).x;var g=this.sa.projection.Vc(t);g.x===this.o.x&&g.y===this.o.y&&p===this.zoom||(c=Ao(this,i,c),Eo(this,(function(t){var i=t-u;if(p!==s){o=e.sa.ie(g);var r=e.sa.ie(y);c=Ao(e,r.x,o.x),h=o.y-r.y}u=t,Fo(e,c*i,h*i),Go(e,s+=d*i),e.ab(),e.fa()}),this.Oc,(function(){zo(e,f,p),Go(e,p),e.ab(f),e.fa()}),this.Pc))}else Ho(this),zo(this,f,p),Go(this,p),this.ab(f);this.fa()}},U.prototype.Oc=300,U.prototype.tg=function(t){var e=Dc(t);if(!e||e&&0>t)throw new D(this.tg,1,"positive number required");this.Oc=t},U.prototype.setAnimationDuration=U.prototype.tg,U.prototype.gh=function(){return this.Oc},U.prototype.getAnimationDuration=U.prototype.gh,U.prototype.Pc=Vl,U.prototype.ug=function(t){if(!Da(t))throw new D(this.ug,1,"function required");this.Pc=t},U.prototype.setAnimationEase=U.prototype.ug,U.prototype.hh=function(){return this.Pc},U.prototype.getAnimationEase=U.prototype.hh,U.prototype.qg=function(){this.Pc=Vl,this.Oc=300},U.prototype.resetAnimationDefaults=U.prototype.qg,U.prototype.ci=function(t,e,i){var r;this.Da=Hk(),(r=this.ha.ia.splice(t,1)[0])&&r.B&&r.B(),(r=this.u.ia.splice(t,1)[0])&&r.B&&r.B(),(r=this.W.ia.splice(t,1)[0])&&r.B&&r.B(),(r=this.ra.ia.splice(t,1)[0])&&r.B&&r.B(),this.f=this.c.Na(),0===t&&(Dl(this,e,!1),this.Hb()),this.m=Jm(this.Uj,Io(this),Jo(this)),this.le(),i||this.fa()},U.prototype.di=function(){this.Hb(),this.fa()},U.prototype.yh=function(t,e,i){var r,n,o,a;if(e){var s={rc:this.Ln,ib:this.ib};e.V?C(e,um)?n=new tm(e):C(e,Gm)&&(a=new tm(e)):(e.requestOverlays&&(r=new so(e,s)),e.requestTiles&&(n=new qo(e,s)),e.requestMarkers&&(o=new uo(e,s)),e.requestDomMarkers&&(a=new zm(e,s)))}i=i||0,this.ha.ia.splice(t,i,r),this.u.ia.splice(t,i,n),this.W.ia.splice(t,i,o),this.ra.ia.splice(t,i,a),this.f=this.c.Na(),this.m=Jm(this.Uj,Io(this),Jo(this))},U.prototype.Va=function(t,e){var i=this.g.center,r=this.ta;return this.sa.Ra((t-i.x)*r,(e-i.y)*r)},U.prototype.screenToGeo=U.prototype.Va,U.prototype.sg=function(t,e){return t=this.Va(t,e),(e=this.A.lb()).position=t,e},U.prototype.Ga=function(t){var e=this.ta,i=this.g.center,r=i.x*e;i=i.y*e,t=this.sa.kb(t);var n=this.sa.w;return new I(yd((t.x-yd(t.x/n)*n+r)/e),yd((t.y+i)/e))},U.prototype.geoToScreen=U.prototype.Ga,U.prototype.I=function(t,e){var i=this.kd[t||4];t=this.sa;var r=i.left-e,n=t.Ra(r,i.top-e),o=i.right+e;return e=t.Ra(o,i.bottom+e),o-r>=t.w&&(n.lng=-(e.lng=180)),eg(n,e)},U.prototype.Ha=function(t,e,i,r){var n,o=[],a=this.ta;for(t*=a,e*=a,n=(a=[this.ha,this.u,this.W,this.ra]).length;n--&&(!i||!o.length);){for(var s=o,l=a[n].ia,u=t,c=e,h=i,p=l.length;p--&&!((o=l[p])&&o.Ha&&(s=s.concat(o.Ha(u,c,h)),s.length&&h)););o=s}r(o)},U.prototype.getObjectsAt=U.prototype.Ha,U.prototype.Qc=y,U.prototype.R=function(){var t,e=this.m.length;U.l.R.call(this);var i=Io(this);this.L.set(0,0);var r=i.w;for(t=i.h;e--;){var n=(i=this.m[e]).Bb();n.w===r&&n.h===t||i.kf(r,t)}this.Qc=new Ti(r,t),this.fa()},U.prototype.getCapabilities=function(){return to},U.prototype.getCapabilities=U.prototype.getCapabilities,n=U.prototype,n.le=function(){this.ha.Tc.length=0,this.u.Tc.length=0,this.W.Tc.length=0,this.ra.Tc.length=0},n.Oh=function(){var t;this.T&&this.T.before();var e=this.u.ia,i=this.g.center.clone().scale(this.ta).round(),r=this.I(1,0),n=this.I(1,Mo),o=this.zoom,a=o-this.ib,s=this.sa,l=this.io,u=this.Tn,c=e[0];e=this.L;var h=this.m.length,p=this.f;for(t=p.length;h--;){var f=this.m[h];C(f,rm)&&f.clear()}if(c){if(l)for(;l;)h=o-l,c.V(r,i,s,h,!0,e),--l;if(u&&this.He)for(f=1;f<=u&&(h=o+f,s.Qa(h),l=this.I(2,0),s.Qa(o),!c.V(l,i,s,h,!0,e));f++);}for(this.ld=vo;t--;)C(s=p[t],jj)&&s.ea()&&s.ea().$e(n,a);r=this.gk(r,i,o,!1,e,No,this.u,this.ha),i=this.gk(n,i,a,!1,e,Oo,this.W,this.ra),this.F=r&&i,this.b&&this.b.wa()&&this.Hg(),this.P||(this.P=this.A.lb()),this.P.bounds=this.I(4,0),this.A.ab(this.P),this.P=null,this.Qc&&(this.g.ab(this.Qc),this.Qc=y),o<this.Sj?this.He=!0:this.xj&&(this.He=!1),this.Sj=o,this.xj=r,this.T&&this.T.after(),Ko(this)},n.gk=function(t,e,i,r,n,o,a){var s,l=Array.prototype.slice.call(arguments,6),u=l.length,c=l[0].ia.length,h=u*c,p=!!h;for(s=0;s<h;s++){if(o===No)var f=s%u,d=Math.floor(s/u);else f=Math.floor(s/c),d=s%c;var y=l[f].ia[d];f=l[f].Tc,y&&((y=y.V(t,e,this.sa,i,r,n,this.Ga))===rk.ACTIVE&&(this.ld=1/0),y!==rk.DONE||f[d]||(Lo(this,this.f[d]),f[d]=!0),f[d]||(p=!1))}return p},n.s=function(){var t=this.c.Na()[0],e=this.g;Sk(this.jo),Ho(this,!0),t&&Dl(this,t,!1),Jo(this).forEach((function(t){t.B()})),e.element&&e.element.removeChild(this.Ea),this.Ea=null,this.rb=3,U.l.s.call(this)},n.fa=function(){this.Da=Hk(),this.rb===xo&&(this.F=!1,this.rb=1,Ko(this))},n.se=function(t,e,i){Go(this,t=El(this,El(this,t)+this.ib),e,i)},U.prototype.zoomAt=U.prototype.se,U.prototype.oc=function(t,e){Co(this),Qo(this,e),this.i.start(t,!!e)},U.prototype.startInteraction=U.prototype.oc,U.prototype.fc=function(t,e,i,r,n){var o=!1;this.i.wa()&&(e=this.i.store(t,e,i,r,n),this.i.Bc(Cl.COORD)&&0<cm(t=this.i.Wd())&&(Po(this,-t.x,-t.y),o=!0),e&&this.i.Bc(Cl.ZOOM)&&(t=this.i.Jf(),e=this.i.Kf(),(e=Cd(Ed(2,this.zoom)*e)/Md)!==this.zoom&&(Go(this,e=yo(this,e),t.x,t.y),o=!0)),o&&this.fa())},U.prototype.interaction=U.prototype.fc,U.prototype.zb=function(t){var e=this;if(this.i.wa()&&!t){if(this.j){t=this.i.Cb();var i=this.i.tc(),r=this.j.duration,n=(this.j.Ze||1)*t,o=new Hm(-n/(0<r?r:1),n);!E(i.x)&&!E(i.y)&&0<n&&e.i.Bc(Cl.COORD)&&Eo(this,(function(t){n=o.Me(t*r),E(n)||Po(e,yd(-i.x*n),yd(-i.y*n))}),r,void 0,this.j.Ee)}this.j=null,this.i.clear()}},U.prototype.endInteraction=U.prototype.zb,U.prototype.nc=function(t,e,i){Co(this),this.a.start(e,i),Qo(this,t)},U.prototype.startControl=U.prototype.nc,U.prototype.control=function(t,e,i){if(E(+i))throw new D(this.control,2,i);if(E(t))throw new D(this.control,0,t);if(E(e))throw new D(this.control,1,e);this.a.wa()&&this.a.set(t,e,i,0,0,0)},U.prototype.control=U.prototype.control,U.prototype.yb=function(t,e){var i,r=this;if(this.a.wa()){Ho(this,!0);var n=Hk(),o=n-this.la;if(1<=o&&Ro(this,om(this.a),o),!this.j||t||e)"function"==typeof e&&((t=this.lb()).zoom=this.zoom-this.ib,e(t),t.zoom+=this.ib,So(this,t));else{e=this.a.Cb();var a=this.a.tc(),s=this.j.duration,l=(this.j.Ze||1)*e,u=new Hm(-l/(0<s?s:1),l);!E(a.mb)&&!E(a.nb)&&0<l&&Eo(this,(function(t,e,o,c){n&&(o=c-n,n=0),l=u.Me(t*s)*o,E(l)||((i=a.ob*l)&&Go(r,yo(r,r.zoom+i),r.a.b,r.a.c),Po(r,yd(a.mb*l),yd(a.nb*l)))}),s,void 0,this.j.Ee)}this.a.reset()}},U.prototype.endControl=U.prototype.yb,U.prototype.Kd=function(t){var e=this,i=t.c;this.L.set(0,0),i.mb||i.nb||i.ob?(this.la=Hk(),Eo(this,(function(t,r,n,o){e.la=o,Ro(e,i,n)}),Number.POSITIVE_INFINITY),this.fa()):Ho(this,!0)},U.prototype.bh=function(){},U.prototype.enter=U.prototype.bh,U.prototype.If=function(t){Bl(this.Ea,t)},U.prototype.exit=U.prototype.If,U.prototype.capture=function(t,e,i,r){var n=this.Ea.ownerDocument.createElement("canvas"),o=n.getContext("2d"),a=this.ta;for(n.width=(i-t)*a,n.height=(r-e)*a,i=0;i<this.m.length;i++)C(r=this.m[i],rm)&&o.drawImage(r.K(),-t*a,-e*a);return Xb(n)};var Oo=0,No=1,vo=1e3,Mo=256;function To(t){var e=t.ownerDocument;e=e.documentElement||e.body.parentNode||e.body;try{var i=t.getBoundingClientRect()}catch(t){i={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:i.left+("number"==typeof window.pageXOffset?window.pageXOffset:e.scrollLeft),y:i.top+("number"==typeof window.pageYOffset?window.pageYOffset:e.scrollTop)}}var Uo=function(){return this}.apply(null);function Vo(t,e,i,r,n,o){if(isNaN(t))throw Error("x needs to be a number");if(isNaN(e))throw Error("y needs to be a number");if(isNaN(i))throw Error("pointer must have an id");this.viewportX=t,this.viewportY=e,this.target=null,this.id=i,this.type=r,this.dragTarget=null,this.button=uc(n)?n:-1,this.buttons=uc(o)?o:0,this.a=this.button}function Wo(t,e,i){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(i))throw Error("y needs to be a number");t.viewportX=e,t.viewportY=i}function Xo(t,e){t.a=e,t.buttons|=Yo[+e]||0}function Zo(t,e){t.a=e,t.buttons&=~(Yo[+e]||0)}t("H.mapevents.Pointer",Vo),Vo.prototype.Hm=function(){return this.a},Vo.prototype.getLastChangedButton=Vo.prototype.Hm;var Yo=[1,4,2],$o={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};function ap(t,e,i,r,n,o,a){ap.l.constructor.call(this,t),this.pointers=e,this.changedPointers=i,this.targetPointers=r,this.currentPointer=n,this.originalEvent=a,this.target=o}function bp(t){this.a=t instanceof Array?t.slice(0):[]}function cp(t,e){return-1!==(e=t.indexOf(e))?t.a[e]:null}function dp(t,e){for(var i=t.a.length,r=[];i--;)t.a[i].type!==e&&r.push(t.a[i]);t.a=r}function ep(t,e){for(var i=t.a.length;i--;)if(t.a[i].dragTarget===e)return!0;return!1}function fp(t,e,i){if(i=i||{},!(t instanceof T))throw Error("events: map instance required");if(!(e instanceof Array))throw Error("events: map array required");nd.call(this),this.Yg=i.Yg||300,this.lj=i.lj||50,this.kl=i.kl||50,this.ll=i.ll||500,this.Gh=i.Gh||900,this.Fh=i.Fh||8,this.map=t,this.m=this.map.b,this.f=this.m.element,this.A=e,this.a=new bp,this.b=new bp,this.j={},this.c=null,this.u=!0,this.U={},this.g={},this.o=null,this.Ce=A(this.Ce,this),this.T={pointerdown:this.Rl,pointermove:this.Sl,pointerup:this.Tl,pointercancel:this.Ql},gp(this)}function gp(t,e){var i,r=t.A.length;for(i=0;i<r;i++){var n=t.A[i],o=n.listener;"function"==typeof o&&(e?(n.target||t.f).removeEventListener(n.Sa,o):(n.target||t.f).addEventListener(n.Sa,o))}}function hp(t,e,i){var r;if("function"==typeof t.T[e]){"pointermove"!==e&&(t.u=!0);var n=0;for(r=t.b.length();n<r;n++){var o=t.b.a[n]||null;t.f.contains(i.composedPath()[0])?ip(t,o,t.sj.bind(t,i,e,o)):t.sj(i,e,o,null)}}t.b.clear()}function ip(t,e,i){if(t.c===e)i(e.target);else{var r=t.m,n=e.viewportX;if(e=e.viewportY,0>n||0>e||n>=r.width||e>=r.height)i(y);else{var o=t.map;o.Xd(n,e,(function(t){i(t||o)}))}}}function kp(t,e,i){e===t.c&&(lp(t,e.dragTarget,"dragend",i,e),t.c=null,jp(e.id,t.U)),e.dragTarget=null}function jp(t,e){e[t]&&(e[t].timeout?clearTimeout(e[t].timeout):clearTimeout(e[t]),delete e[t])}function mp(t,e,i){var r=e.target,n=new I(e.viewportX,e.viewportY),o=e.id;jp(o,t.g);var a=setTimeout((function(){r&&r===e.target&&n.Ya({x:e.viewportX,y:e.viewportY})<t.Fh&&(lp(t,r,"longpress",i,e),delete t.j[e.id])}),t.Gh);t.g[o]={timeout:a,Ye:n}}function lp(t,e,i,r,n){if(e&&"function"==typeof e.dispatchEvent){var o,a=ap,s=t.a.Na(),l=t.b.Na(),u=(t=t.a).a.length,c=[];for(o=0;o<u;o++)t.a[o].target===e&&c.push(t.a[o]);a=new a(i,s,l,c,n,e,r),n.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(i)?n.a:$o.NONE,e.dispatchEvent(a)}return a}function np(t){this.i=A(this.i,this),fp.call(this,t,[{Sa:"touchstart",listener:this.i},{Sa:"touchmove",listener:this.i},{Sa:"touchend",listener:this.i},{Sa:"touchcancel",listener:this.i}]),this.P={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.F=(t=(t=t.m)?t.K():null)?Array.prototype.slice.call(t.querySelectorAll("a"),0):[]}function op(t){var e=pp(this);(window.PointerEvent||window.MSPointerEvent)&&e.push({Sa:"MSHoldVisual",listener:"prevent"}),fp.call(this,t,e)}function pp(t){var e,i,r=!!window.PointerEvent,n=[];return t.i=A(t.i,t),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach((function(o){e=o.toLowerCase().replace(/ms/g,""),i=r?e:o,n.push({Sa:i,listener:t.i,target:/^pointer(up|move)$/.test(e)?window:null})})),n}Vo.Button=$o,u(ap,sd),t("H.mapevents.Event",ap),n=bp.prototype,n.clear=function(){this.a.splice(0,this.a.length)},n.length=function(){return this.a.length},n.indexOf=function(t){for(var e=this.a.length;e--;)if(this.a[e].id===t)return e;return-1},n.remove=function(t){return-1!==(t=this.indexOf(t))?this.a.splice(t,1)[0]:null},n.push=function(t){if(t instanceof Vo)return this.a.push(t);throw Error("list needs a pointer")},n.Na=function(){return this.a},n.clone=function(){return new bp(this.a)},u(fp,nd),n=fp.prototype,n.sj=function(t,e,i,r){jp(i.id,this.U),this.T[e].call(this,i,r,t)},n.Tl=function(t,e,i){var r=t.id;t.target=e,kp(this,t,i),lp(this,e,"pointerup",i,t),"mouse"!==t.type&&lp(this,e,"pointerleave",i,t),e=this.j[t.id];var n={x:t.viewportX,y:t.viewportY},o=i.timeStamp,a=t.target,s=this.o;e&&e.target===a&&e.Ye.Ya(n)<this.kl&&o-e.Li<this.ll?(lp(this,a,"tap",i,t),s&&s.target===a&&o-s.Li<this.Yg?s.Ye.Ya({x:t.viewportX,y:t.viewportY})<this.lj&&(lp(this,a,"dbltap",i,t),this.o=null):this.o={target:a,Ye:new I(t.viewportX,t.viewportY),Li:i.timeStamp}):this.o=null,this.j={},jp(r,this.g)},n.Ce=function(t,e){var i=this;lp(this,t.dragTarget,"drag",e,t),jp(t.id,this.U),this.U[t.id]=setTimeout((function(){i.Ce(t,e)}),150)},n.Sl=function(t,e,i){var r=t.dragTarget,n=t.id,o=t.target;t.target=e,o!==e&&(lp(this,o,"pointerleave",i,t),lp(this,e,"pointerenter",i,t)),r?this.c?(this.Ce(t,i),this.g[n]&&this.g[n].Ye.Ya({x:t.viewportX,y:t.viewportY})>this.Fh&&jp(n,this.g)):this.u?this.u=!1:(this.c=t,lp(this,r,"dragstart",i,t),this.Ce(t,i),delete this.j[n],this.u=!0):(!this.c||this.c&&this.c.dragTarget!==e&&this.c.dragTarget!==this.map)&&lp(this,e,"pointermove",i,t)},n.Rl=function(t,e,i){var r=!(/^(?:mouse|pen)$/.test(t.type)&&0!==i.button);if(e){t.target=e,this.j[t.id]={Ye:new I(t.viewportX,t.viewportY),target:t.target,Li:i.timeStamp},"mouse"!==t.type&&lp(this,e,"pointerenter",i,t);var n=lp(this,e,"pointerdown",i,t);!this.c&&r&&(e.draggable&&!ep(this.a,e)?t.dragTarget=e:!this.map.draggable||n.defaultPrevented||ep(this.a,this.map)||(t.dragTarget=this.map)),mp(this,t,i)}},n.Ql=function(t,e,i){var r=t.id;t.target=null,e?(lp(this,e,"pointerleave",i,t),lp(this,e,"pointercancel",i,t)):lp(this,this.map,"pointercancel",i,t),kp(this,t,i),this.j={},jp(r,this.g)},n.s=function(){gp(this,!0),this.a.clear(),this.b.clear();var t,e=this.U;for(t in e)jp(t,e);for(var i in e=this.g)jp(i,e);delete this.f,delete this.A,delete this.a,delete this.b,delete this.map,this.o=null,delete this.j,this.c=null,nd.prototype.s.call(this)},u(np,fp),np.prototype.i=function(t){var e,i=t.touches,r=this.a.length();if("touchstart"===t.type&&r>=i.length){for(r=this.a.clone(),e=i.length;e--;)r.remove(i[e].identifier);for(e=r.length();e--;)this.a.remove((r.a[e]||null).id);this.b=r,hp(this,"pointercancel",t),this.b.clear()}if(this.P[t.type]){i=To(this.m.element),r=t.type;var n,o=(e=t.changedTouches).length;for(this.b.clear(),n=0;n<o;n++){var a=e[n],s=cp(this.a,a.identifier),l=a.pageX-i.x,u=a.pageY-i.y;if(s)if("touchmove"===r){a=Math.abs(s.viewportX-l);var c=Math.abs(s.viewportY-u);(1<a||1<c||1===a&&1===c)&&(Wo(s,l,u),this.b.push(s))}else"touchend"===r&&(this.a.remove(s.id),this.b.push(s),Zo(s,$o.LEFT));else s=new Vo(l,u,a.identifier,"touch",$o.LEFT,1),this.a.push(s),this.b.push(s)}hp(this,this.P[t.type],t),-1===this.F.indexOf(t.target)&&t.preventDefault()}},np.prototype.s=function(){this.F=null,fp.prototype.s.call(this)},u(op,fp);var qp={2:"touch",3:"pen",4:"mouse"};function rp(t,e,i,r){rp.l.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=t,this.viewportY=e,this.target=i,this.originalEvent=r}function sp(t){this.uh=A(this.uh,this),this.wh=A(this.wh,this),this.vh=A(this.vh,this),this.F=!1,this.i=-1,this.P=0,sp.l.constructor.call(this,t,[{Sa:"contextmenu",listener:this.uh},{target:t,Sa:"longpress",listener:this.wh},{target:t,Sa:"dbltap",listener:this.vh}])}function tp(t,e,i,r,n){var o=t.map,a=Date.now()-t.P;n?!t.F&&a>t.Gh&&(t.F=!0,n.dispatchEvent(new rp(e,i,n,r)),De(o.K(),up,t.rj,!1,t)):o.Xd(e,i,t.Un.bind(t,e,i,r))}op.prototype.i=function(t){var e=window.PointerEvent?t.type:t.type.toLowerCase().replace(/ms/g,""),i=To(this.f),r=cp(this.a,t.pointerId),n=t.pageX-i.x;i=t.pageY-i.y;var o=qp[t.pointerType]||t.pointerType;if($c&&"rtl"===x.getComputedStyle(this.m.element).direction&&(n-=(x.devicePixelRatio-1)*this.m.width),!(r||/^pointer(up|out|cancel)$/.test(e)||"touch"===o&&"pointerdown"!==e)){r={x:n,y:i};var a=t.pointerType;"number"==typeof a&&(a=qp[a]),r=new Vo(r.x,r.y,t.pointerId,a,t.button,t.buttons),this.a.push(r)}r&&(/^pointer(up|cancel)$/.test(e)?("touch"===o&&this.a.remove(r.id),Zo(r,t.button)):"pointerdown"===e&&("touch"===t.pointerType&&(dp(this.a,"mouse"),dp(this.a,"pen")),Xo(r,t.button)),this.b.push(r),"pointermove"!==e?(Wo(r,n,i),hp(this,/^pointer(over|out)$/.test(e)?"pointermove":e,t)):r.viewportX===n&&r.viewportY===i||(Wo(r,n,i),hp(this,e,t))),this.b.clear()},u(rp,sd),t("H.mapevents.ContextMenuEvent",rp),u(sp,fp),n=sp.prototype,n.wh=function(t){var e=t.currentPointer;"touch"===e.type&&1===t.pointers.length&&tp(this,e.viewportX,e.viewportY,t.originalEvent,t.target)},n.vh=function(t){"touch"===t.currentPointer.type&&(this.P=Date.now())},n.uh=function(t){var e=this;-1===this.i?this.i=setTimeout((function(){var i=To(e.f),r=t.pageX-i.x;i=t.pageY-i.y,e.i=-1,tp(e,r,i,t)}),this.Yg):(clearInterval(this.i),this.i=-1),t.preventDefault()},n.Un=function(t,e,i,r){tp(this,t,e,i,r=r&&Da(r.dispatchEvent)?r:this.map)},n.rj=function(){this.F&&(this.F=!1,this.map.dispatchEvent(new sd("contextmenuclose",this.map)))},n.s=function(){var t=this.map.K();clearInterval(this.i),t&&Ke(t,up,this.rj,!1,this),fp.prototype.s.call(this)};var up=["mousedown","touchstart","pointerdown","wheel"];function vp(t,e,i,r,n){vp.l.constructor.call(this,"wheel"),this.delta=t,this.viewportX=e,this.viewportY=i,this.target=r,this.originalEvent=n}function wp(t){var e="onwheel"in document;this.L=e,this.P=(e?"d":"wheelD")+"elta",this.i=A(this.i,this),wp.l.constructor.call(this,t,[{Sa:(e?"":"mouse")+"wheel",listener:this.i}]),this.F=this.map.b}function xp(t){this.i=A(this.i,this),fp.call(this,t,[{Sa:"mousedown",listener:this.i},{Sa:"mousemove",listener:this.i,target:window},{Sa:"mouseup",listener:this.i,target:window},{Sa:"mouseover",listener:this.i},{Sa:"mouseout",listener:this.i},{Sa:"dragstart",listener:this.F}])}function yp(t){var e=t.b.element.style;if(-1!==zp.indexOf(t))throw Error("InvalidArgument: map is already in use");this.a=t,zp.push(t),e.msTouchAction=e.touchAction="none",ad||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new np(this.a),this.b=new xp(this.a)):this.c=new op(this.a),this.g=new wp(this.a),this.f=new sp(this.a),this.a.xb(this.B,this),nd.call(this)}u(vp,sd),t("H.mapevents.WheelEvent",vp),u(wp,fp),wp.prototype.i=function(t){if(!t.ul){var e=To(this.f),i=t.pageX-e.x;e=t.pageY-e.y;var r,n=this.P,o=t[n+(n+"Y"in t?"Y":"")];if($c&&"rtl"===x.getComputedStyle(this.F.element).direction&&(i-=(x.devicePixelRatio-1)*this.F.width),o){var a=Math.abs,s=a(o);o=(!(r=t[n+"X"])||3<=s/a(r))&&(!(r=t[n+"Z"])||3<=s/a(r))?(+(0<o)-+(0>o))*(this.L?1:-1):0}(i=new vp(o,i,e,null,t)).delta&&(t.stopImmediatePropagation(),t.preventDefault(),this.map.Xd(i.viewportX,i.viewportY,this.R.bind(this,i)))}},wp.prototype.R=function(t,e){var i,r,n=t.target=e||this.map;setTimeout((function(){n.dispatchEvent(t),t.f||(i=t.originalEvent,(r=new x.WheelEvent("wheel",i)).ul=!0,i.target.dispatchEvent(r))}),0)},u(xp,fp),xp.prototype.i=function(t){var e,i=t.type,r=To(this.f);r={x:t.pageX-r.x,y:t.pageY-r.y},(e=this.a.a[0]||null)||(e=new Vo(r.x,r.y,1,"mouse"),this.a.push(e)),this.b.push(e),Wo(e,r.x,r.y),/^mouse(?:move|over|out)$/.test(i)?hp(this,"pointermove",t):(/^mouse(down|up)$/.test(i)&&(r=t.which-1,"up"===Uo.RegExp.$1?Zo(e,r):Xo(e,r)),hp(this,i.replace("mouse","pointer"),t)),this.b.clear()},xp.prototype.F=function(t){t.preventDefault()},u(yp,nd),t("H.mapevents.MapEvents",yp);var zp=[];function Ap(t,e){var i;if(e=void 0===e?{}:e,Ap.l.constructor.call(this),-1!==Bp.indexOf(t))throw new D(Ap,0,"events are already used");this.b=i=t.a,this.j=t,Bp.push(t),i.draggable=!0,this.i=e.kinetics||{duration:600,ease:Vl},this.o=e.modifierKey||"Alt",this.enable(e.enabled),this.c=i.b,this.f=this.c.element,this.g=0,i.addEventListener("dragstart",this.Rh,!1,this),i.addEventListener("drag",this.jk,!1,this),i.addEventListener("dragend",this.Qh,!0,this),i.addEventListener("wheel",this.zk,!1,this),i.addEventListener("dbltap",this.uk,!1,this),i.addEventListener("pointermove",this.kk,!1,this),Ce(this.f,"contextmenu",this.ik,!1,this),t.xb(this.B,this)}Gc(zp),yp.prototype.B=function(){delete this.a,this.c.B(),this.g.B(),this.f.B(),this.b&&this.b.B(),zp.splice(zp.indexOf(this.a),1),nd.prototype.B.call(this)},yp.prototype.dispose=yp.prototype.B,yp.prototype.cm=function(){return this.a},yp.prototype.getAttachedMap=yp.prototype.cm,u(Ap,nd),t("H.mapevents.Behavior",Ap);var Bp=[];Gc(Bp),Ap.prototype.a=0;var Cp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};Ap.Feature=Cp;var Dp=Cp.PANNING,Ep=Cp.PINCH_ZOOM,Fp=Cp.WHEEL_ZOOM,Gp=Cp.DBL_TAP_ZOOM,Hp=Cp.FRACTIONAL_ZOOM,Ip=Cp.TILT,Jp=Cp.HEADING,Kp=Dp|Ep|Fp|Gp|Hp|Ip|Jp;function Lp(t,e){if(t!==+t||t%1||0>t||2147483647<t)throw new D(e,0,"integer in range [0...0x7FFFFFFF] required")}function Mp(t,e,i){var r,n="touch"===e.currentPointer.type,o=0;if(r=!n){r=t.o;var a,s=e.originalEvent;a=s.getModifierState?s.getModifierState(r):!!s[r.replace(/^Control$/,"ctrl").toLowerCase()+"Key"],r=a}return r?o|=Ip|Jp:(o|=Dp,n&&2===(e=e.pointers).length&&(o|=Ep|Jp,i?55>Bd(e[0].viewportY-e[1].viewportY)&&(o|=Ip):t.zh&Cl.TILT&&(o|=Ip))),((o&=t.a)&Ip?Cl.TILT:0)|(o&Jp?Cl.HEADING:0)|(o&Ep?Cl.ZOOM:0)|(o&Dp?Cl.COORD:0)}function Np(t){var e=t.pointers;return t=e[0],e=e[1],t=[t.viewportX,t.viewportY],e&&t.push(e.viewportX,e.viewportY),t}function Op(t,e,i,r,n){var o=+i-+e;if(t=t.b.c,isNaN(+e))throw Error("start zoom needs to be a number");if(isNaN(+i))throw Error("to zoom needs to be a number");0!==o&&(t.startControl(null,r,n),t.control(0,0,6,0,0,0),t.endControl(!0,(function(t){t.zoom=i})))}function Pp(t,e){return Xa.apply(null,arguments),t}function W(t,e,i,r,n,o){if(!t||!e)throw new D(W,B,'Parameters "scheme" and "host" must be specified');this.Fi(t),this.jf(e),this.Hd(i),this.Bi(n),this.Vk(o),this.xg(r)}function Qp(t,e){var i,r,n=x.document,o=n&&n.createElement("a"),a="";if(n){if(e){var s=(i=n.getElementsByTagName("base")[0])&&i.href,l=n.head,u=i||l.appendChild(n.createElement("base"));u.href=e}o.href=t,a=o.href,e&&(i?i.href=s:l.removeChild(u))}else/[\w]+:\/\//.test(t)&&(a=t);if(t=(s=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(a))[1],l=s[4],e=s[5],u=s[6],n=s[7],i=s[8],!s[2]&&l&&/@/.test(l)&&(l=l.split("@")[1]),s=W,u=u&&0<u.length?u.substr(1):"",o={},n)for(a=/([?&]?([^=&+]+))(=([^&]+))?/g;r=a.exec(n);)o[decodeURIComponent(r[2])]=r[4]?decodeURIComponent(r[4]):void 0;return new s(t,l,u,o,isNaN(+e)?void 0:+e,i&&0<i.length?i.substr(1):"")}function Sp(t){function e(t,e){return encodeURIComponent(t)+(void 0===e?"":"="+encodeURIComponent(e).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16)})))}var i,r=[],n=t.a;for(i in n)if(n.hasOwnProperty(i)&&"function"!=typeof n[i]){var o=t.a[i];C(o,Tp)?o.a.forEach((function(t){r.push(e(i,t))})):r.push(e(i,o))}return 0<r.length?"?"+r.join("&"):""}function Up(t){var e=Ff("H-service","1.30.9","bc7b03e3");return t.a.xnlp="CL_JSMv3."+e.version,t}function Rp(t){var e,i=0;for(e in t.a)if(t.a.hasOwnProperty(e)&&"function"!=typeof t.a[e]&&0<++i)break;return!i}function Tp(t){var e;if(!zc(t))throw new D(Tp,0,t);for(e=0;e<t.length;e++){var i=t[e];if(!Ac(i)&&!Dc(i))throw new D(Tp,0,"The array can only contain strings and numbers")}this.a=t}Ap.DRAGGING=Dp,Ap.WHEELZOOM=Fp,Ap.DBLTAPZOOM=Gp,Ap.FRACTIONALZOOM=Hp,Ap.prototype.disable=function(t){var e=this.a;t!==B?(Lp(t,this.disable),e^=e&t):e=0,this.c.endInteraction(!0),this.a=e,this.b.draggable=0<(e&(Dp|Ip|Jp|Ep))},Ap.prototype.disable=Ap.prototype.disable,Ap.prototype.enable=function(t){var e=this.a;t!==B?(Lp(t,this.enable),e|=t&Kp):e=Kp,this.a=e,this.b.draggable=0<(e&(Dp|Ip|Jp|Ep))},Ap.prototype.enable=Ap.prototype.enable,Ap.prototype.isEnabled=function(t){return Lp(t,this.isEnabled),t===(this.a&t)},Ap.prototype.isEnabled=Ap.prototype.isEnabled,n=Ap.prototype,n.zh=0,n.Rh=function(t){var e=Mp(this,t,!0);if(this.zh=e){var i=this.c;if(t=Np(t),i.startInteraction(e,this.i),i.interaction.apply(i,t),this.a&Fp&&!(this.a&Hp)&&(e=t[0],i=t[1],this.g)){t=this.b.ub();var r=(0>this.g?Ad:zd)(t);t!==r&&(this.g=0,Op(this,t,r,e,i))}}},n.jk=function(t){var e=Mp(this,t,!1);if(e!==this.zh)"pointerout"!==t.originalEvent.type&&"pointerover"!==t.originalEvent.type&&(this.Qh(t),this.Rh(t));else if(e){e=this.c;var i=Np(t);e.interaction.apply(e,i),t.originalEvent.preventDefault()}},n.Qh=function(t){Mp(this,t,!1)&&this.c.endInteraction(!this.i)},n.zk=function(t){if(!t.defaultPrevented&&this.a&Fp){var e=t.delta,i=this.b.ub(),r=this.b,n=r.cc().type;r=this.a&Hp?i-e:(0>-e?Ad:zd)(i)-e,n!==ek.P2D&&n!==ek.WEBGL&&n!==ek.HARP||(Op(this,i,r,t.viewportX,t.viewportY),this.g=e),t.preventDefault()}},n.kk=function(){},n.uk=function(t){var e=t.currentPointer,i=this.b.ub(),r=t.currentPointer.type,n=this.b.cc().type;(n===ek.P2D||n===ek.WEBGL||n===ek.HARP)&&this.a&Gp&&(t="mouse"===r?0===t.originalEvent.button?-1:1:0<t.pointers.length?1:-1,Op(this,i,t=this.a&Hp?i-t:(0>-t?Ad:zd)(i)-t,e.viewportX,e.viewportY))},n.ik=function(t){return!(this.a&Gp&&(t.preventDefault(),1))},n.B=function(){var t=this.b;t&&(t.draggable=!1,t.removeEventListener("dragstart",this.Rh,!1,this),t.removeEventListener("drag",this.jk,!1,this),t.removeEventListener("dragend",this.Qh,!0,this),t.removeEventListener("wheel",this.zk,!1,this),t.removeEventListener("dbltap",this.uk,!1,this),t.removeEventListener("pointermove",this.kk,!1,this),delete this.b),this.f&&(this.f.style.msTouchAction="",Ke(this.f,"contextmenu",this.ik,!1,this),delete this.f),delete this.c,delete this.i,Bp.splice(Bp.indexOf(this.j),1),delete this.j,nd.prototype.B.call(this)},Ap.prototype.dispose=Ap.prototype.B,t("H.mapevents.buildInfo",(function(){return Ff("H-mapevents","1.30.9","eb955cd")})),R.prototype.o=ca(3,(function(t){var e=this.getCache(),i=this;if(t!==y){C(t,Lk,R.prototype.o,0);var r=t}else r=pl;r!==e&&e.qa((function(t,e,n){return!!i.ac(t)&&(r.add(t,e,n),!0)})),this.F=r})),bi.prototype.b=ca(2,(function(t){this.g=t,(t=this.getState())!==Zh.INIT&&t!==Zh.LOADING&&ji(this)})),t("H.service.Url",W),W.parse=Qp,W.prototype.clone=function(){var t,e={};for(t in this.a)e[t]=this.a[t];return new W(this.i,this.g,this.b,e,this.f,this.c)},W.prototype.clone=W.prototype.clone,W.prototype.Fi=function(t){if(!t||"string"!=typeof t)throw new D(this.Fi,0,'The "scheme" parameter must be a non-empty string.');return this.i=t,this},W.prototype.setScheme=W.prototype.Fi,W.prototype.gn=function(){return this.i},W.prototype.getScheme=W.prototype.gn,W.prototype.jf=function(t){if(!t||"string"!=typeof t||"-"===t.charAt(0)||"."===t.charAt(0)||"."===t.charAt(t.length-1))throw new D(this.jf,0,'The "host" parameter is not a valid host name.');return this.g=t,this},W.prototype.setHost=W.prototype.jf,W.prototype.Bm=function(){return this.g},W.prototype.getHost=W.prototype.Bm,W.prototype.Hd=function(t){return this.b=t||void 0,this},W.prototype.setPath=W.prototype.Hd,W.prototype.Um=function(){return this.b},W.prototype.getPath=W.prototype.Um,W.prototype.xg=function(t){if(t){if("object"!=typeof t)throw new D(this.xg,0,'Parameter "params" must be an object.');this.a=t}else this.a={};return this},W.prototype.setQuery=W.prototype.xg,W.prototype.Tj=function(){return!Rp(this)},W.prototype.hasQuery=W.prototype.Tj,W.prototype.getQuery=function(){return this.a},W.prototype.getQuery=W.prototype.getQuery,W.prototype.Bi=function(t){if(void 0===t)this.f=t;else{var e=Zd(+t<<0,0,65535);if(e!=t)throw new D(this.Bi,0,'Parameter "port" must be an integer in range [0...65535]');this.f=e}return this},W.prototype.setPort=W.prototype.Bi,W.prototype.Ym=function(){return this.f},W.prototype.getPort=W.prototype.Ym,W.prototype.Vk=function(t){return this.c=t||void 0,this},W.prototype.setAnchor=W.prototype.Vk,W.prototype.rd=function(){return this.c},W.prototype.getAnchor=W.prototype.rd,W.prototype.G=function(t){if("object"!=typeof t)throw new D(this.G,0,'Parameter "other" must be an object.');var e,i=this.a;for(e in t)t.hasOwnProperty(e)&&"function"!=typeof t[e]&&(i[e]=t[e]);return this},W.prototype.mergeQuery=W.prototype.G,W.prototype.Fa=function(t){if(!t||"string"!=typeof t)throw new D(this.Fa,0,'Parameter "subDomain" must be a non-empty string');return"."===t.substr(t.length-1)&&(t=t.substr(0,t.length-1)),this.jf(t+"."+this.g)},W.prototype.addSubDomain=W.prototype.Fa,W.prototype.D=function(t){if(!t||"string"!=typeof t)throw new D(this.D,0,'Parameter "subPath" must be a non-empty string');return this.Hd((this.b?this.b+"/":"")+t)},W.prototype.addSubPath=W.prototype.D,W.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!Rp(this)||this.c?"/":"",this.b?encodeURI(this.b):"",Sp(this),this.c?"#"+encodeURIComponent(this.c):""].join("")},W.prototype.toString=W.prototype.toString,W.MultiValueQueryParameter=Tp,Tp.prototype.sn=function(){return this.a},Tp.prototype.getValues=Tp.prototype.sn;var Vp=globalThis;function Wp(){}sc("monospace serif"),Wp.prototype.pop=function(t){return this[t]||(this[t]=[]),this[t].pop()||document.createElement("canvas")},Wp.prototype.push=function(t,e){this[e]||(this[e]=[]),this[e].push(t)};var Xp=new Wp;function Yp(){var t=decodeURIComponent(Vp.H.getScriptPath());return Qp(t=t?"/"===t[t.length-1]?t.substring(0,t.length-1):t:"https://js.api.here.com/v3/3.1.30.9").D("styles")}function Y(t){var e=(t=Pp({},this.c,t)).apikey||t.apiKey,i=t.baseUrl;if(i=e?i?0:"baseUrl":"apikey")throw new D(Y,0,'"'+i+'" must be specified');this.Yk(t.baseUrl),this.b=e,this.a.G({apikey:e}),this.f=t.headers||{},this.g=Va(t.servicesConfig||{})}function Zp(t,e,i){var r,n=this,o=+(i=i||{}).min,a=+i.max;i.tileSize=i.tileSize||512,i.min=o?Zd(o,1,17):1,i.min+=Jk(i.tileSize,1),i.max=a?Zd(a,1,17):17,Zp.l.constructor.call(this,i),C(t,$p,Zp,0),C(e,Yh,Zp,1),this.j=t,e.b&&e.b("OMV"),this.Zb(e,!0),this.A=function(){aq(n),n.reload(!1)},t.addEventListener("versionupdate",this.A),aq(this),Zp.prototype.R=(r=/^v2\/vectortiles\/(.+)\/mc$/.exec(t.C().b))?r[1]:B+""}function aq(t){var e=t.vd("_#-;,:","_#-;,:","_#-;,:");t.L=new RegExp("^"+e.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function cq(t,e,i){var r=t.tb().getState()===Zh.READY,n=Ac(e),o=Ac(i);n&&(t.u=e),o&&(t.g=i),(n||o)&&(t.b=[],(e=(n=/^([a-zA-Z]{2})(-|$)/).exec(e))&&t.b.push(e[1]),(e=n.exec(i))&&t.b.push(e[1]),t.m=!0,r&&t.cb())}t("H.service.util.eval",(function(a){return eval(a)})),t("H.service.Platform",Y),Y.prototype.c={apikey:null,baseUrl:new W("https","hereapi.com")},Y.prototype.Yk=function(t){this.a=Up(t.clone()),this.b=t=this.b,this.a.G({apikey:t})},Y.prototype.setBaseUrl=Y.prototype.Yk,Y.prototype.bc=function(){return this.a},Y.prototype.getBaseUrl=Y.prototype.bc,Y.prototype.Wa=function(t,e){try{return t.Zj=!0,new t(Pp({platformBaseUrl:this.bc(),headers:this.f},this.g[t.CONFIG_KEY]||{},e||{}))}finally{t.Zj=!1}},Y.prototype.createService=Y.prototype.Wa,u(Zp,R),t("H.service.omv.Provider",Zp),Zp.prototype.Ad=ef,Zp.prototype.providesOMV=Zp.prototype.Ad,Zp.prototype.ac=function(t){return this.L.test(t)},Zp.prototype.cacheFilter=Zp.prototype.ac,Zp.prototype.vd=function(t,e,i){return bq(this.j,t,e,i).toString()},Zp.prototype.getTileKey=Zp.prototype.vd,Zp.prototype.Mb=function(){return this.W},Zp.prototype.getCache=Zp.prototype.Mb,Zp.prototype.MAX_STORE_TIME=2592e6,Zp.prototype.Tg=function(){return md()},Zp.prototype.$d=function(){return md()?ld():Zp.l.$d.call(this)},Zp.prototype.J=function(t,e,i,r,n){return this.j.jb(t,e,i,r,n)},Zp.prototype.requestInternal=Zp.prototype.J,Zp.prototype.lc=function(t){t.b&&t.b("OMV"),this.Zb(t)},Zp.prototype.setStyle=Zp.prototype.lc,Zp.prototype.va=function(){return Zp.l.tb.apply(this)},Zp.prototype.getStyle=Zp.prototype.va,Zp.prototype.tb=function(){var t,e=Zp.l.tb.apply(this);return this.m&&(e.getState()===Zh.READY?(t=e.sd())&&t.global&&(this.u&&(t.global.ux_language=this.u),this.g&&(t.global.ux_language_fallback=this.g),e=new bi(t,e.bc())):e.load()),e},Zp.prototype.m=!1;var dq=["en"];function gq(){this.a={}}Zp.prototype.Gm=function(){return this.b||dq},Zp.prototype.getLanguages=Zp.prototype.Gm,Zp.prototype.s=function(){Zp.l.s.call(this),this.j.removeEventListener("versionupdate",this.A)},Zp.prototype.W=new Lk(256),Zp.prototype.ua=function(t,e){return eq(this.j.ua(),this.R,e,t)},Zp.prototype.getCopyrights=Zp.prototype.ua,Y.prototype.Ff=function(t,e,i,r,n,o){var a=this.oh(),s=this.oh({type:"aerial"}),l=this.Nj(),u=this.Jj(),c=ek.WEBGL,h={},p={crossOrigin:"anonymous"};if(Ea(t)){var f=t;"crossOrigin"in f&&(p.crossOrigin=f.crossOrigin),t=f.tileSize,e=f.ppi,i=f.lg,r=f.lg2,n=f.style,o=f.pois,f.engineType&&(c=f.engineType,p.engineType=c)}var d=t||512;if(0>[72,250,320,500].indexOf(+e)){if(e!==B)throw new D(this.Ff,1,e)}else h.ppi=+e;if(i&&(h.lg=i),r&&(h.lg2=r),n&&(h.style=n),o&&(h.pois=o),t=function(t,e,i,r,n){return t.qc(e,i,d,r,h,1,n,p)},c===ek.HARP&&!H.map.render.harp)throw new D(this.Ff,0,"HARP engine is not supported, module not found");return e=c===ek.WEBGL?new bi(Yp().D("omv/miami/normal.day.yaml").toString()):new H.map.render.harp.Style(Yp().D("harp/oslo/normal.day.json").toString()),i=c===ek.WEBGL?new bi(Yp().D("omv/miami/truck.day.yaml").toString()):new H.map.render.harp.Style(Yp().D("harp/oslo/normal.day.json").toString()),r={engineType:c},cq((e=u.nd(e,r)).ea(),h.lg,h.lg2),cq((i=u.nd(i,r)).ea(),h.lg,h.lg2),u=l.jj(h.lg?{lg:h.lg,i18n:!0,engineType:c}:{engineType:c}),{vector:{normal:{map:e,truck:i,traffic:l.ij(void 0,c),trafficincidents:u}},raster:{normal:{xbase:t(a,"xbasetile","normal.day","png8",!1),xbasenight:t(a,"xbasetile","normal.night","png8",!0),base:t(a,"basetile","normal.day","png8",!1),basenight:t(a,"basetile","normal.night","png8",!0),map:t(a,"maptile","normal.day","png8",!1),mapnight:t(a,"maptile","normal.night","png8",!0),trafficincidents:u,transit:t(a,"maptile","normal.day.transit","png8",!1),labels:t(a,"labeltile","normal.day","png",!1)},satellite:{xbase:t(s,"xbasetile","hybrid.day","jpg",!0),base:t(s,"basetile","hybrid.day","jpg",!0),map:t(s,"maptile","hybrid.day","jpg",!0),labels:t(s,"labeltile","hybrid.day","png",!0)},terrain:{xbase:t(s,"xbasetile","terrain.day","jpg",!1),base:t(s,"basetile","terrain.day","jpg",!1),map:t(s,"maptile","terrain.day","jpg",!1),labels:t(s,"labeltile","terrain.day","png",!1)}}}},Y.prototype.createDefaultLayers=Y.prototype.Ff,gq.prototype.Ab=function(t,e){var i,r=t+e;return(i=this.a[r])?i:(t=(t=hq.MARKER.replace("{{icon}}",iq[t]||iq.OTHER)).replace("{{color}}",jq[e]||jq.BLOCKING),e={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Ui(Vi.POLYGON,kq.MARKER)},this.a[r]=new Rj(t,e))};var hq={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},iq={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},jq={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},kq={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function lq(t,e,i){(i=i||{}).criticality||(i.criticality="major,critical"),C(t,mq,lq,0),In.call(this,{max:20,min:8,requestData:A(this.R,this),engineType:i.engineType}),this.b=new gq,this.u=t,this.g=i,this.reload=A(this.reload,this),this.m=setInterval(this.reload,e||18e4)}u(lq,In),t("H.service.traffic.incidents.Provider",lq);var nq={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};lq.prototype.R=function(t,e,i,r,n){var o=this,a=this.b;return this.u.requestIncidentsByTile(t,e,i,(function(t){var e,i=[];if(t=t.TRAFFIC_ITEMS)for(e=(t=t.TRAFFIC_ITEM).length;e--;){var n=t[e],s=n.TRAFFIC_ITEM_TYPE_DESC;switch(s){case"ACCIDENT":case"CONGESTION":var l=s;break;case"CONSTRUCTION":l="ROADWORKS";break;default:l="OTHER"}l=a.Ab(l,nq[n.CRITICALITY.DESCRIPTION]),(s=new Gn({lat:(s=n.LOCATION.GEOLOC.ORIGIN).LATITUDE,lng:s.LONGITUDE},{provider:o,icon:l})).setData(n),i.push(s)}r(i)}),n,this.g)},lq.prototype.B=function(){In.prototype.B.call(this),clearInterval(this.m)};var oq="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function pq(t,e,i,r){pq.l.constructor.call(this,{min:10,max:21,engineType:r}),C(t,mq,pq,0),this.m=t,this.b=i||qq,this.b.responseattributes="sh,fc",this.g=setInterval(A(this.reload,this),e||18e4),this.c===ek.WEBGL?this.Zb(new bi(Yp().D("traffic/flow.yaml").toString()),!0):this.Zb(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],lineWidth:3,metricUnit:"Pixel"}}]}))}u(pq,R),t("H.service.traffic.flow.Provider",pq),pq.prototype.ki=ef,pq.prototype.providesGeoJSON=pq.prototype.ki,pq.prototype.va=function(){return this.tb()},pq.prototype.getStyle=pq.prototype.va,pq.prototype.lc=function(t){t.b&&t.b("GeoJSONTileSource"),this.Zb(t)},pq.prototype.setStyle=pq.prototype.lc;var qq={locationreferences:"tmc,shp"};pq.prototype.s=function(){pq.l.s.call(this),clearInterval(this.g)},pq.prototype.J=function(t,e,i,r,n){return this.m.requestFlowByTile(t,e,i,(function(t){t.type&&-1!==t.type.indexOf("Error")?n(t.Details):r(t)}),n,this.b)},pq.prototype.requestInternal=pq.prototype.J,pq.prototype.od=function(t,e,i,r,n){var o,a,s,l,u,c={type:"FeatureCollection",features:[]},h=r.RWS.length;for(o=0;o<h;o++){var p=r.RWS[o],f=p.RW,d=f.length,y=-1!==oq.indexOf(p.EXTENDED_COUNTRY_CODE+p.EBU_COUNTRY_CODE);for(p=0;p<d;p++){var g=f[p].FIS,v=g.length;for(g=0;g<v;g++){var m=f[p].FIS[g].FI,_=m.length;for(a=0;a<_;a++){var b=m[a],w=[],x=b.CF[0],E=!!x.SSS,A={type:"Feature",properties:x,geometry:{type:"MultiLineString",coordinates:w}};for(A.properties.LHT=y,b.SHP.length&&(A.properties.FC=b.SHP[0].FC),E&&(u=[]),x=0;x<b.SHP.length;x++){var T=b.SHP[x].value,k=T.length;for(s=0;s<k;s++){var S=E?u:void 0,M=new io(T[s].trim()),I=[],O={};for(M.re();-1!==(l=M.Rb());)l===rq?(O.lat=+String.fromCharCode.apply(pq,M.Od()),M.next(),M.re()):l===sq?(O.lng=+String.fromCharCode.apply(pq,M.Od()),I.push([O.lng,O.lat]),S&&S.push($f(O)),O=[],M.next(),M.re()):M.next();O.lng=+String.fromCharCode.apply(pq,M.Od()),I.push([O.lng,O.lat]),S&&S.push($f(O)),l=I,w.push(l)}}c.features.push(A)}}}}return pq.l.od.call(this,t,e,i,c,n)},pq.prototype.createTileInternal=pq.prototype.od;var sq=32,rq=44;function tq(t,e){if(e=void 0===e?{}:e,!t.Zj)throw new Yc(t);tq.l.constructor.call(this);var i=uq(this,e);if(!i.baseUrl&&!i.platformBaseUrl)throw new D(t,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.j=(i.baseUrl?i.baseUrl:i.platformBaseUrl).clone(),(t=i.baseUrl?e:i).host&&this.j.jf(t.host),t.subDomain&&this.j.Fa(t.subDomain),t.path&&this.j.Hd(t.path),Up(this.j),this.i=i.headers||{}}function uq(t,e){return t=t.a(),e?Pp({},t,e):t}function vq(t,e,i){return function(r){return"function"!=typeof r.json?Promise.reject(i(wq(e,r))):r.json().then((function(e){return i(t.b(e))}),(function(){return i(wq(e,r))}))}}function wq(t,e){return Error((e.statusText?"["+e.statusText+"] ":"")+t+" request failed")}function xq(t){function e(e){r.contains(n)&&r.removeChild(n),u&&clearTimeout(u),delete xq.a[o],e&&t.uj&&t.uj.call(l,e)}if(!t.url||!t.Sg)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!=typeof t.Sg)throw Error("Parameters options.callback must be a function");var i=t.bp||document,r=i.getElementsByTagName("head")[0],n=i.createElement("script");i=t.url instanceof W?t.url:Qp(t.url,t.ap);var o=xq.b++,a=t.Ll||"callback",s=t.Sg,l={},u=null;return l.id=o,l.cancel=function(){e("cancelled")},0!==t.timeout&&(u=x.setTimeout((function(){e("timeout")}),t.timeout||3e4)),xq.a[o]=function(t){e(),s.call(l,t)},n.type="text/javascript",n.src=i.toString()+(i.Tj()?"&":"?")+a+"="+(t.cp?"H.service.jsonp.handleResponse("+o+")":encodeURI("H.service.jsonp.handleResponse("+o+")")),r.appendChild(n),l}function mq(t){mq.l.constructor.call(this,mq,t),this.c=uq(this,t).callbackKey}function yq(t,e,i,r){return xq({url:e,Sg:i,uj:function(t){r(Error("["+t+"] "+e+" request failed"))},Ll:t.c})}function zq(t){zq.l.constructor.call(this,zq,t),this.c=uq(this,t).reverseSubDomain}function Aq(t){Aq.l.constructor.call(this,Aq,t)}function Bq(t,e,i,r,n){return e=t.C().clone().D(e).G(i||{}),t.J(e,r,n)}function Cq(){this.a={}}function Dq(t,e){for(var i in e)if(e.hasOwnProperty(i)){var r,n=e[i],o=t.a[i]||(t.a[i]=[]),a=n.length;for(r=0;r<a;r++)o.push(new Eq(n[r]))}}function eq(t,e,i,r){var n=(t=t.a[e])?t.length:0,o=[];for(e=0;e<n;e++)t[e].wd(i,r)&&o.push(t[e]);return o}function Eq(t){var e,i=t.boxes;if(this.label=t.label,this.min=t.minLevel,this.max=t.maxLevel,this.b=[],i&&(e=i.length)){var r=i[0],n=new K(r[0],r[1],r[2],r[3]);for(this.b.push(n),this.a=new K(r[0],r[1],r[2],r[3]),t=1;t<e;t++)n=new K((r=i[t])[0],r[1],r[2],r[3]),this.b.push(n),this.a.hc(n,!1,this.a)}}function $p(t){$p.l.constructor.call(this,$p,t),t=uq(this,t).mapVersion,this.c=uc(t)?t:Fq[this.C().toString()],uc(this.c)||Gq(this)}u(tq,F),t("H.service.Service",tq),tq.prototype.a=function(){return{}},tq.prototype.C=function(){return this.j},tq.prototype.getUrl=tq.prototype.C,tq.prototype.J=function(t,e,i,r){return(r=new sf(void 0===r?"application/json":r,t.toString(),ge,{headers:this.i})).then(e,vq(this,t,i)),r},tq.prototype.b=function(t){return Error(t.message)},t("H.service.jsonp",xq),xq.yn=function(t){return(t=xq.a[t])?t:function(){}},xq.handleResponse=xq.yn,xq.b=0,xq.a={},u(mq,tq),t("H.service.traffic.Service",mq),mq.prototype.a=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},mq.CONFIG_KEY="traffic",mq.prototype.ij=function(t,e){return new tl(new pq(this,void 0,t,e),{max:22})},mq.prototype.createFlowLayer=mq.prototype.ij,mq.prototype.jj=function(t){return new Jn(new lq(this,void 0,t))},mq.prototype.createIncidentsLayer=mq.prototype.jj,mq.prototype.yo=function(t,e,i){return yq(this,t=this.C().clone().D("incidents.json").G(t),e,i)},mq.prototype.requestIncidents=mq.prototype.yo,mq.prototype.xo=function(t,e,i,r,n,o){return yq(this,t=this.C().clone().D(["flow/json",i,t,e].join("/")).G(o||{}),r,n)},mq.prototype.requestFlowByTile=mq.prototype.xo,mq.prototype.zo=function(t,e,i,r,n,o){return yq(this,t=this.C().clone().D(["incidents/json",i,t,e].join("/")).G(o||{}),r,n)},mq.prototype.requestIncidentsByTile=mq.prototype.zo,Y.prototype.Nj=function(t){return this.Wa(mq,t)},Y.prototype.getTrafficService=Y.prototype.Nj,u(zq,tq),t("H.service.GeocodingService",zq),zq.prototype.a=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},zq.CONFIG_KEY="geocoding",zq.prototype.b=function(t){return Error(t.Details||t.message||t.error)},zq.prototype.fh=function(t,e,i){return t=this.C().clone().D("geocode.json").G(t),this.J(t,e,i)},zq.prototype.geocode=zq.prototype.fh,zq.prototype.oi=function(t,e,i){return t=this.C().clone().D("reversegeocode.json").G(t),this.c&&t.Fa(this.c),this.J(t,e,i)},zq.prototype.reverseGeocode=zq.prototype.oi,zq.prototype.search=function(t,e,i){return t=this.C().clone().D("search.json").G(t),this.J(t,e,i)},zq.prototype.search=zq.prototype.search,Y.prototype.xm=function(t){return this.Wa(zq,t)},Y.prototype.getGeocodingService=Y.prototype.xm,u(Aq,tq),t("H.service.PlacesService",Aq),Aq.prototype.a=function(){return{subDomain:"places.ls",path:"places/v1"}},Aq.CONFIG_KEY="places",Aq.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},Aq.prototype.request=function(t,e,i,r){return Bq(this,t,e,i,r)},Aq.prototype.search=function(t,e,i){return Bq(this,"discover/search",t,e,i)},Aq.prototype.search=Aq.prototype.search,Aq.prototype.Jo=function(t,e,i){return Bq(this,"suggest",t,e,i)},Aq.prototype.suggest=Aq.prototype.Jo,Aq.prototype.Vl=function(t,e,i){return Bq(this,"discover/explore",t,e,i)},Aq.prototype.explore=Aq.prototype.Vl,Aq.prototype.Hl=function(t,e,i){return Bq(this,"discover/around",t,e,i)},Aq.prototype.around=Aq.prototype.Hl,Aq.prototype.An=function(t,e,i){return Bq(this,"discover/here",t,e,i)},Aq.prototype.here=Aq.prototype.An,Aq.prototype.Ml=function(t,e,i){return Bq(this,"categories/places",t,e,i)},Aq.prototype.categories=Aq.prototype.Ml,Aq.prototype.Wl=function(t,e,i,r){return t=Qp(t).G(this.C().getQuery()).G(r||{}),this.J(t,e,i)},Aq.prototype.follow=Aq.prototype.Wl,Y.prototype.Vm=function(t){return this.Wa(Aq,t)},Y.prototype.getPlacesService=Y.prototype.Vm,Eq.prototype.wd=function(t,e){if(t>=this.min&&t<=this.max){if(!(t=this.b.length)||!this.a)return!0;if(this.a.wd(e))for(;t--;)if(this.b[t].wd(e))return!0}return!1},u($p,tq),t("H.service.omv.Service",$p),$p.prototype.a=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},$p.CONFIG_KEY="omv";var Fq={};function Gq(t){t.J(t.C().clone().D("../../info"),(function(e){e=e.mapVersion;var i=t.C().toString();t.c=e,e!==Fq[i]&&(Fq[i]=e,t.dispatchEvent("versionupdate"))}),(function(){}))}function bq(t,e,i,r){return e=t.C().clone().D(r+"/"+e+"/"+i+"/omv"),uc(t.c)&&e.G({mv:t.c}),e}function Hq(t){Hq.l.constructor.call(this,Hq,t),this.c=t.getToken}function Qq(t,e,i,r){return t.C().clone().D(e+"/layers/"+i+"/features").G(r||{})}function Oq(t,e,i,r,n){return Qq(t,i,r,e=Object.assign({},n,{id:new Tp(e)}))}function Mq(t,e,i,r,n){return t.C().clone().D(i+"/layers/"+r+"/features/"+e).G(n||{})}function Kq(t,e,i,r,n,o,a){return a=void 0===a?"application/json":a,i={method:i,headers:Object.assign({},o?{"Content-Type":"application/geo+json"}:void 0,"function"==typeof t.c?{Authorization:"Bearer "+t.c()}:void 0,t.i)},o&&(i.data=JSON.stringify(o)),(o=new sf(a,e.toString(),ge,i)).then(r,vq(t,e,n)),o}function Iq(t,e,i,r){xc(i,"String",t,e,"must be a string"),xc(r,"String",t,e+1,"must be a string")}function Lq(t,e){xc(e,"String",t,0,"must be a string")}function Nq(t,e){if(!Array.isArray(e)||0===e.length||e.some((function(t){return"string"!=typeof t})))throw new D(t,0,"must be a non-empty array of strings")}function Pq(t,e,i){if(!Ea(i))throw new D(t,e,"must be a GeoJSON object")}function Jq(t,e,i,r){if(!Da(i))throw new D(t,e,"must be a function");if(!Da(r))throw new D(t,e+1,"must be a function")}function Rq(t,e,i,r){if(Rq.l.constructor.call(this,r?{min:r.min,max:r.max,engineType:r.engineType}:void 0),C(t,Hq,Rq,0),!Ac(e))throw new D(Rq,1,'"catalogHrn" must be a string');if(!Ac(i))throw new D(Rq,2,'"layerId" must be a string');this.u=t,this.b=e,this.g=i,this.m=Ea(r)&&Ea(r.parameters)?r.parameters:{},this.Zb(this.c===ek.WEBGL?new bi({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.b+":"+this.g},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.b+":"+this.g,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.b+":"+this.g,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.b+":"+this.g,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.b+":"+this.g,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",lineWidth:"2px",renderOrder:203}]}))}function Sq(t,e,i,r,n,o,a){var s=this;a=a||{},o=o||{};var l=t.C().clone().D(e+"/"+t.wc()+"/"+i).G(o),u=t.f;this.u=t,this.L=l,Ak.call(this,{tileSize:r,max:512===r?19:20,min:512===r?2:0,getURL:function(t,e,i){var o=s.L.clone();return u&&o.Fa(u[(i+e+t)%u.length]),o.D(i+"/"+t+"/"+e+"/"+r+"/"+n),o.toString()},crossOrigin:a.crossOrigin,headers:a.headers,uri:l.toString().replace(/_/g,"")+r,engineType:a.engineType}),this.Ea=e,this.Da=i,this.la=o,this.W=i.split(".")[0],this.ag=A(this.ag,this),this.getCopyrights=this.ua,t.addEventListener("versionupdate",this.ag)}function Tq(t){Tq.l.constructor.call(this,Tq,t),t=uq(this,t),this.f=t.shards,(this.g=t.ignoreTypes?null:t.type)&&this.C().Fa(this.g),this.c=t.version,this.m=new Cq,this.u={},this.o=0,"newest"===this.c&&Uq(this)}function Vq(t,e){for(var i={},r=t[e+"s"][e],n=r.length;n--;)i[r[n].id]=r[n];t[e+"s"]=i}function Uq(t){var e=t.C().clone().D("info").G({output:"json"});t.f&&e.Fa(t.f[0]),t.J(e,(function(e){var i;if(Vq(e=e.response,"map"),Vq(e,"scheme"),Vq(e,"tiletype"),Vq(e,"format"),Vq(e,"resolution"),Vq(e,"language"),"newest"===t.c&&"traffic"!==t.g)for(i in e.maps)e.maps[i].hash&&e.maps[i].newest&&(t.c=e.maps[i].hash,t.dispatchEvent("versionupdate"));t.F=e,t.dispatchEvent("infoupdate")}),(function(t){throw t}))}function Wq(t){var e=t.C().clone().D("copyright").D(t.wc()).G({output:"json"});t.f&&e.Fa(t.f[0]),t.o=1,t.J(e,(function(e){t.o=2,Dq(t.m,e),t.dispatchEvent("copyrightupdate")}),(function(e){throw t.o=-1,e}))}function Xq(t){Xq.l.constructor.call(this,Xq,t)}function Yq(t){Yq.l.constructor.call(this,Yq,t)}function Zq(t){Zq.l.constructor.call(this,Zq,t)}function $q(){}function ar(){}function br(t,e){this.a=t,this.b=e}function cr(){}function dr(t,e){this.b=t,this.a=e}function er(t,e,i){var r;if(e=e||(t&&t.length?Object.keys(t[0]):B),this.Fb=t,e)for(this.Md=e,this.Ug=t=nc(),r=e.length;r--;)t[e[r]]=!0;i!==B&&(this.Yh=i)}function fr(t,e){return t.Fb?t.Fb.push(e):t.Fb=[e],t.Fb.length-1}function gr(t){var e=hr;if(!t||!Ac($e(t.layerId,t.layer))||!Dc(t.level)||uc(t.rowFilter)&&!Da(t.rowFilter)||uc(t.rowFilterContext)&&!Ea(t.rowFilterContext))throw new D(e,1,uc("invalid layer config")?"invalid layer config":t)}function ir(t,e,i,r){r=r||jr,this.a={},r.provider=t,this.invalidate=ff,ir.l.constructor.call(this,e,r),delete this.invalidate,i&&(this.b=i),this.xa(Vg.ADD)}Gc(Fq),$p.prototype.Nm=function(){return this.c},$p.prototype.getMapVersion=$p.prototype.Nm,$p.prototype.nd=function(t,e){return new tl(new Zp(this,t,e),{max:22})},$p.prototype.createLayer=$p.prototype.nd,$p.prototype.jb=function(t,e,i,r,n){return this.J(bq(this,t,e,i),(function(t){return t.arrayBuffer().then(r,n)}),n,"arraybuffer")},$p.prototype.qh=function(t,e){if(!Da(t))throw new D(this.qh,0,'"onResult" must be a function');if(!Da(e))throw new D(this.qh,1,'"onError" must be a function');return this.J(this.C().clone().Hd("v2/vectortiles/pviews"),t,e)},$p.prototype.getPoliticalViews=$p.prototype.qh,Y.prototype.Jj=function(t){return this.Wa($p,t)},Y.prototype.getOMVService=Y.prototype.Jj,$p.prototype.g=function(t){Dq(this.f,t),this.dispatchEvent("copyrightupdate")},$p.prototype.ua=function(){return this.f||(this.f=new Cq,this.J(this.C().clone().D("../../copyrights"),A(this.g,this),id)),this.f},$p.prototype.getCopyrights=$p.prototype.ua,u(Hq,tq),t("H.service.iml.Service",Hq),Hq.prototype.a=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},Hq.prototype.b=function(t){var e=[{keys:["code","title","cause","action"],format:function(){return t.code+": "+t.title+"; cause: "+t.cause+"; action: "+t.action}},{keys:["error","error_description"],format:function(){return t.error+": "+t.error_description}},{keys:["error","errorMessage"],format:function(){return t.error+": "+t.errorMessage}}];return Error(Ea(t)?function(){for(var i=ea(e),r=i.next();!r.done;r=i.next()){var n=(r=r.value).format;if(r.keys.every((function(e){return t[e]})))return n()}return JSON.stringify(t)}():t)},Hq.prototype.Zd=function(t,e,i,r,n){var o=this.Zd;return Iq(o,0,t,e),Jq(o,2,i,r),Kq(this,t=this.C().clone().D(t+"/layers/"+e+"/statistics").G(n||{}),"GET",i,r)},Hq.prototype.getStatistics=Hq.prototype.Zd,Hq.prototype.Nf=function(t,e,i,r,n,o,a,s,l){var u=l?"":".mvtf";return Kq(this,t=this.C().clone().D(r+"/layers/"+n+"/tile/web/"+i+"_"+t+"_"+e+u).G(Object.assign({clip:!0},s)),"GET",l?o:function(t){return t.arrayBuffer().then(o)},a,void 0,l?"application/json":"arraybuffer")},Hq.prototype.getFeaturesByTile=Hq.prototype.Nf,Hq.prototype.Bj=function(t,e,i,r,n,o){var a=this.Bj;return Lq(a,t),Iq(a,1,e,i),Jq(a,3,r,n),Kq(this,t=Mq(this,t,e,i,o),"GET",r,n)},Hq.prototype.getFeatureById=Hq.prototype.Bj,Hq.prototype.Yc=function(t,e,i,r,n,o){var a=this.Yc;return Nq(a,t),Iq(a,1,e,i),Jq(a,3,r,n),Kq(this,t=Oq(this,t,e,i,o),"GET",r,n)},Hq.prototype.getFeaturesById=Hq.prototype.Yc,Hq.prototype.Sd=function(t,e,i,r,n){var o=this.Sd;if(!Ea(t)||!(t.bbox||t.north&&t.east&&t.south&&t.west))throw new D(o,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return Iq(o,1,e,i),Jq(o,3,r,n),Kq(this,t=this.C().clone().D(e+"/layers/"+i+"/bbox").G(t),"GET",r,n)},Hq.prototype.getFeaturesByBoundingBox=Hq.prototype.Sd,Hq.prototype.Dj=function(t,e,i,r,n){var o=this.Dj;if(!(Ea(t)&&t.radius&&(t.lat&&(t.lng||t.lon)||t.refCatalogHrn&&t.refLayerId&&t.refFeatureId)))throw new D(o,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return Iq(o,1,e,i),Jq(o,3,r,n),Kq(this,t=this.C().clone().D(e+"/layers/"+i+"/spatial").G(t),"GET",r,n)},Hq.prototype.getFeaturesByPointAndRadius=Hq.prototype.Dj,Hq.prototype.Cj=function(t,e,i,r,n,o){var a=this.Cj;if(!Ea(t)||!t.radius)throw new D(a,0,'must be an object with "radius"');return Pq(a,1,e),Iq(a,2,i,r),Jq(a,4,n,o),Kq(this,t=this.C().clone().D(i+"/layers/"+r+"/spatial").G(t),"POST",n,o,e)},Hq.prototype.getFeaturesByGeometryAndRadius=Hq.prototype.Cj,Hq.prototype.Tk=function(t,e,i,r,n){var o=this.Tk;return Iq(o,0,t,e),Jq(o,2,i,r),Kq(this,t=this.C().clone().D(t+"/layers/"+e+"/search").G(n||{}),"GET",i,r)},Hq.prototype.searchFeatures=Hq.prototype.Tk,Hq.prototype.ck=function(t,e,i,r,n){var o=this.ck;return Iq(o,0,t,e),Jq(o,2,i,r),Kq(this,t=this.C().clone().D(t+"/layers/"+e+"/iterate").G(n||{}),"GET",i,r)},Hq.prototype.iterateFeatures=Hq.prototype.ck,Hq.prototype.fd=function(t,e,i,r,n,o){var a=this.fd;return Pq(a,0,t),Iq(a,1,e,i),Jq(a,3,r,n),Kq(this,e=Qq(this,e,i,o),"PUT",r,n,t)},Hq.prototype.putFeatures=Hq.prototype.fd,Hq.prototype.dd=function(t,e,i,r,n,o){var a=this.dd;return Pq(a,0,t),Iq(a,1,e,i),Jq(a,3,r,n),Kq(this,e=Qq(this,e,i,o),"POST",r,n,t)},Hq.prototype.postFeatures=Hq.prototype.dd,Hq.prototype.pd=function(t,e,i,r,n){var o=this.pd;return Nq(o,t),Iq(o,1,e,i),Jq(o,3,r,n),Kq(this,t=Oq(this,t,e,i),"DELETE",r,n)},Hq.prototype.deleteFeatures=Hq.prototype.pd,Hq.prototype.Lk=function(t,e,i,r,n,o,a){var s=this.Lk;return Lq(s,t),Pq(s,1,e),Iq(s,2,i,r),Jq(s,4,n,o),Kq(this,t=Mq(this,t,i,r,a),"PUT",n,o,e)},Hq.prototype.putFeature=Hq.prototype.Lk,Hq.prototype.Ek=function(t,e,i,r,n,o,a){var s=this.Ek;return Lq(s,t),Pq(s,1,e),Iq(s,2,i,r),Jq(s,4,n,o),Kq(this,t=Mq(this,t,i,r,a),"PATCH",n,o,e)},Hq.prototype.patchFeature=Hq.prototype.Ek,Hq.prototype.nj=function(t,e,i,r,n){var o=this.nj;return Lq(o,t),Iq(o,1,e,i),Jq(o,3,r,n),Kq(this,t=Mq(this,t,e,i),"DELETE",r,n,void 0,"text/plain")},Hq.prototype.deleteFeature=Hq.prototype.nj,Hq.CONFIG_KEY="iml",Y.prototype.Cm=function(t){return this.Wa(Hq,t)},Y.prototype.getIMLService=Y.prototype.Cm,u(Rq,R),t("H.service.iml.Provider",Rq),Rq.prototype.J=function(t,e,i,r,n){return this.u.Nf(t,e,i,this.b,this.g,r,n,this.m)},Rq.prototype.requestInternal=Rq.prototype.J,Rq.prototype.Ad=ef,Rq.prototype.providesOMV=Rq.prototype.Ad,Rq.prototype.va=function(){return this.tb()},Rq.prototype.getStyle=Rq.prototype.va,Rq.prototype.lc=function(t){C(t,bi)&&t.b("MVT"),this.Zb(t)},Rq.prototype.setStyle=Rq.prototype.lc,u(Sq,Ak),Sq.prototype.MAX_STORE_TIME=2592e6,n=Sq.prototype,n.s=function(){Ak.prototype.s.call(this),this.u.removeEventListener("versionupdate",this.ag)},n.ua=function(t,e){return eq(this.u.ua(),this.W,e,t)},n.ag=function(){var t=this.u;this.L=t.C().clone().D(this.Ea+"/"+t.wc()+"/"+this.Da).G(this.la),this.reload(!1)},n.Tg=function(){return md()},n.$d=function(){return md()?ld():Sq.l.$d.call(this)},u(Tq,tq),t("H.service.MapTileService",Tq),Tq.prototype.a=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},Tq.CONFIG_KEY="maptile",Tq.prototype.Oj=function(){return this.g},Tq.prototype.getType=Tq.prototype.Oj,Tq.prototype.wc=function(){return this.c},Tq.prototype.getVersion=Tq.prototype.wc,Tq.prototype.ua=function(){return this.o||(this.c&&"newest"!==this.c||"traffic"===this.g)&&Wq(this),this.m},Tq.prototype.getCopyrights=Tq.prototype.ua,Tq.prototype.lh=function(){return this.F},Tq.prototype.getInfo=Tq.prototype.lh,Tq.prototype.De=function(t,e,i,r,n,o){var a,s=this.C().clone().D(t+"/"+this.wc()+"/"+e+"/"+i+"/"+r).G(n||{}).toString(),l=0,u=s.length;if(0!==u)for(a=0;a<u;a++)l=(l<<5)-l+s.charCodeAt(a),l|=0;return s=l,(l=this.u[s])||(l=new Sq(this,t,e,i,r,n,Pp({headers:this.i},o||{})),this.u[s]=l),l},Tq.prototype.createTileProvider=Tq.prototype.De,Tq.prototype.qc=function(t,e,i,r,n,o,a,s){return new tl(t=this.De(t,e,i,r,n,s),{opacity:o,dark:!!a})},Tq.prototype.createTileLayer=Tq.prototype.qc,Y.prototype.oh=function(t){return this.Wa(Tq,t)},Y.prototype.getMapTileService=Y.prototype.oh,u(Xq,tq),t("H.service.publicTransit.Service",Xq),Xq.prototype.a=function(){return{subDomain:"transit.router",path:"v8"}},Xq.CONFIG_KEY="publicTransit",Xq.prototype.en=function(t,e,i){return t=this.C().clone().D("routes").G(t),this.J(t,e,i)},Xq.prototype.getRoutes=Xq.prototype.en,Xq.prototype.pm=function(t,e,i){return t=this.C().clone().D("departures").G(t),this.J(t,e,i)},Xq.prototype.getDepartures=Xq.prototype.pm,Xq.prototype.jn=function(t,e,i){return t=this.C().clone().D("stations").G(t),this.J(t,e,i)},Xq.prototype.getStations=Xq.prototype.jn,Xq.prototype.b=function(t){return Error(JSON.stringify(t))},Y.prototype.an=function(t){return this.Wa(Xq,t)},Y.prototype.getPublicTransitService=Y.prototype.an,u(Yq,tq),t("H.service.RoutingService",Yq),Yq.prototype.a=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Yq.prototype.b=function(t){return Error(t.details)},Yq.CONFIG_KEY="routing",Yq.prototype.Ld=function(t,e,i){return t=this.C().clone().D("calculateroute.json").G(t),this.J(t,e,i)},Yq.prototype.calculateRoute=Yq.prototype.Ld,Yq.prototype.Rg=function(t,e,i){return t=this.C().clone().Fa("isoline").D("calculateisoline.json").G(t),this.J(t,e,i)},Yq.prototype.calculateIsoline=Yq.prototype.Rg,u(Zq,tq),t("H.service.RoutingService8",Zq),Zq.CONFIG_KEY="routing_v8",Zq.prototype.a=function(){return{subDomain:"router",path:"v8/routes"}},Zq.prototype.b=function(t){return Error(t.error)},Zq.prototype.Ld=function(t,e,i){return t=this.C().clone().G(t),this.J(t,e,i)},Zq.prototype.calculateRoute=Zq.prototype.Ld,Zq.prototype.Rg=function(t,e,i){return t=this.C().clone().Fa("isoline").Hd("v8/isolines").G(t),this.J(t,e,i)},Zq.prototype.calculateIsoline=Zq.prototype.Rg,Y.prototype.Lj=function(t,e){if(7===(e=+e||7))e=Yq;else{if(8!==e)throw new D(this.Lj,1,"allowed values are 7 and 8");e=Zq}return this.Wa(e,t)},Y.prototype.getRoutingService=Y.prototype.Lj,t("H.service.extension.dataView.ITable",$q),$q.prototype.Vd=function(){},$q.prototype.getMeta=$q.prototype.Vd,$q.prototype.Yd=function(){},$q.prototype.getRowCount=$q.prototype.Yd,$q.prototype.vc=function(){},$q.prototype.getRow=$q.prototype.vc,$q.prototype.Ta=function(){},$q.prototype.getColumnNames=$q.prototype.Ta,$q.prototype.Ke=function(){},$q.prototype.getColumn=$q.prototype.Ke,$q.prototype.ya=function(){},$q.prototype.getCell=$q.prototype.ya,$q.prototype.concat=function(){},$q.prototype.concat=$q.prototype.concat,t("H.service.extension.dataView.IRow",ar),ar.prototype.Ta=function(){},ar.prototype.getColumnNames=ar.prototype.Ta,ar.prototype.ya=function(){},ar.prototype.getCell=ar.prototype.ya,ar.prototype.ud=function(){},ar.prototype.getTable=ar.prototype.ud,t("H.service.extension.dataView.ObjRow",br),br.prototype.Ta=function(){return this.a.Ta()},br.prototype.getColumnNames=br.prototype.Ta,br.prototype.ya=function(t){return this.a.ya(this.b,t)},br.prototype.getCell=br.prototype.ya,br.prototype.ud=function(){return this.a},br.prototype.getTable=br.prototype.ud,t("H.service.extension.dataView.IColumn",cr),cr.prototype.ya=function(){},cr.prototype.getCell=cr.prototype.ya,t("H.service.extension.dataView.ObjColumn",dr),dr.prototype.ya=function(t){return this.b.ya(t,this.a)},dr.prototype.getCell=dr.prototype.ya,t("H.service.extension.dataView.ObjTable",er),n=er.prototype,n.Yh=B,n.Fb=B,n.Md=B,n.Ug=B,n.Vd=function(){return this.Yh},er.prototype.getMeta=er.prototype.Vd,er.prototype.Yd=function(){return this.Fb?this.Fb.length:0},er.prototype.getRowCount=er.prototype.Yd,er.prototype.vc=function(t){var e=this.Fb;return e&&e[t]?new br(this,t):B},er.prototype.getRow=er.prototype.vc,er.prototype.Ta=function(){return this.Md||gf},er.prototype.getColumnNames=er.prototype.Ta,er.prototype.Ke=function(t){return this.Ug[t]?new dr(this,t):B},er.prototype.getColumn=er.prototype.Ke,er.prototype.ya=function(t,e){var i=this.Fb;return(t=i&&this.Ug[e]&&i[t])&&t[e]},er.prototype.getCell=er.prototype.ya,er.prototype.concat=function(){var t,e=arguments.length,i=this.Md,r=""+this.Md,n=(this.Fb||[]).slice();for(t=0;t<e;t++){var o=arguments[t];if(!(o instanceof er))throw new D(this.concat,t);if(o.Fb){if(i&&""+o.Md!==r)throw new D(this.concat,t,"Incompatible columns!");n=n.concat(o.Fb)}}return new er(n,this.Md,this.Yh)},er.prototype.concat=er.prototype.concat,u(ir,kh),t("H.service.remote.Spatial",ir);var jr={};function kr(t,e){this.a=t,e&&(this.b=e)}ir.prototype.gb=function(){return this.b||kh.prototype.gb.call(this)},ir.prototype.getId=ir.prototype.gb,ir.prototype.rg=id,ir.prototype.retain=ir.prototype.rg,ir.prototype.release=ef,ir.prototype.release=ir.prototype.release;var lr=new kr(gf);function mr(t,e,i){t.a[e.key]=new kr(i,void 0)}function nr(t,e,i,r){if(!Da(i))throw new D(t,e,"has invalid type");if(!Da(r))throw new D(t,e+1,"has invalid type")}function or(t,e,i){var r=8===t;this.b=e,this.c=i||id,(this.a=4===t||r)?this.j=r:this.g=1===t,this.f=this.a?"$HProjGeometry":"geometry"}function pr(t,e,i,r,n){var o=[],a=n.paths,s=a.length,l=0,u=t.b&&t.b(r);for(t=new ir(e,t.j,B,{style:u||t.i,data:r});l!==s;)o.push(rr(a[l++]));return mr(t,i,[new Ah(o,n.interiorsIndex,n.outlinesIndex)]),t}function qr(t,e,i,r){r=new Yf(r[0],r[1]);var n=t.b&&t.b(i);return t=t.g?new Gn(r,t={icon:n,data:i,provider:e}):new Zi(r,t={icon:n,data:i,provider:e})}function rr(t){for(var e=0,i=t.length,r=[];e<i;)r.push(new I(t[e++],t[e++]));return r}function sr(t,e){var i={};this.b=t,Xa(i,e||i),ik.call(this,i),this.ng={},(t=this.Nb(Yg.SPATIAL)).update(t.a+1,Vg.ADD)}function tr(t){return t.xc(!0)}function ur(t,e,i){var r,n=e.j&&e.j[i];return!n&&(r=e.o)&&(delete e.o,(e.j=t=t.b.parse(t,e,r))&&(n=t[i])),n||gf}ir.prototype.Td=function(t){return(this.a[t.key]||lr).a},ir.prototype.getGeometriesForTile=ir.prototype.Td,ir.prototype.nh=function(t){return(this.a[t.key]||lr).b},ir.prototype.getLabels=ir.prototype.nh,or.prototype.parse=function(t,e,i){var r,n,o,a,s={},l=[],u=0;for(o=i.length;u<o;u++){var c=i[u],h=c.Rows;if(c=h.length){var p=Object.keys(h[0]).filter((function(t){return"geometry"!==t&&"$HProjGeometry"!==t}));for(p=new er(h,p),a=0;a<c;a++){var f=h[a];if(n=f[this.f]){if(delete f[this.f],f=p.vc(a))try{(r=this.a?pr(this,t,e,f,n):qr(this,t,f,n.path)).ja(t),l.push(r)}catch(t){this.c(t.message)}}else this.c("Layer must contain geometries")}}}return s[this.a?"spatials":this.g?"markers":"domMarkers"]=l,s},u(sr,ik),t("H.service.remote.ObjectProvider",sr),sr.prototype.B=function(){ik.prototype.B.call(this)},sr.prototype.Fc=function(){return gf},sr.prototype.requestMarkers=sr.prototype.Fc,sr.prototype.Ec=function(){return gf},sr.prototype.requestDomMarkers=sr.prototype.Ec,sr.prototype.Dd=function(){return gf},sr.prototype.requestOverlays=sr.prototype.Dd,sr.prototype.Ub=ef,sr.prototype.providesMarkers=sr.prototype.Ub,sr.prototype.Tb=ef,sr.prototype.providesDomMarkers=sr.prototype.Tb,sr.prototype.Dc=ef,sr.prototype.providesSpatials=sr.prototype.Dc,sr.prototype.og=function(){return gf},sr.prototype.requestSpatials=sr.prototype.og,sr.prototype.pg=function(t,e){return t=ur(this,t,vr),e&&(t=t.filter(tr)),t},sr.prototype.requestSpatialsByTile=sr.prototype.pg,sr.prototype.ca=function(t){var e=t.gb();if(this.ng[e])throw new Yc(this.ca,"Remote object "+e+" already added");return this.ng[e]=t},sr.prototype.Ja=function(t){delete this.ng[t.gb()]};var vr="spatials";function wr(t){var e=(t=t||{}).tileCacheSize||1024,i=t.resultType,r=t.styleCallback;if(uc(t.min)||(t.min=12),wr.l.constructor.call(this,t),-1===xr.indexOf(i))throw new D(wr,2,"invalid resultType");if(this.b=i,r&&!Da(r))throw new D(wr,2,"invalid style callback");this.la=r,this.W=t.pixelRatio||Te(),this.Jb=A(this.Jb,this),this.o(new Lk(e,A(this.rb,this))),this.createTileInternal=A(4===i||8===i?this.R:this.L,this)}function yr(t){var e=t.Da;return e||(t.u||(t.u=t.m(t.b,t.la,t.Jb)),(e=t.Da=new sr(t.u)).ja(t),e.addEventListener(t.v.Ca,A(t.Ea,t)),e.Da=!0),e}u(wr,R),t("H.service.extension.TileProvider",wr),wr.prototype.g=!1,wr.prototype.getCapabilities=function(){return wr.l.getCapabilities.call(this)|Lj.CROP_LINES_BY_TILE|Lj.CROP_POLYGONS_BY_TILE},wr.prototype.jb=function(t,e,i,r){return this.g?wr.l.jb.call(this,t,e,i,r):B},wr.prototype.requestTile=wr.prototype.jb,wr.prototype.Jb=function(t){this.dispatchEvent(new ud("error",Ac(t)?t:t+"",this))},wr.prototype.Ub=function(){return 1===this.b},wr.prototype.providesMarkers=wr.prototype.Ub,wr.prototype.Tb=function(){return 2===this.b},wr.prototype.providesDomMarkers=wr.prototype.Tb,wr.prototype.Dc=function(){return 4===this.b||8===this.b},wr.prototype.providesSpatials=wr.prototype.Dc,wr.prototype.L=function(t,e,i,r){var n=this.getTileKey(t,e,i);n=this.Mb().get(n);var o=2==this.b,a=[],s=yr(this);for(n?n.valid=!0:(delete(t=n=new Tk(t,e,i,y)).j,t.o=r),e=(r=ur(s,n,o?"domMarkers":"markers")).length;e--;)(t=r[e]).Mi=n,(o||1===t.Ab().getState())&&a.push(t);return n.data=a,n},wr.prototype.Ea=function(t){(t=t.target.Mi)&&(t.valid=!1)},wr.prototype.Eo=function(t){this.A=!!t},wr.prototype.setTileCanvasRendering=wr.prototype.Eo,wr.prototype.A=!0,wr.prototype.R=function(t,e,i,r){var n=yr(this),o=this.getTileKey(t,e,i),a=this.tileSize,s=this.Mb().get(o);return s||(delete(t=s=new Xk(o,t,e,i,a,this.W,i,n)).j,t.o=r),this.A?(r=Xp.pop(a),s.V(r)||Xp.push(r,a)):cl(s),s},wr.prototype.rb=function(t,e){var i;if(4===this.b||8===this.b){for(i=(t=e.Ua()).length;i--;)delete t[i].a[e.key];(t=e.kg())&&(Xp.push(t,this.tileSize),e.mg())}else for(i=(t=e.data).length;i--;)delete t[i].Mi},wr.prototype.s=function(){wr.l.s.call(this),yr(this).B()};var zr={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};wr.ResultType=zr;var xr=[1,2,4,8];function hr(t,e,i){var r=this,n=e&&e.rowFilter,o=i.resultType;hr.l.constructor.call(this,i),C(t,Ar,hr,0),gr(e),n?(i=Va(e)).rowFilter=n.toString():i=Va(e),delete i.layer,i.layerId=$e(e.layerId,e.layer),(new Nf).a("pde","H.service.extension.worker.processor"),t=t.C().clone().D(Br+"."+Cr).G({meta:1}),new Qf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:4===o,serverUrl:t.toString(),layerConfigs:[i],horizontalMargin:1}]}).then((function(){r.g=!0,r.Xa()}),this.Jb)}u(hr,wr),t("H.service.extension.platformData.TileProvider",hr),hr.prototype.m=function(t,e,i){return(t=new or(t,e,i)).i=Dr,t};var Dr=new ch({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});function Er(t,e,i,r,n,o){nr(Er,1,e,i),nr(Er,2,r,n),(this.f=t.length)?(this.U=t,this.m=e,this.i=i,this.b=0,this.c=A(this.c,this),this.o=r,this.j=n,this.a=nc(),Xa(this.a,Fr,o||{}),this.g={},x.setTimeout(this.c,0)):e(gf,!0)}hr.prototype.J=function(t,e,i,r,n){var o,a=this,s=this.getTileKey(t,e,i);s=this.Mb().get(s);var l={cancel:id},u=!0,c=this.b;if(s&&(4===c||8===c?s.de()||(r(Xp.pop(this.tileSize),null),u=!1):(r(y),u=!1)),u){var h=Vp.setTimeout((function(){(o=new Qf("pde",{message:[a.uid,1,[t,e,i]]})).then(r,n)}),500);l.cancel=function(){o?o.cancel():Vp.clearTimeout(h)}}return l},hr.prototype.requestInternal=hr.prototype.J,hr.prototype.s=function(){hr.l.s.call(this),new Qf("pde",{message:[this.uid,3]})},hr.ResultType=zr;var Fr={duration:100,$l:"geometry",Zl:"WKT",Ao:"searchAttributes",mj:B};function Gr(t){this.a=t}function Ar(t){Ar.l.constructor.call(this,Ar,t)}Er.prototype.c=function(){for(var t,e=[],i=!1,r=Hk();this.b<this.f;){var n=this.U[this.b];if(i=n.attributes,t=n.layerId||this.a.mj,n.distance&&(i[this.a.Ao]={nearest:new Yf(n.nearestLat,n.nearestLon),distance:n.distance}),n=n[this.a.$l]){try{var o=Nn(new io(n))}catch(t){this.i(new x.Error(t.message)),i=!0;break}i[this.a.Zl]=o}if((n=this.g[t])||(n=this.g[t]=this.o({layerId:t,columnNames:Object.keys(i)})),i=this.j(n,i),e.push(i),this.b++,(i=this.b===this.f)||Hk()-r>=this.a.duration){this.m(e,i);break}}i?this.g={}:this.u=x.setTimeout(this.c,0)},Er.prototype.cancel=function(){x.clearTimeout(this.u),this.b<this.f&&this.i(new x.Error("parsing canceled"))},Er.prototype.cancel=Er.prototype.cancel,Gr.prototype.cancel=function(){for(var t=this.a,e=t.length;e--;)t[e].cancel();t.length=0},u(Ar,tq),t("H.service.extension.platformData.Service",Ar),Ar.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"1"}},Ar.CONFIG_KEY="platformData",Ar.prototype.request=function(t,e,i,r,n){var o="text/plain";if(!t)throw new D(this.request,0,t);if(!e)throw new D(this.request,1,e);if(!r)throw new D(this.request,3,r);if(!n)throw new D(this.request,4,n);return t=this.C().clone().D(t+"."+e).G(i),e===Hr.JSON&&(o="application/json"),this.J(t,r,n,o)};var Br="tiles";Ar.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:Br,FILE:"file",INDEX:"index"};var Cr="json",Hr={TXT:"txt",JSON:Cr,HTML:"html",BIN:"bin"};function Ir(t,e,i,r,n){var o,a=[],s=i.layer_id||i.layer_ids;return t=t.request(e,Cr,i,(function(t){o=new Er(t.geometries,r,n,(function(t){return new er([],t.columnNames,t)}),(function(t,e){return t.vc(fr(t,e))}),{mj:s}),a.push(o)}),(function(t){n(new x.Error(t))})),a.push(t),new Gr(a)}function Jr(t,e,i){if(!zc(t))throw new D(i,0,"has invalid type");if(!zc(e))throw new D(i,1,"has invalid type");if(t.length!==e.length||!t.length)throw new D(i,1,"specify one key attribute for each given layer id in the same order")}function Kr(t){Kr.l.constructor.call(this,Kr,t)}function Lr(t){var e=Mr;if(!t||!Ac(t.layerId)||uc(t.rowFilter)&&!Da(t.rowFilter)||uc(t.rowFilterContext)&&!Ea(t.rowFilterContext))throw new D(e,1,uc("invalid layer config")?"invalid layer config":t)}function Nr(t){return Ac(t)&&/^[A-Z][A-Z0-9_]*$/.test(t)}function Or(t){for(var e=t&&t.length,i=2<=e&&"WKT"===t[--e]&&"GEOMETRY_ID"===t[--e];i&&e--;)i=Nr(t[e]);return i}function Pr(t,e){var i="",r=[];if(e){var n=t.geometries;if(n&&n.length){var o=Object.keys(n[0].attributes);for(i=i+"Meta:\t"+e+"\n"+o.join("\t"),i+="\tWKT\n",t=0;t<n.length;t++){var a=n[t].attributes,s=n[t].geometry;for(e=0;e<o.length;e++)r.push(a[o[e]]);i+=r.join("\t"),i+="\t"+s+"\n",r=[]}}}else{if(s={},r=[],t.geometries)for(n=0;n<t.geometries.length;n++)s[(e=t.geometries[n]).layerId]||(s[e.layerId]=[]),s[e.layerId].push(e);for(o in s)r.push({layerId:o,geometries:s[o]});for(t=0;t<r.length;t++)i+=Pr(r[t],r[t].layerId)}return i}function Mr(t,e,i){var r,n=this,o=e&&e.rowFilter;Mr.l.constructor.call(this,i),C(t,Qr,Mr,0);var a=i.resultType;if(Lr(e),o){var s=Va(e);s.rowFilter=o.toString()}else s=e;(new Nf).a("cle","H.service.extension.worker.processor");var l=e.layerId;t.request(Rr,Sr,{detail_level:"all",layer_id:l},(function(e){var i;for(e=e.layers,i=0;i<e.length;i++)if(e[i].layerId===l){s.level=e[i].level;break}r=t.C().clone().D(Tr+"."+Sr).G({meta:1}),new Qf("cle",{message:[n.uid,0,{tileSize:n.tileSize,projected:!0,onlyOutline:4===a,serverUrl:r.toString(),layerConfigs:[s],batchTiles:!1,horizontalMargin:1}]}).then((function(){n.g=!0,n.Xa()}),n.Jb)}),(function(t){n.Jb(t.message)}))}function Ur(){if(Vr)throw new Yc(Ur)}Ar.EntryPointType=Hr,Ar.prototype.qc=function(t,e){var i=e&&e.resultType;return t=new hr(this,t,e),1==i||2===i?new Jn(t):new tl(t)},Ar.prototype.createTileLayer=Ar.prototype.qc,Ar.prototype.Gc=function(t,e,i,r,n,o){function a(t,e){e&&s--,r(t,!s)}var s,l=[];for(Jr(t,e,this.Gc),nr(this.Gc,3,r,n),C(i,K,this.Gc,2),i={bbox:i.ka+","+i.aa+";"+i.ma+","+i.ga},o&&Xa(i,o),t=i.layer_id?[i.layer_id]:t,o=0,s=t.length;o<s;o++)i.layer_id=t[o],i.key_attribute=e[o],l.push(Ir(this,"search/bbox",i,a,n));return new Gr(l)},Ar.prototype.searchByBoundingBox=Ar.prototype.Gc,Ar.prototype.Wb=function(t,e,i,r,n,o,a){if(Jr(t,e,this.Wb),C(i,Yf,this.Wb,2,"has invalid type"),!Dc(r))throw new D(this.Wb,3,"has invalid type");return nr(this.Wb,4,n,o),t={layer_ids:t.join(","),key_attributes:e.join(","),proximity:i.lat+","+i.lng+","+r},a&&Xa(t,a),Ir(this,"search/proximity",t,n,o)},Ar.prototype.searchByProximity=Ar.prototype.Wb,Ar.prototype.Vb=function(t,e,i,r,n,o,a){var s="";if(Jr(t,e,this.Vb),!Ac(i)&&!C(i,L))throw new D(this.Vb,1,"has invalid type");if(!Dc(r))throw new D(this.Vb,2,"has invalid type");if(nr(this.Vb,4,n,o),t={layer_ids:t.join(","),key_attributes:e.join(","),radius:r},Ac(i))t.route_id=i;else{for(r=i.Y,i=0,e=r.length;i<e;i+=3)s+=r[i]+","+r[i+1],i<e-3&&(s+=";");t.corridor=s}return a&&Xa(t,a),Ir(this,"search/corridor",t,n,o)},Ar.prototype.searchByCorridor=Ar.prototype.Vb,Y.prototype.Wm=function(t){return this.Wa(Ar,t)},Y.prototype.getPlatformDataService=Y.prototype.Wm,u(Kr,tq),t("H.service.extension.geofencing.Service",Kr),Kr.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}},Kr.CONFIG_KEY="geofencing",Kr.prototype.request=function(t,e,i,r){if(!t)throw new D(this.request,0,t);if(!Da(i))throw new TypeError("onResult must be a function");if(!Da(r))throw new TypeError("onError must be a function");return t=this.C().clone().D(t+".json").G(e),this.J(t,i,r)},Kr.prototype.request=Kr.prototype.request,Kr.prototype.b=function(t){return Error(t.issues&&t.issues.length?t.issues.map((function(t){return t.message})).join(". "):t.message||t.response_code)},Kr.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},Y.prototype.ym=function(t){return this.Wa(Kr,t)},Y.prototype.getGeofencingService=Y.prototype.ym,t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"}),u(Mr,wr),t("H.service.extension.customLocation.TileProvider",Mr),Mr.prototype.m=function(t,e,i){return new or(t,e,i)},Mr.prototype.J=function(t,e,i,r,n){var o,a=this,s=this.getTileKey(t,e,i);s=this.Mb().get(s);var l={cancel:id},u=!0,c=this.b;if(s&&(4===c||8===c?s.de()||(r(Xp.pop(this.tileSize),null),u=!1):(r(y),u=!1)),u){var h=Vp.setTimeout((function(){(o=new Qf("cle",{message:[a.uid,1,[t,e,i]]})).then(r,n)}),500);l.cancel=function(){o?o.cancel():Vp.clearTimeout(h)}}return l},Mr.prototype.requestInternal=Mr.prototype.J,Mr.prototype.s=function(){Mr.l.s.call(this),new Qf("cle",{message:[this.uid,3]})},t("H.service.extension.customLocation.Table",Ur);var Vr=!0;function Wr(t,e){var i;Vr=!1;var r=new Ur;Vr=!0,r.c=qc(x.JSON.parse(x.JSON.stringify(t))),t=t.columnNames;var n=nc();for(i=t.length;i--;)n[t[i]]=i;if(r.f=n,r.b=t.length,e){if(e.length%t.length)throw new D(Wr,1,"Invalid number of cells")}else e=[];return r.a=e,r}Ur.prototype.Vd=function(){return this.c},Ur.prototype.getMeta=Ur.prototype.Vd,Ur.prototype.Yd=function(){return this.a.length/this.b},Ur.prototype.getRowCount=Ur.prototype.Yd,Ur.prototype.vc=function(t){return t<this.a.length/this.b?new Xr(this,t):B},Ur.prototype.getRow=Ur.prototype.vc,Ur.prototype.fn=function(){var t,e=this.a.length/this.b,i=new x.Array(e);for(t=0;t<e;t++)i[t]=new Xr(this,t);return i},Ur.prototype.getRows=Ur.prototype.fn,Ur.prototype.Lg=function(t){var e=this.b,i=this.a,r=i.length/this.b;if(!t||t.length%e)throw new D(this.Lg,0,"Invalid number of cells");return this.a=i.concat(t),r},Ur.prototype.addCells=Ur.prototype.Lg,Ur.prototype.El=function(){for(var t=this.b,e=this.a,i=this.a.length/this.b;t--;)e.push(y);return this.vc(i)},Ur.prototype.addRow=Ur.prototype.El,Ur.prototype.Ta=function(){return this.c.columnNames},Ur.prototype.getColumnNames=Ur.prototype.Ta,Ur.prototype.Ke=function(t){return this.f[t]===B?B:new Yr(this,t)},Ur.prototype.getColumn=Ur.prototype.Ke,Ur.prototype.ya=function(t,e){return this.a[t*this.b+this.f[e]]},Ur.prototype.getCell=Ur.prototype.ya,Ur.prototype.Hc=function(t,e,i){if(e=this.f[e],t>=this.a.length/this.b)throw new D(this.Hc,0,"Row index out of bounds");if(e===B)throw new D(this.Hc,0,"Column unknown");this.a[t*this.b+e]=i},Ur.prototype.setCell=Ur.prototype.Hc,Ur.prototype.concat=function(t){var e,i=arguments.length,r=""+this.Ta(),n=this.a?this.a.slice():[];for(e=0;e<i;e++){var o=arguments[e];if(!(o instanceof Ur))throw new D(this.concat,e);if(""+o.Ta()!==r)throw new D(this.concat,e,"Incompatible columns!");o.a&&(n=n.concat(o.a))}return Wr(this.c,n)},Ur.prototype.concat=Ur.prototype.concat;var Zr=/(\n|\t|\r|")/;function $r(t,e,i,r,n,o,a,s){var l;for(l=0;l<a;l++){l&&e.push("\t");var u=i[r*n+o[l]];if(l!==s){if(u!==y){if(u=String(u),Zr.test(u))throw new D(t.Ki,0,'Invalid character (\\n, \\r, \\t, or ") in row '+r+" column "+t.c.columnNames[o[l]]);e.push(u)}}else e.push(u)}}function Yr(t,e){this.b=t,this.a=e}function Xr(t,e){this.a=t,this.Sh=e}function as(t){if(t===B)t="\t";else if(!/^[^"\r\n]$/.test(t))throw new D(as,0);this.c=String(t).charCodeAt(0),this.Th=A(this.Th,this),this.a=bs}Ur.prototype.Ki=function(t,e){var i,r=this.b,n=this.Ta(),o=[],a=[],s=this.a,l=-1;for(i=0;i<r;i++)t&&!t.test(n[i])||("WKT"===n[i]&&(l=o.length),o.push(i));if(!(t=o.length))throw new D(this.Ki,1,"No columns filtered");if($r(this,a,n,0,r,o,t,l),e){var u=e.length;for(i=0;i<u;i++)a.push("\n"),$r(this,a,s,n=e[i],r,o,t,l)}else for(u=this.Yd(),n=0;n<u;n++)a.push("\n"),$r(this,a,s,n,r,o,t,l);return a.join("")},Ur.Column=Yr,Yr.prototype.ya=function(t){return this.b.ya(t,this.a)},Yr.prototype.getCell=Yr.prototype.ya,Yr.prototype.Hc=function(t,e){this.b.Hc(t,this.a,e)},Yr.prototype.setCell=Yr.prototype.Hc,Ur.Row=Xr,Xr.prototype.Ta=function(){return this.a.Ta()},Xr.prototype.getColumnNames=Xr.prototype.Ta,Xr.prototype.ya=function(t){return this.a.ya(this.Sh,t)},Xr.prototype.getCell=Xr.prototype.ya,Xr.prototype.Hc=function(t,e){this.a.Hc(this.Sh,t,e)},Xr.prototype.setCell=Xr.prototype.Hc,Xr.prototype.ud=function(){return this.a},Xr.prototype.getTable=Xr.prototype.ud;var bs=0;function cs(t,e,i){var r=t.a;if(r!==e)throw 1===r&&(t.a=bs),new Yc(i,"Requires state: "+["READY","PARSE","PAUSE"][e]+" but found "+["READY","PARSE","PAUSE"][r])}function ds(t,e){var i=[];return t.parse(e,(function(t,e,r){return 1>t&&(i[e]=r),0<t})),t.a=bs,i}function es(t,e,i){this.c=new io(t),this.o=e,this.g=!0,this.Bf=this.j=this.b=0,fs(this),this.a=i,this.f=[],this.i=!1}function fs(t){var e=t.c.Rb();t.m=!1,(t.U=34===e)&&t.c.next()}function gs(t,e){var i=t.c;switch(t.m=!0,e){case t.o:t.b++;break;case 13:i.next(),10!==i.Rb()&&t.a("CR without LF");case 10:t.b=0,t.j++;break;case-1:t.g=!1;break;default:t.a("End of field expected")}return i.next(),-1}function hs(t,e,i,r){if(r=r||{},!e)throw new D(hs,1,"has to be a function");if(!i)throw new D(hs,2,"has to be a function");for(this.o=e,this.u=i,this.a=[],this.g={},this.f=[],this.b={},this.i={},this.j={},this.m={},this.U=r.duration||100,this.c=A(this.c,this),t=t.split("Meta:\t").slice(1),e=0;e<t.length;e++){i=(r=t[e].split("\n"))[0].split("\t")[0],r=r.slice(1).join("\n"),this.b[i]=new as,this.g[i]=ds(this.b[i],r);var n={layerId:i,columnNames:this.g[i]};this.f.push(i),this.m[i]=Wr(n),this.i[i]=Hk(),is(this,r,i),this.c(i)}}function is(t,e,i){var r=[],n=t.g[i].length-1,o=t.m[i];try{t.b[i].parse(e,(function(e,a,s){var l=!1;return 0<e&&(r[a]=s,a===n&&(t.a.push(o.vc(o.Lg(r))),Hk()-t.i[i]>t.U&&(l=!0))),l}),(function(t,e,i){if(0<t&&e===n)return Nn(i)}))}catch(e){t.u(e)}}function Qr(t){Qr.l.constructor.call(this,Qr,t)}function js(t,e,i,r){var n,o=e[t=t===ks?"changes":"file"],a=Ac(o),s=!a&&C(o,Blob);if(!a&&!s)throw new D(r,0,"Invalid "+t+" parameter");if(ls)n=s?o:of(o,"text/plain"),(r=new x.FormData).append(t,n,n.name||t+".wkt"),i.method="POST",i.data=r,delete e[t];else if(s)throw new D(r,0,"Sending Blob data is not supported by the browser")}n=as.prototype,n.getState=function(){return this.a},n.abort=function(){cs(this,2,as.prototype.abort),this.a=bs},n.Th=function(t){throw this.a=bs,new D(as.prototype.parse,0,"Malformed DSV at row "+this.b.j+" column "+this.b.b+": "+t)},n.parse=function(t,e,i){cs(this,bs,as.prototype.parse),t=t.trim(),this.b=new es(t,this.c,this.Th),this.f=e,this.tk=i||ff,this.a=2,this.Uh()},n.tk=ff,n.Uh=function(){var t=this.b,e=[];cs(this,2,as.prototype.Uh),this.a=1;do{if(!t.g){this.a=bs;break}if(n>t.b){if(void 0!==i&&i!==n)return void this.b.a("The number of columns must be the same for all rows");var i=n}var r=t.j,n=t.b,o=t.Bf,a=this.tk(r,n,t);if(t.Bf>o)for(;-1!==t.next(););else{for(;-1!==(o=t.next());)e.push(o);a=String.fromCharCode.apply(y,e),e.length=0}fs(t),this.f(r,n,a)&&(this.a=t.g?2:bs)}while(1===this.a);2!=this.a&&void 0!==i&&0<n&&i!==n&&this.b.a("The number of columns must be the same for all rows")},n=es.prototype,n.Bf=0,n.Rb=function(){if(this.m)var t=-1;else{var e=this.c;if(t=e.Rb(),this.U)switch(t){case 34:e.next(),34!==(t=e.Rb())&&(t=gs(this,t));break;case-1:this.a("Closing quotation mark expected")}else switch(t){case 34:this.a("Unexpected quotation mark");case this.o:case 13:case 10:case-1:t=gs(this,t)}}return t},n.re=function(){this.i=!0,this.f=[]},n.Od=function(){var t=this.f.slice();return this.i=!1,this.f=[],t},n.next=function(){var t=this.Rb();return-1!==t&&this.c.next(),this.i&&this.f.push(t),this.Bf++,t},hs.prototype.cancel=function(){for(var t in this.j)x.clearTimeout(this.j[t])},hs.prototype.cancel=hs.prototype.cancel,hs.prototype.c=function(t){var e,i,r=this;this.j[t]=x.setTimeout((function(){if(2===r.b[t].getState())r.i[t]=Hk(),r.o(r.a,!1),r.a=[],r.b[t].Uh(),r.c(t);else{for(e=!0,i=0;i<r.f.length;i++)if(r.b[r.f[i]].getState()!==bs){e=!1;break}e&&(0<r.a.length&&r.o(r.a,!0),r.a=[])}}),0)},u(Qr,tq),t("H.service.extension.customLocation.Service",Qr),Qr.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}},Qr.CONFIG_KEY="customLocation",Qr.prototype.qc=function(t,e){var i=e&&e.resultType;return t=new Mr(this,t,e),1===i||2===i?new Jn(t):new tl(t)},Qr.prototype.createTileLayer=Qr.prototype.qc;var ls=x.FormData&&!!x.FormData.prototype.append;function ms(t,e,i,r,n,o){var a="text/plain",s=e===ns.LAYERS_UPLOAD||e===ns.LAYERS_MODIFY||e===ns.LAYERS_IMPORT,l=r,u={data:B,method:"GET",headers:t.i};if(!e)throw new D(t.request,0,e);if(!i)throw new D(t.request,1,i);nr(t.request,3,n,o),s&&(C(r,Object,t.request,2,"Invalid request parameters"),js(e,l=Va(r),u,t.request));var c=t.C().clone().D(e+"."+i).G(l);return i===os.JSON&&(a="application/json"),(t=new sf(a,c.toString(),ge,u)).then((function(t){var e=t.issues;e&&t.error_id&&t.response_code?o(Error(e[0].message)):n(t)}),(function(t){"error"===t.type||404===t.status?o(Error(t.statusText||"Unable to load data")):t.json().then((function(t){o(Error("["+t.issues[0].message+"] "+c+" request failed"))}),(function(){o(Error("["+t.statusText+"] "+c+" request failed"))}))})),t}Qr.prototype.request=function(t,e,i,r,n){return ms(this,t,e,i,r,n)};var Rr="layers/list",ks="layers/modify",Tr="tiled/tile",ns={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:Rr,LAYERS_MODIFY:ks,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:Tr};Qr.EntryPoint=ns;var Sr="json",os={TXT:"txt",JSON:Sr};function ps(t,e,i,r,n){var o,a=[];return t=t.request(e,Sr,i,(function(t){t.geometries.length?(t=Pr(t,i.layer_id),o=new hs(t,r,n),a.push(o)):r(gf,!0)}),n),a.push(t),new Gr(a)}Qr.EntryPointType=os,Qr.prototype.sb=function(t,e,i){var r=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:t},(function(n){var o=String(n).replace(/[\r\n]+$/g,"").split("\t");r.request(Rr,Sr,{layer_id:t,detail_level:"all"},(function(t){(t=t.layers[0]).columnNames=o,e(Wr(t))}),i)}),i)},Qr.prototype.getLayer=Qr.prototype.sb,Qr.prototype.Rj=function(t,e,i,r){var n=e&&e.length,o=-1,a=this;return function s(){return++o<n?a.request("layers/access/grant",Sr,{layer_id:t,granted_app_id:e[o].grantedAppId,permissions:e[o].permissions.join(",")},s,r):a.sb(t,i,r)}()},Qr.prototype.grantAccess=Qr.prototype.Rj,Qr.prototype.oj=function(t,e,i){return this.request("layers/delete",Sr,{layer_ids:t},e,i)},Qr.prototype.deleteLayer=Qr.prototype.oj,Qr.prototype.nd=function(t,e,i){function r(){setTimeout((function(){l.sb(a,(function(t){setTimeout(n.bind(null,t),c)}),(function(){64e3>u?(u+=c,r()):i(x.Error("Timeout"))}))}),c),c*=2}function n(r){var n=JSON.stringify(r.Ta()),o=t.grants;if(n!==JSON.stringify(s)){var u="Results into different column names on the backend: "+n;setTimeout((function(){l.oj(a,(function(){i(x.Error(u))}),(function(t){i(x.Error(u+". "+t.message))}))}),c)}else o&&o.length?l.Rj(a,o,e,i):e(r)}var o,a,s,l=this,u=0,c=1e3,h=!t||!Nr(a=t.layerId)&&(o="layerId")||!Or(s=t.columnNames)&&(o="columnNames")?0:Da(e)?Da(i)?-1:2:1;if(0<=h)throw new D(l.nd,h,o||arguments[h]);return l.sb(a,(function(){i(x.Error("Layer exists already"))}),(function(){var e={layer_id:a,file:s.join("\t")},n=t.level,o=t.storage;n!==B&&(e.level=n),o!==B&&(e.storage=o),l.request("layers/upload",Sr,e,r,i)}))},Qr.prototype.createLayer=Qr.prototype.nd,Qr.prototype.Wb=function(t,e,i,r,n,o){if(!zc(t))throw new D(this.Wb,0,"has invalid type");if(C(e,Yf,this.Wb,1,"has invalid type"),!Dc(i))throw new D(this.Wb,2,"has invalid type");return nr(this.Wb,3,r,n),t={layer_ids:t.join(","),proximity:e.lat+","+e.lng+","+i},o&&Xa(t,o),ps(this,"search/proximity",t,r,n)},Qr.prototype.searchByProximity=Qr.prototype.Wb,Qr.prototype.Vb=function(t,e,i,r,n,o){var a="";if(!zc(t))throw new D(this.Vb,0,"has invalid type");if(!Ac(e)&&!C(e,L))throw new D(this.Vb,1,"has invalid type");if(!Dc(i))throw new D(this.Vb,2,"has invalid type");if(nr(this.Vb,3,r,n),t={layer_ids:t.join(","),radius:i},Ac(e))t.route_id=e;else{var s=e.Y;for(e=0,i=s.length;e<i;e+=3)a+=s[e]+","+s[e+1],e<i-3&&(a+=",");t.corridor=a}return o&&Xa(t,o),ps(this,"search/corridor",t,r,n)},Qr.prototype.searchByCorridor=Qr.prototype.Vb,Qr.prototype.Gc=function(t,e,i,r,n){function o(t,e){e&&a--,i(t,!a)}var a,s=[];if(!zc(t))throw new D(this.Gc,0,"has invalid type");for(C(e,K,this.Gc,1,"has invalid type"),nr(this.Gc,2,i,r),e={bbox:e.ka+","+e.aa+";"+e.ma+","+e.ga},n&&Xa(e,n),t=e.layer_id?[e.layer_id]:t,n=0,a=t.length;n<a;n++)e.layer_id=t[n],s.push(ps(this,"search/bbox",e,o,r));return new Gr(s)},Qr.prototype.searchByBoundingBox=Qr.prototype.Gc,Qr.prototype.pi=function(t,e,i,r){var n,o=[];if(!Ac(t))throw new D(this.pi,0,"has invalid type");nr(this.pi,1,e,i);var a={layer_id:t};return r&&Xa(a,r),r=this.request("search/all",Sr,a,(function(r){r.geometries.length?(r=Pr(r,t),n=new hs(r,e,i),o.push(n)):e(gf,!0)}),i),o.push(r),new Gr(o)},Qr.prototype.searchAll=Qr.prototype.pi;var qs={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function rs(t,e,i,r,n,o){function a(){d++,r(this,d===p)}function s(t){d++,n(t,this,d===p)}var l,u="append"!==e,c={},h=nc(),p=0,f=[],d=0;if(!zc(i))throw new D(o,0,i);for(nr(o,1,r,n),l=i.length;l--;){var g=i[l];if(C(g,Xr)){var v=g.ud().Vd().layerId,m=g.ya("GEOMETRY_ID");if(u){if(m===y||""===String(m))var _='GEOMETRY_ID must not be null or ""';c[m=v+"_"+m]&&(_="same GEOMETRY_ID for multiple rows"),c[m]=g}else m!==y&&""!==String(m)&&(_='GEOMETRY_ID must be null or ""')}else _="Invalid type";if(_)throw new D(o,0,"- Invalid row at index "+l+", "+_);(m=h[v])||(m=h[v]=[],p++),m.push(g)}for(v in h){for(i=[],l=(m=h[v]).length;l--;)i.push(m[l].Sh);f.push(t.request(ks,Sr,{layer_id:v,action:e,changes:m[0].ud().Ki(qs[e]||null,i)},A(a,m),A(s,m)))}return new Gr(f)}function ss(t){Aq.l.constructor.call(this,ss,t)}function ts(t){ts.l.constructor.call(this,ts,t)}function us(t){if(this.f=!!t.toBypassToken,!this.f&&!t.token)throw new D(us,0,'"token" must be specified');us.l.constructor.call(this,us,t),this.o=t.token,this.g={},this.c={}}function zs(t,e,i,r,n,o,a){return n={method:n,headers:Object.assign(t.f?{}:{authorization:"Bearer "+t.o},{"Content-Type":"application/geo+json"},t.i)},o&&(n.data=JSON.stringify(o)),(o=new sf("application/json",(e=ws(t.C().clone().D(e+"/features").G(a||{}))).toString(),ge,n)).then(i,vq(t,e,r)),o}function ys(t,e){t.c[e]=As,t.Sf(e,(function(i){t.c[e]=Bs,t.g[e]=i.copyright,t.dispatchEvent("copyrightupdate")}),(function(i){throw t.c[e]=Cs,i}))}function xs(t,e){return t.f?e:ws(e).G({access_token:t.o})}function ws(t){var e=Object.assign({},t.getQuery());return delete e.apikey,t.xg(e)}Qr.prototype.ej=function(t,e,i){return rs(this,"append",t,e,i,this.ej)},Qr.prototype.appendRows=Qr.prototype.ej,Qr.prototype.sl=function(t,e,i){return rs(this,"update",t,e,i,this.sl)},Qr.prototype.updateRows=Qr.prototype.sl,Qr.prototype.pj=function(t,e,i){return rs(this,"delete",t,e,i,this.pj)},Qr.prototype.deleteRows=Qr.prototype.pj,Y.prototype.nm=function(t){return this.Wa(Qr,t)},Y.prototype.getCustomLocationService=Y.prototype.nm,u(ss,tq),t("H.service.extension.customRoute.Service",ss),ss.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"2"}},ss.CONFIG_KEY="customRoute",ss.prototype.b=function(t){return Error(t.issues&&t.issues.length?t.issues.map((function(t){return t.message})).join(". "):t)},ss.prototype.Ld=function(t,e,i){return nr(this.Ld,1,e,i),t=this.C().clone().D("calculateroute.json").G(t),this.J(t,e,i)},ss.prototype.calculateRoute=ss.prototype.Ld,Y.prototype.om=function(t){return this.Wa(ss,t)},Y.prototype.getCustomRoutingService=Y.prototype.om,u(ts,tq),t("H.service.SearchService",ts),ts.CONFIG_KEY="search",ts.prototype.a=function(){return{subDomain:"search",path:"v1"}},ts.prototype.b=function(t){return t=[t.title,t.action,t.cause].filter((function(t){return t})),Error(t.join(". "))},ts.prototype.fh=function(t,e,i){return t=this.C().clone().Fa("geocode").D("geocode").G(t),this.J(t,e,i)},ts.prototype.geocode=ts.prototype.fh,ts.prototype.oi=function(t,e,i){return t=this.C().clone().Fa("revgeocode").D("revgeocode").G(t),this.J(t,e,i)},ts.prototype.reverseGeocode=ts.prototype.oi,ts.prototype.Il=function(t,e,i){return t=this.C().clone().Fa("autosuggest").D("autosuggest").G(t),this.J(t,e,i)},ts.prototype.autosuggest=ts.prototype.Il,ts.prototype.Pl=function(t,e,i){return t=this.C().clone().Fa("discover").D("discover").G(t),this.J(t,e,i)},ts.prototype.discover=ts.prototype.Pl,ts.prototype.Sn=function(t,e,i){return t=this.C().clone().Fa("lookup").D("lookup").G(t),this.J(t,e,i)},ts.prototype.lookup=ts.prototype.Sn,ts.prototype.Kl=function(t,e,i){return t=this.C().clone().Fa("browse").D("browse").G(t),this.J(t,e,i)},ts.prototype.browse=ts.prototype.Kl,Y.prototype.hn=function(t){return this.Wa(ts,t)},Y.prototype.getSearchService=Y.prototype.hn,u(us,tq),t("H.service.xyz.Service",us),us.prototype.a=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},us.prototype.b=function(t){return Error(t.errorMessage||t.message)},us.prototype.rh=function(t,e,i){return xc(t,"String",this.rh,0,'"projectId" must be a string'),vs(this.rh,1,e,i),t=ws(this.C().clone().Hd("project-api/projects/"+t)),this.J(t,e,i)},us.prototype.getProject=us.prototype.rh,us.prototype.Mj=function(t,e,i){return vs(this.Mj,0,t,e),i=xs(this,this.C().clone().G(i||{})),this.J(i,t,e)},us.prototype.getSpaces=us.prototype.Mj,us.prototype.Sf=function(t,e,i){return xc(t,"String",this.Sf,0,'"spaceId" must be a string'),vs(this.Sf,1,e,i),t=xs(this,this.C().clone().D(t)),this.J(t,e,i)},us.prototype.getSpace=us.prototype.Sf,us.prototype.Zd=function(t,e,i){return xc(t,"String",this.Zd,0,'"spaceId" must be a string'),vs(this.Zd,1,e,i),t=xs(this,this.C().clone().D(t+"/statistics")),this.J(t,e,i)},us.prototype.getStatistics=us.prototype.Zd,us.prototype.Nf=function(t,e,i,r,n,o,a){return t=xs(this,this.C().clone().D(r+"/tile/web/"+i+"_"+t+"_"+e+".mvtf").G(Object.assign({clip:!0},a))),this.J(t,(function(t){return t.arrayBuffer().then(n)}),o,"arraybuffer")},us.prototype.search=function(t,e,i,r){return xc(t,"String",this.search,0,'"spaceId" must be a string'),vs(this.search,1,e,i),t=xs(this,this.C().clone().D(t+"/search").G(r||{})),this.J(t,e,i)},us.prototype.search=us.prototype.search,us.prototype.Yc=function(t,e,i,r){if(xc(t,"String",this.Yc,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.Yc,1,'"params" must be an object');return vs(this.Yc,2,i,r),t=xs(this,this.C().clone().D(t+"/features").G(e)),this.J(t,i,r)},us.prototype.getFeaturesById=us.prototype.Yc,us.prototype.Sd=function(t,e,i,r){if(xc(t,"String",this.Sd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.Yc,1,'"params" must be an object');return vs(this.Sd,2,i,r),t=xs(this,this.C().clone().D(t+"/bbox").G(e)),this.J(t,i,r)},us.prototype.getFeaturesByBoundingBox=us.prototype.Sd,us.prototype.ua=function(t){return this.g[t]||(this.c[t]||ys(this,t),null)},us.prototype.fd=function(t,e,i,r,n){if(xc(t,"String",this.fd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.fd,1,'"geojsonObject" must be an object');if(vs(this.fd,2,i,r),n&&!Ea(n))throw new D(this.fd,4,'"opt_params" must be an object');return zs(this,t,i,r,"PUT",e,n)},us.prototype.putFeatures=us.prototype.fd,us.prototype.dd=function(t,e,i,r,n){if(xc(t,"String",this.dd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.dd,1,'"featureCollection" must be an object');if(vs(this.dd,2,i,r),n&&!Ea(n))throw new D(this.dd,4,'"opt_params" must be an object');return zs(this,t,i,r,"POST",e,n)},us.prototype.postFeatures=us.prototype.dd,us.prototype.pd=function(t,e,i,r){if(xc(t,"String",this.pd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.pd,1,'"params" must be an object');return vs(this.pd,2,i,r),zs(this,t,i,r,"DELETE",B,e)},us.prototype.deleteFeatures=us.prototype.pd,us.CONFIG_KEY="xyz";var As=1,Bs=2,Cs=-1;function vs(t,e,i,r){if(!Da(i))throw new D(t,e,'"onResult" must be a function');if(!Da(r))throw new D(t,e+1,'"onError" must be a function')}function Ds(t,e,i){var r;if(Ds.l.constructor.call(this,i?{min:i.min,max:i.max,engineType:i.engineType}:void 0),C(t,us,Ds,0),!Ac(e))throw new D(Ds,1,'"spaceId" must be a string');if(this.m=t,this.b=e,this.g={},i&&(["limit","simplificationLevel","tags"].forEach((function(t){t in i&&(this.g[t]=i[t])}),this),t=i.parameters))for(r in t)this.g[r]=t[r];this.Zb(this.c===ek.WEBGL?new bi({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.b},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.b,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.b,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.b,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.b,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",lineWidth:"2px",renderOrder:203}]}))}function Es(t){var e;if(t)for(Fs={},e=t.length;e--;)Fs[t[e]]=!0;this.jl={}}Y.prototype.vn=function(t){return this.Wa(us,t)},Y.prototype.getXYZService=Y.prototype.vn,u(Ds,R),t("H.service.xyz.Provider",Ds),Ds.prototype.J=function(t,e,i,r,n){return this.m.Nf(t,e,i,this.b,r,n,this.g)},Ds.prototype.requestInternal=Ds.prototype.J,Ds.prototype.ua=function(){return this.m.ua(this.b)},Ds.prototype.getCopyrights=Ds.prototype.ua,Ds.prototype.Ad=ef,Ds.prototype.providesOMV=Ds.prototype.Ad,Ds.prototype.va=function(){return this.tb()},Ds.prototype.getStyle=Ds.prototype.va,Ds.prototype.lc=function(t){C(t,bi)&&t.b("MVT"),this.Zb(t)},Ds.prototype.setStyle=Ds.prototype.lc,t("H.service.buildInfo",(function(){return Ff("H-service","1.30.9","bc7b03e3")}));var Gs,Fs={};Es.prototype.parse=function(t,e,i){var r,n,o,a,s;Gs=!1;try{i=JSON.parse(i)}catch(t){Gs=!0}if(i&&(r=i.metadata)){var l={spatials:[]};for(n in r)if((i=!Fs[n]&&(o=Hs[n]))&&((a=r[n])||(Gs=!0,a=void 0),i=a),i)for(i=a.length;i--;){var u;(u=a[i])||(Gs=!0,u=void 0),(s=u)&&o(e,t,this,n,s,l)}}else Gs=!0;return Gs?void 0:l},Es.prototype.parse=Es.prototype.parse;var Hs={"street labels":function(t,e,i,r,n,o){var a;if((a=n.vertices)||(Gs=!0,a=void 0),a){var s,l,u=a.length;if((l=0<u)||(Gs=!0,l=void 0),l)for(s=Array(u/2);u;){var c=a[--u];l=a[--u],s[u/2]=new I(l,c)}s=s?{a:[s]}:B,u=+n["font size"]/t.Za(),(a=i.jl[u])||(Is.lineWidth=u,a=i.jl[u]=i.Nd.Aj(Is)),Js(t,e,s,!1,a,n,r,o)}delete n.vertices},"city center labels":function(t,e,i,r,n,o){Js(t,e,Ks(n,new Ah([])),!0,i.Nd,n,r,o)},labels:function(t,e,i,r,n,o){var a;if((a=n["bounding boxes"])||(Gs=!0,a=void 0),a){for(var s,l=a.length,u=new Ah([]);l--;){var c;(c=a[l])||(Gs=!0,c=void 0),(s=c)&&Ks(s,u)}Js(t,e,u,!0,i.Nd,n,r,o)}delete n["bounding boxes"]},buildings:function(t,e,i,r,n,o){var a,s,l,u,c=n.id,h=e.ng[c],p=[],f=[];(a=n)||(Gs=!0,a=void 0),a&&((s=a.vertices)||(Gs=!0,s=void 0),s)&&((u=a.polygons)||(Gs=!0,u=void 0),(l=u)&&p.push.apply(p,Ls(s,l)),(a=a.outlines)||(Gs=!0,a=void 0),(l=a)&&f.push.apply(f,Ls(s,l))),l=p.length,p.push.apply(p,f),f=new Ah(p,Ud,l),(p=p.length)||(Gs=!0,p=void 0),p&&(h?(mr(h,t,[f]),o.spatials.push(h)):(h=Js(t,e,f,!0,i.Nd,n,r,o,c),e.ca(h)))}};Hs["transit stops"]=Hs.POIs=Hs.labels;var Ms=["box 2","box 1","annotation box","icon box"];function Ks(t,e){for(var i,r,n=Ms.length;n--;)if(r=t[i=Ms[n]]){var o=r[0],a=r[1],s=r[2];r=r[3],e.a.push([new I(o,a),new I(o+s,a),new I(o+s,a+r),new I(o,a+r)]),delete t[i]}return e}function Ls(t,e){var i,r,n,o=e.length;if(0<o)for(r=Array(o);o--;)if((i=e[o])||(Gs=!0,i=void 0),i){var a=i.length;if(0<a)for(r[o]=n=Array(a);a--;){var s=2*i[a];n[a]=new I(t[s],t[s+1])}}return r||[]}var Ns={};function Js(t,e,i,r,n,o,a,s,l){return Ns.style=n,r=new ir(e,r,l,Ns),i&&mr(r,t,[i]),Os(o),o.category=a,r.setData(o),s.spatials.push(r),r.ja(e),r}Es.prototype.Nd=new ch({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Is={};function Os(t){var e,i=!1;switch(typeof t){case"object":if(t instanceof Array)for(e=t.length;e--;)Os(t[e])?i=!0:delete t[e];else if(t)for(e in t)Os(t[e])?i=!0:delete t[e];break;case"number":i=!0;break;default:i=!!t}return i}function Ps(t,e,i){e=e||{};var r=(i=i||{}).tileType||"maptile",n=i.scheme||"normal.day";if(R.call(this,{min:0,max:20}),!0===e.pois&&(e.pois="!F"),this.L=e,!(t&&t instanceof Qs))throw Error("InvalidArgument: service required");this.m=t,this.g=A(this.g,this),this.m.addEventListener("versionupdate",this.g),this.A=t.C().clone().D(r+"/"+t.wc()+"/"+n).G(Rs).G(e),this.W=t.g||null,this.R=i.pixelRatio||i.pixelratio||Te(),this.tileSize=i.tileSize||256,this.tileType=r,this.scheme=n,this.b=new sr(new Es(i.categoryFilter)),this.b.ja(this),this.u=A(this.u,this),this.b.addEventListener("update",this.u),R.call(this,{min:0,max:20}),this.o(new Lk(i.tileCacheSize||256,A(this.la,this)))}u(Ps,R),t("H.service.metaInfo.TileProvider",Ps),Ps.prototype.la=function(t,e){for(var i,r=(t=e.Ua()).length;r--;)delete(i=t[r]).a[e.key],i.release();e.data&&(Xp.push(e.kg(),this.tileSize),e.mg())},Ps.prototype.u=function(){this.dispatchEvent("update")},Ps.prototype.J=function(t,e,i,r,n){var o,a=this.A.clone(),s=this.W,l=this.tileSize,u=this.getTileKey(t,e,i);if((u=this.Mb().get(u))&&!u.de()){r(Xp.pop(this.tileSize),null);var c={cancel:function(){}}}else{s&&a.Fa(s[(i+e+t)%s.length]),a.D(i+"/"+t+"/"+e+"/"+l+"/png8");var h=Vp.setTimeout((function(){(o=new sf("text/plain",a.toString())).then((function(t){r(null,t)}),n)}),500)}return c||{cancel:function(){o?o.cancel():Vp.clearTimeout(h)}}},Ps.prototype.requestInternal=Ps.prototype.J,Ps.prototype.od=function(t,e,i,r,n){var o=this.b,a=r||Xp.pop(this.tileSize);if(r)(t=this.Mb().get(this.getTileKey(t,e,i))).V(r);else if(delete(r=t=new Xk(this.vd(t,e,i),t,e,i,this.tileSize,this.R,i,o)).j,r.o=n,t.V(a))for(a=(n=t.Ua()).length;a--;)n[a].rg();else Xp.push(a,this.tileSize);return t},Ps.prototype.createTileInternal=Ps.prototype.od,Ps.prototype.B=function(){this.b.B(),this.m.removeEventListener("versionupdate",this.g),R.prototype.B.call(this)},Ps.prototype.g=function(){var t=this.m;this.A=t.C().clone().D(this.tileType+"/"+t.wc()+"/"+this.scheme).G(Rs).G(this.L),this.reload(!1)};var Rs={metadata:"metaonly",mgen:"2"};function Qs(t){Qs.l.constructor.call(this,Qs,t),t=uq(this,t),this.g=t.shards,(this.c=t.ignoreTypes?null:t.type)&&this.C().Fa(this.c),this.f=t.version,this.o=new Cq,"newest"===this.f&&Ss(this)}function Ts(t,e){for(var i={},r=t[e+"s"][e],n=r.length;n--;)i[r[n].id]=r[n];t[e+"s"]=i}function Ss(t){var e=t.C().clone().D("info").G({output:"json"});t.g&&e.Fa(t.g[0]),t.J(e,(function(e){var i;if(Ts(e=e.response,"map"),Ts(e,"scheme"),Ts(e,"tiletype"),Ts(e,"format"),Ts(e,"resolution"),Ts(e,"language"),"newest"===t.f&&"traffic"!==t.c)for(i in e.maps)e.maps[i].hash&&e.maps[i].newest&&(t.f=e.maps[i].hash,t.dispatchEvent("versionupdate"));t.m=e,t.dispatchEvent("infoupdate")}),(function(t){throw t}))}function Us(t,e,i,r,n){1&n&&Vs(t,t,e,i,r,0),2&n&&Vs(t,t,e,i,r,1),4&n&&Vs(t,t,e,i,r,2),8&n&&Vs(t,t,e,i,r,3)}function Vs(t,e,i,r,n,o){for(var a,s,l,u,c=(i+1)*(i+1),h=4*r,p=i+1,f=[{r:0,Xl:0,Jl:0,Ig:0,next:null}],d=1,y=["r","g","b","a"][o],g=2*i+1;d<g;d++)f[d]={r:0,Xl:0,Jl:0,Ig:0,next:null},f[d-1].next=f[d];f[2*i].next=f[0];var v=4*(r-1);for(a=0;a<n;a++){var m=a*h,_=t[m+o],b=_*p*(i+2)/2;for(g=_*p,d=0;d<=i;d++)f[d][y]=_;var w=0;for(d=1;d<=i;d++){var x=d<r?m+4*d:m+v;b+=(x=t[x+o])*(p-d),w+=x,f[i+d][y]=x}x=f[0],l=f[p],d=m,u=4*p;var E=m+v;for(_=0;_<r;_++){e[d+o]=b/c,b-=g;var A=_+p<r?d+u:E;if(b+=w+=A=t[A+o],g-=x[y],g+=l[y],w-=l[y],x[y]=A,x=x.next,l=l.next,d+=4,!b)for(;(s=4*(_+p))<h&&0===t[m+o+s];)_++,d+=4}}for(m=(n-1)*h,_=0;_<r;_++){for(b=(a=e[(t=4*_)+o])*p*(i+2)/2,g=a*p,d=0;d<=i;d++)f[d][y]=a;for(w=0,d=1;d<=i;d++)b+=(x=e[(x=d<n?t+d*h:t+m)+o])*(i-d+1),w+=x,f[i+d][y]=x;for(x=f[0],l=f[p],d=t,E=p*h,v=t+m,a=0;a<n;a++)if(e[d+o]=b/c,b-=g,b+=w+=A=e[(A=a+p<n?d+E:v)+o],g-=x[y],g+=l[y],w-=l[y],x[y]=A,x=x.next,l=l.next,d+=h,!b)for(;(s=a+p)<n&&0===e[s*h+o+t];)a++,d+=h}}function Ws(t,e,i){this.f=e=t>>e,this.j=Math.log(e)*Math.LOG2E,this.i=t=document.createElement("CANVAS"),this.a=t.getContext("2d"),this.b=t.width=t.height=3*e;var r=document.createElement("canvas");t=i.a;var n,o=i.b;for(a in e=[],r.width=256,r.height=1,r=r.getContext("2d"),o)o.hasOwnProperty(a)&&e.push({stop:parseFloat(a),value:o[a]});o=e.length,e.sort(this.o),0<e[0].stop&&e.unshift({stop:0,value:e[0].value}),1>e[o-1].stop&&e.push({stop:1,value:e[o-1].value}),o=e.length;var a=r.createLinearGradient(0,0,256,0);for(n=0;n<o;n++){if(!t&&l){var s=l.stop+(e[n].stop-l.stop)/2;a.addColorStop(s,l.value),a.addColorStop(s,e[n].value)}a.addColorStop(e[n].stop,e[n].value);var l=e[n]}r.fillStyle=a,r.fillRect(0,0,256,1),this.c=r.getImageData(0,0,256,1).data,this.g=i.a}function Xs(t,e){this.canvas=t,this.size=e}function Ys(t,e){var i,r=0;if(!Ea(t)||Ua(t))throw new D(Ys,0,t);for(i in t){var n=+i;if(r++,!(Dc(n)&&0<=n&&1>=n&&Ac(t[i])))throw new D(Ys,0,t)}if(2>r)throw new D(Ys,0,"Specify at least 2 stops");this.b=t,this.a=!!e}u(Qs,tq),t("H.service.metaInfo.Service",Qs),Qs.prototype.a=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},Qs.CONFIG_KEY="metaInfo",Qs.prototype.Oj=function(){return this.c},Qs.prototype.wc=function(){return this.f},Qs.prototype.getVersion=Qs.prototype.wc,Qs.prototype.ua=function(){return this.o},Qs.prototype.getCopyrights=Qs.prototype.ua,Qs.prototype.lh=function(){return this.m},Qs.prototype.getInfo=Qs.prototype.lh,Qs.prototype.De=function(t,e,i,r,n,o){return new Ps(this,r,{tileSize:t,pixelRatio:e,categoryFilter:i,tileType:n,scheme:o})},Qs.prototype.createTileProvider=Qs.prototype.De,Qs.prototype.qc=function(t,e,i,r,n,o){return new tl(this.De(t,e,i,r,n,o))},Qs.prototype.createTileLayer=Qs.prototype.qc,Y.prototype.Fj=function(t){return this.Wa(Qs,t)},Y.prototype.getMetaInfoService=Y.prototype.Fj,function(){var t=Y.prototype.createDefaultLayers;Y.prototype.createDefaultLayers=function(e,i,r,n,o,a){var s=t.call(this,e,i,r,n,o,a),l={},u=this.Fj();"object"==typeof e&&(e=(a=e).tileSize,i=a.ppi,r=a.lg,n=a.lg2,o=a.style,a=a.pois),e=e||256;var c=320===i?2:1;if(0>[72,250,320,500].indexOf(+i)){if(i!==B)throw new D(this.Ff,1,i)}else l.ppi=+i;return r&&(l.lg=r),n&&(l.lg2=n),o&&(l.style=o),a&&(l.pois=a),s.raster.normal.metaInfo=u.qc(e,c,["buildings"],l),s}}(),Ws.prototype.o=function(t,e){return t.stop-e.stop},t("H.data.heatmap.Colors",Ys);var Zs=new Ys({0:"#008",.2:"#0b0",.5:"#ff0",.7:"#f00"},!0);function $s(t,e,i){this.a=t=Zd(t,0,30),this.u=e,this.i=i,this.o=[],this.b=[];do{this.b[t]=[],this.o[t]=new at}while(t--);e===bt?(this.m=ct,this.j=dt):(this.m=et,this.j=ft),this.c=1/0,this.f=-1/0}Ys.DEFAULT=Zs;var gt=Math.log(.5);function dt(t){return this.g?Math.round((t-this.c)/this.g*255):127}function ft(t){return void 0===this.U?127:Math.round(255*Math.pow(t,this.U))}function ht(t,e,i,r,n){var o,a,s=1<<e;return r=Yd(r,s),!(s=0<=i&&i<s&&(o=t.b[e])&&(a=o[i])&&(s=a[r])||null)&&n&&0<=e&&(s=ht(t,e-1,i>>1,r>>1,n)),s}function it(t,e,i,r,n,o){for(var a,s=[];i<=r;i++)for(a=n;a<=o;a++)s.push(ht(t,e,i,a,!1));return s}function jt(t,e){var i,r=0,n=0,o=ht(t,0,0,0,!1);return e.f||(e.z===t.a?e.c=e.a:(kt(t,e,(function(e){var a=lt(t,e),s=4-a.length;if(e.z!==t.a){for(i=0;i<a.length;i++)r+=a[i].a,n++;r+=s*o.a,n+=s}})),e.c=r/n),e.f=!0),e.c}function kt(t,e,i){e=[e];for(var r,n;0<e.length;)r=lt(t,n=e.shift()),i(n),e.push.apply(e,r)}function lt(t,e){var i,r,n,o=[];for(r=0;1>=r;r++)for(n=0;1>=n;n++)(i=ht(t,e.z+1,2*e.x+r,2*e.y+n,!1))&&o.push(i);return o}function et(t,e,i){this.x=t,this.y=e,this.z=i,this.a=this.b=this.g=0,this.f=!1,this.c=0}function ct(t,e,i){this.x=t,this.y=e,this.z=i,this.a=this.b=this.g=0,this.f=!1,this.c=0}function at(){this.f=this.c=1/0,this.a=this.b=-1/0}function mt(t){var e=t||{},i=+e.sampleDepth;t=+e.coarseness;var r=e.colors,n={min:e.min,max:e.max,engineType:e.engineType},o=e.tileSize,a=+e.dataMax;if(e.tileSize&&(n.tileSize=o),R.call(this,n),fk(this,e.opacity),this.A="value"===e.type?bt:nt,this.sampleDepth_=Dc(i)?Zd(Math.round(i),1,8):4,this.u=!!e.assumeValues,e=this.max,this.L=Dc(a)?Zd(Math.round(a),this.min,e+this.sampleDepth_):e,t=Dc(t)?Zd(Math.round(t),0,3):1,r&&!C(r,Ys))throw new D(mt,0,"colors");this.b=new $s(e+this.sampleDepth_,this.A,this.L),this.W=new Ws(this.tileSize,t,r||Zs),this.m=A(this.m,this),this.g=A(this.g,this),this.R=new Fk(20,this.m)}function ot(t,e,i,r){var n=document.createElement("canvas"),o=t.tileSize,a=n.getContext("2d");n.width=n.height=o;var s,l,u=t.W,c=t.b,h=t.u,p=t.A,f=u.f,d=u.a,y=p===nt?2:1,g=y;t=Math.min(t.sampleDepth_+y,u.j),y=u.b;var v=c.a;if(h&&p===bt){for(l=-1;1>=l;l++)for(h=-1;1>=h;h++){var m=(m=ht(c,r,i+l,e+h,!0))?c.j(jt(c,m)):128;d.fillStyle="rgba("+m+",128,0,1)",d.fillRect((h+1)*f,(l+1)*f,f,f)}h=f-Math.floor(f/10),l=3,Us((m=d.getImageData(0,0,y,y)).data,h,y,y,l),d.putImageData(m,0,0)}else d.fillStyle=h?"#080":"#000",d.fillRect(0,0,y,y);for(;g<=t&&r+g<=v;g++){l=f-(h=f>>g);var _=p===nt?127+Math.floor(128/(1<<t-g)):255;m=2+(1<<g);var b=1<<g,w=e<<g,x=i<<g;for(w=(b=it(c,r+g,x-1,x+b,w-1,w+b)).length;w--;){x=w%m;var E=w/m<<0;(s=b[w])&&(s=c.j(s.a),d.fillStyle="rgba("+s+","+_+",0,1)",d.fillRect(x*h+l,E*h+l,h,h))}m=d,_=h,b=l,w=f+2*h,h=f+2*h,x=x=3,Us((E=d.getImageData(b,l,w,h)).data,_,w,h,x),m.putImageData(E,b,l)}for(e=d.getImageData(0,0,y,y),i=u.c,r=u.g,t=0,y=(c=e.data).length;t<y;t+=4)p=c[t],g=c[t+1],4===i.length&&(p=0),c[t]=i[4*p],c[t+1]=i[4*p+1],c[t+2]=i[4*p+2],c[t+3]=i[4*p+3]*(r?g/255:10>g?0:1);return d.putImageData(e,0,0),f=(u=new Xs(u.i,f)).size,a.drawImage(u.canvas,f,f,f,f,0,0,o,o),n}$s.prototype.Gb=function(t){var e,i,r=t.value;void 0===r&&(r=1),r>this.f&&(this.f=r,this.g=this.f-this.c),r<this.c&&(this.c=r,this.g=this.f-this.c);var n=fj.Vc(t).scale(1073741823).floor();r=this.a;var o=n.x>>30-r;for(n=n.y>>30-r,i=this.m;-1<r;){this.b[r][n]||(this.b[r][n]=[]),(e=this.b[r][n][o])||(e=this.b[r][n][o]=new i(o,n,r)),e.Gb(t,r);var a=this.o[r];a.f>e.b&&(a.f=e.b),a.a<e.b&&(a.a=e.b),a.c>e.a&&(a.c=e.a),a.b<e.a&&(a.b=e.a),r--,o>>=1,n>>=1}},$s.prototype.clear=function(){$s.call(this,this.a,this.u,this.i)},et.prototype.Gb=function(t,e){this.g++,this.b+=t.value||1,this.a=this.b/Math.pow(2,2*(30-e))},ct.prototype.Gb=function(t){t=t.value,this.b+=void 0!==t?t:1,this.a=this.b/++this.g,this.f=!1},u(mt,R),t("H.data.heatmap.Provider",mt),mt.prototype.kc=function(t){fk(this,t)},mt.prototype.setOpacity=mt.prototype.kc,mt.prototype.Zc=function(){return this.f},mt.prototype.getOpacity=mt.prototype.Zc,mt.prototype.af=ef,mt.prototype.providesRasters=mt.prototype.af,mt.prototype.J=function(t,e,i,r,n){var o,a,s=this.u;if(ht(this.b,0,0,0,!1)){if(!s){var l=it(this.b,i,e-1,e+1,t-1,t+1);for(o=l.length;o--&&!s;)if(null!==l[o]){s=!0;break}}s&&(a=this.R.push([t,e,i,r,n],this.g))}return s||r(null),a},mt.prototype.requestInternal=mt.prototype.J,mt.prototype.m=function(t,e){t.done(ot(this,e[0],e[1],e[2]))},mt.prototype.g=function(t,e,i){var r=t.data;t=r[3],r=r[4],i?r():t(e)},mt.prototype.dj=function(t,e){var i;if(!zc(t))throw new D(this.dj,0,t);if(i=t.length){for(;i--;)this.b.Gb(t[i]);var r;i=(t=this.b).o;var n=t.a,o=0;if(t.u===nt){var a=i[t.a].a;for(r=t.a;0<=r&&i[r].a===a;r--)o=r;for(a=i[0].a,r=0;r<=o&&a===i[r].a;r++)n=r;o>t.i&&(o=t.i),a=Math.round(n+(o-n)/2),t.U=gt/Math.log(i[a].b)}this.reload(!!e)}},mt.prototype.addData=mt.prototype.dj,mt.prototype.clear=function(){this.b.clear(),this.reload(!0)},mt.prototype.clear=mt.prototype.clear;var nt=0,bt=1;function pt(){}function qt(t){for(var e,i=(t=t.attributes).length;i--;)switch(e=t[i],e.name){case"x":this.x=parseFloat(e.value);break;case"y":this.y=parseFloat(e.value);break;case"xunits":this.ad="fraction"===pt.prototype.Oa(e);break;case"yunits":this.Ac="fraction"===pt.prototype.Oa(e)}}function rt(t){var e=t.childNodes,i=new pt;for(t=e.length;t--;){var r=e[t];"href"===r.nodeName&&(this.href=i.Oa(r))}}function st(t){var e;if(t){var i=(t=t.childNodes).length;for(e=new pt;i--;){var r=t[i];switch(r.nodeName){case"scale":this.scale=e.Of(r);break;case"Icon":this.icon=r=new rt(r);break;case"hotSpot":this.a=r=new qt(r)}}}}function tt(){this.a={4:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),"ff"].join("")},5:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),t.charAt(4),t.charAt(4)].join("")},7:function(t){return t+"ff"},9:function(t){return t}},this.b={4:function(t){return[ut(t.charAt(1)),ut(t.charAt(2)),ut(t.charAt(3)),255]},5:function(t){return[ut(t.charAt(1)),ut(t.charAt(2)),ut(t.charAt(3)),ut(t.charAt(4))]},7:function(t){return[(t=parseInt(t.substring(1),16))>>16&255,t>>8&255,255&t,255]},9:function(t){return[(t=parseInt(t.substring(1),16))>>24&255,t>>16&255,t>>8&255,255&t]}}}function ut(t){return((t=parseInt(t,16))<<4)+t}function vt(t){return 16>t?"0"+Math.round(t).toString(16):Math.round(t).toString(16)}function wt(t,e,i){return/^(#|rgb).*/.test(e)?(i||(i="","#"===e.charAt(0)?i=t.a[e.length]?e:"":"rgb"===e.substr(0,3)&&(i=2<(i=(e=e.match(/\d+(\.\d+)?/g)).length)&&5>i?["#",vt(+e[0]),vt(+e[1]),vt(+e[2]),3<i?vt(255*+e[3]):"ff"].join(""):""),e=i),(t=t.b[e.length](e))[3]=Math.round(t[3]/255*100)/100,t):[0,0,0,255]}function xt(t){for(var e,i=(t=t.childNodes).length,r=new pt,n=new tt;i--;)switch(e=t[i],e.nodeName){case"color":this.a=r.Mf(e);break;case"colorMode":this.b=r.Oa(e)}"random"===this.b&&(this.a="#"+n.ql(this.a,!1))}function yt(t){var e=t.childNodes,i=e.length,r=new pt;for(this.a=this.fill=!0,this.b=new xt(t);i--;)switch(t=e[i],t.nodeName){case"fill":this.fill=r.Pd(t);break;case"outline":this.a=r.Pd(t)}}function zt(t){var e=t.childNodes,i=e.length,r=new pt;for(this.a=new xt(t);i--;)"width"===(t=e[i]).nodeName&&(this.width=r.Of(t))}function At(t){for(var e,i=(t=t.childNodes).length,r=new pt;i--;)switch(e=t[i],e.nodeName){case"bgColor":this.bgColor=r.Mf(e);break;case"textColor":this.textColor=r.Mf(e);break;case"text":this.text=r.Oa(e);break;case"displayMode":this.displayMode=r.Oa(e)}}function Bt(t){var e=t.childNodes,i=e.length;for(this.id=t.getAttribute("id");i--;)switch(t=e[i],t.nodeName){case"IconStyle":this.Vj=t=new st(t);break;case"LineStyle":this.fe=t=new zt(t);break;case"PolyStyle":this.Gk=t=new yt(t);break;case"BalloonStyle":this.wf=t=new At(t)}}function Ct(t,e){var i=(t=t.childNodes).length,r=new pt;for(this.b=e;i--;)switch(e=t[i],e.nodeName){case"key":this.key=r.Oa(e);break;case"styleUrl":this.a=r.Oa(e)}}function Dt(t,e){var i=t.childNodes,r=i.length;for(this.b=e,this.id=t.getAttribute("id"),this.a=[];r--;)"Pair"===(t=i[r]).nodeName&&(t=new Ct(t,this.b),this.a.push(t))}function Et(){this.a={}}function Ft(t){for(var e,i=(t=t.childNodes).length,r=null,n=new pt;i--;)"coordinates"===(e=t[i]).nodeName&&(r=n.Oa(e));this.a=null,r&&(this.a=n.fi(r)||null)}function Gt(t,e){var i=t&&t.childNodes||[],r=new pt;if(!t||!e)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.g=t,t=i.length;t--;){var n=i[t];switch(n.nodeName){case"name":this.name=r.Oa(n);break;case"description":this.b=r.Oa(n);break;case"visibility":this.visibility=r.Pd(n);break;case"open":this.open=r.Pd(n);break;case"styleUrl":(this.c=r.Oa(n))&&(n=this.c.substr(1),this.f=e.th(n,!1));break;case"Style":this.a=n=new Bt(n)}}}function Ht(t){for(var e,i=(t=t.childNodes).length,r=new pt;i--;)if("coordinates"===(e=t[i]).nodeName){var n=[],o=new pt;try{n=o.Dk(r.Oa(e))}catch(t){n=[]}this.a=2>n.length?[]:n}}function It(t){for(var e=new L,i=t.a?t.a.length:0;i--;)e.Bd(t.a[i]);return e}function Jt(){}function Kt(t){var e=t.childNodes,i=e.length;for(this.a=new L,this.c=[];i--;){var r=e[i],n=r.nodeName;if("outerBoundaryIs"===n||"innerBoundaryIs"===n){var o=r.childNodes;for(r=o.length;r--;){var a=o[r];if("LinearRing"===a.nodeName){var s=new Ht(a);if("outerBoundaryIs"===n){this.a=It(s);var l=void 0,u=t,c=s.a;s=new pt;var h=u.querySelector("altitudeMode");if(h&&h.parentNode===u&&!/^\s*clampTo/.test(s.Oa(h))&&c){h=c.length;for(var p=0;p<h&&0!==l;p++){var f=c[p].alt;f?l?f!==l&&(l=0):l=f:l=0}(c=u.querySelector("*|altitudeOffset"))&&c.parentNode===a&&"http://www.google.com/kml/ext/2.2"===c.namespaceURI&&(a=s.Of(c))&&(l+=a),l&&(l=wd(Hi,l),(a=u.querySelector("extrude"))&&a.parentNode===u&&s.Pd(a)?this.b=l:this.f=l)}}else this.c.push(It(s))}}}}}function Lt(t,e){var i=document.createElement("CANVAS");i.width=1,i.height=1,this.i=t,this.b={},this.c={},this.f=new Rj(i),this.g=e||""}function Mt(t,e,i){for(var r,n,o=(e=e.childNodes).length,a={};o--;){var s=e[o];switch(s.nodeName){case"Point":r=new Ft(s),n=Nt(t,"Marker"),r=new Gn(r.a,n),n.gi&&De(n.gi,"statechange",A(t.j,t,n.gi,r,n),!1);break;case"LineString":case"LinearRing":r=new Ht(s),n=Nt(t,"Polyline"),r=new wh(It(r),n);break;case"Polygon":r=new Kt(s),(n=Nt(t,"Polygon")).elevation=r.f,n.extrusion=r.b,r=new Gi(new O(r.a,r.c),n);break;case"MultiGeometry":r=Mt(t,s,new Q)}r&&(t.a.name&&(a.name=t.a.name),t.a.b&&(a.description=t.a.b),n&&n.wf&&(a.balloonStyle=n.wf),a.kmlNode=t.a.g,r.setData(a),i&&i.ca(r))}return i||r}function Nt(t,e){var i=t.a,r={visibility:i.visibility},n=new tt,o=1,a={x:0,y:0,ad:!1,Ac:!1},s=Ot(t,i.f);switch(i.a&&(s=Ot(t,i.a,s)),e){case"Marker":if(s&&s.Vj){if((n=s.Vj).scale&&(o=n.scale),n.a){var l=n.a;a={x:l.x,y:l.y,ad:l.ad,Ac:l.Ac}}n.icon&&n.icon.href?(e=n.icon.href,Pt.test(e)||(e=t.g+e),n=o+"_"+a.x+a.y+a.ad+a.Ac+"_"+e,(l=t.b[n]||t.c[n])||(l=new Rj(e),t.c[n]=l),0===l.getState()?(r.icon=t.f,r.gi=l,r.href=e,r.anchor=a,r.scale=o):1===l.getState()&&(r.icon=l)):1!==o&&(l||(a={x:14,y:4,ad:!1,Ac:!1}),o={size:new Ti((t={w:28*o,h:36*o}).w,t.h),anchor:new I(a.ad?t.w*a.x:a.x*o,a.Ac?t.h*(1-a.y):t.h-a.y*o),hitArea:new Ui(Vi.POLYGON,[0*o,16*o,0*o,7*o,8*o,0*o,18*o,0*o,26*o,7*o,26*o,16*o,18*o,34*o,8*o,34*o])},r.icon=new Rj('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',o))}break;case"Polyline":r.style={},s&&s.fe&&(o=s.fe,r.style.strokeColor="rgba("+wt(n,o.a.a,!0)+")",0<=o.width&&(r.style.lineWidth=o.width));break;case"Polygon":r.style={},s&&(s.fe&&(o=s.fe,r.style.strokeColor="rgba("+wt(n,o.a.a,!0)+")",0<=o.width&&(r.style.lineWidth=o.width)),s.Gk&&(o=s.Gk,r.style.fillColor=o.fill?"rgba("+wt(n,o.b.a,!0)+")":"rgba(0,0,0,0)",o.a||(r.style.lineWidth=0)))}return r.wf=s.wf,r}function Ot(t,e,i){for(var r in i=i||{},e)e.hasOwnProperty(r)&&(i[r]="object"==typeof e[r]?Ot(t,e[r],i[r]):e[r]);return i}t("H.data.utils.Dom",pt),pt.prototype.Pd=function(t){return!!t&&/^\s*(1|true)\s*$/i.test(this.Oa(t))},pt.prototype.getBoolean=pt.prototype.Pd,pt.prototype.Oa=function(t){var e;try{if(t.nodeType===Node.ATTRIBUTE_NODE)return t.value;var i="",r=0,n=t.childNodes;for(e=n.length;r<e;r++)n[r].nodeType!==Node.COMMENT_NODE&&(i+=n[r].nodeValue.replace(/^\s+|\s+$/g,""))}catch(t){}return i||""},pt.prototype.getString=pt.prototype.Oa,pt.prototype.Of=function(t){return parseFloat(this.Oa(t))||0},pt.prototype.getFloat=pt.prototype.Of,pt.prototype.Dk=function(t){var e,i=t.split(/\s+/),r=i.length,n=!(i&&1==r),o=n?1:3,a=[];for(n||(r=(i=t.split(",")).length),e=0;e<r;e+=o){if(!(t=this.fi(n?i[e]:e+3>i.length?null:i.slice(e,e+3))))return[];a.push(t)}return a},pt.prototype.parseCoords=pt.prototype.Dk,pt.prototype.fi=function(t){if(!t)return null;var e=t instanceof Array&&0<t.length&&4>t.length?t:t.split(",");t=parseFloat(e[0]);var i=parseFloat(e[1]);return e=parseFloat(e[2]),isNaN(i)||isNaN(t)?null:new Yf(i,t,isNaN(e)?void 0:e)},pt.prototype.parseCoord=pt.prototype.fi,pt.prototype.Mf=function(t){return t=this.Oa(t),/^[0-9a-fA-F]{8}$/.test(t)?"#"+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2):"#000000ff"},pt.prototype.getColor=pt.prototype.Mf,t("H.data.kml.HotSpot",qt),t("H.data.kml.Icon",rt),t("H.data.kml.IconStyle",st),t("H.data.utils.ColorHelper",tt),tt.prototype.ql=function(t,e){var i="";if(!/^(#|rgb).*/.test(t)){var r;for(i="",r=0;6>r;r++)i+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return i+"ff"}for(t=wt(this,t,e),e=0;4>e;e++)i+=vt(r=3>e?Math.floor(Math.random()*(t[e]+1)):255*t[e]);return i},tt.prototype.toRandomRGBA=tt.prototype.ql,t("H.data.kml.ColorStyle",xt),t("H.data.kml.PolyStyle",yt),t("H.data.kml.LineStyle",zt),t("H.data.kml.BalloonStyle",At),t("H.data.kml.Style",Bt),t("H.data.kml.Pair",Ct),Ct.prototype.va=function(){if(this.a){var t="highlight"===this.key;t=this.b.th(this.a.substr(1),t)}return t},Ct.prototype.getStyle=Ct.prototype.va,t("H.data.kml.StyleMap",Dt),Dt.prototype.va=function(t){var e=null;t=t?"highlight":"normal";for(var i=this.a.length;i--;)this.a[i].key===t&&(e=this.a[i].va());return e},Dt.prototype.getStyle=Dt.prototype.va,t("H.data.kml.StyleContainer",Et),Et.prototype.Ng=function(t){t&&t.id&&(this.a["style_"+t.id]=t)},Et.prototype.addStyle=Et.prototype.Ng,Et.prototype.th=function(t,e){return(t=this.a["style_"+t])instanceof Dt&&(t=t.va(e)),t},Et.prototype.getStyleById=Et.prototype.th,t("H.data.kml.Point",Ft),t("H.data.kml.Feature",Gt),t("H.data.kml.Line",Ht),Jt.prototype.f=0,Jt.prototype.b=0,u(Kt,Jt),t("H.data.kml.Polygon",Kt),Lt.prototype.create=function(t){return this.a=new Gt(t,this.i),Mt(this,t)},Lt.prototype.j=function(t,e,i){var r=i.anchor,n=i.scale;i=n+"_"+r.x+r.y+r.ad+r.Ac+"_"+i.href;var o={};if(1===t.getState()){var a=this.b[i];if(!a){var s=r.x,l=r.y;(a=t.Bb())&&(a={w:a.w*n,h:a.h*n},o.size=a),s=r.ad&&a?a.w*s:s*n,l=r.Ac&&a?a.h*(1-l):!r.Ac&&a?a.h-l*n:l*n,o.anchor={x:s,y:l},a=new Rj(t.Wc(),o),this.b[i]=a}e.Jc(a)}delete this.c[i]};var Pt=/^[^:\/]+:/;function Qt(t){vc(this,Qt),this.url=t,this.b=[],this.a=y,this.c=A(this.c,this),F.call(this)}u(Qt,F),t("H.data.AbstractReader",Qt);var Rt={ERROR:-1,LOADING:0,VISIT:1,READY:2};function St(t,e,i,r){St.l.constructor.call(this,e,t),this.state=i,this.message=r}function Tt(t){var e=t?t.lastIndexOf("/"):-1;this.g=[],Qt.call(this,t),0<=e&&(this.i=t.substr(0,e)+"/")}function Vt(t,e,i){i?i.ca(e):(t.a&&t.a.ec().ca(e),t.b.push(e),t.N(Rt.VISIT,e))}function Ut(t,e){for(var i,r=t.length,n=[];r--;)(i=t[r]).nodeName===e&&n.push(i);return n}function Wt(t,e){this.b=t,this.a=e}function Xt(t){return new Yf(t[1],t[0])}function Zt(t){for(var e,i=Yt(t[0]),r=[],n=1,o=t.length;n<o;n++)e=Yt(t[n]),r.push(e);return new O(i,r)}function Yt(t){for(var e=0,i=t.length,r=new L;e<i;e++)r.Bd(Xt(t[e]));return r}function $t(t,e){e=e||{},this.i=e.style||this.Nd,(this.g=!!e.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),Qt.call(this,t)}function bu(t){var e={};if(t.geometry){var i=t.geometry;e.type=i.type,e.properties=t.properties,i.coordinates&&(e.coordinates=i.coordinates),i.geometries&&(e.geometries=i.geometries),t.id&&(e.id=t.id)}return e}function au(t,e){t.a&&t.a.ec().ca(e),t.b.push(e),t.N(Rt.VISIT,e)}function cu(t,e){this.a=t,this.b=e}function du(t,e,i){this.f=this.b=i,this.hi=[],this.a=0,this.O=eg(t,e,!0)}function eu(t){var e;nd.call(this),this.a=[],t?Xa(e={},fu,t):e=fu,this.g=e,nd.call(this)}Qt.State=Rt,Qt.prototype.f=Rt.READY,Qt.prototype.v={Cl:"statechange"},Qt.prototype.sb=function(){return this.a||(this.a=new N,this.a.ec().$b(this.b)),new ul(this.a)},Qt.prototype.getLayer=Qt.prototype.sb,Qt.prototype.Tm=function(){return this.b.concat([])},Qt.prototype.getParsedObjects=Qt.prototype.Tm,Qt.prototype.C=function(){return this.url},Qt.prototype.getUrl=Qt.prototype.C,Qt.prototype.Fo=function(t){if(this.f===Rt.LOADING||this.f===Rt.VISIT)throw Error("InvalidState: state "+this.f);return this.b=[],this.a=y,this.url=t,this},Qt.prototype.setUrl=Qt.prototype.Fo,Qt.prototype.getState=function(){return this.f},Qt.prototype.getState=Qt.prototype.getState,Qt.prototype.N=function(t,e,i){this.f=t,this.dispatchEvent(new St(e||this,this.v.Cl,t,i||""))},Qt.prototype.parse=function(){var t=this;uc(this.url)?(this.N(Rt.LOADING),new sf("text/plain",this.url).then((function(e){try{t.c(e)}catch(e){t.N(Rt.ERROR,y,e.message)}}),(function(){t.N(Rt.ERROR,y,"Error loading file")}))):t.N(Rt.ERROR,y,"File url was not set")},Qt.prototype.parse=Qt.prototype.parse,u(St,sd),u(Tt,Qt),t("H.data.kml.Reader",Tt),Tt.prototype.c=function(t){var e,i=null;if(Ac(t)&&""!=t.trim()){try{var r=(new DOMParser).parseFromString(t,"text/xml")}catch(t){return void this.N(Rt.ERROR,y,"Error parsing KML document")}if(r.getElementsByTagName("parsererror").length)this.N(Rt.ERROR,y,"Error parsing KML document");else if((t=r.childNodes&&"kml"===r.childNodes[0].nodeName?r.childNodes[0]:void 0)&&(e=Ut(t.childNodes,"Document")[0]),e=e||t){r=new Et;for(var n=Ut(e.childNodes,"Style"),o=Ut(e.childNodes,"StyleMap"),a=n.length;a--;)t=new Bt(n[a]),r.Ng(t);for(a=o.length;a--;)t=new Dt(o[a],r),r.Ng(t);for(this.j=new Lt(r,this.i),e=(t=e.childNodes).length;e--;)r=i,"Placemark"===(n=t[e]).nodeName?(n=this.j.create(n))&&Vt(this,n,r):"Folder"===n.nodeName&&(Vt(this,(n={group:new Q,node:n}).group,r),this.g.push(n)),!e&&(r=this.g.shift())&&(t=r.node.childNodes,i=r.group,e=t.length);this.N(Rt.READY)}else this.N(Rt.ERROR,y,"Invalid KML document")}else this.N(Rt.ERROR,y,"Unable to create objects from the empty data")},Wt.prototype.create=function(t,e){var i=t.coordinates;switch(t.type){case"Point":var r=new Gn(Xt(i));break;case"LineString":r=new wh(Yt(i));break;case"Polygon":r=new Gi(Zt(i));break;case"MultiPoint":var n=0,o=i.length;if(r=[],this.a){for(;n<o;n++)r.push(Xt(i[n]));i=new Gn(new Si(r))}else{for(;n<o;n++)r.push(new Gn(Xt(i[n])));(i=new Q).$b(r)}r=i,o="multiPoint";break;case"MultiLineString":if(n=0,o=i.length,r=[],this.a){for(;n<o;n++)r.push(Yt(i[n]));i=new wh(new vh(r))}else{for(;n<o;n++)r.push(new wh(Yt(i[n])));(i=new Q).$b(r)}r=i,o="multiLineString";break;case"MultiPolygon":if(r=[],n=0,o=i.length,this.a){for(;n<o;n++)r.push(Zt(i[n]));i=new Gi(new Ei(r))}else{for(;n<o;n++)r.push(new Gi(Zt(i[n])));(i=new Q).$b(r)}r=i,o="multiPolygon";break;case"GeometryCollection":i=r=new Q,o=0;for(var a=(n=t.geometries).length;o<a;o++)this.create(n[o],i);o="geometryCollection"}return r&&(i=r,n=t.properties,t=t.id,a={},n&&(this.a?a=n:a.properties=n),o&&!this.a&&(a[o]=!0),t&&i.Ei(t),i.setData(a),this.b(r)),e&&r&&e.ca(r),r},Wt.prototype.create=Wt.prototype.create,u($t,Qt),t("H.data.geojson.Reader",$t),$t.prototype.c=function(t){var e,i;try{var r="string"==typeof t?JSON.parse(t):t;if("object"==typeof r){var n=new Wt(this.i,this.g);switch(r.type){case"FeatureCollection":if(e=r.features){var o=new Q;for(au(this,o),i=0;i<e.length;i++){var a=bu(e[i]);(a=n.create(a))&&o.ca(a)}}break;case"Feature":a=bu(r),(a=n.create(a))&&au(this,a);break;default:(a=n.create(r))&&au(this,a)}this.N(Rt.READY)}else this.N(Rt.ERROR,y,"Invalid syntax")}catch(t){this.N(Rt.ERROR,y,"Parse error. "+t.message)}},$t.prototype.ro=function(t){this.N(Rt.LOADING),this.c(t)},$t.prototype.parseData=$t.prototype.ro,$t.prototype.Nd=function(){},t("H.data.buildInfo",(function(){return Ff("H-data","1.30.9","5d65eb7")})),ig.prototype.Nc=ca(1,(function(t,e){this.a.Nc(t,Dc(e)?e:this.c)})),mg.prototype.Nc=ca(0,(function(t,e){var i,r=0;if(!t(this)&&e--)for(;3>=r;r++)(i=this[r])&&i.Nc(t,e)})),t("H.clustering.grid.NoisePoint",cu),cu.prototype.Aa=function(){return $f(this.a)},cu.prototype.getPosition=cu.prototype.Aa,cu.prototype.yc=function(){return this.a.wt},cu.prototype.getWeight=cu.prototype.yc,cu.prototype.xd=ff,cu.prototype.isCluster=cu.prototype.xd,cu.prototype.uc=function(){return this.b},cu.prototype.getMinZoom=cu.prototype.uc,cu.prototype.getData=function(){return this.a.data},cu.prototype.getData=cu.prototype.getData,t("H.clustering.grid.Cluster",du),du.prototype.ye=function(t){this.c||(this.c=$f(t)),this.a+=t.wt||1,this.hi.push(t)},du.prototype.Aa=function(){return this.c},du.prototype.getPosition=du.prototype.Aa,du.prototype.yc=function(){return this.a},du.prototype.getWeight=du.prototype.yc,du.prototype.xd=ef,du.prototype.isCluster=du.prototype.xd,du.prototype.uc=function(){return this.b},du.prototype.getMinZoom=du.prototype.uc,du.prototype.Qf=function(){return this.f},du.prototype.getMaxZoom=du.prototype.Qf,du.prototype.I=function(){return this.O},du.prototype.getBoundingBox=du.prototype.I,du.prototype.eh=function(t){this.Ie(t)},du.prototype.forEachEntry=du.prototype.eh,du.prototype.Ie=function(t){var e=this;if(!Da(t))throw new D(this.Ie,0,t);this.hi.forEach((function(i){t(new cu(i,e.b+1))}))},du.prototype.forEachDataPoint=du.prototype.Ie,u(eu,nd);var gu={clusters:[],noisePoints:[]},fu={projection:fj,min:0,max:22,eps:32,minWeight:2};function hu(t){eu.call(this,t)}function iu(t){this.a=t;var e=(t=document.createElement("canvas")).getContext("2d"),i=this.a,r=14*i;t.width=r,t.height=r,e.scale(i,i),e.beginPath(),e.strokeStyle="#FFFFFF",e.fillStyle="#1080DD",e.arc(7,7,6,0,2*Math.PI,!1),e.fill(),e.lineWidth=1,e.stroke(),this.f=new Rj(t,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.b={},this.c={}}function ju(t,e,i){var r,n=document.createElement("canvas"),o=n.getContext("2d"),a=t.a,s=e*a;return n.width=s,n.height=s,o.scale(a,a),a=e+":"+i,(r=t.b[a])?o.putImageData(r,0,0):(e/=2,o.beginPath(),o.strokeStyle="rgba("+i+",0.2)",o.fillStyle="rgba("+i+",1)",o.arc(e,e,e/5*3,0,2*Math.PI,!1),o.fill(),o.lineWidth=e/5*4,o.stroke(),t.b[a]=o.getImageData(0,0,s,s)),n}function ku(t){if(eu.call(this,t),(t=this.g).projection!==fj)throw new D(ku,0,"Other projection than mercator not supported yet");this.o=t.projection,this.f=t.eps,this.F=t.minWeight,this.m=new gj(this.o),(new Nf).a("cluster","H.clustering.dynamicgrid.worker"),this.i=A(this.i,this),this.j=A(this.j,this)}n=eu.prototype,n.Ic=function(t){this.a=t,this.b=!0},n.Gb=function(t){this.a.push(t),this.b=!0},n.vf=function(t){this.a=this.a.concat(t),this.b=!0},n.bf=function(t){this.a=this.a.filter((function(e){return e!==t})),this.b=!0},n.s=function(){eu.l.s.call(this),delete this.a},n.Wk=id,u(hu,eu),hu.prototype.Ii=function(t){var e,i=this.g,r=i.min,n=i.max,o=[],a=[];if(this.b){for(e=this.a;r<=n;r++){for(var s,l,u,c,h,p,f,d,y=void 0,g=r,v=e,m=o,_=a,b=i.eps,w=i.projection,x=i.minWeight,E=v.length,A=Math.pow(2,g+8),T=[];d=v[--E];)if(!d.Oi){for(f=A,p=(u=w.Vc(d).scale(A).floor()).x,h=u.y,l=T.length;l--;)c=(s=T[l]).Aa(),s.Ni||(s.Ni=w.Vc(c).scale(A).floor()),(c=(c=s.Ni).Ya(u))<f&&(f=c,y=s);y&&y.I().md(d)||(y=new du(w.ig({x:(p-b)/A,y:(h-b)/A}),w.ig({x:(p+b)/A,y:(h+b)/A}),g),T.push(y)),y.ye(d),y=null}for(E=T.length;E--;)if((l=(s=T[E]).yc())<x)for(l=(s=s.hi).length;d=s[--l];)_.push(new cu(d,g)),d.Oi=!0;else m.push(s)}for(r=0,n=e.length;r<n;r++)delete e[r].Oi;this.b=!1,t({clusters:o,noisePoints:a})}},t("H.clustering.theme.Circular",iu),iu.prototype.hm=function(t){var e=t.yc(),i=this.c[e];if(!i){if(10>e){i=ju(this,28,"118,209,0");var r={x:11,y:18}}else 25>e?(i=ju(this,38,"255,105,0"),r={x:13,y:23}):50>e?(i=ju(this,38,"240,60,0"),r={x:13,y:23}):100>e?(i=ju(this,38,"181,0,21"),r={x:13,y:23}):1e3>e?(i=ju(this,48,"181,0,21"),r={x:15,y:28}):(i=ju(this,66,"181,0,21"),r={x:20,y:38});var n=i.getContext("2d");n.fillStyle="#FFFFFF",n.font="bold 11px Arial",n.fillText(String(e),r.x,r.y),i=new Rj(i,{size:{w:r=i.width/this.a,h:r},anchor:{x:r/2,y:r/2}}),this.c[e]=i}return(e=new Gn(t.Aa(),{icon:i,min:t.uc(),max:t.Qf()})).setData(t),e},iu.prototype.getClusterPresentation=iu.prototype.hm,iu.prototype.Qm=function(t){var e=new Gn(t.Aa(),{icon:this.f,min:t.uc()});return e.setData(t),e},iu.prototype.getNoisePresentation=iu.prototype.Qm,u(ku,eu),ku.prototype.Wk=function(t,e){this.U=t,this.u=zd(e)},ku.prototype.Ii=function(t,e){var i=this.c,r=this.U,n=this.u||0,o=!i||!(i.zoom===n&&i.b.na(r));if(r&&(this.b||o)){if(i&&3>i.he&&i.cancel(),this.b=!1,(i=this.f)>=128*Ed(2,n))var a=lu;else{(o=this.m).Qa(n);var s=o.kb(r.Pb());a=o.kb(r.Lb()),s.y-=i,a.y+=i,s=o.Xe(s);var l=o.Xe(a);a=new K(s.lat,s.lng,l.lat,l.lng),i=o.Ra(i,0).lng+180,a=a.Cc(s.lat,s.lng-i,l.lat,s.lng).Cc(s.lat,l.lng,l.lat,l.lng+i)}for(i=a,a=[],o=(s=this.a).length;o--;)i.md(s[o])&&a.push(s[o]);0<a.length?(this.c=new mu(r,n,a,this.f,this.F,this.o!==fj,t,e),this.c.then(this.i,this.j)):t(gu)}},ku.prototype.i=function(t){Ca(t)||(t=new x.Uint32Array(t)),this.c.g(nu(this,t))},ku.prototype.j=function(t){Ac(t)&&this.c.c(t)};var lu=new K(90,-180,-90,180);function nu(t,e){for(var i=0,r=e[i++],n=Array(r),o=0,a=[],s=e.length,l=t.c.a,u=t.c.zoom;r--;)n[o++]=new cu(l[e[i++]],u);for(;i<s;){r=e[i++],o=l[e[i]];var c=t.m,h=t.f;c.Qa(t.c.zoom);var p=c.kb(o);for(o=c.Ra(p.x-h,p.y-h),c=c.Ra(p.x+h,p.y+h),o=new du((o=new K(o.lat,o.lng,c.lat,c.lng)).Pb(),o.Lb(),u);r--;)o.ye(l[e[i++]]);a.push(o)}return{clusters:a,noisePoints:n}}function mu(t,e,i,r,n,o,a,s){this.b=t,this.zoom=e,this.a=i,this.g=a,this.c=s,a=3*(t=i.length),s=new(x.Float64Array||Array)(a);for(var l;t--;)l=i[t],s[--a]=l.lat,s[--a]=l.lng,s[--a]=l.wt;fe.call(this,"cluster",{message:[s,r,n,e,o]},void 0)}function ou(t,e,i){this.b=t,this.a=e,this.f=i}function pu(t,e,i,r){this.b=t,this.a=e,this.i=i,this.m=r,this.f=Ja(this.f,this),this.c=Ja(this.c,this)}function qu(t,e,i,r,n,o){this.g=e,t&&(this.parent=t,1&e?(i=t[8],n=t[5]):(i=t[7],n=t[8]),2&e?(r=t[9],o=t[6]):(r=t[4],o=t[9])),this[7]=i,this[5]=n,this[8]=(i+n)/2,this[4]=r,this[6]=o,this[9]=(r+o)/2}function ru(t,e){return t[e]||(++t.ge,t[e]=new qu(t,e))}function su(t,e,i,r){var n,o;if(!e(t,r)&&i--)for(++r,n=0;4>n;n++)(o=t[n])&&su(o,e,i,r)}function tu(t){this.b=t||10,uu(this)}function uu(t){t.head=t.a=new qu(null,NaN,0,0,4294967296,4294967296)}function vu(t,e){var i,r;for(i=0;4>i;i++)(r=e[i])&&(vu(t,r),delete e[i]);delete e.parent,delete e.entries}function wu(t,e){var i,r=t.head;if(e){var n=e;if(n!==r)for(r=n;n=n.parent;)(n.entries||1<n.ge)&&(r=n)}else for(;!r.entries&&2>(i=r.ge)&&i;)r=n;t.head=r}function xu(t,e,i,r,n,o,a){var s=e.entries;return o?e.ge?s=xu(t,ru(e,+(i>=e[8])|+(r>=e[9])<<1),i,r,n,o-1,a):s?((s=ru(e,+((s=s[0])[1]>=e[8])|+(s[0]>=e[9])<<1)).entries=e.entries,s.Ae=e.Ae,s.Be=e.Be,s.Ib=e.Ib,s.a=e.a,s.f=e.f,s.b=e.b,s.c=e.c,delete e.entries,wu(t,s),s=xu(t,ru(e,+(i>=e[8])|+(r>=e[9])<<1),i,r,n,o-1,a)):(o=s=new yu(i,r,n,a),(e.entries||(e.entries=[])).push(o),wu(t,e)):(s||wu(t,e),t=s=new yu(i,r,n,a),(e.entries||(e.entries=[])).push(t)),e.Ae+=i*n,e.Be+=r*n,e.Ib+=n,e.a===B?(e.a=e.b=i,e.f=e.c=r):(i<e.a?e.a=i:i>e.b&&(e.b=i),r<e.f?e.f=r:r>e.c&&(e.c=r)),s}function yu(t,e,i,r){this[0]=e,this[1]=t,this.a=i,this.data=r}function zu(t){eu.call(this,t),t=this.g,this.j=t.projection,this.m=t.min,this.f=t.max,this.o=t.minWeight,this.c=7-yd(Cd(xd(1,t.eps))/Md),this.i=new tu(xd(this.m,this.f+this.c))}function Au(t,e,i,r,n,o,a){var s,l=e.Ib;if(a&&(a.node.Ib!==l?(o.clusters.push(new pu(t,a.node,a.depth,i-1)),a=null):n++),a||(l>=t.o?(a={node:e,depth:i},n=i):Bu(t,e,n+1,o)),e.ge&&r--)for(i++,l=0;4>l;l++)(s=e[l])&&(Au(t,s,i,r,n,o,a),a=null);a&&o.clusters.push(new pu(t,a.node,a.depth,t.f+t.c))}function Bu(t,e,i,r){var n;if(e=e.entries){var o=e.length;for(r=r.noisePoints,n=0;n<o;n++)r.push(new ou(t,e[n],i))}else for(n=0;4>n;n++)(o=t[n])&&Bu(t,o,i,r)}function Cu(t,e){var i={},r=(e=e||{}).min||0;switch(r={min:r,max:xd(r,e.max||22)},Cu.l.constructor.call(this,r),this.Ea=e.pixelRatio||Te(),Xa(i,fu,r,e.clusteringOptions||{}),i.minWeight=xd(fu.minWeight,i.minWeight),i.strategy){case Du.DYNAMICGRID:if(i.projection!==fj)throw new D(Cu,1,"Unsupported projection");this.b=new ku(i);break;case Du.GRID:this.b=new hu(i);break;default:this.b=new zu(i)}this.b.Ic(t),this.F=e.theme||new iu(this.Ea),this.R=A(this.R,this),this.W=A(this.W,this),Eu(this)}ku.prototype.s=function(){ku.l.s.call(this)},u(mu,Qf),t("H.clustering.fastgrid.NoisePoint",ou),ou.prototype.Aa=function(){return this.c||(this.c=this.b.Ra(this.a[1],this.a[0],1)),this.c},ou.prototype.getPosition=ou.prototype.Aa,ou.prototype.yc=function(){return this.a.a},ou.prototype.getWeight=ou.prototype.yc,ou.prototype.xd=ff,ou.prototype.isCluster=ou.prototype.xd,ou.prototype.uc=function(){return this.f-this.b.c},ou.prototype.getMinZoom=ou.prototype.uc,ou.prototype.getData=function(){return this.a.data},ou.prototype.getData=ou.prototype.getData,t("H.clustering.fastgrid.Cluster",pu),pu.prototype.Aa=function(){return this.j||(this.j=this.b.Ra(this.a.Ae,this.a.Be,this.a.Ib)),this.j},pu.prototype.getPosition=pu.prototype.Aa,pu.prototype.yc=function(){return this.a.Ib},pu.prototype.getWeight=pu.prototype.yc,pu.prototype.xd=ef,pu.prototype.isCluster=pu.prototype.xd,pu.prototype.uc=function(){return this.i?this.i-this.b.c:-1/0},pu.prototype.getMinZoom=pu.prototype.uc,pu.prototype.Qf=function(){return this.m-this.b.c},pu.prototype.getMaxZoom=pu.prototype.Qf,pu.prototype.I=function(){return this.O||(this.O=eg(this.b.Ra(this.a.a,this.a.f,1),this.b.Ra(this.a.b,this.a.c,1),!0)),this.O},pu.prototype.getBoundingBox=pu.prototype.I,pu.prototype.eh=function(t){this.g=t,this.a.Nc(this.f,Ud)},pu.prototype.forEachEntry=pu.prototype.eh,pu.prototype.f=function(t,e){var i,r,n=!1;if(t.Ib>=this.b.o&&t!==this.a&&t.Ib!==this.a.Ib&&(this.g(new pu(this.b,t,0,e)),n=!0),!n&&(i=t.entries))for(t=i.length,r=0;r<t;r++)this.g(new ou(this.b,i[r],e));return n},pu.prototype.Ie=function(t){this.o=t,this.a.Nc(this.c,Ud)},pu.prototype.forEachDataPoint=pu.prototype.Ie,pu.prototype.c=function(t,e){var i;if(t=t.entries){var r=t.length;for(i=0;i<r;i++)this.o(new ou(this.b,t[i],e))}return!1},n=qu.prototype,n.ge=0,n.removeChild=function(t){var e=t.g;this[e]===t&&(delete this[e],delete t.parent,--this.ge)},n.Nc=function(t,e){for(var i=0,r=this;r=r.parent;)++i;su(this,t,e,i)},n.Ae=0,n.Be=0,n.Ib=0,tu.prototype.zc=function(t,e,i,r){var n=this.a;if(!(t>=n[7]&&e>=n[4]&&t<=n[5]&&e<=n[6]))throw Error("Coordinates out of bounds");return xu(this,this.a,t,e,i,this.b,r)},tu.prototype.Nc=function(t,e){su(this.a,t,e===+e?e:this.b,0)},u(zu,eu),n=zu.prototype,n.Ic=function(t){var e,i=0,r=t.length,n=new I(0,0),o=this.j,a=this.i;for(zu.l.Ic.call(this,t),vu(a,a.a),uu(a);i<r;i++)o.Vc(e=t[i],n).scale(4294967296).floor(),a.zc(n.x,n.y,e.wt,e.data);this.b=!0},n.Gb=function(t){zu.l.Gb.call(this,t),this.Ic(this.a)},n.vf=function(t){for(var e=t.length,i=zu.l.Gb;e--;)i.call(this,t[e]);this.Ic(this.a)},n.bf=function(t){zu.l.bf.call(this,t),this.Ic(this.a)},n.Ra=function(t,e,i,r){return this.j.Ra(t/i/4294967296,e/i/4294967296,r)},n.Ii=function(t){if(this.b){var e={clusters:[],noisePoints:[]};Au(this,this.i.a,0,this.f+this.c,-1/0,e,null),this.b=!1,t(e)}},n.s=function(){zu.l.s.call(this),this.i=null},t("H.clustering.DataPoint",(function(t,e,i,r){this.lat=t,this.lng=e,this.wt=i===+i?i:1,this.data=r})),u(Cu,N),t("H.clustering.Provider",Cu),Cu.prototype.s=function(){Cu.l.s.call(this),this.g.qa(),this.b.B(),delete this.b,delete this.T,delete this.F,x.clearTimeout(this.ha)};var Du={FASTGRID:0,GRID:1,DYNAMICGRID:2};function Eu(t,e,i){t.ha&&x.clearTimeout(t.ha),e&&t.b.Wk(e,i),t.ha=x.setTimeout(t.R,150)}function Fu(t){var e=t.T.clusters,i=t.T.noisePoints,r=e.length,n=i.length,o=0<r+n;for(t.g.qa();n--;){var a=i[n];t.g.ca(t.F.getNoisePresentation(a))}for(;r--;)i=e[r],t.g.ca(t.F.getClusterPresentation(i));o&&t.Xa()}function Gu(t,e){t:{for(var i=t.length,r="string"==typeof t?t.split(""):t,n=0;n<i;n++)if(n in r&&e.call(void 0,r[n],n,t)){e=n;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}Cu.Strategy=Du,Cu.prototype.R=function(){this.dispatchEvent("start"),this.b.Ii(this.W,id)},Cu.prototype.W=function(t){this.dispatchEvent("end"),this.T=t,Fu(this)},Cu.prototype.Ic=function(t){this.b.Ic(t),Eu(this)},Cu.prototype.setDataPoints=Cu.prototype.Ic,Cu.prototype.Gb=function(t){this.b.Gb(t),Eu(this)},Cu.prototype.addDataPoint=Cu.prototype.Gb,Cu.prototype.vf=function(t){this.b.vf(t),Eu(this)},Cu.prototype.addDataPoints=Cu.prototype.vf,Cu.prototype.bf=function(t){this.b.bf(t),Eu(this)},Cu.prototype.removeDataPoint=Cu.prototype.bf,Cu.prototype.ln=function(){return this.F},Cu.prototype.getTheme=Cu.prototype.ln,Cu.prototype.Do=function(t){this.F=t,this.T&&(this.g.qa(),Fu(this))},Cu.prototype.setTheme=Cu.prototype.Do,Cu.prototype.Tb=function(){return!0},Cu.prototype.providesDomMarkers=Cu.prototype.Tb,Cu.prototype.Ub=function(){return!0},Cu.prototype.providesMarkers=Cu.prototype.Ub,Cu.prototype.Dc=function(){return!0},Cu.prototype.providesSpatials=Cu.prototype.Dc,Cu.prototype.$e=function(t,e){Eu(this,t,e)},Cu.prototype.preprocessData=Cu.prototype.$e,t("H.clustering.buildInfo",(function(){return Ff("H-clustering","1.30.9","10ddda0")}));var Hu={};function Iu(t){var e=t.ownerDocument,i=e.documentElement;e=e.defaultView;var r=t.getBoundingClientRect();return t=r.left,r=r.top,isNaN(e.pageXOffset)?(t+=i.scrollLeft,r+=i.scrollTop):(t+=e.pageXOffset,r+=e.pageYOffset),new I(t,r)}function Ju(t,e,i){e=Dc(e)?e+"px":e,i=Dc(i)?i+"px":i,t.style[yf("transform")]="translate("+e+","+i+")"}var Ku,Lu=navigator.userAgent,Mu=-1<Lu.indexOf("Android")&&-1<Lu.indexOf("Mozilla/5.0")&&-1<Lu.indexOf("AppleWebKit"),Nu=/AppleWebKit\/([\d.]+)/,Ou=null===Nu.exec(Lu)?null:parseFloat(Nu.exec(Lu)[1]);Ku=Mu&&null!==Ou&&537>Ou;var Pu=globalThis,Qu=document.createElement("T");function Ru(){this.a=this.qj()}Ru.prototype.qj=function(){var t=navigator,e=[];return t&&(t.msPointerEnabled?e.push(Su):t.pointerEnabled&&e.push(Tu)),1>e.length&&("TouchEvent"in Pu&&e.push(Uu),e.push(Vu)),e},Ru.prototype.detectEventSets=Ru.prototype.qj,Ru.prototype.addEventListener=function(t,e,i,r){for(var n,o=this.a,a=o.length,s=!1;a--;)(n=o[a][e])&&(s=!0,t.addEventListener(n,i,r||!1));s||t.addEventListener(e,i,r||!1)},Ru.prototype.removeEventListener=function(t,e,i,r){for(var n,o=this.a,a=o.length,s=!1;a--;)(n=o[a][e])&&(s=!0,t.removeEventListener(n,i,r||!1));s||t.removeEventListener(e,i,r||!1)};var Tu={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},Su={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},Uu={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Vu={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function Wu(t,e,i,r){return t=t.createElement(e),i&&(t.className=i),r&&(t.innerHTML=r),t}function Xu(t,e){for(var i=1,r=arguments.length;i<r;i++)t.appendChild(arguments[i])}var Yu=new Ru;function Zu(t,e,i){Yu.addEventListener(t,e,i,void 0)}function $u(t,e,i){Yu.removeEventListener(t,e,i,void 0)}function Z(t,e){F.call(this),this.Ea=t||"div",this.c=e?e.split(" "):[],this.T=!1,this.c.push("H_el")}function av(t){(t=t.K())&&t.parentNode&&t.parentNode.removeChild(t)}function bv(t){t=t||{},Z.call(this,"div","H_btn"),this.Kc(t.label||" "),this.mc(t.tooltip||""),this.setData(t.data),this.Ba(!!t.disabled),this.N(cv.UP,!0),t.onStateChange&&this.addEventListener("statechange",t.onStateChange),this.b=A(this.b,this),this.a=A(this.a,this)}u(Z,F),t("H.ui.base.Element",Z),Z.prototype.V=function(t){if(!t)throw Error("Wrong document object");return this.S=Wu(t,this.Ea,this.c.join(" ")),this.renderInternal(this.S,t),this.Ba(this.gc(),!0),this.mc(this.ra),this.vb(this.L),this.S},Z.prototype.ha=function(){},Z.prototype.P=function(){},Z.prototype.$=function(){},Z.prototype.renderInternal=Z.prototype.$,Z.prototype.gc=function(){return this.T},Z.prototype.isDisabled=Z.prototype.gc,Z.prototype.Ba=function(t,e){return((t=!!t)!==this.T||e)&&((this.T=t)?this.Ma("H_disabled"):this.pb("H_disabled")),this},Z.prototype.setDisabled=Z.prototype.Ba,Z.prototype.F=null,Z.prototype.getData=function(){return this.F},Z.prototype.getData=Z.prototype.getData,Z.prototype.setData=function(t){this.F=t},Z.prototype.setData=Z.prototype.setData,Z.prototype.mc=function(t){var e=this.K();this.ra=t,e&&(t?e.setAttribute("title",t):e.removeAttribute("title"))},Z.prototype.setTooltip=Z.prototype.mc,Z.prototype.S=null,Z.prototype.K=function(){return this.S},Z.prototype.getElement=Z.prototype.K,Z.prototype.L=!0,Z.prototype.vb=function(t){var e=this.K();this.L=t,e&&(e.style.display=t?"":"none")},Z.prototype.setVisibility=Z.prototype.vb,Z.prototype.xc=function(){return this.L},Z.prototype.getVisibility=Z.prototype.xc,Z.prototype.Ma=function(t){var e=this.K();return 0>this.c.indexOf(t)&&this.c.push(t),e&&(e.className=this.c.join(" ")),this},Z.prototype.addClass=Z.prototype.Ma,Z.prototype.pb=function(t){t=this.c.indexOf(t);var e=this.K();return-1<t&&this.c.splice(t,1),e&&(e.className=this.c.join(" ")),this},Z.prototype.removeClass=Z.prototype.pb,Z.prototype.s=function(){Z.l.s.call(this),av(this),this.F=this.S=null,delete this.ra},u(bv,Z),t("H.ui.base.Button",bv),bv.prototype.Ba=function(t,e){return t&&this.pb("H_active"),bv.l.Ba.call(this,t,e)},bv.prototype.$=function(t){Zu(t,"start",this.b),Zu(t,"end",this.a),Zu(t,"out",this.a),this.Kc(this.Oe(),!0)},bv.prototype.renderInternal=bv.prototype.$,bv.prototype.getState=function(){return this.g},bv.prototype.getState=bv.prototype.getState,bv.prototype.N=function(t,e){return t!==this.g&&(this.g=t,t===cv.DOWN?this.Ma("H_active"):this.pb("H_active"),e||this.dispatchEvent("statechange")),this},bv.prototype.setState=bv.prototype.N,bv.prototype.Oe=function(){return this.f},bv.prototype.getLabel=bv.prototype.Oe,bv.prototype.Kc=function(t,e){return(e||t!==this.f)&&(this.f=t,(e=this.K())&&(e.innerHTML=t)),this},bv.prototype.setLabel=bv.prototype.Kc,bv.prototype.b=function(t){this.gc()||this.N(cv.DOWN),t.preventDefault()},bv.prototype.a=function(t){this.gc()||this.N(cv.UP),t.preventDefault()},bv.prototype.s=function(){var t=this.K();t&&($u(t,"start",this.b),$u(t,"end",this.a),$u(t,"out",this.a)),Z.prototype.s.call(this)};var cv={UP:"up",DOWN:"down"};bv.State=cv;var dv={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function ev(t){var e;t=t||{},this.b=!!t.vertical,this.W=t.length||"16em",this.a=Dc(e=t.min)?e:0,this.i=xd(this.a,Dc(e=t.max)?e:100),this.la=E(e=t.step)?1:e,this.j=fv(this,Dc(e=t.value)?e:(this.a+this.i)/2),this.fg=A(this.fg,this),this.bg=A(this.bg,this),this.hg=A(this.hg,this),this.gg=A(this.gg,this),this.o=t.pointerArea,Z.call(this,"div","H_slider"+(this.b?"":" H_l_horizontal"))}function gv(t){if(!t.m){Zu(t.K(),"start",t.fg);var e=t.o;Zu(e,"move",t.bg),Zu(e,"end",t.hg),Zu(e,"out",t.gg),t.m=!0}}function hv(t){if(t.m){$u(t.K(),"start",t.fg);var e=t.o;$u(e,"move",t.bg),$u(e,"end",t.hg),$u(e,"out",t.gg),t.m=!1}}function fv(t,e){var i=t.la;return e=Zd(e,t.a,t.i),i?t.a+yd((e-t.a)/i)*i:e}function iv(t,e){var i=t.A,r=t.b;t.u||(t.u=i["offset"+(r?"Height":"Width")]),0>(e-=Iu(i)[r?"y":"x"])&&(e=0),e=(t.i-t.a)*e/t.u,e=fv(t,r?t.i-e:t.a+e),t.j!==e&&(t.zg(e,!0),t.dispatchEvent(new Wg(t.v.jd,e,t.j)))}function jv(t,e){return(e.touches?e.targetTouches[0]:e)["page"+(t.b?"Y":"X")]}function kv(t){var e=!1,i=t.type;return-1!==i.indexOf("pointer")||-1!==i.indexOf("touch")?e=!0:C(t,MouseEvent)&&(e=1===t.which||1===t.buttons),e}function lv(t){var e=t.touches;return e&&1===e.length||C(t,MouseEvent)}u(ev,Z),t("H.ui.base.Slider",ev),ev.prototype.zg=function(t,e){var i=this.b,r=i?"top":"left";return this.f&&!e||(t=Zd(t,this.a,this.i),this.g&&(i=(i?-1:1)*(e=100*(t-this.a)/(this.i-this.a)),this.g.style[r]=i+"%",this.Da.style[r]=100+i+"%"),this.j=fv(this,t)),this.j},ev.prototype.setValue=ev.prototype.zg,ev.prototype.rn=function(){return this.j},ev.prototype.getValue=ev.prototype.rn,n=ev.prototype,n.fg=function(t){var e=this.b;if(kv(t)&&lv(t)){var i=jv(this,t),r=t.target;r===this.g||r.parentElement===this.g?(this.R=i-Iu(this.g)[e?"y":"x"]-this.g.offsetWidth/2,this.K().className="H_slider H_slider_active"+(this.b?"":" H_l_horizontal"),this.f=!0):iv(this,i),t.preventDefault()}},n.hg=function(){this.f&&(this.K().className="H_slider "+(this.b?"":" H_l_horizontal"),this.f=!1)},n.gg=function(t){this.f&&t.target===this.o&&(this.f=!1)},n.bg=function(t){this.f&&lv(t)&&(kv(t)?(iv(this,jv(this,t)-this.R),t.preventDefault()):this.f=!1)},n.v={jd:"change"},n.$=function(t,e){var i=Wu(e,"div","H_slider_cont"),r=Wu(e,"div","H_slider_knob_cont"),n=Wu(e,"div","H_slider_knob"),o=Wu(e,"div","H_slider_knob_halo"),a=Wu(e,"div","H_slider_track");e=Wu(e,"div","H_slider_track H_slider_track_active"),t.appendChild(i),i.appendChild(a),a.appendChild(e),i.appendChild(r),r.appendChild(n),r.appendChild(o),this.A=a,this.Da=e,this.g=r,this.o||(this.o=t.ownerDocument.body),i.style[this.b?"height":"width"]=this.W,this.zg(this.j),gv(this)},ev.prototype.renderInternal=ev.prototype.$,ev.prototype.s=function(){hv(this)},ev.prototype.Ba=function(t,e){return t?hv(this):this.A&&gv(this),Z.prototype.Ba.call(this,t,e)},ev.prototype.setDisabled=ev.prototype.Ba;var mv={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};function nv(t,e,i){Z.call(this,t,e),this.a=i?i.concat():[]}function ov(){nv.call(this,"div","H_ctl"),this.map=null,this.Rc="top-left"}function pv(t){var e=(t=t||{}).slider;ov.call(this),this.o=A(this.o,this),this.g=A(this.g,this),this.b=A(this.b,this),e&&(this.u=A(this.u,this),this.A=e,this.rb=t.sliderSnaps,this.Ma("H_zoom_slider")),this.i=new bv({label:dv.in,onStateChange:this.o}),this.m=new bv({label:dv.out,onStateChange:this.o}),this.Ma("H_zoom"),this.Ma("H_grp"),this.la=!1!==t.fractionalZoom,this.setZoomSpeed(t.zoomSpeed||4),this.Xb(t.alignment||"right-middle")}function qv(t){t.removeChild(t.f),t.f=null,t.j&&(t.j.removeEventListener("minchange",t.b),t.j.removeEventListener("maxchange",t.b),t.j=null)}function rv(t,e){var i={},r={};i["top-left"]=Wu(e,"div",[sv,tv].join(" ")),i["top-center"]=Wu(e,"div",[sv,uv,vv,tv].join(" ")),i["top-right"]=Wu(e,"div",[sv,tv].join(" ")),i["left-top"]=Wu(e,"div",[sv,wv].join(" ")),i["left-middle"]=Wu(e,"div",[sv,xv,yv,wv].join(" ")),i["left-bottom"]=Wu(e,"div",[sv,wv].join(" ")),i["right-top"]=Wu(e,"div",[sv,wv].join(" ")),i["right-middle"]=Wu(e,"div",[sv,zv,yv,wv].join(" ")),i["right-bottom"]=Wu(e,"div",[sv,wv].join(" ")),i["bottom-left"]=Wu(e,"div",[sv,tv].join(" ")),i["bottom-center"]=Wu(e,"div",[sv,Av,vv,tv].join(" ")),i["bottom-right"]=Wu(e,"div",[sv,tv].join(" ")),r["top-left"]=Wu(e,"div",[uv,xv].join(" ")),r["top-right"]=Wu(e,"div",[uv,zv].join(" ")),r["bottom-left"]=Wu(e,"div",[Av,xv].join(" ")),r["bottom-right"]=Wu(e,"div",[Av,zv].join(" ")),Xu(r["top-left"],i["top-left"],i["left-top"]),Xu(r["top-right"],i["top-right"],i["right-top"]),Xu(r["bottom-left"],i["left-bottom"],i["bottom-left"]),Xu(r["bottom-right"],i["right-bottom"],i["bottom-right"]),Xu(t,r["top-left"],r["top-right"],r["bottom-left"],r["bottom-right"],i["top-center"],i["left-middle"],i["right-middle"],i["bottom-center"]),this.a=i}t("H.ui.LayoutAlignment",mv),u(nv,Z),t("H.ui.base.Container",nv),nv.prototype.Ba=function(t,e){var i=this.a?this.a.length:0;for(Z.prototype.Ba.call(this,t,e);i--;)this.a[i].Ba(t,e);return this},nv.prototype.setDisabled=nv.prototype.Ba,nv.prototype.La=function(t){var e=this.K();return this.a.push(t),e&&(t.V(e.ownerDocument),e.appendChild(t.K())),this},nv.prototype.addChild=nv.prototype.La,nv.prototype.jh=function(){return this.a.concat()},nv.prototype.getChildren=nv.prototype.jh,nv.prototype.removeChild=function(t){var e=this.a.indexOf(t),i=this.K();0<=e&&(this.a.splice(e,1),i&&i.removeChild(t.K()))},nv.prototype.removeChild=nv.prototype.removeChild,nv.prototype.qa=function(){var t=this.K();t&&this.a.forEach((function(e){t.removeChild(e.K())})),this.a=[]},nv.prototype.$=function(t,e){for(var i=0,r=this.a.length;i<r;i++)t.appendChild(this.a[i].V(e))},nv.prototype.renderInternal=nv.prototype.$,nv.prototype.s=function(){this.qa(),this.a.forEach(this.W,this),Z.prototype.s.call(this)},nv.prototype.W=function(t){t.B()},u(ov,nv),t("H.ui.Control",ov),ov.prototype.Ka=function(t){this.map=t},ov.prototype.V=function(t){return nv.prototype.V.call(this,t)},ov.prototype.$=function(t,e){nv.prototype.renderInternal.call(this,t,e),this.Xb(this.Rc)},ov.prototype.renderInternal=ov.prototype.$,ov.prototype.We=function(){},ov.prototype.onUnitSystemChange=ov.prototype.We,ov.prototype.dc=function(){return this.map},ov.prototype.getMap=ov.prototype.dc,ov.prototype.za=function(){return this.Da},ov.prototype.getLocalization=ov.prototype.za,ov.prototype.am=function(){return this.Rc},ov.prototype.getAlignment=ov.prototype.am,ov.prototype.Xb=function(t){return"string"==typeof t&&mv[t.replace("-","_").toUpperCase()]===t&&(this.Rc=t,this.dispatchEvent("alignmentchange")),this},ov.prototype.setAlignment=ov.prototype.Xb,u(pv,ov),t("H.ui.ZoomControl",pv),pv.prototype.wn=function(){return this.R},pv.prototype.getZoomSpeed=pv.prototype.wn,pv.prototype.Go=function(t){this.R=t},pv.prototype.setZoomSpeed=pv.prototype.Go,pv.prototype.Ka=function(t){this.map!==t&&(this.map&&this.map.removeEventListener("mapviewchange",this.g),qv(this)),ov.prototype.Ka.apply(this,arguments),this.map&&(this.b(),t.addEventListener("mapviewchange",this.g),t.addEventListener("baselayerchange",this.b))},pv.prototype.setMap=pv.prototype.Ka,pv.prototype.s=function(){ov.prototype.s.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.b),qv(this)},pv.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.i.mc(this.za().translate("zoom.in")),this.m.mc(this.za().translate("zoom.out"))},pv.prototype.renderInternal=pv.prototype.$,pv.prototype.Xb=function(t){var e=this.Rc;return ov.prototype.Xb.call(this,t),e!==t&&this.b(),this},pv.prototype.setAlignment=pv.prototype.Xb,pv.prototype.g=function(){var t=this.map,e=t.ub(),i=t.Za()-1;t=t.f||t.cc().getCapabilities().lookAt.zoom,this.A&&this.f.zg(e),this.gc()||(this.i.Ba(e+i>=t.max),this.m.Ba(e<=t.min))},pv.prototype.Ba=function(t,e){return pv.l.Ba.call(this,t,e),this.g(),this},pv.prototype.setDisabled=pv.prototype.Ba,pv.prototype.o=function(t){var e,i=(t=t.target)===this.i?1:-1,r=0<i?Math.ceil:Math.floor,n=this.map,o=this;n&&("down"===t.getState()?(n.c.startControl(),n.c.control(0,0,i*this.R,0,0,0)):n.c.endControl(!0,(function(t){e=o.la?t.zoom:r(t.zoom),t.zoom=e})))},pv.prototype.u=function(t){this.map&&this.map.lf(t.newValue)},pv.prototype.b=function(){var t=this.Rc,e=this.dc();if(/^top/g.test(t)||/^bottom/g.test(t)){var i=this.m;t=this.i;var r=!1}else i=this.i,t=this.m,r=!0;if(this.removeChild(i),this.removeChild(t),this.La(i),this.A&&e){qv(this),e=r;var n=(r=(i=this.map)&&i.f)||i.cc().getCapabilities().lookAt.zoom;(this.j=r)&&(r.addEventListener("minchange",this.b),r.addEventListener("maxchange",this.b)),this.f=new ev({step:this.rb?1:0,vertical:e,min:n.min,max:n.max,value:i.ub(),pointerArea:i.K()}),this.f.addEventListener(this.f.v.jd,this.u),this.La(this.f)}this.La(t)};var uv="H_l_top",Av="H_l_bottom",xv="H_l_left",zv="H_l_right",vv="H_l_center",yv="H_l_middle",tv="H_l_horizontal",wv="H_l_vertical",sv="H_l_anchor";function Bv(t,e){e?(e=t.offsetWidth,t.style.marginLeft=-Math.round(.5*e)+"px"):(e=t.offsetHeight,t.style.marginTop=-Math.round(.5*e)+"px")}rv.prototype.update=function(){var t=this.a;Bv(t["top-center"],!0),Bv(t["bottom-center"],!0),Bv(t["left-middle"],!1),Bv(t["right-middle"],!1)},rv.prototype.put=function(t,e){t=t?t.K():null;var i=e?this.a[e]:null;t&&i&&(t.parentElement&&t.parentElement.removeChild(t),i.insertBefore(t,/(bottom|right)$/.test(e)||/(center|middle)/.test(e)&&i.childNodes.length%2?i.firstChild:null)),this.update()};var Cv={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",Cv);var Dv={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function Ev(t){bv.call(this,t),this.j=function(t){t.preventDefault()},this.i=A((function(t){this.gc()||this.toggleState(),t.preventDefault()}),this)}function Fv(t,e,i){Zi.call(this,t,{icon:Gv,visibility:i}),Hv(this,e)}function Hv(t,e){t.Mn=e,t.S&&(t.S.textContent=e)}u(Ev,bv),t("H.ui.base.PushButton",Ev),Ev.prototype.$=function(t){Zu(t,"start",this.i),Zu(t,"end",this.j),this.Kc(this.Oe(),!0)},Ev.prototype.renderInternal=Ev.prototype.$,Ev.prototype.Oo=function(){var t=cv.DOWN;return this.N(this.getState()===t?cv.UP:t),this},Ev.prototype.toggleState=Ev.prototype.Oo,Ev.prototype.s=function(){var t=this.K();t&&$u(t,"start",this.i),bv.prototype.s.call(this)},u(Fv,Zi);var Gv=new Qi(Wu(Pu.document,"span","H_dm_label"),{onAttach:function(t,e,i){i.S=t,Hv(i,i.Mn)},onDetach:function(t,e,i){delete i.S}});function Iv(t,e){F.call(this),this.b=t,this.f=new Fv(this.Mo,""),e.push(this.f),this.a=new Q({objects:e,data:this}),this.wg=this.wg.bind(this)}function Jv(t,e){e&&(t.nextSibling=e,e.previousSibling=t)}function Kv(t,e,i,r){var n=new L,o=[];Jv(t,this),Jv(this,e),n.Bd(t.Aa()),n.Bd(e.Aa()),this.c=new wh(n,{style:i.fe}),this.i=new wh(n,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.c.va().lineWidth+2*(r||5))}}),i.c&&(this.g=new wh(n,{style:i.c}),o.push(this.g)),o.push(this.c,this.i),Iv.call(this,i,o),this.o=this.j=-1,(t=this.a).addEventListener("pointermove",this.F,!0,this),t.addEventListener("pointerleave",this.u,!0,this)}function Lv(t,e,i){var r=t.c.da();r.nf(3*+i,3,[e.lat,e.lng,0]),t.g&&t.g.ba(r),t.i.ba(r),t.c.ba(r)}function Mv(t,e,i){i=e.b(i||0),this.c=new Gn(t,{icon:i,zIndex:0}),this.c.draggable=!0,Iv.call(this,e,[this.c]),(t=this.a).addEventListener("dragstart",this.$n,!0,this),t.addEventListener("drag",this.ao,!0,this),t.addEventListener("dragend",this.Zn,!0,this)}function Nv(t){var e=0;t.nextSibling&&t.previousSibling&&(t.nextSibling.bd||t.previousSibling.bd?t.nextSibling.bd&&!t.previousSibling.bd&&(e=2):e=1),e=t.b.b(e),t.c.Jc(e)}function Ov(t,e){this.c=e,this.b=t,this.a={bd:!0},Pv(this,this.a),this.eg=A(this.eg,this)}function Qv(t,e){for(var i=(t=t.a).nextSibling;i!==t;){var r=i,n=i.previousSibling!==t&&e;(r.m=n)?r.wg():(r.Wh&&x.clearTimeout(r.Wh),r.Wh=x.setTimeout(r.wg,100)),i=i.nextSibling}}function Rv(t,e){var i=e||t.a.nextSibling,r=0,n=0;if(e&&!Sv(t,e))throw new D(t.df,0,e);for(i instanceof Mv?r=i.Ne():i instanceof Kv&&(r=i.previousSibling.Ne()),e=i;e&&e!==t.a;e=e.nextSibling,n++)e.si(r),1==n%2&&(r+=e.Ne())}function Sv(t,e){for(var i=t.a.nextSibling,r=!1;i!==t.a;){if(i===e){r=!0;break}i=i.nextSibling}return r}function Tv(t,e,i){e=new Kv(e,i,t.c),t.b.ca(e.a)}function Pv(t,e){t.a.nextSibling=e,e.previousSibling=t.a}function Uv(t){var e,i=(t=t||{}).lineStyle;ov.call(this),this.m=new Ev({label:Dv.btn,onStateChange:A(this.Xn,this)}),this.La(this.m),(e=t.distanceFormatter)&&(this.tj=e),i&&(this.dk=i,this.Ak=B),this.Xb(t.alignment||"right-bottom"),this.i={},this.i[0]=t.startIcon,this.i[2]=t.endIcon,this.i[1]=t.stopoverIcon,this.i[3]=t.splitIcon}function Vv(t){var e,i=t.map,r={};t.f||(t.o=new N,t.g=new ul(t.o,{pixelRatio:t.map.Za()}),t.u=e=t.o.ec(),t.u.fl(!0),e.addEventListener("dragstart",t.Vn,!0,t),e.addEventListener("dragend",t.mf,!0,t),e.addEventListener("pointerenter",t.mf,!0,t),e.addEventListener("pointerleave",t.Wn,!0,t),e.addEventListener("tap",t.no,!0,t),t.j=Wv(t),r.a=A(t.tj,t),r.b=A(t.lk,t),r.g=A(t.Ij,t),r.map=t.map,r.f=t.j,r.fe=t.dk,r.c=t.Ak,t.b=new Ov(t.u,r),t.f=!0),t.j&&t.u.ca(t.j),i.addEventListener("tap",t.xk,!0,t),i.a.add(t.g)}function Xv(t){var e=t.map;t.f&&(e.removeEventListener("tap",t.xk,!0,t),e.cf(t.g),t.b.qa())}function Wv(t){function e(){var t=r.Bb();return t={anchor:r.rd().clone().scale(o).floor(),size:new Ti(zd(t.w*o),zd(t.h*o)),hitArea:n},new Rj(r.Wc(),t)}var i,r=t.lk(3),n=new Ui(Vi.NONE,[]),o=r===t.A?.5:1;if(1===r.getState())var a=e();else a=new Rj("<svg/>",{hitArea:n}),r.addEventListener("statechange",(function(){1===r.getState()&&i.Jc(e())}));return i=new Gn(t.map.fb(),{visibility:!1,icon:a})}function Yv(){this.b=Zv.CLOSED,nv.call(this,"div","H_overlay")}u(Iv,F),n=Iv.prototype,n.bd=!1,n.Mo={lat:0,lng:0},n.Kc=function(t,e){Hv(this.f,t),this.f.ba(e)},n.Wh=0,n.wg=function(){this.f.vb(this.m)},u(Kv,Iv),Kv.prototype.Ne=function(){var t=this.c.da();return t.Ge(0).Ya(t.Ge(1))},Kv.prototype.F=function(t){var e=t.currentPointer;t=this.previousSibling.Aa();var i=this.nextSibling.Aa(),r=this.b.f,n=e.viewportX;e=e.viewportY,this.j===n&&this.o===e||(this.j=n,this.o=e,r.ba(this.b.g(t,i,{x:n,y:e})),r.vb(!0))},Kv.prototype.u=function(){this.b.f.vb()},Kv.prototype.si=function(){this.Kc(this.b.a(this.Ne()),this.c.I().fb())},u(Mv,Iv),n=Mv.prototype,n.qk=0,n.v={jd:"change"},n.Ne=function(){return this.qk},n.Aa=function(){return this.c.da()},n.ao=function(t){var e=t.currentPointer;t=e.viewportX,e=e.viewportY,this.i===t&&this.j===e||(this.i=t,this.j=e,this.c.ba(this.b.map.Va(t-this.g.x,e-this.g.y)),this.dispatchEvent(new sd(this.v.jd,this)))},n.$n=function(t){var e=t.currentPointer,i=e.viewportX;e=e.viewportY;var r=this.b.map.Ga(this.Aa());this.c.qe(1),this.g={x:i-r.x,y:e-r.y},t.stopPropagation()},n.Zn=function(){this.c.qe(0)},n.si=function(t){this.qk=t,this.Kc(this.b.a(t),this.Aa())},t("H.ui.distanceMeasurement.Model",Ov),n=Ov.prototype,n.Xf=function(){return this.a.nextSibling===this.a},n.ye=function(t){var e=this.a.previousSibling,i=this.Xf();return t=new Mv(t,this.c,i?0:2),this.b.ca(t.a),Jv(t,this.a),t.addEventListener(t.v.jd,this.eg),i?Pv(this,t):(Tv(this,e,t),Nv(e),Rv(this,e)),t},n.insertBefore=function(t,e){var i,r=1;if(e){if(!Sv(this,e))throw new D(this.insertBefore,1,e);(i=e.previousSibling.bd)&&(r=0),(t=new Mv(t,this.c,r)).addEventListener(t.v.jd,this.eg),this.b.ca(t.a),i?(Tv(this,t,i=this.a.nextSibling),Pv(this,t),e=t,Nv(i)):(e=(i=e.previousSibling).previousSibling,r=i.nextSibling,this.b.Ja(i.a),Tv(this,e,t),Tv(this,t,r)),Rv(this,e)}else t=this.ye(t);return t},n.qa=function(){Pv(this,this.a),this.b.qa()},n.df=function(t){var e=this.a,i=t.previousSibling,r=t.nextSibling;if(!Sv(this,t))throw new D(this.df,0,t);if(this.b.Ja(t.a),i===e){var n=r;n!==e?(Pv(this,t=n.nextSibling),t.si(0),Nv(t),Rv(this,t)):Pv(this,this.a)}else r===e?(Jv(t=(n=i).previousSibling,e),Nv(t)):i&&r&&(Tv(this,i.previousSibling,r.nextSibling),this.b.Cd([r.a,i.a]),Rv(this,i.previousSibling));n&&n!==e&&this.b.Ja(n.a)},n.eg=function(t){var e=(t=t.target).previousSibling,i=t.nextSibling,r=t.Aa();if(!i.bd){Lv(i,r,!1);var n=t}e.bd||(Lv(e,r,!0),n=e.previousSibling),Rv(this,n)},u(Uv,ov),t("H.ui.DistanceMeasurement",Uv),n=Uv.prototype,n.Vh=Cv.METRIC,n.dk={strokeColor:"rgb(39,44,54)",lineWidth:5},n.Ak={strokeColor:"white",lineWidth:7},n.tj=function(t){var e="m",i=0;return"metric"===this.Vh?1e3<=t&&(t/=1e3,e="km",i=1):(e="ft",5280<=(t/=.3048)&&(t/=5280,e="mi",i=1)),t.toFixed(i)+" "+this.za().translate("scale."+e)},n.Ij=function(t,e,i){var r=this.map.Ga(t);return e=this.map.Ga(e),i=new I(i.x,i.y).Hj(r,e),this.map.Va(i.x,i.y)||$f(t)},n.$=function(t,e){var i=22*(this.map.cc().type===ek.P2D?this.map.Za():1),r=i/2;ov.prototype.renderInternal.call(this,t,e),this.Vh=Cv.METRIC,this.A=new Rj(Dv.point,{anchor:{x:r,y:r},size:{w:i,h:i},hitArea:new Ui(Vi.CIRCLE,[r,r,r])}),this.m.mc(this.za().translate("distance.measurement"))},Uv.prototype.renderInternal=Uv.prototype.$,n=Uv.prototype,n.lk=function(t){return this.i[t]||this.A},n.mf=function(){Qv(this.b,!0)},n.Vn=function(){Qv(this.b)},n.Wn=function(t){"touch"!==t.currentPointer.type&&Qv(this.b)},n.no=function(t){var e,i=t.currentPointer,r=t.target.Ia;r&&(r=r.getData())instanceof Iv&&(e=r),r=e,t=(t=t.originalEvent).metaKey||t.altKey,r&&(t&&r instanceof Mv?this.b.df(r):r instanceof Kv&&(t=r.previousSibling.Aa(),e=r.nextSibling.Aa(),i={x:i.viewportX,y:i.viewportY},this.b.insertBefore(this.Ij(t,e,i),r.nextSibling),this.j.vb()),this.mf())},n.xk=function(t){var e=t.currentPointer;(t=t.target)!==this.map&&t.getProvider&&t.getProvider()===this.o||(this.b.ye(this.map.Va(e.viewportX,e.viewportY)),this.j.vb(),this.mf())},n.Xn=function(t){"down"===t.target.getState()?Vv(this):Xv(this)},n.We=function(t){this.Vh=t,this.f&&(Rv(this.b),this.mf())},Uv.prototype.onUnitSystemChange=Uv.prototype.We,Uv.prototype.s=function(){Xv(this),this.f&&(this.o.B(),this.g.B()),Uv.l.s.call(this)},Uv.prototype.Ka=function(t){t?this.m.getState()===cv.DOWN&&(this.map=t,Vv(this)):(Xv(this),this.f=!1),ov.prototype.Ka.apply(this,arguments)},Uv.prototype.setMap=Uv.prototype.Ka,u(Yv,nv),t("H.ui.base.OverlayPanel",Yv),Yv.prototype.N=function(t,e){return(t!==this.b||e)&&(this.b=t,t===Zv.OPEN?this.Ma("H_open"):this.pb("H_open")),this},Yv.prototype.setState=Yv.prototype.N,Yv.prototype.getState=function(){return this.b},Yv.prototype.getState=Yv.prototype.getState,Yv.prototype.Fk=function(t){var e=t.Rc;t=t.K();var i=this.K(),r=i.style;if(this.pb("H_top"),this.pb("H_middle"),this.pb("H_bottom"),this.pb("H_left"),this.pb("H_center"),this.pb("H_right"),r.bottom=r.top=r.left=r.right=r.margin="",/top/g.test(e)){this.Ma("H_top"),r.top="0",r.margin="0 12px";var n=-1}else/bottom/g.test(e)?(this.Ma("H_bottom"),r.bottom="0",r.margin="0 12px",n=1):(this.Ma("H_middle"),r.top="50%",r.margin="0 12px",r.marginTop=-Math.round(.5*i.offsetHeight)+"px",n=0);/left/g.test(e)?(this.Ma("H_left"),r.left=t.offsetWidth+"px",r.marginLeft="12px"):/right/g.test(e)?(this.Ma("H_right"),r.right=t.offsetWidth+"px",r.marginRight="12px"):(this.Ma("H_center"),r.left="50%",0>n?(r.top=t.offsetHeight+"px",r.marginTop="12px"):0<n&&(r.bottom=t.offsetHeight+"px",r.marginBottom="12px"),r.marginLeft=-Math.round(.5*i.offsetWidth)+"px",t.appendChild(i))},Yv.prototype.pointToControl=Yv.prototype.Fk;var Zv={OPEN:"open",CLOSED:"closed"};function $v(t){t=t||{},nv.call(this,"div","H_rdo"),this.g=new Z("div","H_rdo_title"),this.b=new nv("div","H_rdo_buttons"),this.La(this.g),this.La(this.b),this.i=A((function(t){t.target.getState()===cv.DOWN?(this.Uk(t.target,!0),this.dispatchEvent(aw)):t.target.N(cv.DOWN,!0)}),this),this.addEventListener("statechange",this.i),this.Gi(t.title||""),t.onActiveButtonChange&&this.addEventListener(aw,t.onActiveButtonChange),t.buttonsOptions&&t.buttonsOptions.forEach((function(t){this.Kg(new Ev(t))}),this)}Yv.State=Zv,u($v,nv),t("H.ui.base.RadioGroup",$v);var aw="activebuttonchange";function bw(t){t=t||{},ov.call(this),this.g=new Yv,this.b=this.b.bind(this),this.o=this.o.bind(this),this.m=this.m.bind(this),this.Xb(t.alignment||"bottom-right"),cw(this,t.baseLayers,t.layers)}function cw(t,e,i){var r=t.dc();t.f&&t.f.forEach((function(t){var e=t.layer;t=e&&Gu(i,(function(t){return t.layer===e})),e&&!t&&r.cf(e)})),t.j=zc(e)?e:[],t.f=zc(i)?i:[],t.i&&(t.i.qa(),t.u.qa(),dw(t))}function dw(t){var e=t.za();t.j.forEach((function(t,i){this.i.Kg(new Ev({label:ew(e,t.label),data:i,disabled:!t.layer}))}),t),t.f.forEach((function(t,i){this.u.La(new Ev({label:ew(e,t.label),onStateChange:this.la.bind(this,t.layer),data:i,disabled:!t.layer}))}),t),t.R.vb(!(!t.f.length||!t.j.length)),x.setTimeout(function(){this.map&&(this.b(),this.A.Ba(!(this.j&&this.j.length||this.f&&this.f.length)))}.bind(t))}function hw(t,e){var i,r,n={},o=e.ea(),a=window.H.service&&window.H.service.omv.Provider;if(a&&e.ea()instanceof a&&o.va().Fe){var s=o.va(),l=function(){var t=iw.ground.filter((function(t){return!!s.sh("layers."+t)})),a=iw.water.filter((function(t){return!!s.sh("layers."+t)}));t.concat(a).length&&(Eh(n,s.Fe(t)),Eh(n,s.Fe(a,!1,!0)),delete n.global,i=new bi(n,s.bc()),(r=o.j.nd(i)).Fg=e,this.map.Mg(r)),s.removeEventListener(ai.CHANGE,l)}.bind(t);s.getState()!==Zh.READY?s.addEventListener(ai.CHANGE,l):l()}}function fw(t){return Gu(t.map.a.Na(),(function(t){return!!t.Fg}))}function gw(t){t=t.map.a.Na();var e=window.H.service&&window.H.service.traffic.flow.Provider;return!!e&&t.some((function(t){return t.ea()instanceof e}))}$v.prototype.$=function(t,e){nv.prototype.renderInternal.call(this,t,e),this.Gi(this.f,!0)},$v.prototype.renderInternal=$v.prototype.$,$v.prototype.qa=function(){this.b.qa()},$v.prototype.Gi=function(t,e){return(t!==this.f||e)&&(this.f=t,this.g.K()&&(this.g.K().innerHTML=this.f)),this},$v.prototype.setTitle=$v.prototype.Gi,$v.prototype.nn=function(){return this.f},$v.prototype.getTitle=$v.prototype.nn,$v.prototype.Kg=function(t){if(!(t instanceof Ev))throw Error("PushButton expected");return t.ja(this),this.b.La(t),this},$v.prototype.addButton=$v.prototype.Kg,$v.prototype.to=function(t){return this.b.removeChild(t),t.ja(null),this},$v.prototype.removeButton=$v.prototype.to,$v.prototype.Lf=function(){return this.b.jh()},$v.prototype.getButtons=$v.prototype.Lf,$v.prototype.Uk=function(t,e){for(var i=this.Lf(),r=i.length;r--;)i[r].N(i[r]===t?cv.DOWN:cv.UP,e)},$v.prototype.setActiveButton=$v.prototype.Uk,$v.prototype.s=function(){this.removeEventListener("statechange",this.i),this.qa(),nv.prototype.s.call(this)},u(bw,ov),t("H.ui.MapSettingsControl",bw),bw.prototype.ha=function(){var t=this.dc();t&&(t.addEventListener("tap",this.o),(t=t.a).addEventListener("add",this.b),t.addEventListener("remove",this.b),t.addEventListener("set",this.b))},bw.prototype.P=function(){var t=this.dc();t&&(t.removeEventListener("tap",this.o),(t=t.a).removeEventListener("add",this.b),t.removeEventListener("remove",this.b),t.removeEventListener("set",this.b))},bw.prototype.$=function(t,e){var i=this.za().translate("layers.choose");ov.prototype.renderInternal.call(this,t,e),this.ha(),this.A=new Ev({tooltip:i,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A((function(t){t.target.getState()===cv.DOWN?(this.g.N(Zv.OPEN),this.g.Fk(this)):this.g.N(Zv.CLOSED)}),this)}),this.i=new $v({title:i,onActiveButtonChange:function(){t:{for(var t=this.i.Lf(),e=t.length;e--;)if(t[e].getState()===cv.DOWN){t=t[e];break t}t=null}t=t.getData(),this.map.Fd(this.j[t].layer),this.m()}.bind(this)}),this.u=new nv("div","H_grp"),this.R=new Z("div","H_separator"),this.La(this.A),this.La(this.g),this.g.La(this.i),this.g.La(this.R),this.g.La(this.u),dw(this)},bw.prototype.renderInternal=bw.prototype.$,bw.prototype.b=function(){var t=this.map.f,e=this.map.a;this.j.forEach((function(e,i){this.i.Lf()[i].N(cv[e.layer===t?"DOWN":"UP"],!0)}),this),this.f.forEach((function(t,i){i=this.u.jh()[i],t.layer?i.N(cv[-1!==e.indexOf(t.layer)?"DOWN":"UP"],!0):i.Ba(!0)}),this)},bw.prototype.la=function(t,e){e.target.getState()===cv.DOWN?this.map.Mg(t):this.map.cf(t),this.m()},bw.prototype.m=function(){var t;(t=fw(this))&&(t.Fg.ea().va().Ue(t.ea().va().sd()),this.map.cf(t),t.B(),delete t.Fg),gw(this)&&hw(this,this.map.f)};var iw={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function ew(t,e){return/^layers?/.test(e)&&t.xh(e)?t.translate(e):e}bw.prototype.o=function(){this.A.N(cv.UP)},bw.prototype.s=function(){bw.l.s.call(this),this.P()};var jw=[];t("H.ui.i18n.defaultLocales",jw);var kw={},lw=[];function mw(t,e){kw[t]=e,-1===jw.indexOf(t)&&jw.push(t),lw.length?nw(t,e):lw=Object.keys(e)}function nw(t,e){for(var i,r=lw,n=r.length;n--;)if(!e[i=r[n]])throw Error("'"+i+"' key missing in translation map for "+t)}function ow(t){t=t||{},ov.call(this),this.f=new Ev({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:A(this.Yn,this)}),this.La(this.f),this.Xb(t.alignment||"right-bottom")}function pw(t,e){if(!Ac(t))throw new TypeError("string locale code required");if(Ea(e))nw(t,e);else{if(-1===jw.indexOf(t))throw Error("Default locale '"+t+"' does nto exist.");e=kw[t]}this.a=e||{},this.b=t}function qw(t){t=t||{},ov.call(this),this.Ma("H_scalebar"),this.Xb(t.alignment||"right-bottom"),this.m=150,this.update=A(this.update,this),this.i=this.g=this.b=this.f=null}function rw(t){C(t,Qe,rw,1),Z.call(this,"div","H_context_menu_item"),this.b=t,this.f=A(this.f,this),this.a=A(this.a,this),this.b.addEventListener("update",this.a)}function sw(t){C(t,Array,sw,1),nv.call(this,"div","H_context_menu"),this.f=t,this.b=null}function tw(t,e){e=e||{};var i=this;Z.call(this,"div","H_ib H_ib_top"),this.A=A((function(t){i.gc()||(i.close(),t.preventDefault())}),this),this.update=A(this.update,this),this.f=A(this.f,this),this.setPosition(t),this.hf(e.content),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.N(uw.OPEN)}u(ow,ov),t("H.ui.ZoomRectangle",ow),n=ow.prototype,n.Yn=function(t){var e=this.map,i=e.b.element;t.target.getState()===cv.DOWN?(e.addEventListener("dragstart",this.nk,!0,this),e.addEventListener("drag",this.pk,!0,this),e.addEventListener("dragend",this.mk,!0,this),(t=i.ownerDocument.createElement("div")).className="H_zoom_lasso",i.appendChild(t),this.b=t):(e.removeEventListener("dragstart",this.nk,!0,this),e.removeEventListener("drag",this.pk,!0,this),e.removeEventListener("dragend",this.mk,!0,this),i.removeChild(this.b))},n.nk=function(t){var e=this.b.style,i=t.currentPointer,r=i.viewportX;i=i.viewportY,t.target===this.map&&(t.stopPropagation(),e.width="0px",e.height="0px",e.top=i+"px",e.left=r+"px",e.display="block",this.i=i,this.g=r)},n.pk=function(t){var e=t.currentPointer,i=e.viewportX,r=e.viewportY;e=this.g;var n=this.i,o=this.b.style;t.target===this.map&&(t.stopPropagation(),t=i-e,i=r-n,o.left=e+(0>t?t:0)+"px",o.top=n+(0>i?i:0)+"px",o.width=Math.abs(t)+"px",o.height=Math.abs(i)+"px")},n.mk=function(t){var e=this.map,i=t.currentPointer;t.target===this.map&&(t.stopPropagation(),this.b.style.display="none",e.c.Yb({bounds:fg([e.Va(this.g,this.i),e.Va(i.viewportX,i.viewportY)])},!0))},n.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.f.mc(this.za().translate("zoom.rectangle"))},ow.prototype.renderInternal=ow.prototype.$,mw("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),mw("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transportes públicos","layer.traffic":"Condições de trânsito","layer.incidents":"Mostrar incidentes de trânsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes públicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo avariado","traffic.from":"Hora de início:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),mw("ru-RU",{"layers.normal":"Режим карты","layers.satellite":"Спутниковая","layers.terrain":"Местность","layer.transit":"Общественный транспорт","layer.traffic":"Дорожные условия","layer.incidents":"Показать дорожные события","layers.choose":"Выберите вид",minimap:"Minimap","scale.switchToImperial":"Использовать мили","scale.switchToMetric":"Использовать километры","scale.km":"км","scale.m":"м","scale.mi":"миль","scale.ft":"фут","zoom.out":"Отдалить","zoom.in":"Приблизить","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Общественный транспорт","traffic.MISCELLANEOUS":"Прочее ДТП","traffic.ACCIDENT":"ДТП","traffic.OTHER_NEWS":"Другие новости","traffic.PLANNED_EVENT":"Плановое мероприятие","traffic.ROAD_HAZARD":"Дорожная опасность","traffic.ROAD_CLOSURE":"Дорога закрыта","traffic.WEATHER":"Погода","traffic.CONGESTION":"Пробка","traffic.CONSTRUCTION":"Ремонт","traffic.DISABLED_VEHICLE":"Неисправный автомобиль","traffic.from":"Время начала:","traffic.until":"Ожидаемое время окончания:","distance.measurement":"Измерить расстояние"}),mw("fi-FI",{"layers.normal":"Karttanäkymä","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"Näytä liikennetapahtumat","layers.choose":"Valitse näkymä",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"Lähennä","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelemätön syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiellä","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"Sää","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennustyö","traffic.DISABLED_VEHICLE":"Pysähtynyt ajoneuvo","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu päättymisaika:","distance.measurement":"Measure distance"}),mw("pt-BR",{"layers.normal":"Exibição do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Condições do trânsito","layer.incidents":"Mostrar incidentes no trânsito","layers.choose":"Escolher exibição",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"pés","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Miscelânea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo incapacitado","traffic.from":"Hora de início:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),mw("zh-CN",{"layers.normal":"地图视图","layers.satellite":"卫星","layers.terrain":"地形","layer.transit":"公共交通","layer.traffic":"交通情况","layer.incidents":"显示交通事件","layers.choose":"选择视图",minimap:"Minimap","scale.switchToImperial":"切换为「英里」","scale.switchToMetric":"切换为「公里」","scale.km":"公里","scale.m":"米","scale.mi":"英里","scale.ft":"英尺","zoom.out":"缩小","zoom.in":"放大","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"公共交通","traffic.MISCELLANEOUS":"综合事件","traffic.ACCIDENT":"交通意外","traffic.OTHER_NEWS":"其他新闻","traffic.PLANNED_EVENT":"预定事件","traffic.ROAD_HAZARD":"道路危险","traffic.ROAD_CLOSURE":"道路已关闭","traffic.WEATHER":"天气","traffic.CONGESTION":"堵塞","traffic.CONSTRUCTION":"施工","traffic.DISABLED_VEHICLE":"车辆抛锚","traffic.from":"开始时间：","traffic.until":"预计结束时间：","distance.measurement":"Measure distance"}),mw("es-ES",{"layers.normal":"Mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Estado del tráfico","layer.incidents":"Mostrar incidentes de tráfico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"Más noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construcción","traffic.DISABLED_VEHICLE":"Vehículo averiado","traffic.from":"Inicio:","traffic.until":"Finalización estimada:","distance.measurement":"Measure distance"}),mw("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arrière","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.PLANNED_EVENT":"Événement prévu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chaussée fermée","traffic.WEATHER":"Météo","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"Véhicule en panne","traffic.from":"Date ou heure de début:","traffic.until":"Date et heure de fin estimées:","distance.measurement":"Measure distance"}),mw("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Pokaż zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmień na mile","scale.switchToMetric":"Zmień na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybliż","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomości","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpieczeństwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamknięta","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.from":"Data rozpoczęcia:","traffic.until":"Przybliżona data zakończenia:","distance.measurement":"Measure distance"}),mw("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gelände","layer.transit":"Öffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsstörungen anzeigen","layers.choose":"Ansicht auswählen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergrößern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Öffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),mw("tr-TR",{"layers.normal":"Harita görünümü","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ulaşım","layer.traffic":"Trafik durumları","layer.incidents":"Trafik olaylarını göster","layers.choose":"Görünüm seç",minimap:"Minimap","scale.switchToImperial":"Mile dönüştür","scale.switchToMetric":"Kilometreye dönüştür","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzaklaştır","zoom.in":"Yakınlaştır","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ulaşım","traffic.MISCELLANEOUS":"Çeşitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Diğer haberler","traffic.PLANNED_EVENT":"Planlı etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapalı","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Yoğunluk","traffic.CONSTRUCTION":"Yol çalışması","traffic.DISABLED_VEHICLE":"Araç arızası","traffic.from":"Başlangıç zamanı:","traffic.until":"Tahmini bitiş zamanı:","distance.measurement":"Measure distance"}),mw("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),mw("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"}),t("H.ui.i18n.Localization",pw),pw.prototype.Mm=function(){return this.b},pw.prototype.getLocale=pw.prototype.Mm,pw.prototype.Fm=function(){return Object.keys(this.a)},pw.prototype.getKeys=pw.prototype.Fm,pw.prototype.xh=function(t){return!(!this.a||!this.a[t])},pw.prototype.hasKey=pw.prototype.xh,pw.prototype.translate=function(t){var e=this.a[t];if(!Ac(e))throw Error("Translation missing for key '"+t+"'.");return e},pw.prototype.translate=pw.prototype.translate,u(qw,ov),t("H.ui.ScaleBar",qw),qw.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),t.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',t.style.direction="ltr",this.f=t.firstChild,e=this.f.childNodes,this.b=e[0],this.g=e[1],this.i=t.lastChild,this.j=Cv.METRIC,this.o=A((function(t){this.gc()||(this.dispatchEvent("toggleunitsystem"),t.preventDefault())}),this),this.u=A((function(t){t.preventDefault()}),this),Zu(t,"start",this.u),Zu(t,"end",this.o),this.mc(this.za().translate("scale.switchToImperial")),this.update()},qw.prototype.renderInternal=qw.prototype.$,qw.prototype.Ka=function(t){this.map&&this.map.removeEventListener("mapviewchange",this.update),t&&t.addEventListener("mapviewchange",this.update),ov.prototype.Ka.apply(this,arguments)},qw.prototype.setMap=qw.prototype.Ka,qw.prototype.capture=function(t,e,i){var r=this.K(),n=r.ownerDocument,o=n.createElement("canvas"),a=o.getContext("2d"),s=n.createElementNS("http://www.w3.org/2000/svg","svg"),l=n.createElementNS("http://www.w3.org/2000/svg","foreignObject"),u=kf(r,n,!1);n=parseFloat(r.offsetWidth)+1;var c=parseFloat(r.offsetHeight),h=n*t;t*=c,o.width=h,o.height=t,s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("width",h),s.setAttribute("height",t),s.setAttribute("viewBox","0 0 "+n+" "+c),l.setAttribute("width","100%"),l.setAttribute("height","100%"),s.appendChild(l),u.setAttribute("width","100%"),u.setAttribute("height","100%"),u.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var p=window.getComputedStyle(r);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach((function(t){u.style.setProperty(t,p.getPropertyValue(t))})),l.appendChild(u),new sf("image",r=af(s.outerHTML)).then((function(t){a.drawImage(t,0,0),e(o)}),i)},qw.prototype.capture=qw.prototype.capture,qw.prototype.We=function(t){this.j=t,this.mc("imperial"===t?this.za().translate("scale.switchToMetric"):this.za().translate("scale.switchToImperial")),this.update()},qw.prototype.onUnitSystemChange=qw.prototype.We,qw.prototype.update=function(){var t;if(this.K()){this.f=this.f,this.b=this.b;var e=this.m,i=0,r=this.map;if(r){var n=Math.round(.5*r.b.width),o=Math.round(.5*r.b.height);(t=r.Va(n,o))&&(r=r.Va(n+1,o))&&(i=100*t.Ya(r))}i&&(this.j===Cv.IMPERIAL?1609.344>i?(r=i/.3048006,t=this.za().translate("scale.ft")):(r=i/1609.344,t=this.za().translate("scale.mi")):1e3>i?(r=i,t=this.za().translate("scale.m")):(r=i/1e3,t=this.za().translate("scale.km")),(r=(i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)))/r*100)<e/5?(i*=5,r*=5):r<e/2?(i*=2,r*=2):r>e&&(i/=2,r/=2),r=Math.round(r),this.f.setAttribute("width",r),this.i.textContent=i+" "+t,this.b.points.getItem(2).x=this.g.points.getItem(2).x=this.b.points.getItem(3).x=this.g.points.getItem(3).x=r-2)}},u(rw,Z),t("H.ui.context.Item",rw),rw.prototype.f=function(t){var e=this.b,i=e.callback;i&&!e.isDisabled()&&(this.dispatchEvent("click"),i(t))},rw.prototype.$=function(){var t=this,e=this.K();Ce(e,"click",this.f),e.addEventListener("keyup",(function(e){13==e.keyCode&&t.f(e)})),this.a()},rw.prototype.renderInternal=rw.prototype.$,rw.prototype.a=function(){var t=this.K(),e=this.b;e.callback?(this.Ma("clickable"),t.setAttribute("tabindex","0")):(this.pb("clickable"),t.removeAttribute("tabindex")),e.isDisabled()?this.Ma("disabled"):this.pb("disabled"),e=e.getLabel(),Qu.textContent=e,t.innerHTML=Qu.innerHTML.split("\n").join("<br/>")},rw.prototype.s=function(){Z.prototype.s.call(this),this.b.removeEventListener("update",this.a)},u(sw,nv),t("H.ui.context.Menu",sw),sw.prototype.$=function(){nv.prototype.$.apply(this,arguments),this.f.forEach((function(t){t===Re?t=new Z("div","H_context_menu_item_separator"):(t=new rw(t)).addEventListener("click",this.g.bind(this)),this.La(t)}),this),Ce(this.K(),["mousedown","touchstart","pointerdown","wheel"],(function(t){t.stopPropagation()}))},sw.prototype.renderInternal=sw.prototype.$,sw.prototype.setPosition=function(t,e){if(this.b){var i=this.K(),r=i.offsetWidth,n=i.offsetHeight,o=this.b,a=o.b.width;t+r>a&&t>a/2&&(t-=r),e+n>(o=o.b.height)&&e>o/2&&(e-=n),Ju(i,t,e)}},sw.prototype.setPosition=sw.prototype.setPosition,sw.prototype.g=function(){this.b&&this.b.dispatchEvent(new sd("contextmenuclose",this.b))},sw.prototype.Ka=function(t){this.b=t},sw.prototype.setMap=sw.prototype.Ka,u(tw,Z),t("H.ui.InfoBubble",tw),tw.prototype.a=null,tw.prototype.Aa=function(){return this.u},tw.prototype.setPosition=function(t){this.u=$f(t),this.update()},tw.prototype.setPosition=tw.prototype.setPosition,tw.prototype.Ka=function(t){this.a=t},tw.prototype.$=function(t,e){this.o=Wu(e,"div","H_ib_body"),this.tailEl_=Wu(e,"div","H_ib_tail"),this.g=Wu(e,"div","H_ib_close H_btn",'<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>'),this.b=Wu(e,"div","H_ib_content","&nbsp;"),this.o.appendChild(this.g),this.o.appendChild(this.b),Zu(this.g,"start",this.A),this.a.c.addEventListener("sync",this.update),this.a.b.addEventListener("sync",this.update),this.a.addEventListener("enginechange",this.f),t.appendChild(this.o),t.appendChild(this.tailEl_),this.hf(this.i)},tw.prototype.renderInternal=tw.prototype.$,tw.prototype.f=function(){this.m||(this.m=setTimeout(this.update,0))},tw.prototype.update=function(){var t,e=this.K(),i=this.a,r="none";if(this.m=0,i&&e&&this.getState()===uw.OPEN){if(t=i.Ga(this.u)){var n=t.x;t=t.y,(n>=-(i=i.b.width)||n<=2*i||t>=-i||t<=2*i)&&(r="",Ku?(e.style.left=n-i+"px",e.style.top=t+"px"):Ju(e,n,t))}e.style.display=r,""===r&&(e.style.visibility="visible")}};var uw={OPEN:"open",CLOSED:"closed"},e;function vw(t){this.c=t,this.a=this.b=null,this.i=0,this.g=22,this.f=A(this.f,this),(t=this.c.dc()).addEventListener("mapviewchange",this.m,!1,this),(t=t.a).addEventListener("add",this.j,!1,this),t.addEventListener("remove",this.o,!1,this)}function ww(t,e){t.b&&e&&t.b===e.ea()||(t.b&&t.b.removeEventListener("tap",t.f),e?(t.b=e.ea(),t.b.addEventListener("tap",t.f),t.i=t.b.min,t.g=t.b.max):(t.b=null,t.i=0,t.g=22))}function xw(t){return window.H.service&&t.ea()instanceof window.H.service.traffic.incidents.Provider}function yw(t,e){var i=t.K(),r=this;F.call(this),this.c=t,this.i=i.ownerDocument,this.f={},this.b=[],new vw(this),this.S=Wu(this.i,"div","H_ui"),this.setDirection(),this.T=A((function(t){this.m.put(t.target,t.target.Rc)}),this),this.addEventListener("alignmentchange",this.T),this.P=A((function(){this.rl()}),this),this.addEventListener("toggleunitsystem",this.P),this.S.addEventListener("contextmenu",this.F,!1),this.S.addEventListener("MSHoldVisual",this.F,!1),this.c.addEventListener("contextmenu",this.A,!1,this),this.c.addEventListener("contextmenuclose",this.u,!1,this),this.c.xb(this.B.bind(this)),this.a=null,this.o=-1,this.m=new rv(this.S,this.i),this.g=Cv.METRIC,zw(this,"en-US"),e&&Aw(this,e),i.appendChild(this.S),x.setTimeout((function(){r.m.update()}),1)}function zw(t,e){if(Ac(e))var i=e;else{if(!(e instanceof pw))throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");i=e.b;var r=e}if(!i)throw Error("No locale was defined.");if(r)t.j=r;else{if(!(0<=jw.indexOf(i)))throw Error("Locale ["+i+"] is not supported.");t.j=new pw(i)}}function Aw(t,e){var i,r;e.unitSystem&&t.yg(e.unitSystem),(r=e.locale)&&zw(t,r),(i=e.zoom)&&t.Jd("zoom",new pv(Ea(i)?i:null)),(i=e.zoomrectangle)&&t.Jd("zoomrectangle",new ow(Ea(i)?i:null)),(i=e.mapsettings)&&t.Jd("mapsettings",new bw(Ea(i)?i:null)),(i=e.scalebar)&&t.Jd("scalebar",new qw(Ea(i)?i:null)),(i=e.distancemeasurement)&&t.Jd("distancemeasurement",new Uv(Ea(i)?i:null))}function Bw(t,e,i){var r,n=e.raster;if(e=e.vector.normal,t===ek.P2D){if(t=[{label:"layers.normal",layer:n.normal.map},{label:"layers.satellite",layer:n.satellite.map},{label:"layers.terrain",layer:n.terrain.map}],i)for(r in n)if(n[r].map===i){var o=r;break}i=[{label:"layer.incidents",layer:n.normal.trafficincidents},{label:"layer.transit",layer:o&&n[o].transit}]}else t=[{label:"layers.normal",layer:e.map},{label:"layers.satellite",layer:n.satellite.map}],i=[{label:"layer.traffic",layer:e.traffic},{label:"layer.incidents",layer:e.trafficincidents}];return{alignment:"bottom-right",baseLayers:t,layers:i}}function Cw(t,e){if(e=e||{},!(t&&t instanceof tl))throw Error("Base layer is mandatory for overview UI element");ov.call(this),this.f=new Ev({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.g,this)}),this.La(this.f),this.b=new Dw(t,e.zoomDelta,e.scaleX,e.scaleY),this.Xb(e.alignment||"right-bottom"),this.La(this.b)}function Dw(t,e,i,r){this.j=t,"number"==typeof e&&(this.tl=e),"number"==typeof i&&(this.Bk=i),"number"==typeof r&&(this.Ck=r),nv.call(this,"div","H_overview")}function Fw(t){!t.Id&&Ew(t),t.pb("H_overview_active"),t.b.removeEventListener("mapviewchange",t.Ji,!1,t)}function Ew(t,e){var i=t.b.b.element,r=t.K().style,n=i.offsetWidth/t.Bk/10;i=i.offsetHeight/t.Ck/10;var o=t.g.style;e?(r.width=n+"em",r.height=i+"em",o.width=n+"em",o.height=i+"em"):r.width=r.height="0em",t.f.b.resize()}tw.State=uw,tw.prototype.j=uw.OPEN,tw.prototype.getState=function(){return this.j},tw.prototype.getState=tw.prototype.getState,tw.prototype.N=function(t){t!==this.j&&(this.j=t,this.dispatchEvent("statechange")),(t=this.K())&&(this.j===uw.OPEN?(t.style.display="block",t.style.visibility="hidden",this.f()):t.style.display="none")},tw.prototype.setState=tw.prototype.N,tw.prototype.close=function(){this.N(uw.CLOSED)},tw.prototype.close=tw.prototype.close,tw.prototype.open=function(){this.N(uw.OPEN)},tw.prototype.open=tw.prototype.open,tw.prototype.jm=function(){return this.b||null},tw.prototype.getContentElement=tw.prototype.jm,tw.prototype.hf=function(t){if(t){if("string"!=typeof t&&("number"!=typeof t.nodeType||"string"!=typeof t.nodeName))throw Error("InfoBubble content must be a string or HTML node.");this.i=t}else this.i="";this.K()&&(this.i?(this.b.innerHTML="","string"==typeof this.i?this.b.innerHTML=t:"number"==typeof t.nodeType&&"string"==typeof t.nodeName&&this.b.appendChild(t)):this.b.innerHTML="&nbsp;",this.f())},tw.prototype.setContent=tw.prototype.hf,tw.prototype.s=function(){this.close(),this.hf(""),this.g&&$u(this.g,"end",this.A),this.a&&(this.a.c.removeEventListener("sync",this.update),this.a.b.removeEventListener("sync",this.update)),Z.prototype.s.call(this)},vw.prototype.m=function(t){var e=t.newValue.zoom;this.a&&t.modifiers&t.ZOOM&&(e<this.i||e>this.g)&&this.a.close()},vw.prototype.j=function(t){xw(t=t.added)&&ww(this,t)},vw.prototype.o=function(t){xw(t.removed)&&(this.a&&this.a.close(),ww(this,null))},vw.prototype.f=function(t){var e;if(t.target&&(e=t.target.getData())&&0===t.currentPointer.button){var i=t.target.da();this.a||(this.a=new tw(i),this.a.Ma("H_tib"),this.c.cj(this.a)),this.a.setPosition(i),i=e.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_"),i=this.c.za().xh("traffic."+i)?this.c.za().translate("traffic."+i):e.TRAFFIC_ITEM_DESCRIPTION[e.TRAFFIC_ITEM_DESCRIPTION.length-1].value,this.a.hf('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",i).replace("{{desc}}",e.TRAFFIC_ITEM_DESCRIPTION[0].value).replace("{{traffic.from}}",this.c.za().translate("traffic.from")).replace("{{traffic.until}}",this.c.za().translate("traffic.until")).replace("{{from}}",e.START_TIME).replace("{{until}}",e.END_TIME)),this.a.open()}t.stopPropagation()},u(yw,F),t("H.ui.UI",yw),yw.prototype.F=function(t){for(var e=t.target;e&&!/\bH_ib_content\b/.test(e.className);)e=e.parentNode;e||t.preventDefault()},yw.prototype.K=function(){return this.S},yw.prototype.getElement=yw.prototype.K,yw.prototype.dc=function(){return this.c},yw.prototype.getMap=yw.prototype.dc,yw.prototype.qn=function(){return this.g},yw.prototype.getUnitSystem=yw.prototype.qn,yw.prototype.yg=function(t){var e,i=this.f;if(t!==this.g)for(e in this.g=t,i)i[e]instanceof ov&&i[e].onUnitSystemChange(this.g)},yw.prototype.setUnitSystem=yw.prototype.yg,yw.prototype.setDirection=function(t){this.S.setAttribute("dir",t||getComputedStyle(this.dc().K()).direction)},yw.prototype.setDirection=yw.prototype.setDirection,yw.prototype.za=function(){return this.j},yw.prototype.rl=function(){this.g===Cv.METRIC?this.yg(Cv.IMPERIAL):this.yg(Cv.METRIC)},yw.prototype.toggleUnitSystem=yw.prototype.rl,yw.prototype.cj=function(t){var e=this.b.length,i=this.S;if(0>this.b.indexOf(t)){t.ja(this),t.Ka(this.c);var r=t.V(this.i);e=0<e?this.b[e-1].K().nextSibling:this.S.firstChild,i.insertBefore(r,e),this.b.push(t)}},yw.prototype.addBubble=yw.prototype.cj,yw.prototype.A=function(t){var e=t.items;this.a&&this.u(),clearTimeout(this.o),this.o=x.setTimeout(function(){e.length&&(this.a=new sw(e),this.S.insertBefore(this.a.V(this.i),this.S.firstChild),this.a.ja(this),this.a.Ka(this.c),this.a.setPosition(t.viewportX,t.viewportY))}.bind(this),0)},yw.prototype.u=function(){this.a&&(this.a.B(),this.a=null)},yw.prototype.so=function(t){var e=this.b.indexOf(t);-1<e&&(t.ja(null),t.Ka(null),this.b.splice(e,1),this.S.removeChild(t.K()))},yw.prototype.removeBubble=yw.prototype.so,yw.prototype.fm=function(){return this.b},yw.prototype.getBubbles=yw.prototype.fm,yw.prototype.Jd=function(t,e){if(this.Le(t))throw Error("A control with name ["+t+"] is already registered.");e.ja(this),e.Ka(this.c),e.Da=this.j,e.V(this.i),e.onUnitSystemChange(this.g),this.f[t]=e},yw.prototype.addControl=yw.prototype.Jd,yw.prototype.uo=function(t){var e=this.Le(t);if(!e)throw Error("Control ["+t+"] not found in this UI's controls.");return e.P(),e.ja(null),e.Ka(null),av(e),delete this.f[t],e},yw.prototype.removeControl=yw.prototype.uo,yw.prototype.Le=function(t){return this.f[t]},yw.prototype.getControl=yw.prototype.Le,yw.prototype.s=function(){for(var t in this.f)Hu.hasOwnProperty.call(this.f,t)&&this.f[t].B();this.b.forEach((function(t){t.B()})),(t=this.S.parentNode)&&t.removeChild(this.S),F.prototype.s.call(this),delete this.S},yw.prototype.capture=function(t,e,i,r){var n=this.Le("scalebar"),o=t.getContext("2d"),a=t.width,s=t.height,l=this.c.m,u=5+(l?l.K().childNodes[1].offsetHeight:0);n&&n.xc()?n.capture(e,(function(r){o.drawImage(r,a-r.width-5*e,s-r.height-u*e),i(t)}),r):i(t)},yw.prototype.capture=yw.prototype.capture,yw.createDefault=function(t,e,i){var r=t.cc().type;if(i=new yw(t,{unitSystem:Cv.METRIC,zoom:{alignment:"right-bottom"},mapsettings:Bw(r,e,t.f),scalebar:{alignment:"bottom-right"},locale:i||"en-US"}),r===ek.P2D){var n=i.Le("mapsettings"),o=function(){if(n.dc()){var i=Bw(r,e,t.f);cw(n,i.baseLayers,i.layers)}};t.addEventListener(t.v.uf,o),i.xb((function(){t.removeEventListener(t.v.uf,o)})),n.xb((function(){t.removeEventListener(t.v.uf,o)}))}return i},u(Cw,ov),t("H.ui.Overview",Cw),Cw.prototype.Fd=function(t){return this.b.Fd(t),this},Cw.prototype.setBaseLayer=Cw.prototype.Fd,Cw.prototype.g=function(t){t.target.getState()===cv.DOWN?(Ew(t=this.b,!0),t.Ji(),t.Ma("H_overview_active"),t.b.addEventListener("mapviewchange",t.Ji,!1,t)):Fw(this.b)},Cw.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.f.K().style.float=this.Rc.match("right")?"right":"left",this.b.Ka(this.map),this.f.mc(this.za().translate("minimap"))},Cw.prototype.renderInternal=Cw.prototype.$,Cw.prototype.s=function(){this.b.B(),Z.prototype.s.call(this)},u(Dw,ov),Dw.prototype.Fd=function(t){this.f.Fd(t)},Dw.prototype.$=function(t,e){Xu(t,e=Wu(e,"div","H_overview_map")),this.g=e},Dw.prototype.renderInternal=Dw.prototype.$,n=Dw.prototype,n.tl=3,n.Bk=5,n.Ck=5,n.Ka=function(t){this.b=t,this.f=new T(this.g,this.j,{pixelRatio:this.b.Za(),engineType:this.b.cc().type}),this.f.m.K().style.display="none",this.o=this.f.c,this.i=this.b.c},n.Ji=function(t){t&&t.modifiers&t.SIZE&&Ew(this,!0),(t=this.i.lb()).zoom-=this.tl,this.o.Yb(t)},n.s=function(){Dw.l.s.call(this),Fw(this),this.f.B(),this.f=this.o=this.i=this.b=this.j=this.g=null},t("H.ui.buildInfo",(function(){return Ff("H-ui","1.30.9","51a0cf5")})),H.__bootstrap__='var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(a,b){if(b){var c=ca;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var fa;\nif("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={nb:!0},ka={};try{ka.__proto__=ia;ha=ka.nb;break a}catch(a){}ha=!1}fa=ha?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=fa;da("Object.setPrototypeOf",function(a){return a||la});var p=this||self;\nfunction ma(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function na(){}\nfunction oa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";\nelse if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==oa(a)}function qa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ra="closure_uid_"+(1E9*Math.random()>>>0),sa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ua(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?va=ta:va=ua;return va.apply(null,arguments)}\nfunction wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){ma(a,b,void 0)}function xa(a,b){function c(){}c.prototype=b.prototype;a.X=b.prototype;a.prototype=new c;a.prototype.constructor=a};function v(){}t("H.util.ICache",v);v.prototype.add=function(){};v.prototype.add=v.prototype.add;v.prototype.get=function(){};v.prototype.get=v.prototype.get;v.prototype.ua=function(){};v.prototype.drop=v.prototype.ua;v.prototype.forEach=function(){};v.prototype.forEach=v.prototype.forEach;v.prototype.V=function(){};v.prototype.removeAll=v.prototype.V;v.prototype.ca=function(){};v.prototype.registerOnDrop=v.prototype.ca;v.prototype.sa=function(){};v.prototype.deRegisterOnDrop=v.prototype.sa;function ya(){var a=za,b;for(b in a)return!1;return!0}function Aa(a){var b={},c;for(c in a)b[c]=a[c];return b}var Ba="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ca(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ba.length;f++)c=Ba[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var x=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}xa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=va,Ga=String,Ha=x.Object.freeze||function(a){return a},z=[].pop(),Ia=/x/.exec("");function Ja(a){return Ga(a).split(","!==z?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new A(c,d,void 0!==z?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new A(b,c,d!==z?d:a);return e}\nt("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);\nfunction Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:x.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(qa(g)&&g.window===g&&g.self===g||qa(g)&&0<g.nodeType&&r(g.cloneNode))&&qa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}\nfunction Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function B(a,b,c){this.g=[];b&&this.ca(b);if(c&&!r(c))throw new A(B,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ja(a)}t("H.util.Cache",B);B.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new A(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&ab(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,A:null,F:null},this.c),gb(this);return e};B.prototype.add=B.prototype.add;\nB.prototype.ca=function(a){if(!r(a))throw new A(this.ca,0,a);this.g.push(a)};B.prototype.registerOnDrop=B.prototype.ca;B.prototype.sa=function(a){this.g=this.g.filter(function(b){return b!==a})};B.prototype.deRegisterOnDrop=B.prototype.sa;B.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};B.prototype.get=B.prototype.get;B.prototype.ua=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};B.prototype.drop=B.prototype.ua;\nB.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};B.prototype.forEach=B.prototype.forEach;B.prototype.V=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};B.prototype.removeAll=B.prototype.V;B.prototype.Ja=function(a){if(!(0<+a))throw new A(B.prototype.Ja,0,a);this.o=+a;gb(this);return this};B.prototype.setMaxSize=B.prototype.Ja;B.prototype.Db=function(){return this.o};\nB.prototype.getMaxSize=B.prototype.Db;B.prototype.zb=function(){return this.b};B.prototype.getCurrentSize=B.prototype.zb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.o&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.A||b.F)&&hb(a,b,!1);if(b.A=c)b.F=c.F,c.F=b;b.F||(a.c=b);b.A||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.F,e=b.A;if(d||e||b==a.c&&b==a.f)d?d.A=e:a.c=e,e?e.F=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],ab(a,b));b.A=b.F=null}\nfunction ab(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function C(){}t("H.service.extension.dataView.ITable",C);C.prototype.Aa=function(){};C.prototype.getMeta=C.prototype.Aa;C.prototype.Ba=function(){};C.prototype.getRowCount=C.prototype.Ba;C.prototype.ja=function(){};C.prototype.getRow=C.prototype.ja;C.prototype.D=function(){};C.prototype.getColumnNames=C.prototype.D;C.prototype.za=function(){};C.prototype.getColumn=C.prototype.za;C.prototype.s=function(){};C.prototype.getCell=C.prototype.s;C.prototype.concat=function(){};C.prototype.concat=C.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.D=function(){};ib.prototype.getColumnNames=ib.prototype.D;ib.prototype.s=function(){};ib.prototype.getCell=ib.prototype.s;ib.prototype.Ca=function(){};ib.prototype.getTable=ib.prototype.Ca;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.D=function(){return this.a.D()};jb.prototype.getColumnNames=jb.prototype.D;jb.prototype.s=function(a){return this.a.s(this.b,a)};jb.prototype.getCell=jb.prototype.s;jb.prototype.Ca=function(){return this.a};jb.prototype.getTable=jb.prototype.Ca;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.s=function(){};kb.prototype.getCell=kb.prototype.s;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.s=function(a){return this.b.s(a,this.a)};lb.prototype.getCell=lb.prototype.s;function A(a,b,c){var d=arguments.length;b=b!==z?+b:b;if(b!==z){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Ja(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,A.prototype);return d}xa(A,Error);t("H.lang.InvalidArgumentError",A);A.prototype.name="InvalidArgumentError";function D(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):z);this.G=a;if(b)for(this.O=b,this.ra=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==z&&(this.Ea=c)}t("H.service.extension.dataView.ObjTable",D);l=D.prototype;l.Ea=z;l.G=z;l.O=z;l.ra=z;l.Aa=function(){return this.Ea};D.prototype.getMeta=D.prototype.Aa;D.prototype.Ba=function(){return this.G?this.G.length:0};D.prototype.getRowCount=D.prototype.Ba;D.prototype.ja=function(a){var b=this.G;return b&&b[a]?new jb(this,a):z};\nD.prototype.getRow=D.prototype.ja;D.prototype.D=function(){return this.O||mb};D.prototype.getColumnNames=D.prototype.D;D.prototype.za=function(a){return this.ra[a]?new lb(this,a):z};D.prototype.getColumn=D.prototype.za;D.prototype.s=function(a,b){var c=this.G;return(a=c&&this.ra[b]&&c[a])&&a[b]};D.prototype.getCell=D.prototype.s;\nD.prototype.concat=function(){var a=arguments.length,b,c=this.O,d=""+this.O,e=(this.G||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof D))throw new A(this.concat,b);if(f.G){if(c&&""+f.O!==d)throw new A(this.concat,b,"Incompatible columns!");e=e.concat(f.G)}}return new D(e,this.O,this.Ea)};D.prototype.concat=D.prototype.concat;function E(a,b){this.x=+a;this.y=+b}t("H.math.Point",E);E.prototype.set=E;E.prototype.set=E.prototype.set;E.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new E(this.x,this.y);return a};E.prototype.clone=E.prototype.clone;E.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};E.prototype.add=E.prototype.add;E.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};E.prototype.sub=E.prototype.sub;E.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};\nE.prototype.scale=E.prototype.scale;E.prototype.round=function(){this.x=nb(this.x);this.y=nb(this.y);return this};E.prototype.round=E.prototype.round;E.prototype.floor=function(){this.x=ob(this.x);this.y=ob(this.y);return this};E.prototype.floor=E.prototype.floor;E.prototype.ceil=function(){this.x=pb(this.x);this.y=pb(this.y);return this};E.prototype.ceil=E.prototype.ceil;E.prototype.I=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};E.prototype.equals=E.prototype.I;\nE.prototype.Eb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new E(a.x+f*c,a.y+f*d)}return e};E.prototype.getNearest=E.prototype.Eb;E.prototype.ta=function(a){return qb(rb(this.x-a.x,2)+rb(this.y-a.y,2))};E.prototype.distance=E.prototype.ta;E.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof E?a:new E(a.x,a.y)};var F=Math,sb=F.min,tb=F.max,nb=F.round,ob=F.floor,pb=F.ceil,ub=F.abs,vb=F.log,qb=F.sqrt,rb=F.pow,wb=F.exp,xb=F.sin,yb=F.asin,zb=F.cos,Ab=F.tan,Bb=F.atan,Cb=F.atan2,Db=F.LN2,G=F.PI,Eb=G/2,Fb=G/4,Hb=2*G,Ib=3*G,Jb=G/180,Kb=180/G,Lb=1/0;rb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-ob(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}\nfunction Pb(a,b,c,d,e,f){return qb(rb((a-e)*(d-f)-(b-f)*(c-e),2)/(rb(c-e,2)+rb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);\nfunction Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}\nfunction Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==z;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var J=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var M=n[0];var w=n[1];J&&J.I(M)?h.push(w):g.push(h=n);J=w;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);\nfunction Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new E(h,-b),new E(g,-a)]:[new E(g,-a),new E(h,-b)]}\nfunction Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.ia=Yb(b.x,b.y,null,Zb(b));a.ia=Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.C)for(d=a;d.next;d=d.next)if(!d.C){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.ob;var n=f.pb;var q=f.jc;var u=f.kc;e=Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Fa=k;k.Fa=e}}f=Sb(b,cc(a));\nc&&(f=!f);for(g=b;g;g=g.next)g.C&&(g.va=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.C&&(d.va=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.pa;a=a.Fa){for(f=a.va;;){c=Yb(a.x,a.y,c);c.artificial=a.C||a.Qb;a.pa=1;a=f?a.next:a.u;if(!a)break;if(a.C){a.pa=1;break}}if(!a)break}c.ab=J;var J=c}return J}}t("H.math.clipping.clipPolygon",Wb);\nfunction Yb(a,b,c,d,e,f,g,h,k,m){a={x:a,y:b,next:c||null,u:d||null,ab:e||null,Fa:f||null,C:!!g,va:h||0,pa:k||0,alpha:m||0};d&&(a.u.next=a);c&&(a.next.u=a);return a}function $b(a){for(;a&&a.C;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.C||b.C&&b.pa))}return b}function dc(a){var b=Zb(a);b.u.next=a;a.u=b.u}\nfunction ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.ia&&(f.ia.x=f.x,f.ia.y=f.y),ac(a,b,c,d,e);e.jc=a.x+k*g;e.kc=a.y+k*h;e.ob=k;e.pb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}\nfunction bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.u=b.u;a.next.u=a;a.u.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=Yb(a[e].x,a[e].y,d);c.Qb=b;if(c.next=d)d.u=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}xa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){if(!Qa("STATIC_DB"))throw new A(this.constructor,0);this.o=x.indexedDB||x.ic||x.Tb||x.Ub;if(!this.o)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var hc,ic;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new A(this.get,0);if(!r(b))throw new A(this.get,1);jc(this,function(e){d=e.get(a);kc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=lc)}}};\ngc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};\nfunction mc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.o.open(nc+"STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.v);a.f=this.error;a.c.forEach(function(e){e(a.f)});a.a=a.c=null};a.v=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.v);a.a?(a.a.forEach(function(e){e(this.result)},this),a.a=a.c=null):(a.b=a.f=null,a.a=[],a.c=[])};a.a.push(b);c&&a.c.push(c)}}\nfunction jc(a,b,c){mc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function kc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){hc||(hc=new gc);return hc});var nc="H_";\nt("H.util.IndexedDBStorage.isSupported",function(){var a="";if(ic===z)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)ic=!1;else{try{var b=x.indexedDB||x.ic||x.Tb||x.Ub;a=nc+"TEST_DB";var c=b&&b.open(a,1)}catch(d){}ic=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return ic});function K(){0!=oc&&(pc[this[ra]||(this[ra]=++sa)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};K.prototype.c=!1;K.prototype.B=function(){if(!this.c&&(this.c=!0,this.P(),0!=oc)){var a=this[ra]||(this[ra]=++sa);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.");delete pc[a]}};\nK.prototype.N=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?va(a,b):a))};K.prototype.P=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function L(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.cb=!0}L.prototype.stopPropagation=function(){this.a=!0};L.prototype.c=function(){this.cb=!1};t("H.util.Event",L);L.prototype.stopPropagation=L.prototype.stopPropagation;L.prototype.stopPropagation=L.prototype.stopPropagation;L.prototype.CAPTURING_PHASE=1;L.prototype.CAPTURING_PHASE=L.prototype.CAPTURING_PHASE;L.prototype.AT_TARGET=2;L.prototype.AT_TARGET=L.prototype.AT_TARGET;L.prototype.BUBBLING_PHASE=3;L.prototype.BUBBLING_PHASE=L.prototype.BUBBLING_PHASE;L.prototype.eventPhase=0;L.prototype.eventPhase=L.prototype.eventPhase;function qc(a,b,c){qc.X.constructor.call(this,a,c);this.data=b}xa(qc,L);t("H.util.DataEvent",qc);function rc(a,b,c){rc.X.constructor.call(this,a,c);this.message=b}xa(rc,L);t("H.util.ErrorEvent",rc);function sc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}sc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function tc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function uc(){this.b=this.a=null}var wc=new sc(function(){return new vc},function(a){a.reset()});uc.prototype.add=function(a,b){var c=wc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function xc(){var a=yc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function vc(){this.next=this.b=this.a=null}vc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};vc.prototype.reset=function(){this.next=this.b=this.a=null};var zc=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Cc(a,b){return a<b?-1:a>b?1:0};var Dc;a:{var Ec=p.navigator;if(Ec){var Fc=Ec.userAgent;if(Fc){Dc=Fc;break a}}Dc=""}function Gc(a){return-1!=Dc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;oa(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(oa(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=na;var Vc=Gc("Opera"),Wc=Gc("Trident")||Gc("MSIE"),Xc=Gc("Edge"),Yc=Gc("Gecko")&&!(-1!=Dc.toLowerCase().indexOf("webkit")&&!Gc("Edge"))&&!(Gc("Trident")||Gc("MSIE"))&&!Gc("Edge"),Zc=-1!=Dc.toLowerCase().indexOf("webkit")&&!Gc("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;\na:{var bd="",cd=function(){var a=Dc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;\nfunction jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Gc("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=va(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},\nthis);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!Gc("Trident")&&!Gc("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Sa;c.Sa=null;e()}};return function(e){d.next={Sa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;\nf.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);yc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!Gc("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,yc=new uc;function od(){for(var a;a=xc();){try{a.a.call(a.b)}catch(b){hd(b)}tc(wc,a)}nd=!1};function pd(a){this.a=qd;this.v=void 0;this.f=this.b=this.c=null;this.g=this.o=!1;if(a!=na)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new sc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}\nfunction xd(a,b,c){yd(a,b,c,null)||kd(wa(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,wa(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;\npd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}\nfunction Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ga=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ia=function(a){this.a=qd;rd(this,td,a)};\nfunction rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ga,a.Ia,a)||(a.v=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||na,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(qa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}\nfunction Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.o||(a.o=!0,kd(a.T,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.T=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.v);this.o=!1};\nfunction Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}tc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}xa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Za=Fa(this.Za,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==z&&(this.priority=c);this.b().add(this)}var Od=1,Pd={mc:0,nc:Od,lc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Za=function(a){this.aa=3;this.a.b(a)};l.reject=function(a){this.aa=5;this.a.reject(a)};l.aa=0;\nl.cancel=function(){if(3>this.aa){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Pa&&a.ea.sb(this.Pa);this.aa=4}};function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ea=a;this.ea.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};\nQd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ea.oc(b))!==Ia){var d=Fa(this.ea.sb,this.ea,c,b);b.Pa=c;b.then(d,d);b.aa=b.pc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}xa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ka=e;this.key=++Ud;this.W=this.fa=!1}function Wd(a){a.W=!0;a.listener=null;a.proxy=null;a.src=null;a.ka=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.fa=!1)):(b=new Vd(b,this.src,f,!!d,e),b.fa=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}\nXd.prototype.V=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.W&&f.listener==b&&f.capture==!!c&&f.ka==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;\nif(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=zc(String(ad)).split("."),fe=zc("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Cc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Cc(0==ke[2].length,0==le[2].length)||Cc(ke[2],le[2]);\nie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",na,b),p.removeEventListener("test",na,b)}catch(c){}return a}();function oe(a,b){L.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=\n!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=\na.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}xa(oe,L);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.X.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};\noe.prototype.c=function(){oe.X.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==oa(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,qa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}\nfunction we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=qa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}\nfunction ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==oa(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,qa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}\nfunction Ce(a,b,c,d,e){if("array"==oa(b))for(var f=0;f<b.length;f++)Ce(a,b[f],c,d,e);else(d=qa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&De(c))}\nfunction De(a){if("number"!==typeof a&&a&&!a.W){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}\nfunction Ee(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.W&&(f=Fe(f,d),e=e&&!1!==f)}return e}function Fe(a,b){var c=a.listener,d=a.ka||a.src;a.fa&&De(a);return c.call(d,b)}\nfunction Ae(a,b){if(a.W)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=Ee(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=\nd[e],f=Ee(d[e],a,!1,b),c=c&&f}return c}return Fe(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Ge="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Ge]||(a[Ge]=function(b){return a.handleEvent(b)});return a[Ge]};function N(){K.call(this);this.b=new Xd(this);this.v=this;this.o=null}xa(N,K);N.prototype[Td]=!0;l=N.prototype;l.K=function(){return this.o};l.Ka=function(a){this.o=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Ce(this,a,b,c,d)};\nl.dispatchEvent=function(a){var b,c=this.K();if(c)for(b=[];c;c=c.K())b.push(c);c=this.v;var d=a.type||a;if("string"===typeof a)a=new L(a,c);else if(a instanceof L)a.target=a.target||c;else{var e=a;a=new L(d,c);Ca(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.R(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.R(d,!0,a)&&e,a.a||(e=g.R(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.R(d,!1,a)&&e;return e};\nl.P=function(){N.X.P.call(this);this.b&&this.b.V(void 0);this.o=null};l.R=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.W&&f.capture==b){var g=f.listener,h=f.ka||f.src;f.fa&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.cb};t("H.util.EventTarget",N);N.prototype.Ka=N.prototype.Ka;N.prototype.setParentEventTarget=N.prototype.Ka;N.prototype.K=N.prototype.K;N.prototype.getParentEventTarget=N.prototype.K;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;\nN.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.B=N.prototype.B;N.prototype.dispose=N.prototype.B;N.prototype.N=N.prototype.N;N.prototype.addOnDisposeCallback=N.prototype.N;N.prototype.T=N.prototype.R;\nN.prototype.R=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.T.apply(this,arguments),d&&this.K&&null===this.K()&&delete c.eventPhase;return f};function Q(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;Q.X.constructor.call(this)}xa(Q,N);t("H.util.ContextItem",Q);Q.prototype.Bb=function(){return this.g};Q.prototype.getLabel=Q.prototype.Bb;Q.prototype.bc=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};Q.prototype.setLabel=Q.prototype.bc;Q.prototype.Rb=function(){return this.f};Q.prototype.isDisabled=Q.prototype.Rb;\nQ.prototype.ac=function(a){a^this.f&&(this.f=a,this.dispatchEvent("update"));return this};Q.prototype.setDisabled=Q.prototype.ac;var He=new Q;Q.SEPARATOR=He;function Ie(){if(x.document){var a=document.createElement("canvas");a.width=a.height=1;a.getContext("2d")}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.yb?0:b.yb()))throw Error("goog.provide cannot be used within a module.");ma(a,void 0)});function Je(){this.A=0}\nJe.prototype.next=function(a){if(9007199254740992===this.A)throw new Sd(a,this.A,[0,9007199254740991]);return this.A++};var Ke=new Je;Fa(Ke.next,Ke);function lc(){}var mb=Ha([]);Ha({});Ie();Ie();function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new A(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new A(b,c,a);return d}function Ne(a,b,c){var d;if(a!==z&&Ra(d=+a)&&b)throw new A(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0!==(0>a^0>b)&&180<ub(b-a)});function R(){var a=R;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",R);R.prototype.getBoundingBox=R.prototype.Z;R.prototype.equals=R.prototype.I;R.prototype.qa="";R.prototype.ya="";R.prototype.toString=function(){return this.gb([this.qa.toUpperCase()," "]).join("")};R.prototype.toString=R.prototype.toString;R.prototype.dc=function(){return{type:this.ya,coordinates:this.fb()}};R.prototype.toGeoJSON=R.prototype.dc;\nR.prototype.wa=function(){return{type:this.qa,coordinates:this.xa(),boundingBox:this.Z().wa()}};R.prototype.forWorkerMessage=R.prototype.wa;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==z&&(this.alt=Ne(c,S,2))}xa(S,R);t("H.geo.Point",S);S.prototype.I=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.I;S.prototype.ta=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Jb;var c=a.lat*Jb;a=1.274200158E7*yb(sb(1,qb(rb(xb((b-c)/2),2)+zb(b)*zb(c)*rb(xb((this.lng*Jb-a.lng*Jb)/2),2))))}return a};\nS.prototype.distance=S.prototype.ta;\nS.prototype.hc=function(a,b,c){if(c){if(b/=6371000.79){a*=Jb;var d=Jb*this.lat;var e=xb(d);var f=xb(b);var g=zb(b);var h=Jb*this.lng;var k=zb(d);d=yb(k*zb(a)*f+e*g);a=Cb(xb(a)*k*f,g-e*xb(d));a=(h+a+G)%(2*G)-G;k=a*Kb}return b?new S(d*Kb,(k+540)%360-180):this}a=(a%360+360)%360;if(0===(a+90)%180)return d=this.lng+b/(6371000.79*Hb*zb(this.lat*Jb))*(270===a?-360:360),new S(this.lat,(d+540)%360-180);if(b/=6371000.79){a*=Jb;h=this.lat*Jb;e=this.lng*Jb;f=h+b*zb(a);g=f-h;d=vb(Ab(f/2+Fb)/Ab(h/2+Fb));d=Ra(g/\nd)?zb(h):g/d;var m=b*xb(a)/d;ub(f)>Eb&&(f=0<f?G-f:-(G+f))}return b?new S(f*Kb,((e+m+Ib+(ub(h+g)>Eb?G:0))%Hb-G)*Kb):this};S.prototype.walk=S.prototype.hc;S.prototype.Z=function(){return new T(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.Z;function Oe(a,b,c){var d=qa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==z&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new A(b,c,a);return d}S.validate=Oe;\nfunction Pe(a){if(!a)throw new A(Pe,0,a);return new S(a.lat,a.lng,a.alt)}S.fromIPoint=Pe;l=S.prototype;l.qa="Point";l.gb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.ya="Point";l.fb=function(){return[this.lng,this.lat,this.alt||0]};l.xa=function(){return[this.lat,this.lng,this.alt||0]};var W={};t("H.geo.mercator",W);W.a=function(a){return sb(1,tb(0,.5-vb(Ab(Fb+Eb*a/180))/G/2))};W.b=function(a){return a/360+.5};W.la=function(a,b,c){c?(c.x=W.b(b),c.y=W.a(a)):c=new E(W.b(b),W.a(a));return c};W.latLngToPoint=W.la;W.vb=function(a,b){return W.la(a.lat,a.lng,b)};W.geoToPoint=W.vb;W.f=function(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(G*(1-2*a)))-Eb)};W.c=function(a){return 360*(1===a?1:Mb(a,1))-180};W.Y=function(a,b,c){c?(c.lat=W.f(b),c.lng=W.c(a)):c=new S(W.f(b),W.c(a));return c};\nW.xyToGeo=W.Y;W.Yb=function(a,b){return W.Y(a.x,a.y,b)};W.pointToGeo=W.Yb;t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function X(a,b){this.projection=a||W;this.b=0;this.a=this.exp=vb(b||256)/Db;Qe(this);this.y=this.x=0}t("H.geo.PixelProjection",X);var Re=ub(24)+ub(-8);X.prototype.$b=W;X.prototype.projection=X.prototype.$b;X.prototype.x=0;X.prototype.x=X.prototype.x;X.prototype.y=0;X.prototype.y=X.prototype.y;X.prototype.gc=rb(2,Re);X.prototype.w=X.prototype.gc;X.prototype.Lb=rb(2,Re);X.prototype.h=X.prototype.Lb;\nX.prototype.da=function(a){if(Ra(a))throw new A(this.da,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Qe(this);this.x=b*this.w;this.y=c*this.h};X.prototype.rescale=X.prototype.da;function Qe(a){a.a>Re&&(a.a=Re);a.w=rb(2,a.a);a.h=rb(2,a.a)}X.prototype.Wa=function(){return this.b||0};X.prototype.getZoomScale=X.prototype.Wa;X.prototype.ub=function(a,b){a=this.projection.la(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};X.prototype.geoToPixel=X.prototype.ub;\nX.prototype.Ha=function(a,b){return this.projection.Y((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};X.prototype.pixelToGeo=X.prototype.Ha;X.prototype.Y=function(a,b,c){return this.projection.Y((a+this.x)/this.w,(b+this.y)/this.h,c)};X.prototype.xyToGeo=X.prototype.Y;X.prototype.Da=function(a,b,c){a=this.projection.la(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};X.prototype.latLngToPixel=X.prototype.Da;X.prototype.Zb=function(a){return new E(a.x*this.w-this.x,a.y*this.h-this.y)};\nX.prototype.pointToPixel=X.prototype.Zb;t("H.util.Disposable",K);K.prototype.N=K.prototype.N;K.prototype.addOnDisposeCallback=K.prototype.N;t("H.util.dispose",function(a){a&&"function"==typeof a.B&&a.B()});K.prototype.B=K.prototype.B;K.prototype.dispose=K.prototype.B;K.prototype.P=K.prototype.P;function Se(a,b,c,d){if(!a||!b||!c)throw new A(Se,null,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ca(this,d)}t("H.util.BuildInfo",Se);Se.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Te={};function Ue(a,b,c,d){if(!a)throw new A(Ue,1,"Must specify a name parameter");return Te[a]||(Te[a]=new Se(a,b,c,d))}Se.get=Ue;function Z(a,b,c,d,e,f){if(a&&b)this.Na(a),this.na(b),this.La(c),this.Ma(e),this.eb(f),this.oa(d);else throw new A(Z,z,\'Parameters "scheme" and "host" must be specified\');}t("H.service.Url",Z);\nfunction Ve(a,b){var c=x.document,d,e=c&&c.createElement("a"),f="";if(c){if(b){var g=(d=c.getElementsByTagName("base")[0])&&d.href;var h=c.head;var k=d||h.appendChild(c.createElement("base"));k.href=b}e.href=a;f=e.href;b&&(d?d.href=g:h.removeChild(k))}else/[\\w]+:\\/\\//.test(a)&&(f=a);g=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(f);a=g[1];h=g[4];b=g[5];k=g[6];c=g[7];d=g[8];!g[2]&&h&&/@/.test(h)&&(h=h.split("@")[1]);g=Z;k=k&&0<k.length?k.substr(1):\n"";e={};var m;if(c)for(f=/([?&]?([^=&+]+))(=([^&]+))?/g;m=f.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new g(a,h,k,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Z.parse=Ve;Z.prototype.clone=function(){var a={},b;for(b in this.a)a[b]=this.a[b];return new Z(this.o,this.g,this.b,a,this.f,this.c)};Z.prototype.clone=Z.prototype.clone;\nZ.prototype.Na=function(a){if(!a||"string"!==typeof a)throw new A(this.Na,0,\'The "scheme" parameter must be a non-empty string.\');this.o=a;return this};Z.prototype.setScheme=Z.prototype.Na;Z.prototype.Ib=function(){return this.o};Z.prototype.getScheme=Z.prototype.Ib;Z.prototype.na=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new A(this.na,0,\'The "host" parameter is not a valid host name.\');this.g=a;return this};\nZ.prototype.setHost=Z.prototype.na;Z.prototype.Ab=function(){return this.g};Z.prototype.getHost=Z.prototype.Ab;Z.prototype.La=function(a){this.b=a||void 0;return this};Z.prototype.setPath=Z.prototype.La;Z.prototype.Fb=function(){return this.b};Z.prototype.getPath=Z.prototype.Fb;Z.prototype.oa=function(a){if(a)if("object"==typeof a)this.a=a;else throw new A(this.oa,0,\'Parameter "params" must be an object.\');else this.a={};return this};Z.prototype.setQuery=Z.prototype.oa;Z.prototype.Mb=function(){return!We(this)};\nZ.prototype.hasQuery=Z.prototype.Mb;Z.prototype.getQuery=function(){return this.a};Z.prototype.getQuery=Z.prototype.getQuery;Z.prototype.Ma=function(a){if(void 0===a)this.f=a;else{var b=Nb(+a<<0,0,65535);if(b!=a)throw new A(this.Ma,0,\'Parameter "port" must be an integer in range [0...65535]\');this.f=b}return this};Z.prototype.setPort=Z.prototype.Ma;Z.prototype.Gb=function(){return this.f};Z.prototype.getPort=Z.prototype.Gb;Z.prototype.eb=function(a){this.c=a||void 0;return this};\nZ.prototype.setAnchor=Z.prototype.eb;Z.prototype.wb=function(){return this.c};Z.prototype.getAnchor=Z.prototype.wb;Z.prototype.U=function(a){if("object"!==typeof a)throw new A(this.U,0,\'Parameter "other" must be an object.\');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Z.prototype.mergeQuery=Z.prototype.U;\nZ.prototype.Qa=function(a){if(!a||"string"!==typeof a)throw new A(this.Qa,0,\'Parameter "subDomain" must be a non-empty string\');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.na(a+"."+this.g)};Z.prototype.addSubDomain=Z.prototype.Qa;Z.prototype.Ra=function(a){if(!a||"string"!==typeof a)throw new A(this.Ra,0,\'Parameter "subPath" must be a non-empty string\');return this.La((this.b?this.b+"/":"")+a)};Z.prototype.addSubPath=Z.prototype.Ra;\nZ.prototype.toString=function(){return[this.o+"://",this.g,this.f?":"+this.f:"",this.b||!We(this)||this.c?"/":"",this.b?encodeURI(this.b):"",Xe(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Z.prototype.toString=Z.prototype.toString;\nfunction Xe(a){function b(g,h){return encodeURIComponent(g)+(void 0===h?"":"="+encodeURIComponent(h).replace(/[!\'()*]/g,function(k){return"%"+k.charCodeAt(0).toString(16)}))}var c=[],d,e=a.a;for(d in e)if(e.hasOwnProperty(d)&&"function"!==typeof e[d]){var f=a.a[d];Na(f,Ye)?f.a.forEach(function(g){c.push(b(d,g))}):c.push(b(d,f))}return 0<c.length?"?"+c.join("&"):""}function We(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}\nfunction Ye(a){var b;if(!Oa(a,void 0,void 0,void 0))throw new A(Ye,0,a);for(b=0;b<a.length;b++){var c=a[b];if(!Qa(c)&&!Sa(c))throw new A(Ye,0,"The array can only contain strings and numbers");}this.a=a}Z.MultiValueQueryParameter=Ye;Ye.prototype.Kb=function(){return this.a};Ye.prototype.getValues=Ye.prototype.Kb;var Ze={};function $e(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function af(a){Ze[a]=null;this.postMessage(a)}function bf(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(Ze[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function cf(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}cf.prototype.postError=function(a){this.postMessage(a,z,0)};\ncf.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===z?1:c,data:a},b||z)};function df(a,b,c){if(!Qa(a))throw new A(df,0,"InvalidArgument");if(!r(b))throw new A(df,1,"InvalidArgument");var d=ef++;ff[d]={mimeType:c||gf,qb:b};(new cf(["3",d,[]])).postMessage(a,[],2)}var ff={},ef=0;\nfunction hf(a,b){var c=a;if(ff[this.a]){var d=ff[this.a];var e=d.qb;delete ff[this.a];if(b)e(null,b);else{if(d.mimeType===jf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var gf=0,jf=1;function T(a,b,c,d){kf(this,Le(a,T,0),Me(b,T,1),Le(c,T,2),Me(d,T,3))}xa(T,R);t("H.geo.Rect",T);T.prototype.qa="Polygon";T.prototype.gb=function(a){var b=this.m,c=this.i,d=this.l,e=this.j;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};T.prototype.I=function(a){return this===a||!!a&&this.m===a.m&&this.i===a.i&&this.l===a.l&&this.j===a.j};T.prototype.equals=T.prototype.I;T.prototype.clone=function(){return new T(this.m,this.i,this.l,this.j)};\nT.prototype.clone=T.prototype.clone;function kf(a,b,c,d,e){a.i=c;a.j=e;b<d&&(c=b,b=d,d=c);a.m=b;a.l=d;a.c=a.a=a.b=null;return a}T.prototype.Va=function(){this.c||(this.c=new S(this.m,this.i));return this.c};T.prototype.getTopLeft=T.prototype.Va;T.prototype.Ua=function(){this.a||(this.a=new S(this.l,this.j));return this.a};T.prototype.getBottomRight=T.prototype.Ua;T.prototype.Jb=function(){return this.m};T.prototype.getTop=T.prototype.Jb;T.prototype.xb=function(){return this.l};\nT.prototype.getBottom=T.prototype.xb;T.prototype.Cb=function(){return this.i};T.prototype.getLeft=T.prototype.Cb;T.prototype.Hb=function(){return this.j};T.prototype.getRight=T.prototype.Hb;T.prototype.J=function(){this.b||(this.b=new S(this.l+(this.m-this.l)/2,lf(this.i,this.L())));return this.b};T.prototype.getCenter=T.prototype.J;T.prototype.L=function(){return mf(this.i,this.j)};T.prototype.getWidth=T.prototype.L;T.prototype.S=function(){return this.m-this.l};T.prototype.getHeight=T.prototype.S;\nT.prototype.Pb=function(){return this.i>this.j};T.prototype.isCDB=T.prototype.Pb;T.prototype.Sb=function(){return!this.L()&&!this.S()};T.prototype.isEmpty=T.prototype.Sb;T.prototype.Z=function(){return new T(this.m,this.i,this.l,this.j)};T.prototype.getBoundingBox=T.prototype.Z;T.prototype.ga=function(a,b,c){var d=this.J();c||(a=Le(a,this.ga,0),b=Me(b,this.ga,1));b=this.M(a,b,c);a=b.J();return a.lat===d.lat&&a.lng===d.lng&&this.S()===b.S()&&this.L()===b.L()};T.prototype.containsLatLng=T.prototype.ga;\nT.prototype.ha=function(a,b){b||Oe(a,this.ha,0);return this.ga(a.lat,a.lng,b)};T.prototype.containsPoint=T.prototype.ha;T.prototype.Ta=function(a,b){var c=this.J();if(!b&&!Na(a,T))throw new A(this.Ta,0,a);b=this.ma(a,b);a=b.J();return a.lat===c.lat&&a.lng===c.lng&&this.S()===b.S()&&this.L()===b.L()};T.prototype.containsRect=T.prototype.Ta;\nT.prototype.M=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new A(this.M,0,a);if(Ra(b=Me(b)))throw new A(this.M,1,b);}return nf(this.m,this.i,this.l,this.j,a,b,a,b,d)};T.prototype.mergeLatLng=T.prototype.M;T.prototype.$a=function(a,b,c){b||Oe(a,this.$a,0);return this.M(a.lat,a.lng,b,c)};T.prototype.mergePoint=T.prototype.$a;T.prototype.ma=function(a,b,c){if(!b&&!Na(a,T))throw new A(this.ma,0,a);return nf(this.m,this.i,this.l,this.j,a.m,a.i,a.l,a.j,c)};T.prototype.mergeRect=T.prototype.ma;\nT.prototype.ba=function(a,b,c,d,e,f){e||(a=Le(a,this.ba,0),b=Me(b,this.ba,1),c=Le(c,this.ba,2),d=Me(d,this.ba,3));return nf(this.m,this.i,this.l,this.j,a,b,c,d,f)};T.prototype.mergeTopLeftBottomRight=T.prototype.ba;T.prototype.Ya=function(a,b){var c=this.i<=this.j,d=a.i<=a.j,e=this.i<a.j,f=a.i<this.j;if(!b&&!Na(a,T))throw new A(this.Ya,0,a);return this.l<=a.m&&a.l<=this.m&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};T.prototype.intersects=T.prototype.Ya;function mf(a,b){a=b-a;return a+(0>a?360:0)}\nfunction lf(a,b){a+=b/2;return a-(180<a?360:0)}function nf(a,b,c,d,e,f,g,h,k){c=sb(c,g);a=tb(a,e);e=mf(b,d);var m=lf(b,e);g=mf(f,h);var n=lf(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?kf(k,a,m,c,q):new T(a,m,c,q)}T.merge=nf;function of(a,b,c){c||(Oe(a,of,0),Oe(b,of,1));return new T(a.lat,a.lng,b.lat,b.lng)}T.fromPoints=of;\nfunction pf(a,b){var c=1,d=a.length,e=null;var f=oa(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new A(pf,0,a);if(0<d)for(f=a[0],e=of(f,f,b);c<d;c++)f=a[c],e.M(f.lat,f.lng,b,e);return e}T.coverPoints=pf;function qf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new A(qf,0,a);if(0<d)for(e=new T(a[0],a[1],a[0],a[1]);c<d;c+=3)e.M(a[c],a[c+1],b,e);return e}T.coverLatLngAlts=qf;\nfunction rf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new A(rf,0,a);if(0<d)for(e=new T(a[0].m,a[0].i,a[0].l,a[0].j);c<d;c++)e.ma(a[c],b,e);return e}T.coverRects=rf;\nT.prototype.bb=function(a,b){var c=this.i,d=this.m,e=this.j,f=this.l,g=this.J().lng;Oe(a,this.bb,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?kf(b,d,a,f,e):new T(d,a,f,e)};T.prototype.resizeToCenter=T.prototype.bb;T.prototype.ya="Polygon";\nT.prototype.fb=function(){return[[this.i,this.m,0],[this.j,this.m,0],[this.j,this.l,0],[this.i,this.l,0],[this.i,this.m,0]]};T.prototype.wa=function(){return this.xa()};T.prototype.xa=function(){return[this.m,this.i,this.l,this.j]};function sf(){}t("H.util.ICancelable",sf);sf.prototype.cancel=function(){};sf.prototype.cancel=sf.prototype.cancel;function tf(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.$=d;this.a=Ad()}tf.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};tf.prototype.reject=function(a){this.a.reject(a)};tf.prototype.cancel=function(){this.a.a.cancel()};function uf(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var J=x.Float32Array;var M,w=[];if(b){b=Ja(b);a=Ja(a);e&&(f=Ja(c));c=b.length;d=d?1E-7:1E-5;for(M=new J(3*c);g<c;){J=b[g];var I=+J;var Y=+a[g];e&&(q=+f[g]);vf.test(J)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=M[h++]=m+Y*d;k=M[h++]=k+I*d;e&&(n=M[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else M=new J(0);return{path:M,outlineIndices:w}}var vf=/^-?0\\d/;\nfunction wf(a,b){for(var c=0,d=a.length/3,e=new x.Array(d),f=0;c<d;)e[c++]=b.Da(a[f],a[++f]),f+=2;return e};function xf(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var yf=1/Math.pow(10,10);function zf(a,b){var c=[],d=a.Va();a=a.Ua();var e;180==a.lng&&(a.lng-=yf);d=xf(d,b);a=xf(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Af(a,b){var c=a.tileSize||256;this.b={};this.v=Ve(a.serverUrl);this.g=b;this.hb=a.layerConfigs||[];this.o=a.projected;this.T=c;this.Ga=!1!==a.batchTiles;this.fc=a.horizontalMargin||0;this.ib=a.onlyOutline;this.kb=new X(Ia,c);this.f=new X(Ia,c);this.f.da(22-Math.log(c)/Math.LN2+8)}xa(Af,K);\nAf.prototype.mb=function(a,b,c){var d=this.T,e=this.fc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.kb;e.da(c);f=e.Ha(f);d=e.Ha(d);return Bf(this,new T(f.lat,f.lng,d.lat,d.lng),this.hb,{x:a,y:b,z:c})};Af.prototype.lb=function(a,b,c,d,e){return Bf(this,new T(a,b,c,d),e)};\nfunction Bf(a,b,c,d){var e=Cf(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var J=q.level;g[u]=q.columns;q=zf(b,J);var M=q.length-1;for(h=0;h<M;h+=2){var w=[u,q[h+1],q[h],J].join("_");var I=k[w]||a.g.get(w);I||(I=new tf(q[h+1],q[h],J,u),I.key=w,k[w]=I,n.push(I));m.push(I)}}n.length&&(a.Ga?Df(a,n):Ef(a,n));return zd(m.map(function(Y){return Y.then(Fa(this.Ia,this,Y.$,Ff(e))).then(Fa(this.jb,this,Y,d||Gf)).then(Fa(this.ec,this,g[Y.$]))},a))}var Gf={x:0,y:0,z:0};\nAf.prototype.Ia=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new D(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ja(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Ef(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Hf(a,k,m)}var d,e=b.length,f=a.v;for(d=0;d<e;d++){var g=b[d];var h=f.clone().U({tilex:g.x}).U({tiley:g.y}).U({level:g.b}).U({layer:g.$});new df(h.toString(),Fa(c,null,g),jf)}}\nfunction Df(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);If(a,e)}}function If(a,b){var c=a.v.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.$)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.oa(g),new df(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Hf(a,b,h)},jf))}\nfunction Hf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Jf(a,b[e],h)}}else Jf(a,b,c)}function Jf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}\nfunction Ff(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==z?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Kf(a,b,c,d,e){return e?[new E(a,b),new E(c,b),new E(c,d),new E(a,d),new E(a,b)]:[a,b,c,b,c,d,a,d]}\nAf.prototype.jb=function(a,b,c){var d=this.f.Wa()-b.z,e=this.T<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,J=c.Rows,M=J.length,w,I=/^ADAS/.test(a.$),Y=this.f,pa=this.ib,O,bb=[],Ka=[],La=[],cb=[];for(a=0;a<M;a++){var y=w=J[a];var U=(O=I)?"HPY":"LAT";var V=O?"HPX":"LON";var ea=O?"HPZ":"ZLEVEL";if(y[U]){var P=uf(y[U],y[V],y[ea],O);y.geometry=P;delete y[U];delete y[V];delete y[ea];if(y.INNER_LAT)for(U=y.INNER_LAT.split(";"),P=y.INNER_LON.split(";"),delete y.INNER_LAT,\ndelete y.INNER_LON,y.interiors=ea=[],V=U.length,y=0;y<V;y++)ea.push(uf(U[y],P[y],"",O))}if(this.o){V=w;y=Y;P=V.$$projected$$;U=0;if(!P){var ba=V.geometry;O=wf(ba.path,y);w=[O];V.$$projected$$=P={Xb:w};V=(ea=V.interiors)?ea.length:0;w.length+=V;U|=+Lf(w,O,ba.outlineIndices);if(V)for(P.Nb=1,q=0;q<V;q++)ba=ea[q],O=wf(ba.path,y),w[1+q]=O,U|=+Lf(w,O,ba.outlineIndices);U&&(P.Vb=1+V)}y=P;O=y.Xb;w=y.Nb;var Ac=y.Vb;P=[];U=V=Lb;var db=ea=z;y=O[0];if(1===y.length){var Bc=Bc||(Bc=Kf(g,b,h,e,!1));w=y[0];Rb(w.x,\nw.y,Bc)&&P.push(Mf(y,g,b,d))}else{var Be=O.length;for(ba=pa?Ac:0;ba<Be&&(pa||!ba||P.length);ba++)if(y=O[ba],ba>=Ac){ba===Ac&&(U=P.length);var ja=Ub([y],k,m,n,f,!1);Nf(ja,g,b,d,P)}else{var Gb=Gb||(Gb=Kf(k,m,n,f,!0));if(ba>=w)if(ba===w&&(V=P.length),db)for(q=db.length;q--;){if(ja=Of(db[q],y),u=ja.length){for(ea=ea||[];u--;)ea.push(q);Nf(ja,g,b,d,P)}}else ja=Of(Gb,y),Nf(ja,g,b,d,P);else if(ja=Of(Gb,y),Nf(ja,g,b,d,P),1<ja.length&&w<Be)for(db=[],q=ja.length;q--;)db[q]=ja[q]}}P.length&&(bb[a]=P,Ka[a]=V,\nLa[a]=ea,cb[a]=U)}}return{cc:c,rb:bb,Ob:Ka,tb:La,Wb:cb}};function Lf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Of(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.ab)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Nf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Mf(a[f],b,c,d))}\nfunction Mf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}\nAf.prototype.ec=function(a,b){var c=b.cc,d=b.rb,e=b.Ob,f=b.Wb;b=b.tb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,J=c.Rows,M=J.length,w;q<M;q+=1)if(d[q]||!this.o){h={};u=J[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var I,Y=h,pa=d[q],O=e[q],bb=b[q],Ka=f[q],La=g;if(pa){var cb=pa.length;if(bb)for(I=O;I--;){if(I){var y={};for(m in Y)y[m]=Y[m]}else y=Y;u=[pa[I]];var U=sb(cb,Ka)-O;for(h=\n0;h<U;h++)bb[h]===I&&u.push(pa[O+h]);U=u.length;if(!I)for(h=Ka;h<cb;h++)u.push(pa[h]);y.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:U};La.push(y)}else Y.$HProjGeometry={paths:pa,interiorsIndex:O,outlinesIndex:Ka},La.push(Y)}else La.push(Y)}c.Meta&&(k.Meta=c.Meta);return k};Af.prototype.P=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};\nfunction Cf(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=Aa(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=za[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(za[a]=new Af(c,Pf)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.mb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.lb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.B();delete za[a];ya()&&Pf.V();break;default:e.postError("Unsupported command")}});\nvar Pf=new B(26214400),za=Object.create(Ia,void 0);function Qf(a,b,c){var d=a[b];a=a[b+1];this.Xa=[];this.Oa=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Qf.prototype.ha=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Qf.prototype.J=function(){return this.b};var Rf=new E(0,0);function Sf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Tf=new X;function Uf(a,b,c,d,e){Tf.Da(a,b,Rf);d[e]=Rf.x;d[e+1]=Rf.y}\nt("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Sf:Uf,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Tf.da(d);g<h.length;){var J=h[g++];var M=h[g++];var w=h[g++];f(w,M,d,q,u);for(w=a.length;w--;)if(M=a[w],M.ha(q,u)){var I=M;break}I||(I=new Qf(q,u,b),a.push(I));w=u/2;I.Oa+=J||1;I.Xa.push(w);I=null;u+=2}for(w=a.length;w--;)M=a[w],b=M.Oa>=c,f=M.Xa,d=f.length,b?(m.push(d),m=m.concat(f)):\n(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new cf(a.data);var b=Ze[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new cf;var b=function(c,d){bf.apply(a,[c,d,!0])};b("0",$e);b("1",bf);b("2",af);b("3",hf)})();\n',e=function(){var t,i,r;"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope||!(module.exports||"undefined"!=typeof window)||(t=e.toString(),i="",r="undefined"!=typeof document&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){function e(t){return n.call(t).slice(8,-1)}var n={}.toString,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function a(t,e){return t(e={exports:{}},e.exports),e.exports}function s(t){return t&&t.Math==Math&&t}function l(t){try{return!!t()}catch(t){return!0}}function u(t){return"object"==typeof t?null!==t:"function"==typeof t}function c(t){return x?w.createElement(t):{}}function h(t){if(!u(t))throw TypeError(String(t)+" is not an object");return t}function p(t,e){if(!u(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!u(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!u(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!u(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}function f(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function d(t,e){try{k(_,t,e)}catch(i){_[t]=e}return e}function y(t){return"Symbol(".concat(void 0===t?"":t,")_",(++M+I).toString(36))}function g(t){return L[t]||(L[t]=O&&C[t]||(O?C:y)("Symbol."+t))}function v(t){var i,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(i=Object(t),R))?r:N?e(i):"Object"==(n=e(i))&&"function"==typeof i.callee?"Arguments":n}var m="object",_=s(typeof globalThis==m&&globalThis)||s(typeof window==m&&window)||s(typeof self==m&&self)||s(typeof o==m&&o)||Function("return this")(),b=!l((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),w=_.document,x=u(w)&&u(w.createElement),E=!b&&!l((function(){return 7!=Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a})),A=Object.defineProperty,T={f:b?A:function(t,e,i){if(h(t),e=p(e,!0),h(i),E)try{return A(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},k=b?function(t,e,i){return T.f(t,e,f(1,i))}:function(t,e,i){return t[e]=i,t},S=a((function(t){var e="__core-js_shared__",i=_[e]||d(e,{});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})})),M=0,I=Math.random(),O=!l((function(){return!String(Symbol())})),L=S("wks"),C=_.Symbol,R=g("toStringTag"),N="Arguments"==e(function(){return arguments}()),P={};function j(t,e){return Z.call(t,e)}function D(t){return Q[t]||(Q[t]=y(t))}P[g("toStringTag")]="z";var z,F,G,B,U,V,q,Y,W="[object z]"!==String(P)?function(){return"[object "+v(this)+"]"}:P.toString,Z={}.hasOwnProperty,K=S("native-function-to-string",Function.toString),X=_.WeakMap,J="function"==typeof X&&/native code/.test(K.call(X)),Q=S("keys"),$={},tt=_.WeakMap;q=J?(z=new tt,F=z.get,G=z.has,B=z.set,U=function(t,e){return B.call(z,t,e),e},V=function(t){return F.call(z,t)||{}},function(t){return G.call(z,t)}):(Y=D("state"),$[Y]=!0,U=function(t,e){return k(t,Y,e),e},V=function(t){return j(t,Y)?t[Y]:{}},function(t){return j(t,Y)});var et={set:U,get:V,has:q,enforce:function(t){return q(t)?V(t):U(t,{})},getterFor:function(t){return function(e){var i;if(!u(e)||(i=V(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},it=a((function(t){var e=et.get,i=et.enforce,r=String(K).split("toString");S("inspectSource",(function(t){return K.call(t)})),(t.exports=function(t,e,n,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof n&&("string"!=typeof e||j(n,"name")||k(n,"name",e),i(n).source=r.join("string"==typeof e?e:"")),t!==_?(a?!l&&t[e]&&(s=!0):delete t[e],s?t[e]=n:k(t,e,n)):s?t[e]=n:d(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||K.call(this)}))})),rt=Object.prototype;function nt(t){return isNaN(t=+t)?0:(0<t?yt:dt)(t)}function ot(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function at(t){return bt(ot(t))}function st(t){return 0<t?Et(nt(t),9007199254740991):0}function lt(t,e){var i,r=at(t),n=0,o=[];for(i in r)!j($,i)&&j(r,i)&&o.push(i);for(;e.length>n;)j(r,i=e[n++])&&(~kt(o,i)||o.push(i));return o}function ut(t,e){var i=Pt[Nt(t)];return i==Dt||i!=jt&&("function"==typeof e?l(e):!!e)}function ct(t,e){var i,r,n,o,a=t.target,s=t.global,l=t.stat,u=s?_:l?_[a]||d(a,{}):(_[a]||{}).prototype;if(u)for(i in e){if(n=e[i],r=t.noTargetGet?(o=Ft(u,i))&&o.value:u[i],!zt(s?i:a+(l?".":"#")+i,t.forced)&&void 0!==r){if(typeof n==typeof r)continue;!function(t,e){for(var i=Ct(e),r=T.f,n=xt.f,o=0;o<i.length;o++){var a=i[o];j(t,a)||r(t,a,n(e,a))}}(n,r)}(t.sham||r&&r.sham)&&k(n,"sham",!0),it(u,i,n,t)}}W!==rt.toString&&it(rt,"toString",W,{unsafe:!0});var ht,pt,ft,dt=Math.ceil,yt=Math.floor,gt={}.propertyIsEnumerable,vt=Object.getOwnPropertyDescriptor,mt={f:vt&&!gt.call({1:2},1)?function(t){var e=vt(this,t);return!!e&&e.enumerable}:gt},_t="".split,bt=l((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==e(t)?_t.call(t,""):Object(t)}:Object,wt=Object.getOwnPropertyDescriptor,xt={f:b?wt:function(t,e){if(t=at(t),e=p(e,!0),E)try{return wt(t,e)}catch(t){}if(j(t,e))return f(!mt.f.call(t,e),t[e])}},Et=Math.min,At=Math.max,Tt=Math.min,kt=function(t,e,i){for(var r,n,o=at(t),a=st(o.length),s=(r=a,(n=nt(i))<0?At(n+r,0):Tt(n,r));s<a;s++)if(s in o&&o[s]===e)return s||0;return-1},St=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Mt=St.concat("length","prototype"),It={f:Object.getOwnPropertyNames||function(t){return lt(t,Mt)}},Ot={f:Object.getOwnPropertySymbols},Lt=_.Reflect,Ct=Lt&&Lt.ownKeys||function(t){var e=It.f(h(t)),i=Ot.f;return i?e.concat(i(t)):e},Rt=/#|\.prototype\./,Nt=ut.normalize=function(t){return String(t).replace(Rt,".").toLowerCase()},Pt=ut.data={},jt=ut.NATIVE="N",Dt=ut.POLYFILL="P",zt=ut,Ft=xt.f,Gt=!l((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),Ht=D("IE_PROTO"),Bt=Object.prototype,Ut=Gt?Object.getPrototypeOf:function(t){return j(t=Object(ot(t)),Ht)?t[Ht]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Bt:null},Vt=g("iterator"),qt=!1;function Yt(){}[].keys&&("next"in(ft=[].keys())?(pt=Ut(Ut(ft)))!==Object.prototype&&(ht=pt):qt=!0),null==ht&&(ht={}),j(ht,Vt)||k(ht,Vt,(function(){return this}));var Wt={IteratorPrototype:ht,BUGGY_SAFARI_ITERATORS:qt},Zt=Object.keys||function(t){return lt(t,St)},Kt=b?Object.defineProperties:function(t,e){h(t);for(var i,r=Zt(e),n=r.length,o=0;o<n;)T.f(t,i=r[o++],e[i]);return t},Xt=_.document,Jt=Xt&&Xt.documentElement,Qt=D("IE_PROTO"),$t="prototype",te=function(){var t,e=c("iframe"),i=St.length;for(e.style.display="none",Jt.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),te=t.F;i--;)delete te[$t][St[i]];return te()},ee=Object.create||function(t,e){var i;return null!==t?(Yt[$t]=h(t),i=new Yt,Yt[$t]=null,i[Qt]=t):i=te(),void 0===e?i:Kt(i,e)};function ie(t,e,i){t&&!j(t=i?t:t.prototype,se)&&ae(t,se,{configurable:!0,value:e})}function re(){return this}function ne(){return this}function oe(t,e,i,r,n,o,a){var s,l,u;function c(t){if(t===n&&_)return _;if(!fe&&t in v)return v[t];switch(t){case"keys":case de:case ye:return function(){return new i(this,t)}}return function(){return new i(this)}}l=r,u=e+" Iterator",(s=i).prototype=ee(ue,{next:f(1,l)}),ie(s,u,!1),le[u]=re;var h,p,d,y=e+" Iterator",g=!1,v=t.prototype,m=v[he]||v["@@iterator"]||n&&v[n],_=!fe&&m||c(n),b="Array"==e&&v.entries||m;if(b&&(h=Ut(b.call(new t)),pe!==Object.prototype&&h.next&&(Ut(h)!==pe&&(ce?ce(h,pe):"function"!=typeof h[he]&&k(h,he,ne)),ie(h,y,!0))),n==de&&m&&m.name!==de&&(g=!0,_=function(){return m.call(this)}),v[he]!==_&&k(v,he,_),le[e]=_,n)if(p={values:c(de),keys:o?_:c("keys"),entries:c(ye)},a)for(d in p)!fe&&!g&&d in v||it(v,d,p[d]);else ct({target:e,proto:!0,forced:fe||g},p);return p}$[Qt]=!0;var ae=T.f,se=g("toStringTag"),le={},ue=Wt.IteratorPrototype,ce=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(i){}return function(i,r){return function(t,e){if(h(t),!u(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(i,r),e?t.call(i,r):i.__proto__=r,i}}():void 0),he=g("iterator"),pe=Wt.IteratorPrototype,fe=Wt.BUGGY_SAFARI_ITERATORS,de="values",ye="entries",ge="String Iterator",ve=et.set,me=et.getterFor(ge);oe(String,"String",(function(t){ve(this,{type:ge,string:String(t),index:0})}),(function(){var t,e,i,r,n,o,a,s=me(this),l=s.string,u=s.index;return u>=l.length?{value:void 0,done:!0}:(e=u,n=String(ot(l)),o=nt(e),a=n.length,t=o<0||a<=o?"":(i=n.charCodeAt(o))<55296||56319<i||o+1===a||(r=n.charCodeAt(o+1))<56320||57343<r?n.charAt(o):n.slice(o,o+2),s.index+=t.length,{value:t,done:!1})}));var _e={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},be=g("unscopables"),we=Array.prototype;function xe(t){we[be][t]=!0}null==we[be]&&k(we,be,ee(null));var Ee="Array Iterator",Ae=et.set,Te=et.getterFor(Ee),ke=oe(Array,"Array",(function(t,e){Ae(this,{type:Ee,target:at(t),index:0,kind:e})}),(function(){var t=Te(this),e=t.target,i=t.kind,r=t.index++;return!e||r>=e.length?{value:t.target=void 0,done:!0}:"keys"==i?{value:r,done:!1}:"values"==i?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values");le.Arguments=le.Array,xe("keys"),xe("values"),xe("entries");var Se=g("iterator"),Me=g("toStringTag"),Ie=ke.values;for(var Oe in _e){var Le=_[Oe],Ce=Le&&Le.prototype;if(Ce){if(Ce[Se]!==Ie)try{k(Ce,Se,Ie)}catch(o){Ce[Se]=Ie}if(Ce[Me]||k(Ce,Me,Oe),_e[Oe])for(var Re in ke)if(Ce[Re]!==ke[Re])try{k(Ce,Re,ke[Re])}catch(o){Ce[Re]=ke[Re]}}}function Ne(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}function Pe(t,e,i){if(Ne(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,r){return t.call(e,i,r)};case 3:return function(i,r,n){return t.call(e,i,r,n)}}return function(){return t.apply(e,arguments)}}var je=g("iterator"),De=Array.prototype,ze=g("iterator"),Fe=a((function(t){var e={};(t.exports=function(t,i,r,n,o){var a,s,l,u,c,p,f=Pe(i,r,n?2:1);if(o)a=t;else{if("function"!=typeof(s=function(t){if(null!=t)return t[ze]||t["@@iterator"]||le[v(t)]}(t)))throw TypeError("Target is not iterable");if(void 0!==(p=s)&&(le.Array===p||De[je]===p)){for(l=0,u=st(t.length);l<u;l++)if((n?f(h(c=t[l])[0],c[1]):f(t[l]))===e)return e;return}a=s.call(t)}for(;!(c=a.next()).done;)if(function(t,e,i,r){try{return r?e(h(i)[0],i[1]):e(i)}catch(e){var n=t.return;throw void 0!==n&&h(n.call(t)),e}}(a,f,c.value,n)===e)return e}).BREAK=e})),Ge=g("iterator"),He=!1;try{var Be=0;({next:function(){return{done:!!Be++}},return:function(){He=!0}})[Ge]=function(){return this}}catch(o){}function Ue(t,e){var i,r=h(t).constructor;return void 0===r||null==(i=h(r)[Je])?e:Ne(i)}function Ve(t){var e;oi.hasOwnProperty(t)&&(e=oi[t],delete oi[t],e())}function qe(t){return function(){Ve(t)}}function Ye(t){Ve(t.data)}function We(t){_.postMessage(t+"",Qe.protocol+"//"+Qe.host)}var Ze,Ke,Xe,Je=g("species"),Qe=_.location,$e=_.setImmediate,ti=_.clearImmediate,ei=_.process,ii=_.MessageChannel,ri=_.Dispatch,ni=0,oi={},ai="onreadystatechange";$e&&ti||($e=function(t){for(var e=[],i=1;i<arguments.length;)e.push(arguments[i++]);return oi[++ni]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Ze(ni),ni},ti=function(t){delete oi[t]},"process"==e(ei)?Ze=function(t){ei.nextTick(qe(t))}:ri&&ri.now?Ze=function(t){ri.now(qe(t))}:ii?(Xe=(Ke=new ii).port2,Ke.port1.onmessage=Ye,Ze=Pe(Xe.postMessage,Xe,1)):!_.addEventListener||"function"!=typeof postMessage||_.importScripts||l(We)?Ze=ai in c("script")?function(t){Jt.appendChild(c("script"))[ai]=function(){Jt.removeChild(this),Ve(t)}}:function(t){setTimeout(qe(t),0)}:(Ze=We,_.addEventListener("message",Ye,!1)));var si,li,ui,ci,hi,pi,fi,di={set:$e,clear:ti},yi=_.navigator,gi=yi&&yi.userAgent||"",vi=xt.f,mi=di.set,_i=_.MutationObserver||_.WebKitMutationObserver,bi=_.process,wi=_.Promise,xi="process"==e(bi),Ei=vi(_,"queueMicrotask"),Ai=Ei&&Ei.value;function Ti(t){var e,i;this.promise=new t((function(t,r){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=r})),this.resolve=Ne(e),this.reject=Ne(i)}function ki(t,e){if(h(t),u(e)&&e.constructor===t)return e;var i=Ui.f(t);return(0,i.resolve)(e),i.promise}function Si(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}function Mi(t){return"function"==typeof t?t:void 0}function Ii(t,e){return arguments.length<2?Mi(Vi[t])||Mi(_[t]):Vi[t]&&Vi[t][e]||_[t]&&_[t][e]}function Oi(t){var e;return!(!u(t)||"function"!=typeof(e=t.then))&&e}function Li(t,e,i){var r;e.notified||(e.notified=!0,r=e.reactions,Bi((function(){for(var n=e.value,o=1==e.state,a=0;r.length>a;)!function(i){var r,a,s,l=o?i.ok:i.fail,u=i.resolve,c=i.reject,h=i.domain;try{l?(o||(2===e.rejection&&dr(t,e),e.rejection=1),!0===l?r=n:(h&&h.enter(),r=l(n),h&&(h.exit(),s=!0)),r===i.promise?c($i("Promise-chain cycle")):(a=Oi(r))?a.call(r,u,c):u(r)):c(n)}catch(i){h&&!s&&h.exit(),c(i)}}(r[a++]);e.reactions=[],e.notified=!1,i&&!e.rejection&&pr(t,e)})))}function Ci(t,e,i){var r,n;lr?((r=tr.createEvent("Event")).promise=e,r.reason=i,r.initEvent(t,!1,!0),_.dispatchEvent(r)):r={promise:e,reason:i},(n=_["on"+t])?n(r):t===ur&&function(t,e){var i=_.console;i&&i.error&&(1===arguments.length?i.error(t):i.error(t,e))}("Unhandled promise rejection",i)}function Ri(t,e,i,r){return function(n){t(e,i,n,r)}}function Ni(t,e,i,r){e.done||(e.done=!0,r&&(e=r),e.value=i,e.state=2,Li(t,e,!0))}Ai||(si=function(){var t,e;for(xi&&(t=bi.domain)&&t.exit();li;){e=li.fn,li=li.next;try{e()}catch(t){throw li?ci():ui=void 0,t}}ui=void 0,t&&t.enter()},ci=xi?function(){bi.nextTick(si)}:_i&&!/(iphone|ipod|ipad).*applewebkit/i.test(gi)?(hi=!0,pi=document.createTextNode(""),new _i(si).observe(pi,{characterData:!0}),function(){pi.data=hi=!hi}):wi&&wi.resolve?(fi=wi.resolve(void 0),function(){fi.then(si)}):function(){mi.call(_,si)});var Pi,ji,Di,zi,Fi,Gi,Hi,Bi=Ai||function(t){var e={fn:t,next:void 0};ui&&(ui.next=e),li||(li=e,ci()),ui=e},Ui={f:function(t){return new Ti(t)}},Vi=_,qi=g("species"),Yi="Promise",Wi=di.set,Zi=g("species"),Ki=et.get,Xi=et.set,Ji=et.getterFor(Yi),Qi=_[Yi],$i=_.TypeError,tr=_.document,er=_.process,ir=_.fetch,rr=er&&er.versions,nr=rr&&rr.v8||"",or=Ui.f,ar=or,sr="process"==e(er),lr=!!(tr&&tr.createEvent&&_.dispatchEvent),ur="unhandledrejection",cr=zt(Yi,(function(){function t(){}var e=Qi.resolve(1),i=(e.constructor={})[Zi]=function(e){e(t,t)};return!((sr||"function"==typeof PromiseRejectionEvent)&&e.then(t)instanceof i&&0!==nr.indexOf("6.6")&&-1===gi.indexOf("Chrome/66"))})),hr=cr||!function(t,e){if(!He)return!1;var i=!1;try{var r={};r[Ge]=function(){return{next:function(){return{done:i=!0}}}},function(t){Qi.all(t).catch((function(){}))}(r)}catch(t){}return i}(),pr=function(t,e){Wi.call(_,(function(){var i,r=e.value;if(fr(e)&&(i=Si((function(){sr?er.emit("unhandledRejection",r,t):Ci(ur,t,r)})),e.rejection=sr||fr(e)?2:1,i.error))throw i.value}))},fr=function(t){return 1!==t.rejection&&!t.parent},dr=function(t,e){Wi.call(_,(function(){sr?er.emit("rejectionHandled",t):Ci("rejectionhandled",t,e.value)}))},yr=function(t,e,i,r){if(!e.done){e.done=!0,r&&(e=r);try{if(t===i)throw $i("Promise can't be resolved itself");var n=Oi(i);n?Bi((function(){var r={done:!1};try{n.call(i,Ri(yr,t,r,e),Ri(Ni,t,r,e))}catch(i){Ni(t,r,i,e)}})):(e.value=i,e.state=1,Li(t,e,!1))}catch(i){Ni(t,{done:!1},i,e)}}};function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mr(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _r(t,e,i){return e&&mr(t.prototype,e),i&&mr(t,i),t}function br(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Er(t,e)}function xr(t){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Er(t,e){return(Er=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ar(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Tr(t,e,i){return(Tr=Ar()?Reflect.construct:function(t,e,i){var r=[null];r.push.apply(r,e);var n=new(Function.bind.apply(t,r));return i&&Er(n,i.prototype),n}).apply(null,arguments)}function kr(t){var e="function"==typeof Map?new Map:void 0;return(kr=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Tr(t,arguments,xr(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Er(r,t)})(t)}function Sr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mr(t){var e=Ar();return function(){var i,r,n,o=xr(t);return r=this,!(n=e?(i=xr(this).constructor,Reflect.construct(o,arguments,i)):o.apply(this,arguments))||"object"!=typeof n&&"function"!=typeof n?Sr(r):n}}function Ir(t,e,i){return(Ir="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xr(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(i):n.value}})(t,e,i||t)}function Or(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);r=!0);}catch(t){n=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return i}}(t,e)||Cr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(t){return function(t){if(Array.isArray(t))return Rr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Cr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cr(t,e){if(t){if("string"==typeof t)return Rr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Rr(t,e):void 0}}function Rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function Nr(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=Cr(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}cr&&(Qi=function(t){!function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect Promise invocation")}(this,Qi),Ne(t),Pi.call(this);var e=Ki(this);try{t(Ri(yr,this,e),Ri(Ni,this,e))}catch(t){Ni(this,e,t)}},(Pi=function(){Xi(this,{type:Yi,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(t,e,i){for(var r in e)it(t,r,e[r],void 0);return t}(Qi.prototype,{then:function(t,e){var i=Ji(this),r=or(Ue(this,Qi));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=sr?er.domain:void 0,i.parent=!0,i.reactions.push(r),0!=i.state&&Li(this,i,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),ji=function(){var t=new Pi,e=Ki(t);this.promise=t,this.resolve=Ri(yr,t,e),this.reject=Ri(Ni,t,e)},Ui.f=or=function(t){return t===Qi||t===Di?new ji:ar(t)},"function"==typeof ir&&ct({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return ki(Qi,ir.apply(_,arguments))}})),ct({global:!0,wrap:!0,forced:cr},{Promise:Qi}),ie(Qi,Yi,!1),zi=Ii(Yi),Fi=T.f,b&&zi&&!zi[qi]&&Fi(zi,qi,{configurable:!0,get:function(){return this}}),Di=Vi[Yi],ct({target:Yi,stat:!0,forced:cr},{reject:function(t){var e=or(this);return e.reject.call(void 0,t),e.promise}}),ct({target:Yi,stat:!0,forced:cr},{resolve:function(t){return ki(this,t)}}),ct({target:Yi,stat:!0,forced:hr},{all:function(t){var e=this,i=or(e),r=i.resolve,n=i.reject,o=Si((function(){var i=Ne(e.resolve),o=[],a=0,s=1;Fe(t,(function(t){var l=a++,u=!1;o.push(void 0),s++,i.call(e,t).then((function(t){u||(u=!0,o[l]=t,--s||r(o))}),n)})),--s||r(o)}));return o.error&&n(o.value),i.promise},race:function(t){var e=this,i=or(e),r=i.reject,n=Si((function(){var n=Ne(e.resolve);Fe(t,(function(t){n.call(e,t).then(i.resolve,r)}))}));return n.error&&r(n.value),i.promise}}),ct({target:"Promise",proto:!0,real:!0},{finally:function(t){var e=Ue(this,Ii("Promise")),i="function"==typeof t;return this.then(i?function(i){return ki(e,t()).then((function(){return i}))}:t,i?function(i){return ki(e,t()).then((function(){throw i}))}:t)}}),Vi.Promise,"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}return e}),"function"!=typeof Object.values&&(Object.values=function(t){return Object.keys(t).map((function(e){return t[e]}))}),Math.hypot=Math.hypot||function(){for(var t=0,e=arguments.length,i=0;i<e;i++){if(arguments[i]===1/0||arguments[i]===-1/0)return 1/0;t+=arguments[i]*arguments[i]}return Math.sqrt(t)},Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E},"undefined"!=typeof window?("performance"in window==0&&(window.performance={}),Gi=window.performance):"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&("performance"in self==0&&(self.performance={}),Gi=self.performance),Gi&&"function"!=typeof Gi.now&&(Hi=+new Date,Gi.now=function(){return new Date-Hi});var Pr=jr;function jr(t,e){this.x=t,this.y=e}jr.prototype={clone:function(){return new jr(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=e*this.x-i*this.y,n=i*this.x+e*this.y;return this.x=r,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.x+i*(this.x-e.x)-r*(this.y-e.y),o=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=n,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},jr.convert=function(t){return t instanceof jr||!Array.isArray(t)?t:new jr(t[0],t[1])};var Dr=zr;function zr(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(Fr,this,e)}function Fr(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}zr.types=["Unknown","Point","LineString","Polygon"],zr.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i,r=t.readVarint()+t.pos,n=1,o=0,a=0,s=0,l=[];t.pos<r;)if(o||(n=7&(i=t.readVarint()),o=i>>3),o--,1===n||2===n)a+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new Pr(a,s));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}return e&&l.push(e),l},zr.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,o=0,a=0,s=1/0,l=-1/0,u=1/0,c=-1/0;t.pos<i;)if(n||(r=7&(e=t.readVarint()),n=e>>3),n--,1===r||2===r)(o+=t.readSVarint())<s&&(s=o),l<o&&(l=o),(a+=t.readSVarint())<u&&(u=a),c<a&&(c=a);else if(7!==r)throw new Error("unknown command "+r);return[s,u,l,c]},zr.prototype.toGeoJSON=function(t,e,i){var r,n=this.extent*Math.pow(2,i),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),l=zr.types[this.type];function u(t){for(var e=0;e<t.length;e++){var i=t[e],r=180-360*(i.y+a)/n;t[e]=[360*(i.x+o)/n-180,360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90]}}switch(this.type){case 1:for(var c=[],h=0;h<s.length;h++)c[h]=s[h][0];u(s=c);break;case 2:for(h=0;h<s.length;h++)u(s[h]);break;case 3:for(s=function(t){var e=t.length;if(e<=1)return[t];for(var i,r,n=[],o=0;o<e;o++){var a=function(t){for(var e,i,r=0,n=0,o=t.length,a=o-1;n<o;a=n++)e=t[n],r+=((i=t[a]).x-e.x)*(e.y+i.y);return r}(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(i&&n.push(i),i=[t[o]]):i.push(t[o]))}return i&&n.push(i),n}(s),h=0;h<s.length;h++)for(r=0;r<s[h].length;r++)u(s[h][r])}1===s.length?s=s[0]:l="Multi"+l;var p={type:"Feature",geometry:{type:l,coordinates:s},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Gr=Hr;function Hr(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Br,this,e),this.length=this._features.length}function Br(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=1==r?t.readString():2==r?t.readFloat():3==r?t.readDouble():4==r?t.readVarint64():5==r?t.readVarint():6==r?t.readSVarint():7==r?t.readBoolean():null}return e}(i))}function Ur(t,e,i){var r;3!==t||(r=new Gr(i,i.readVarint()+i.pos)).length&&(e[r.name]=r)}Hr.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Dr(this._pbf,e,this.extent,this._keys,this._values)};var Vr,qr=function(t,e){this.layers=t.readFields(Ur,{},e)},Yr=Dr,Wr=void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Zr={};(function(){var t,e,i="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,i){t!=Array.prototype&&t!=Object.prototype&&(t[e]=i.value)},r="undefined"!=typeof window&&window===this||void 0===Wr||null==Wr?this:Wr;if("function"==typeof Object.setPrototypeOf)t=Object.setPrototypeOf;else{t:{var n={};try{n.__proto__={ea:!0},e=n.ea;break t}catch(t){}e=!1}t=e?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var o=t;!function(t,e){if(e){var n=r;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in n||(n[a]={}),n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&i(n,t,{configurable:!0,writable:!0,value:e})}}("Object.setPrototypeOf",(function(t){return t||o}));var a=this||self;function s(t){var e=gr(t);if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var i=Object.prototype.toString.call(t);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function l(t){return"function"==s(t)}function u(t){var e=gr(t);return"object"==e&&null!=t||"function"==e}function c(t,e){t=t.split(".");var i,r=a;t[0]in r||void 0===r.execScript||r.execScript("var "+t[0]);for(;t.length&&(i=t.shift());)t.length||void 0===e?r=r[i]&&r[i]!==Object.prototype[i]?r[i]:r[i]={}:r[i]=e}function h(t,e){function i(){}i.prototype=e.prototype,t.ua=e.prototype,t.prototype=new i,t.prototype.constructor=t}var p=Math,f=p.min,d=p.max,y=p.round,g=p.floor,v=p.ceil,m=p.abs,_=p.log,b=p.sqrt,w=p.pow,x=p.sin,E=p.asin,A=p.cos,T=p.tan,k=p.atan2,S=p.PI,M=S/2,I=S/4,O=2*S,L=3*S,C=S/180,R=180/S;function N(t,e,i){return i<t?i:t<e?e:t}function P(t,e,i){return e<i?e<=t&&t<=i:i<=t&&t<=e}function j(t,e,i,r,n,o){return b(w((t-n)*(r-o)-(e-o)*(i-n),2)/(w(i-n,2)+w(r-o,2)))}c("H.math.normalize",(function(t,e,i){return e-=i=i||0,(t-=i)-g(t/e)*e+i})),c("H.math.clamp",N);var D={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function z(t,e){var i=t.x;t=t.y;for(var r,n,o,a,s=e.length,l=s,u=e[0],c=0,h=0,p=0;1!=c&&1<l;)n=e[--l],r=e[--l],a=e[l?l-1:(s+(l-1))%s],o=e[l?l-2:(s+(l-2))%s],i<=r&&r<=i&&t<=n&&n<=t||i<=o&&o<=i&&t<=a&&a<=t?c=1:c||r!==i?!c&&P(i,r,o)&&((r<i&&i<o||i<r&&o<i)&&(h+=t<(u=n+(i-r)/(o-r)*(a-n)),p+=u<t),c=P(t,n,a)&&j(i,t,r,n,o,a)<=0?2:0):(o===i&&(n<t&&t<a||t<n&&a<t)||(u<=i&&i<o||i<=u&&o<i)&&(t<=n?++h:++p),c=P(t,n,a)&&j(i,t,r,n,o,a)<=0?2:0),u=r;return c||0===p||0==h%2||(c=3),c!==D.NONE}function F(t,e){this.x=+t,this.y=+e}function G(t,e,i,r,n,o,a,s,l,u){return t={x:t,y:e,next:i||null,s:r||null,ta:n||null,X:o||null,o:!!a,T:s||0,O:l||0,alpha:u||0},r&&(t.s.next=t),i&&(t.next.s=t),t}function H(t){for(;t&&t.o;)t=t.next;return t}function B(t){if(t)for(;t.next;)t=t.next;return t}function U(t){var e=B(t);(e.s.next=t).s=e.s}function V(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function q(t,e,i){for(e=e.next;e!==i&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.s=e.s,(t.next.s=t).s.next=t}function Y(t,e){for(var i,r=null,n=0,o=t.length;n<o;n++)(i=G(t[n].x,t[n].y,r)).qa=e,(i.next=r)&&(r.s=i),r=i;return r}function W(t,e,i,r){return(t-=i)*t+(e-=r)*e}c("H.math.CoverType",D),c("H.math.isPointInsidePolygon",z),c("H.math.flatten",(function(t){for(var e=t.length,i=new Float64Array(2*e),r=e&&t[0].x!==X;e--;){var n=t[e],o=e<<1;i[o]=r?n.x:n[0],i[1+o]=r?n.y:n[1]}return i})),c("H.math.Point",F),(F.prototype.set=F).prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new F(this.x,this.y),t},F.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},F.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},F.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},F.prototype.round=function(){return this.x=y(this.x),this.y=y(this.y),this},F.prototype.floor=function(){return this.x=g(this.x),this.y=g(this.y),this},F.prototype.ceil=function(){return this.x=v(this.x),this.y=v(this.y),this},F.prototype.equals=F.prototype.w=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},F.prototype.getNearest=F.prototype.la=function(t,e){var i,r=e.x-t.x,n=e.y-t.y,o=t;return(r||n)&&(o=(i=((this.x-t.x)*r+(this.y-t.y)*n)/(r*r+n*n))<=0?t:1<=i?e:new F(t.x+i*r,t.y+i*n)),o},F.prototype.distance=F.prototype.R=function(t){return b(w(this.x-t.x,2)+w(this.y-t.y,2))},F.fromIPoint=function(t){if(!t)throw Error("invalid argument");return t instanceof F?t:new F(t.x,t.y)},c("H.math.clipping.clipStrips",(function(t,e,i,r,n,o){var a,s,l,u=t.length;if(u)for(a=[];u--;)for(var c,h,p=t[u],f=p.length,d=0,y=1;y<f;y++)(l=function(t,e,i,r,n,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,i=-i,o=-o,s<a){if(n<s||a<r)return;var l=a,u=t;a=s,t=e,s=l,e=u,l=1}else if(n<a||s<r)return;if(e<t){if(i<e||t<o)return;var c=1;t=-t,e=-e,u=o,o=-i,i=-u}else if(i<t||e<o)return;if(a<r){if((t+=(r-a)*(e-t)/(s-a))>i)return;a=r}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>n)return;t=o}return n<s&&(e=t+(n-a)*(e-t)/(s-a),s=n),i<e&&(s=a+(i-t)*(s-a)/(e-t),e=i),c&&(t=-t,e=-e),l?[new F(s,-e),new F(a,-t)]:[new F(a,-t),new F(s,-e)]}(p[y-1],p[y],i,e,r,n))&&(c=l[0],h=l[1],d&&d.w(c)?s.push(h):a.push(s=l),d=h,o&&(y=f,u=0));else a=t;return a})),c("H.math.clipping.clipPolygon",(function(t,e,i){var r;t=Y(t,!0),e=Y(e,!1);var n={},o=r=1;switch(~~(i||0)){case 1:o=r=0;break;case 2:r=0,o=1;break;case 3:r=1,o=0}i=r;var a,s,l,u,c,h,p=o;if(e&&t){for(e.M=G(e.x,e.y,null,B(e)),t.M=G(t.x,t.y,null,B(t)),o=e;o.next;o=o.next)if(!o.o)for(r=t;r.next;r=r.next)r.o||(h=function t(e,i,r,n,o){var a,s=i.x-e.x,l=i.y-e.y,u=n.x-r.x,c=n.y-r.y,h=s*c-l*u;return h?(u=((r.x-e.x)*c-(r.y-e.y)*u)/h,h=(l*(r.x-e.x)-s*(r.y-e.y))/h,u<0||1<u||h<0||1<h?0:(0===u?a=e:1===u?a=i:0===h?a=r:1===h&&(a=n),a?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.M&&(a.M.x=a.x,a.M.y=a.y),t(e,i,r,n,o)):(o.xa=e.x+u*s,o.ya=e.y+u*l,o.fa=u,o.ga=h,1))):0}(o,a=H(o.next),r,s=H(r.next),n))&&(h=n.fa,l=n.ga,q(h=G(u=n.xa,c=n.ya,null,null,null,null,!0,0,0,h),o,a),q(a=G(u,c,null,null,null,null,!0,0,0,l),r,s),(h.X=a).X=h);for(n=z(e,V(t)),i&&(n=!n),o=e;o;o=o.next)o.o&&(n=!(o.T=n));for(n=z(t,V(e)),p&&(n=!n),r=t;r.next;r=r.next)r.o&&(n=!(r.T=n));for(U(e),U(t);(t=function(t){var e=t;if(e)for(;(e=e.next)!=t&&(!e.o||e.o&&e.O););return e}(e))!=e;){for(i=null;!t.O;t=t.X){for(n=t.T;(i=G(t.x,t.y,i)).artificial=t.o||t.qa,t.O=1,t=n?t.next:t.s;)if(t.o){t.O=1;break}if(!t)break}i.ta=f;var f=i}return f}})),c("H.math.simplifyDP",(function(t,e,i){return function t(e,i,r,n,o){var a=0,s=n,l=e[n].x,u=e[n].y,c=e[o].x,h=e[o].y,p=n+1,f=W(l,u,c,h);if(f)for(;p<o;){var d=e[p++],y=d.x,g=((y-l)*(c-l)+((d=d.y)-u)*(h-u))/f;a<(y=g<0?W(y,d,l,u):1<g?W(y,d,c,h):W(y,d,l+g*(c-l),u+g*(h-u)))&&(a=y,s=p-1)}else for(;p<o;)a<(y=W(y=(d=e[p++]).x,d=d.y,l,u))&&(a=y,s=p-1);return i<=a||0<r&&s-n?(--r,1<s-n?(n=t(e,i,r,n,s)).splice(n.length-1,1):n=[e[n]],1<o-s?n.concat(t(e,i,r,s,o)):n.concat(e.slice(s,o+1))):[e[n],e[o]]}(t,e*e,i||0,0,t.length-1)}));var Z=this,K=String,X=[].pop(),J=/x/.exec(""),Q="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t,e){if(1==(t instanceof e&&t.constructor===e))throw new TypeError("Illegal constructor "+nt(e))}c("H.lang.isArray",(function(t,e,i,r){var n;if(!(n="Array"===it(t))&&e)throw new ut(e,i,r!==X?r:t);return n})),c("H.lang.isString",(function(t){return"string"==typeof t}));var tt=isNaN;function et(t){return t===+t}function it(t){var e=Object[Q[0]][Q[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:gr(t)}c("H.lang.isNumber",et),c("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var rt=[];function nt(t,e,i,r){var n,o,a="",s=arguments.length<2;return s&&(e={H:Z.H},i="",r=rt.slice()),st(e,!0,(function(e,o){try{if(n=e[o],s=n,st(e,!(c=[]),(function(t,e){t[e]===s&&c.push(e)})),o=c.sort(ot)[0],!(u(n)&&n.window===n&&n.self===n||u(n)&&0<n.nodeType&&l(n.cloneNode))&&u(n)){if(n===t)return a=i+"."+o,1;if(r.indexOf(n)<0&&(r.push(n),a=nt(t,n,i+"."+o,r)))return 1}}catch(e){}var s,c})),s&&(a=a?a.substr(1).replace("."+Q[0]+".","#"):"~"+(l(t)?((o=/^\s*function ([^\( ]+)/.exec(o=t))?o[1]:"anonymous")+"()":it(t))),a}function ot(t,e){return e.length-t.length}rt.indexOf(rt)<0&&rt.push(rt);var at=Object[Q[0]][Q[2]];function st(t,e,i){var r;if(t){for(n in t)if((!e||at.call(t,n))&&i(t,n,!0))return;for(r=Q.length;r--;){var n=Q[r];if((!e||at.call(t,n))&&i(t,n,!1))break}}}function lt(t,e,i){i[e]="#"+e}function ut(t,e,i){var r,n,o=arguments.length;return(e=e!==X?+e:e)!==X&&((n=r=(n=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?K(n[1].replace(/\s+/g,"")).split(","!==X?",":" "):[]).forEach(lt),n=n[e]||"#"+e),r=t?nt(t):"",o=2<o?K(i):"",(n||o)&&(r+=" (Argument "+(n||"")+(o?" "+o:"")+")"),o=Error(r),Object.setPrototypeOf(o,ut.prototype),o}function ct(t,e,i){var r=N(+t,-90,90);if(e&&tt(r))throw new ut(e,i,t);return r}function ht(t,e,i){var r,n=+t;if((n<-180||180<n)&&(n=(0==(r=(n+180)%360)<0?r:360+r)-180),e&&tt(n))throw new ut(e,i,t);return n}function pt(t,e,i){var r;if(t!==X&&tt(r=+t)&&e)throw new ut(e,i,t);return r}function ft(){$(this,ft)}function dt(t,e,i){this.lat=ct(t,dt,0),this.lng=ht(e,dt,1),i!==X&&(this.alt=pt(i,dt,2))}function yt(t,e,i){var r=u(t)&&!(tt(t.lat=ct(t.lat))||tt(t.lng=ht(t.lng))||t.alt!==X&&tt(t.alt=pt(t.alt)));if(!r&&e)throw new ut(e,i,t);return r}function gt(t,e,i,r){vt(this,ct(t,gt,0),ht(e,gt,1),ct(i,gt,2),ht(r,gt,3))}function vt(t,e,i,r,n){return t.f=i,t.g=n,e<r&&(i=e,e=r,r=i),t.i=e,t.h=r,t.m=t.b=t.c=null,t}function mt(t,e){return(t=e-t)+(t<0?360:0)}function _t(t,e){return(t+=e/2)-(180<t?360:0)}function bt(t,e,i,r,n,o,a,s,l){i=f(i,a),t=d(t,n);var u=_t(e,n=mt(e,r)),c=_t(o,a=mt(o,s))-u,h=(c+=c-1e-6<0?360:0)-1e-6<180?(u=e,s):(c=360-c,u=o,r);return 360<=(c=c+n/2+a/2)+5e-7?(u=-180,h=180):c-5e-7<n?(u=e,h=r):c-5e-7<a&&(u=o,h=s),l?vt(l,t,u,i,h):new gt(t,u,i,h)}function wt(t,e,i){return i||(yt(t,wt,0),yt(e,wt,1)),new gt(t.lat,t.lng,e.lat,e.lng)}function xt(t,e,i,r,n,o){$(this,xt),this.sa=t||10,this.c=this.b=null,this.j=r||0,this.l=n||0,this.m=e||1,this.u=i||1,this.I=!!o,this.flush()}function Et(t,e,i){var r,n;if(t.I&&(r=t.c))for(n=3;0<=n;n--){var o=e[n];if(n%3?o>=r[n]:o<=r[n]){if(!i){t.c=null;break}r[n]=o}}}function At(t,e){var i,r=t.a;if(e){var n=e;if(n!==r)for(r=n;n=n.c;)(n.entries||1<n.a)&&(r=n)}else for(;!r.entries&&(i=r.a)<2&&i;)r=n;t.a=r}h(ut,Error),c("H.lang.InvalidArgumentError",ut),ut.prototype.name="InvalidArgumentError",c("H.geo.isDBC",(function(t,e){return 0!=(t<0^e<0)&&180<m(e-t)})),c("H.geo.AbstractGeometry",ft),ft.prototype.getBoundingBox=ft.prototype.D,ft.prototype.equals=ft.prototype.w,ft.prototype.a="",ft.prototype.l="",ft.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},ft.prototype.toGeoJSON=ft.prototype.va=function(){return{type:this.l,coordinates:this.u()}},ft.prototype.forWorkerMessage=ft.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},h(dt,ft),c("H.geo.Point",dt),dt.prototype.equals=dt.prototype.w=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},dt.prototype.distance=dt.prototype.R=function(t){var e,i;return this===t||this.lat===t.lat&&this.lng===t.lng?0:(e=this.lat*C,i=t.lat*C,12742001.58*E(f(1,b(w(x((e-i)/2),2)+A(e)*A(i)*w(x((this.lng*C-t.lng*C)/2),2)))))},dt.prototype.walk=dt.prototype.wa=function(t,e,i){var r,n,o,a,s,l,u;return i?((e/=6371000.79)&&(t*=C,s=C*this.lat,r=x(s),n=x(e),o=A(e),a=C*this.lng,l=A(s),s=E(l*A(t)*n+r*o),l=(t=(a+(t=k(x(t)*l*n,o-r*x(s)))+S)%(2*S)-S)*R),e?new dt(s*R,(l+540)%360-180):this):0==(90+(t=(t%360+360)%360))%180?(s=this.lng+e/(6371000.79*O*A(this.lat*C))*(270===t?-360:360),new dt(this.lat,(s+540)%360-180)):((e/=6371000.79)&&(t*=C,a=this.lat*C,r=this.lng*C,o=(n=a+e*A(t))-a,s=_(T(n/2+I)/T(a/2+I)),s=tt(o/s)?A(a):o/s,u=e*x(t)/s,m(n)>M&&(n=0<n?S-n:-(S+n))),e?new dt(n*R,((r+u+L+(m(a+o)>M?S:0))%O-S)*R):this)},dt.prototype.getBoundingBox=dt.prototype.D=function(){return new gt(this.lat,this.lng,this.lat,this.lng)},dt.validate=yt,dt.fromIPoint=function t(e){if(!e)throw new ut(t,0,e);return new dt(e.lat,e.lng,e.alt)},dt.prototype.a="Point",dt.prototype.I=function(t){return t.push("(",this.lng," ",this.lat,")"),t},dt.prototype.l="Point",dt.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},dt.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},h(gt,ft),c("H.geo.Rect",gt),gt.prototype.a="Polygon",gt.prototype.I=function(t){var e=this.i,i=this.f,r=this.h,n=this.g;return t.push("(","(",i," ",e,",",n," ",e,",",n," ",r,",",i," ",r,",",i," ",e,")",")"),t},gt.prototype.equals=gt.prototype.w=function(t){return this===t||!!t&&this.i===t.i&&this.f===t.f&&this.h===t.h&&this.g===t.g},gt.prototype.clone=function(){return new gt(this.i,this.f,this.h,this.g)},gt.prototype.getTopLeft=gt.prototype.W=function(){return this.m||(this.m=new dt(this.i,this.f)),this.m},gt.prototype.getBottomRight=gt.prototype.V=function(){return this.b||(this.b=new dt(this.h,this.g)),this.b},gt.prototype.getTop=gt.prototype.na=function(){return this.i},gt.prototype.getBottom=gt.prototype.ha=function(){return this.h},gt.prototype.getLeft=gt.prototype.ja=function(){return this.f},gt.prototype.getRight=gt.prototype.ma=function(){return this.g},gt.prototype.getCenter=gt.prototype.F=function(){return this.c||(this.c=new dt(this.h+(this.i-this.h)/2,_t(this.f,this.A()))),this.c},gt.prototype.getWidth=gt.prototype.A=function(){return mt(this.f,this.g)},gt.prototype.getHeight=gt.prototype.G=function(){return this.i-this.h},gt.prototype.isCDB=gt.prototype.N=function(){return this.f>this.g},gt.prototype.isEmpty=gt.prototype.ra=function(){return!this.A()&&!this.G()},gt.prototype.getBoundingBox=gt.prototype.D=function(){return new gt(this.i,this.f,this.h,this.g)},gt.prototype.containsLatLng=gt.prototype.L=function(t,e,i){var r=this.F();return i||(t=ct(t,this.L,0),e=ht(e,this.L,1)),(t=(e=this.B(t,e,i)).F()).lat===r.lat&&t.lng===r.lng&&this.G()===e.G()&&this.A()===e.A()},gt.prototype.containsPoint=gt.prototype.$=function(t,e){return e||yt(t,this.$,0),this.L(t.lat,t.lng,e)},gt.prototype.containsRect=gt.prototype.aa=function(t,e){var i=this.F();if(!(e||t instanceof gt))throw new ut(this.aa,0,t);return(t=(e=this.J(t,e)).F()).lat===i.lat&&t.lng===i.lng&&this.G()===e.G()&&this.A()===e.A()},gt.prototype.mergeLatLng=gt.prototype.B=function(t,e,i,r){if(!i){if(tt(t=ct(t)))throw new ut(this.B,0,t);if(tt(e=ht(e)))throw new ut(this.B,1,e)}return bt(this.i,this.f,this.h,this.g,t,e,t,e,r)},gt.prototype.mergePoint=gt.prototype.ca=function(t,e,i){return e||yt(t,this.ca,0),this.B(t.lat,t.lng,e,i)},gt.prototype.mergeRect=gt.prototype.J=function(t,e,i){if(!(e||t instanceof gt))throw new ut(this.J,0,t);return bt(this.i,this.f,this.h,this.g,t.i,t.f,t.h,t.g,i)},gt.prototype.mergeTopLeftBottomRight=gt.prototype.C=function(t,e,i,r,n,o){return n||(t=ct(t,this.C,0),e=ht(e,this.C,1),i=ct(i,this.C,2),r=ht(r,this.C,3)),bt(this.i,this.f,this.h,this.g,t,e,i,r,o)},gt.prototype.intersects=gt.prototype.ba=function(t,e){var i=this.f<=this.g,r=t.f<=t.g,n=this.f<t.g,o=t.f<this.g;if(!(e||t instanceof gt))throw new ut(this.ba,0,t);return this.h<=t.i&&t.h<=this.i&&(!i&&(!r||n||o)||!r&&(n||o)||n&&o)},gt.merge=bt,gt.fromPoints=wt,gt.coverPoints=function t(e,i){var r=1,n=e.length,o=null,a=s(e);if("array"!=a&&("object"!=a||"number"!=typeof e.length))throw new ut(t,0,e);if(0<n)for(o=wt(a=e[0],a,i);r<n;r++)a=e[r],o.B(a.lat,a.lng,i,o);return o},gt.coverLatLngAlts=function t(e,i){var r,n=3,o=e.length;if(!(i||e&&null!=e.length))throw new ut(t,0,e);if(0<o)for(r=new gt(e[0],e[1],e[0],e[1]);n<o;n+=3)r.B(e[n],e[n+1],i,r);return r},gt.coverRects=function t(e,i){var r,n=1,o=e.length;if(i&&(!e||null==e.length))throw new ut(t,0,e);if(0<o)for(r=new gt(e[0].i,e[0].f,e[0].h,e[0].g);n<o;n++)r.J(e[n],i,r);return r},gt.prototype.resizeToCenter=gt.prototype.da=function(t,e){var i=this.f,r=this.i,n=this.g,o=this.h,a=this.F().lng;yt(t,this.da,0);var s=t.lat-o-(r-o)/2,l=t.lng-a;return t=(t=i+((l=180<l||l<-180?-(a+t.lng):l)<0?2*l:0))<-180?360+t:t,n=180<(n+=0<l?2*l:0)?n-360:n,90<=(r=0<s?r+2*s:r)&&(r=90),(o=s<0?o+2*s:o)<=-90&&(o=-90),e?vt(e,r,t,o,n):new gt(r,t,o,n)},gt.prototype.l="Polygon",gt.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},gt.prototype.U=function(){return this.j()},gt.prototype.j=function(){return[this.i,this.f,this.h,this.g]},xt.prototype.remove=function(t){var e,i,r,n,o,a,s=!1;if(t&&(e=t.a)&&e.b===this&&(i=e.entries)&&0<=(r=i.indexOf(t))){for(i.splice(r,1),i=this.a;e;)(n=e.entries)&&n.length||(n&&delete e.entries,e.a||!(o=e.c))?e=J:((r=o)[a=(s=e).j]===s&&(delete r[a],delete s.c,--r.a),i===e&&(i=o),e=o);this.a!==i&&(this.a=i,At(this)),Et(this,t,!1),s=!0}return s},xt.prototype.flush=function(){var t=new kt(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(t.b=this).a=this.b=t,this.c=null},xt.prototype.o=function(t,e,i,r,n,o){var a=[],s=this.a,l=this.b;return t<=s[5]&&e<=s[6]&&(n?i>=s[7]:i>s[7])&&(o?r>=s[4]:r>s[4])&&function t(e,i,r,n,o,a,s,l,u){var c,h=i.entries,p=i[7],f=i[4],d=i[5],y=i[6],g=i[8],v=i[9];if(h){var m=h.length;if(f<o||p<n||s<y||a<d)for(;m--;)f=(p=h[m])[3],d=p[0],y=p[1],o<=p[2]&&n<=y&&(d<s||l&&d==s)&&(f<a||u&&f==a)&&r.push(p);else for(;m--;)r.push(h[m])}(g<a||u&&a==g)&&(o<v&&(c=i[1])&&t(e,c,r,n,o,a,s,l,u),(v<s||l&&s==v)&&(c=i[3])&&t(e,c,r,n,o,a,s,l,u)),n<g&&(o<v&&(c=i[0])&&t(e,c,r,n,o,a,s,l,u),(v<s||l&&s==v)&&(c=i[2])&&t(e,c,r,n,o,a,s,l,u))}(this,s,a,t,e,i,r,o||r>=l[6],n||i>=l[5]),a};var Tt=0;function kt(t,e,i,r,n,o){this.j=e,t&&(this.c=t,this.b=t.b,n=1&e?(i=t[8],t[5]):(i=t[7],t[8]),o=2&e?(r=t[9],t[6]):(r=t[4],t[9])),this[7]=i,this[5]=n,this[8]=(i+n)/2,this[4]=r,this[6]=o,this[9]=(r+o)/2}function St(t,e,i,r,n,o){St.ua.constructor.apply(this,arguments)}function Mt(t,e,i,r,n,o,a){var s,l,u=e[8],c=e[9];return a&&(n<u||(s=u<=i))&&(o<c||(l=c<=r))?i=(u=Mt)(t,e=e[s|=l<<1]||(++e.a,e[s]=new kt(e,s)),i,r,n,o,a-1):(r=i=new It(i,r,n,o),(e.entries||(e.entries=[])).push(r),r.a=e,Et(t,i,!0),At(t,e)),i}function It(t,e,i,r){this.id=Tt++,this[0]=e,this[1]=i,this[2]=r,this[3]=t}function Ot(t){this.l=new St(+t||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function Lt(t,e,i,r,n,o){if(o)o=new It(n,-e,i+360,-r),t.j.push(o),t.m=!0,t.a&&t.a.C(e,i,r,n,!0,t.a);else{var a=-e,s=-r,l=(o=t.l).b,u=l[5],c=l[6];if(!(l[7]<=i&&l[4]<=a&&(n<u||u===n&&u===l.b.b[5])&&(s<c||c===s&&c===l.b.b[6])))throw Error("Coordinates out of bounds");o=Mt(o,o.b,i,a,n,s,o.sa),t.b&&t.b.C(e,i,r,n,!0,t.b)}return t.c=null,o}function Ct(t,e,i,r,n,o,a){var s=(t=t.j).length,l=[];if(s)for(var u=i+360,c=n+360;s--;){var h=t[s];(Rt(h,e,i,r,n,o,a)||Rt(h,e,u,r,c,o,a))&&l.push(h)}return l}function Rt(t,e,i,r,n,o,a){var s=t[3],l=t[0],u=t[1];return t=t[2],(o?l<=r:l<r)&&(a?s<=n:s<n)&&e<=t&&i<=u}function Nt(t,e){var i,r;if(i=e.length){for(var n=t.length,o={};n--;)o[t[n].id]=1;for(;i--;)(r=e[i]).id in o||t.push(r)}}function Pt(){}function jt(t,e,i){if(this.l=[],e&&this.K(e),i&&!l(i))throw new ut(jt,2,i);this.b=0,this.m=i,this.a={},this.j=this.c=null,this.Z(t)}function Dt(t,e){return e&&(t.c=Ft(t,e,t.c)),e}function zt(t){for(;t.b>t.u&&t.j;)Gt(t,t.j,!0)}function Ft(t,e,i){return i!==e&&((e.H||e.v)&&Gt(t,e,!1),(e.H=i)&&(e.v=i.v,i.v=e),e.v||(t.c=e),e.H||(t.j=e),t.b+=e.size),e}function Gt(t,e,i){var r=e.v,n=e.H;(r||n||e==t.c&&e==t.j)&&(r?r.H=n:t.c=n,n?n.v=r:t.j=r,t.b-=e.size,i&&(delete t.a[e.id],Ht(t,e))),e.H=e.v=null}function Ht(t,e){for(var i=t.l.length;i--;)t.l[i].call(t,e.id,e.data,e.size)}kt.prototype.a=0,h(St,xt),c("H.geo.QuadTree",Ot),Ot.prototype.N=function(){return this.m},Ot.prototype.D=function(){var t;if(!this.c){var e,i,r=[];if((a=!this.b)&&(s=(o=this.l).c,o.I&&!s&&((a=o.a).entries||a[0]||a[1]||a[2]||a[3])&&(s=function t(e,i){for(var r,n,o=0,a=3;0<=a;a--){for(var s=a+4,l=0<a%3,u=[],c=i[a],h=e[a],p=h.length;p--;){var f=h[p];if(r=f.entries)for(n=r.length;n--;){var d=r[n][a];(l?c<d:d<c)&&(c=d)}for(n=4;n--;)(r=f[n])&&(l?r[s]>c:r[s]<c)&&u.push(r)}o+=u.length,i[a]=c,e[a]=u}return o&&(i=t(e,i)),i}([s=[a],s,s,s],[a[6],a[7],a[4],a[5]]),o.c=s),a=o=s),a&&(this.b=new gt(-o[0],o[3],-o[2],o[1])),(t=this.b)&&r.push(t),!this.a&&(i=(e=this.j).length)){for(a=360,s=-(o=90),l=0;i--;)var n=e[i],o=f(o,n[0]),a=f(a,n[3]),s=d(s,n[2]),l=d(l,n[1]);this.a=new gt(-o,a,-s,l-360)}(t=this.a)&&r.push(t),(t=r[0])&&(r[1]&&(t=t.J(r[1],!0)),this.c=t)}return this.c},Ot.prototype.insertBoundingBox=Ot.prototype.oa=function(t){var e=t.W(),i=t.V();return(t=t.N())?Lt(this,e.lat,i.lng,i.lat,e.lng,t):Lt(this,e.lat,e.lng,i.lat,i.lng,t)},Ot.prototype.remove=function(t){var e,i;return t.a?(i=this.l.remove(t),this.b=null):(i=0<=(t=(e=this.j).indexOf(t)))&&(e.splice(t,1),this.m=0<e.length,this.a=null),i&&(this.c=null),i},Ot.prototype.intersectBoundingBox=Ot.prototype.pa=function(t,e,i){var r=this.l,n=t.W(),o=t.V(),a=-n.lat,s=(n=n.lng,-o.lat);return o=o.lng,!e&&a==s||!i&&n===o?t=[]:t.N()?(Nt(t=r.o(-180,a,o,s,i,e),r.o(n,a,180,s,!1,e)),Nt(t,Ct(this,a,o,s,n+360,e,i))):Nt(t=r.o(n,a,o,s,i,e),Ct(this,a,n,s,o,e,i)),t},c("H.util.ICache",Pt),Pt.prototype.add=function(){},Pt.prototype.get=function(){},Pt.prototype.drop=Pt.prototype.S=function(){},Pt.prototype.forEach=function(){},Pt.prototype.removeAll=Pt.prototype.Y=function(){},Pt.prototype.registerOnDrop=Pt.prototype.K=function(){},Pt.prototype.deRegisterOnDrop=Pt.prototype.P=function(){},c("H.util.Cache",jt),jt.prototype.add=function(t,e,i){var r,n;if(!et(i=+i)||i<0)throw new ut(this.add,2,i);return t=String(t),(n=!this.m||this.m(t,e,i))&&((r=this.a[t])?(r.data!==e&&Ht(this,r),this.b+=i-r.size,r.size=i,r.data=e,Dt(this,r)):this.a[t]=Ft(this,{id:t,data:e,size:i,H:null,v:null},this.c),zt(this)),n},jt.prototype.registerOnDrop=jt.prototype.K=function(t){if(!l(t))throw new ut(this.K,0,t);this.l.push(t)},jt.prototype.deRegisterOnDrop=jt.prototype.P=function(t){this.l=this.l.filter((function(e){return e!==t}))},jt.prototype.get=function(t,e){return(t=e?this.a[t]:Dt(this,this.a[t]))&&t.data},jt.prototype.drop=jt.prototype.S=function(t){var e;(e=this.a[t])&&Gt(this,e,!0)},jt.prototype.forEach=function(t,e,i){var r;for(r in this.a){var n=this.a[r];i&&!i(r,n.data,n.size)||t.call(e,r,n.data,n.size)}},jt.prototype.removeAll=jt.prototype.Y=function(t){var e;for(e in this.a){var i=this.a[e];t&&!t(e,i.data,i.size)||Gt(this,this.a[e],!0)}},jt.prototype.setMaxSize=jt.prototype.Z=function(t){if(!(0<+t))throw new ut(jt.prototype.Z,0,t);return this.u=+t,zt(this),this},jt.prototype.getMaxSize=jt.prototype.ka=function(){return this.u},jt.prototype.getCurrentSize=jt.prototype.ia=function(){return this.b}}).call(Zr);var Kr,Xr=Vr={};function Jr(t){return Tr(Zr.H.math.Point,Lr(t))}Vr.clipPolygon=function(t,e){var i,r,n,o=[],a=Zr.H.math.clipping.clipPolygon(t.map(Jr),e.map(Jr));if(a)do{for(i=[],r=a;i.push([(n=r).x,n.y]),r=r.next;);o.push(i)}while(a=a.nextPoly);else Vr.isPointInsidePolygon(e[0],t)?o.push(e):Vr.isPointInsidePolygon(t[0],e)&&o.push(t);return o},Vr.isPointInsidePolygon=function(t,e){return Zr.H.math.isPointInsidePolygon({x:t[0],y:t[1]},Zr.H.math.flatten(e))},Vr.clamp=function(t,e,i){return(t-=0)>i?i:t<e?e:t},Vr.splitLegs=function(t,e){var i=[];t.push(t[0]);for(var r=0;r<t.length-1;r++){var n,o=t[r],a=t[r+1];i.push(o),Math.abs(a[0]-o[0])>=e&&(n=[(o[0]+a[0])/2,(o[1]+a[1])/2],i.push(n))}return i.length!==t.length-1?Vr.splitLegs(i,e):i},Vr.getBBox=function(t){var e=1/0,i=1/0,r=-1/0,n=-1/0;return t.forEach((function(t){t[0]<e&&(e=t[0]),t[1]<i&&(i=t[1]),t[0]>r&&(r=t[0]),t[1]>n&&(n=t[1])})),[e,i,r,n]},Vr.getBBoxCenter=function(t){var e=Or(t,4),i=e[0],r=e[1];return[i+(e[2]-i)/2,r+(e[3]-r)/2]},Vr.getLineLength=function(t,e,i,r){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-r,2))},Vr.modulo=function(t,e){var i;return(i=t%e)<0==e<0?i:i+e};var Qr=Kr={};Kr.default_source_max_zoom=18,Kr.default_view_max_zoom=20,Kr.tile_size=256,Kr.half_circumference_meters=20037508.342789244,Kr.circumference_meters=2*Kr.half_circumference_meters,Kr.min_zoom_meters_per_pixel=Kr.circumference_meters/Kr.tile_size;var $r=[];Kr.metersPerPixel=function(t){return $r[t]=$r[t]||Kr.min_zoom_meters_per_pixel/Math.pow(2,t),$r[t]};var tn=[];Kr.metersPerTile=function(t){return tn[t]=tn[t]||Kr.circumference_meters/Math.pow(2,t),tn[t]},Kr.tile_scale=4096,Kr.units_per_pixel=Kr.tile_scale/Kr.tile_size,Kr.height_scale=16;var en=[];Kr.unitsPerMeter=function(t){return en[t]=en[t]||Kr.tile_scale/(Kr.tile_size*Kr.metersPerPixel(t)),en[t]},Kr.metersForTile=function(t){return{x:t.x*Kr.circumference_meters/Math.pow(2,t.z)-Kr.half_circumference_meters,y:-(t.y*Kr.circumference_meters/Math.pow(2,t.z)-Kr.half_circumference_meters)}},Kr.tileForMeters=function(t,e){var i=Or(t,2),r=i[0],n=i[1];return{x:Math.floor((r+Kr.half_circumference_meters)/(Kr.circumference_meters/Math.pow(2,e))),y:Math.floor((-n+Kr.half_circumference_meters)/(Kr.circumference_meters/Math.pow(2,e))),z:e}},Kr.metersToExactTileCoords=function(t,e){var i=Or(t,2),r=i[0],n=i[1];return{x:Math.pow(2,e-1)*(1+r/Kr.half_circumference_meters),y:Math.pow(2,e-1)*(1-n/Kr.half_circumference_meters),z:e}},Kr.wrapTile=function(t){var e=t.x,i=t.y,r=t.z,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:!0,y:!1},o=(1<<r)-1;return n.x&&(e&=o),n.y&&(i&=o),{x:e,y:i,z:r}},Kr.wrapMeters=function(t){var e=t.x,i=t.y;return{x:Xr.modulo(e+Kr.half_circumference_meters,Kr.circumference_meters)-Kr.half_circumference_meters,y:i}},Kr.metersToLatLng=function(t){var e=Or(t,2),i=e[0],r=e[1];return i/=Kr.half_circumference_meters,r/=Kr.half_circumference_meters,r=(2*Math.atan(Math.exp(r*Math.PI))-Math.PI/2)/Math.PI,[i*=180,r*=180]},Kr.latLngToMeters=function(t){var e=Or(t,2),i=e[0],r=e[1];return r=Math.log(Math.tan(r*Math.PI/360+Math.PI/4))/Math.PI,r*=Kr.half_circumference_meters,r=Math.min(Math.max(r,-Kr.half_circumference_meters),Kr.half_circumference_meters),[i*=Kr.half_circumference_meters/180,r]},Kr.tileSpaceToMeters=function(t,e,i){var r=Or(t,2),n=r[0],o=r[1],a=Kr.unitsPerMeter(e);return[n/a+i.x,o/a+i.y]},Kr.tileSpaceToLatlng=function(t,e,i){var r=Kr.unitsPerMeter(e);return Kr.transformGeometry(t,(function(t){t[0]=t[0]/r+i.x,t[1]=t[1]/r+i.y;var e=Or(Kr.metersToLatLng(t),2),n=e[0],o=e[1];t[0]=n,t[1]=o})),t},Kr.copyGeometry=function(t){if(null!=t){var e={type:t.type};return"Point"===t.type?e.coordinates=[t.coordinates[0],t.coordinates[1]]:"LineString"===t.type||"MultiPoint"===t.type?e.coordinates=t.coordinates.map((function(t){return[t[0],t[1]]})):"Polygon"===t.type||"MultiLineString"===t.type?e.coordinates=t.coordinates.map((function(t){return t.map((function(t){return[t[0],t[1]]}))})):"MultiPolygon"===t.type&&(e.coordinates=t.coordinates.map((function(t){return t.map((function(t){return t.map((function(t){return[t[0],t[1]]}))}))}))),e}},Kr.transformGeometry=function(t,e){null!=t&&("Point"===t.type?e(t.coordinates):"LineString"===t.type||"MultiPoint"===t.type?t.coordinates.forEach(e):"Polygon"===t.type||"MultiLineString"===t.type?t.coordinates.forEach((function(t){return t.forEach(e)})):"MultiPolygon"===t.type&&t.coordinates.forEach((function(t){t.forEach((function(t){return t.forEach(e)}))})))},Kr.boxIntersect=function(t,e){return!(e.sw.x>t.ne.x||e.ne.x<t.sw.x||e.sw.y>t.ne.y||e.ne.y<t.sw.y)},Kr.findBoundingBox=function(t){for(var e=1/0,i=-1/0,r=1/0,n=-1/0,o=t[0].length,a=0;a<o;a++){var s=t[0][a];s[0]<e&&(e=s[0]),s[1]<r&&(r=s[1]),s[0]>i&&(i=s[0]),s[1]>n&&(n=s[1])}return[e,r,i,n]},Kr.geometryType=function(t){return"Polygon"===t||"MultiPolygon"===t?"polygon":"LineString"===t||"MultiLineString"===t?"line":"Point"===t||"MultiPoint"===t?"point":void 0},Kr.centroid=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(t&&0!==t.length){var i,r=0,n=0,o=0,a=t[0],s=a.length;e&&(i=a[0],a=a.map((function(t){return[t[0]-i[0],t[1]-i[1]]})));for(var l=0,u=s-1;l<s;u=l,l++){var c=a[l],h=a[u],p=c[1]*h[0]-h[1]*c[0];r+=(c[0]+h[0])*p,n+=(c[1]+h[1])*p,o+=3*p}var f=[r/o,n/o];return e&&(f[0]+=i[0],f[1]+=i[1]),f}},Kr.multiCentroid=function(t){for(var e=t.length,i=[0,0],r=0;r<t.length;r++){var n=Kr.centroid(t[r]);i[0]+=n[0],i[1]+=n[1]}return i[0]/=e,i[1]/=e,i},Kr.signedPolygonRingAreaSum=function(t){for(var e=0,i=t.length,r=0;r<i-1;r++){var n=t[r],o=t[r+1];e+=n[0]*o[1]-o[0]*n[1]}return e+(t[i-1][0]*t[0][1]-t[0][0]*t[i-1][1])},Kr.polygonRingArea=function(t){return Math.abs(Kr.signedPolygonRingAreaSum(t))/2},Kr.polygonArea=function(t){if(t)return Kr.polygonRingArea(t[0])},Kr.multiPolygonArea=function(t){for(var e=0,i=0;i<t.length;i++)e+=Kr.polygonArea(t[i]);return e},Kr.ringWinding=function(t){var e=Kr.signedPolygonRingAreaSum(t);return 0<e?"CW":e<0?"CCW":void 0},Kr.getTileBoundingBox=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=Kr.wrapTile(t,{x:!0}),n=Kr.metersForTile(r),o=Kr.metersPerPixel(r.z),a=Kr.metersToLatLng([n.x-i*o,n.y+i*o]),s=Kr.metersToLatLng([n.x+(e+i)*o,n.y-(e+i)*o]),l=Kr.isLastTile(r);return new Zr.H.geo.Rect(0===t.y?90:Xr.clamp(a[1],-90,90),Xr.clamp(a[0],-180,180),l.row?-90:Xr.clamp(s[1],-90,90),l.column?180:Xr.clamp(s[0],-180,180))},Kr.isLastTile=function(t){var e=t.x,i=t.y,r=t.z;return{row:i===Math.pow(2,r)-1,column:e===Math.pow(2,r)-1}};var rn,nn,on=function(){wr(e,kr(Error));var t=Mr(e);function e(i){var r;return vr(this,e),(r=t.call(this)).name="MethodNotImplemented",r.message="Method "+i+" must be implemented in subclass",r}return e}(),an=!1,sn=!1;try{window.document!==HTMLDocument&&(sn=!0)}catch(o){void 0!==self&&(an=!0,self.window={document:{}},self.document=self.window.document)}var ln={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return void 0!==nn?nn:an||self.is_fake_worker},set is_worker(t){nn=t},get is_main(){return void 0!==rn?rn:sn&&!self.is_fake_worker},set is_main(t){rn=t},is_native_worker:an},un={},cn=0,hn={},pn={},fn={};function dn(t,e,i){var r=2<arguments.length&&void 0!==i?i:pn,n=[];if("string"==typeof t&&(t=(n=t.split(".")).pop()),ln.is_main&&e&&1===n.length&&"self"===n[0])r=e;else for(var o=0;o<n.length;o++){if(!r[n[o]])return[];r=r[n[o]]}return[t,r]}un.addTarget=function(t,e){ln.is_fake_worker?fn[t]=e:pn[t]=e},un.removeTarget=function(t){delete pn[t],delete fn[t]};var yn=" No object with that name is registered on main thread.",gn=" Object has no method with that name.",vn="_worker_broker_error_not_set_";function mn(t){Array.isArray(t)&&t.filter((function(t){return t.parent&&t.property})).forEach((function(t){return delete t.parent[t.property]}))}un.withTransferables=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(!(this instanceof un.withTransferables))return Tr(un.withTransferables,e);this.value=e,this.transferables=function t(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if(!e)return n;if(Array.isArray(e))e.forEach((function(i,r){return t(i,e,r,n)}));else if("object"===gr(e))if(e instanceof ArrayBuffer)n.push({object:e,parent:i,property:r});else if(e.buffer instanceof ArrayBuffer)n.push({object:e.buffer,parent:i,property:r});else for(var o in e)t(e[o],e,o,n);return n}(this.value)},ln.is_main&&(un.postMessage=function(t,e){for(var i=arguments.length,r=new Array(2<i?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];if(Array.isArray(t))return Promise.all(t.map((function(t){return un.postMessage.apply(un,[t,e].concat(Lr(r)))})));var o,a={};"object"===gr(e)&&(e=(a=e).method);var s="main_send";"string"==typeof t?(e=t,r=Array.prototype.slice.call(arguments,1),o=!0,s="worker_send"):t.init&&(o=!0);var l,u=[];if(r&&1===r.length&&r[0]instanceof un.withTransferables&&(u=r[0].transferables,r=r[0].value),l={type:s,message_id:++cn,method:e,message:r},o)return function(t,e){var i=t.type,r=Or(dn(t.method,e,"main_send"===i?fn:pn),2),n=r[0],o=r[1],a="Worker broker could not dispatch message type ".concat(t.method," on target ").concat(t.target,".");if(!o)throw Error(a+yn);var s="function"==typeof o[n]&&o[n];if(!s)throw Error(a+gn);return new Promise((function(e,i){var r;try{r=s.apply(o,t.message)}catch(r){return void i(r)}r instanceof Promise?r.then((function(t){t instanceof un.withTransferables&&(t=t.value[0]),e(t)}),(function(t){i(t instanceof Error?"".concat(t.message,": ").concat(t.stack):t)})):(r instanceof un.withTransferables&&(r=r.value[0]),e(r))}))}(l,t&&t.init?t:void 0);var c=new Promise((function(t,i){hn[cn]={method:e,message:r,resolve:t,reject:i}}));return a.stringify&&(l=JSON.stringify(l)),t.postMessage(l,u.map((function(t){return t.object}))),mn(u),c},un.addWorker=function(t){if(!(t instanceof Worker))throw Error("Worker broker could not add non-Worker object",t);t.addEventListener("message",(function(e){var i="string"==typeof e.data?JSON.parse(e.data):e.data,r=i.message_id;if("worker_reply"===i.type)hn[r]&&(i.error?hn[r].reject(i.error):hn[r].resolve(i.message),delete hn[r]);else if("worker_send"===i.type&&null!=r){var n=Or(dn(i.method),2),o=n[0],a=n[1],s="Worker broker could not dispatch message type ".concat(i.method," on target ").concat(i.target,".");if(!a)throw Error(s+yn);var l="function"==typeof a[o]&&a[o];if(!l)throw Error(s+gn);var u,c=vn;try{u=l.apply(a,i.message)}catch(e){c=e}var h,p=[];u&&"function"==typeof u.then?u.then((function(e){e instanceof un.withTransferables&&(p=e.transferables,e=e.value[0]),h={type:"main_reply",message_id:r,message:e},t.postMessage(h,p.map((function(t){return t.object}))),mn(p)}),(function(e){t.postMessage({type:"main_reply",message_id:r,error:e instanceof Error?"".concat(e.message,": ").concat(e.stack):e})})):(u instanceof un.withTransferables&&(p=u.transferables,u=u.value[0]),h={type:"main_reply",message_id:r,message:u,error:c instanceof Error?"".concat(c.message,": ").concat(c.stack):c},t.postMessage(h,p.map((function(t){return t.object}))),mn(p))}}))},un.getMessages=function(){return hn},un.getMessageId=function(){return cn}),ln.is_worker&&(un.postMessage=function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];var n={};"object"===gr(t)&&(t=(n=t).method);var o,a=new Promise((function(e,r){hn[cn]={method:t,message:i,resolve:e,reject:r}})),s=[];return i&&1===i.length&&i[0]instanceof un.withTransferables&&(s=i[0].transferables,i=i[0].value),o={type:"worker_send",message_id:cn,method:t,message:i},n.stringify&&(o=JSON.stringify(o)),self.postMessage(o,s.map((function(t){return t.object}))),mn(s),cn++,a},self.addEventListener("message",(function(t){var e="string"==typeof t.data?JSON.parse(t.data):t.data,i=e.message_id;if("main_reply"===e.type)hn[i]&&(e.hasOwnProperty("error")&&e.error!==vn?hn[i].reject(e.error):hn[i].resolve(e.message),delete hn[i]);else if("main_send"===e.type&&null!=i){var r=Or(dn(e.method),2),n=r[0],o=r[1],a="Worker broker could not dispatch message type ".concat(e.method," on target ").concat(e.target,".");if(!o)throw Error(a+yn);var s,l,u="function"==typeof o[n]&&o[n];if(!u)throw Error(a+gn);try{s=u.apply(o,e.message)}catch(t){l=t}var c,h=[];s instanceof Promise?s.then((function(t){t instanceof un.withTransferables&&(h=t.transferables,t=t.value[0]),c={type:"worker_reply",message_id:i,message:t},self.postMessage(c,h.map((function(t){return t.object}))),mn(h)}),(function(t){self.postMessage({type:"worker_reply",message_id:i,error:t instanceof Error?"".concat(t.message,": ").concat(t.stack):t})})):(s instanceof un.withTransferables&&(h=s.transferables,s=s.value[0]),c={type:"worker_reply",message_id:i,message:s,error:l instanceof Error?"".concat(l.message,": ").concat(l.stack):l},self.postMessage(c,h.map((function(t){return t.object}))),mn(h))}})));var _n,bn={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},wn={},xn={};function En(t){var e,i="object"===gr(t)?t.level:t;if(bn[i]<=bn[En.level]){for(var r=arguments.length,n=new Array(1<r?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if(ln.is_native_worker)un.postMessage.apply(un,[{method:"_logProxy",stringify:!0},t].concat(n));else{if("object"===gr(t)&&!0===t.once){if(xn[JSON.stringify(n)])return;xn[JSON.stringify(n)]=!0}var a=(wn[e=i]=wn[e]||(console[e]?console[e]:console.log).bind(console),wn[e]);1<n.length?a.apply(void 0,["Tangram [".concat(i,"]: ").concat(n[0])].concat(Lr(n.slice(1)))):a("Tangram [".concat(i,"]: ").concat(n[0]))}}}function An(t,e,i){var r,n;return i=i||0,function(){var o=this,a=arguments;function s(){n=0,t.apply(o,a)}clearTimeout(r),n&&i&&Date.now()-n>=i?s():(n=n||Date.now(),r=setTimeout((function(){s()}),e))}}En.level="info",En.workers=null,En.setLevel=function(t){En.level=t,ln.is_main&&Array.isArray(En.workers)&&un.postMessage(En.workers,"_logSetLevelProxy",t)},ln.is_main&&(En.setWorkers=function(t){En.workers=t},En.reset=function(){xn={}}),un.addTarget("_logProxy",En),un.addTarget("_logSetLevelProxy",En.setLevel);var Tn=_n={};un.addTarget("Utils",_n),_n.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},_n.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},_n._requests={},_n._proxy_requests={},_n.io=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6e4,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"text",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"GET",n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(ln.is_worker&&_n.isMicrosoft())return En("debug","Proxying request for URL to worker",t),o&&(_n._proxy_requests[o]=!0),un.postMessage("Utils.io",t,e,i,r,n,o,!0);var s=new XMLHttpRequest,l=(l=new Promise((function(n,o){s.open(r,t,!0),s.timeout=e,s.responseType=i,s.onload=function(){200===s.status?-1<["text","json"].indexOf(s.responseType)?n(s.responseText):n(s.response):o(Error("Request error with a status of "+s.statusText))},s.onerror=function(t){o(Error("There was a network error"+t.toString()))},s.ontimeout=function(t){o(Error("timeout "+t.toString()))},s.send()}))).then((function(t){return o&&delete _n._requests[o],a?un.withTransferables(t):t}));return o&&(_n._requests[o]=s),l},_n.cancelRequest=function(t){if(ln.is_worker&&_n._proxy_requests[t])return un.postMessage("Utils.cancelRequest",t);_n._requests[t]?(En("trace","Cancelling network request key '".concat(t,"'")),_n._requests[t].abort(),delete _n._requests[t]):En("trace","Could not find network request key '".concat(t,"'"))},_n.requestAnimationFramePolyfill=function(){"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)})},_n.serializeWithFunctions=function(t){return"function"==typeof t?t.toString():JSON.stringify(t,(function(t,e){return"function"==typeof e?e.toString():e}))},_n.stringsToFunctions=function(t,e){if("string"==typeof t)t=_n.stringToFunction(t,e);else if(null!=t&&"object"===gr(t))for(var i in t)t[i]=_n.stringsToFunctions(t[i],e);return t},_n._use_count=0,_n._function_cache={};var kn,Sn,Mn=An((function(){En("trace","Cleared cached ".concat(Object.keys(_n._function_cache).length," functions (reused ").concat(_n._use_count," times)")),_n._use_count=0,_n._function_cache={}}),1e4),In=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m;function On(t){if("string"!=typeof t||-1!==t.search(/^(data|blob):/))return"";var e=t.indexOf("?");-1<e&&(t=t.substr(0,e));var i=t.indexOf("#");return-1<i&&(t=t.substr(0,i)),t.substr(0,t.lastIndexOf("/")+1)||""}function Ln(t){return"string"==typeof t&&!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))}function Cn(t){return void 0===kn&&"function"!=typeof(kn=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)&&(kn=null,En("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),kn?kn(t):t}_n.stringToFunction=function(t,e){var i=t;e&&(i+=e.toString());var r=_n._function_cache[i];if(Mn(),r)return _n._use_count++,r;var n="string"==typeof t&&t.match(In);if(n&&2<n.length)try{var o=n[2],a=0<(a=0<n[1].length&&n[1].split(",").map((function(t){return t.trim()})).filter((function(t){return t}))).length?a:["context"],s=new Function(a.toString(),"function"==typeof e?e(o):o);return _n._function_cache[i]=s}catch(e){return t}return t},_n.device_pixel_ratio=1,_n.isPowerOf2=function(t){return 0==(t&t-1)},_n.interpolate=function(t,e,i){if(!Array.isArray(e)||!Array.isArray(e[0]))return e;if(e.length<1)return e;var r,n,o,a,s;if(t<=e[0][0])a=e[0][1],"function"==typeof i&&(a=i(a));else if(t>=e[e.length-1][0])a=e[e.length-1][1],"function"==typeof i&&(a=i(a));else for(var l=0;l<e.length-1;l++)if(t>=e[l][0]&&t<e[l+1][0]){if(r=e[l][0],n=e[l+1][0],Array.isArray(e[l][1])){a=[];for(var u=0;u<e[l][1].length;u++)"function"==typeof i?(s=i(e[l][1][u]),o=i(e[l+1][1][u])-s,a[u]=o*(t-r)/(n-r)+s):(o=e[l+1][1][u]-e[l][1][u],a[u]=o*(t-r)/(n-r)+e[l][1][u])}else a="function"==typeof i?(s=i(e[l][1]),(o=i(e[l+1][1])-s)*(t-r)/(n-r)+s):(o=e[l+1][1]-e[l][1])*(t-r)/(n-r)+e[l][1];break}return a},_n.toCSSColor=function(t){return 1===t[3]?"rgb(".concat(t.slice(0,3).map((function(t){return Math.round(255*t)})).join(", "),")"):"rgba(".concat(t.map((function(t,e){return e<3&&Math.round(255*t)||t})).join(", "),")")},_n.pointInTile=function(t){return 0<=t[0]&&t[1]>-Qr.tile_scale&&t[0]<Qr.tile_scale&&t[1]<=0},_n.zoomToTileLevel=function(t){return Math.floor(t)};var Rn=function(){function t(e,i){var r=this;if(vr(this,t),this.config=e,this.sources=i,this.id=e.id,this.name=e.name,this.pad_scale=e.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(e.rasters)&&e.rasters.forEach((function(t){-1===r.rasters.indexOf(t)&&r.rasters.push(t)})),this.preprocess=e.preprocess,"function"==typeof this.preprocess&&this.preprocess.bind(this),this.transform=e.transform,"function"==typeof this.transform)this.transform=this.transform.bind(this);else if("object"===gr(this.transform))for(var n in this.transform)"function"==typeof this.transform[n]&&(this.transform[n]=this.transform[n].bind(this));this.extra_data=e.extra_data,this.scripts=e.scripts,this.max_zoom=null!=e.max_zoom?e.max_zoom:Qr.default_source_max_zoom,this.setTileSize(e.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=null!=e.min_display_zoom?e.min_display_zoom:0,this.max_display_zoom=null!=e.max_display_zoom?e.max_display_zoom:null,this._has_volatile_data=!!e.has_volatile_data}return _r(t,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(t){if(t.source_data.layers){var e={coords:t.coords},i=[];if("function"==typeof this.transform)i.push(this.transform);else if("object"===gr(this.transform))for(var r=Object.keys(this.transform).sort(),n=0;n<r.length;n++)i.push(this.transform[r[n]]);for(var o=1===Object.keys(t.source_data.layers).length&&t.source_data.layers._default,a=0;a<i.length;a++)o?t.source_data.layers._default=i[a](t.source_data.layers._default,this.extra_data,e):t.source_data.layers=i[a](t.source_data.layers,this.extra_data,e)}}},{key:"_postProcessTile",value:function(t){var e=this;for(var i in this._transformTile(t),t.source_data.layers){var r=t.source_data.layers[i];r&&r.features&&r.features.forEach((function(t){Qr.transformGeometry(t.geometry,(function(t){t[1]=-t[1],e.pad_scale&&(t[0]=Math.round(t[0]*(1+e.pad_scale)-Qr.tile_scale*e.pad_scale/2),t[1]=Math.round(t[1]*(1+e.pad_scale)-Qr.tile_scale*e.pad_scale/2))})),e.updateDefaultWinding(t.geometry)}))}t.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(t){return t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=Lr(this.rasters),this._load(t)}},{key:"_load",value:function(){throw new on("_load")}},{key:"setTileSize",value:function(t){this.tile_size=t||256,("number"!=typeof this.tile_size||this.tile_size<256||!Tn.isPowerOf2(this.tile_size))&&(En({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(t,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(t){return null==this.default_winding&&("Polygon"===t.type?this.default_winding=Qr.ringWinding(t.coordinates[0]):"MultiPolygon"===t.type&&(this.default_winding=Qr.ringWinding(t.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(t,e){if(t.z<this.min_display_zoom||null!=this.max_display_zoom&&e>this.max_display_zoom)return!1;for(var i=0;i<this.rasters.length;i++){var r=this.rasters[i];if(this.sources[r]&&this.sources[r]!==this&&!this.sources[r].includesTile(t,t.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(t){var e=0<arguments.length&&void 0!==t&&t;this._has_volatile_data=e}}],[{key:"create",value:function(e,i){for(var r in i)if(i[r].config.name===e.name&&t.sameConfig(i[r],{config:e}))return i[r];if(t.types[e.type])return new t.types[e.type](e,i)}},{key:"sameConfig",value:function(t,e){if(!t||!e)return!1;var i=Object.assign({},t.config,{id:null,tiled:null,url:null}),r=Object.assign({},e.config,{id:null,tiled:null,url:null});return JSON.stringify(i)===JSON.stringify(r)}},{key:"coordsToMeters",value:function(t){var e=Or(Qr.latLngToMeters(t),2),i=e[0],r=e[1];t[0]=i,t[1]=r}},{key:"projectData",value:function(e){for(var i in e.layers)for(var r=e.layers[i].features.length,n=0;n<r;n++){var o=e.layers[i].features[n];Qr.transformGeometry(o.geometry,t.coordsToMeters)}}},{key:"metersToTileUnits",value:function(t,e,i){i[0]=Math.round((i[0]-e.x)*t),i[1]=-1*Math.round((i[1]-e.y)*t)}},{key:"scaleData",value:function(e,i){var r=i.coords.z,n=i.min,o=(i.max,t.metersToTileUnits.bind(this,Qr.unitsPerMeter(r),n));for(var a in e.layers)for(var s=e.layers[a].features.length,l=0;l<s;l++){var u=e.layers[a].features[l];Qr.transformGeometry(u.geometry,o)}}},{key:"register",value:function(e,i){e&&i&&(t.types[i]=e)}}]),t}();Rn.types={};var Nn=0,Pn=function(){wr(e,Rn);var t=Mr(e);function e(i,r){var n;vr(this,e),(n=t.call(this,i,r)).response_type="";var o=Or(function(t,e){if(!e||0===Object.keys(e).length)return[t,[]];var i=t.indexOf("?"),r=t.indexOf("#"),n="";-1<r&&(n=t.slice(r),t=t.slice(0,r)),-1===i&&(i=t.length,t+="?"),i++;var o="",a=[];for(var s in e)""===function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}(s,t)?o+="".concat(s,"=").concat(e[s],"&"):a.push([s,e[s]]);return[t=t.slice(0,i)+o+t.slice(i)+n,a]}(i.url,i.url_params),2),a=o[0],s=o[1];if(n.url=a,s.forEach((function(t){var e=Or(t,2),r=e[0],o=e[1];En({level:"warn",once:!0},"Data source '".concat(n.name,"': parameter '").concat(r,"' already present in URL '").concat(i.url,"', ")+"skipping value '".concat(r,"=").concat(o,"' specified in 'url_params'"))})),"string"!=typeof n.url)throw Error("Network data source must provide a string `url` property");return n}return _r(e,[{key:"_load",value:function(t){var e=this,i=this.formatUrl(this.url,t),r=t.source_data;return r.url=i,new Promise((function(n,o){r.error=null;var a=Nn+++"-"+i,s=Tn.io(i,6e4,e.response_type,"GET",{},a);r.request_id=a,s.then((function(i){"function"==typeof e.preprocess&&(i=e.preprocess(i)),(i=i instanceof Promise?i:Promise.resolve(i)).then((function(i){e.parseSourceData(t,r,i),e._postProcessTile(t),n(t)}))}),(function(i){r.error=i.stack,e._postProcessTile(t),n(t)}))}))}},{key:"formatUrl",value:function(){throw new on("formatUrl")}},{key:"parseSourceData",value:function(){throw new on("parseSourceData")}}]),e}(),jn=function(){wr(e,Pn);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).tiled=!0,n.parseBounds(i),n.builds_geometry_tiles=!1,n.tms=!0===i.tms,-1<n.url.search("{s}")&&(Array.isArray(i.url_subdomains)&&0<i.url_subdomains.length?(n.url_subdomains=i.url_subdomains,n.next_url_subdomain=0):En({level:"warn",once:!0},"Data source '".concat(n.name,"': source URL includes '{s}' subdomain marker ('").concat(n.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),n}return _r(e,[{key:"parseBounds",value:function(t){var e,i,r,n,o;Array.isArray(t.bounds)&&4===t.bounds.length&&(this.bounds=t.bounds,i=(e=Or(this.bounds,4))[0],r=e[1],n=e[2],o=e[3],this.bounds_meters={min:Qr.latLngToMeters([i,o]),max:Qr.latLngToMeters([n,r])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(t){if(this.bounds){t=Qr.wrapTile(t,{x:!0});var e=(e=this.bounds_tiles.min[t.z])||(this.bounds_tiles.min[t.z]=Qr.tileForMeters(this.bounds_meters.min,t.z)),i=(i=this.bounds_tiles.max[t.z])||(this.bounds_tiles.max[t.z]=Qr.tileForMeters(this.bounds_meters.max,t.z));if(t.x<e.x||t.x>i.x||t.y<e.y||t.y>i.y)return!1}return!0}},{key:"includesTile",value:function(t,i){return!!Ir(xr(e.prototype),"includesTile",this).call(this,t,i)&&!!this.checkBounds(t)}},{key:"formatUrl",value:function(t,e){var i=Qr.wrapTile(e.coords,{x:!0});this.tms&&(i.y=Math.pow(2,i.z)-1-i.y);var r=t.replace("{x}",i.x).replace("{y}",i.y).replace("{z}",i.z);return null!=this.url_subdomains&&(r=r.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),r}},{key:"urlHasTilePattern",value:function(t){return t&&-1<t.search("{x}")&&-1<t.search("{y}")&&-1<t.search("{z}")}}]),e}(),Dn=function(){wr(e,Rn);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).target_name="MapsJsSource"+i.uid,n.tiled=!!i.tiled,un.addTarget(n.target_name,Sr(n)),ln.is_worker&&un.postMessage(n.target_name+".onWorkerInitialized"),ln.is_main&&(n._workers_left=0),n}return _r(e,[{key:"initialize",value:function(t,e,i,r){this._main_initialized||(this.provider=t,this.worker=r,this._workers_left+=i,this._on_update=e,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(t){this._isReady()&&this.onProviderUpdate(t)}},{key:"onProviderUpdate",value:function(t){this.dispatchUpdate(void 0,t.data)}},{key:"dispatchUpdate",value:function(t,e){this._on_update(this.name,t,e)}},{key:"dispose",value:function(){un.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}(),zn=function(t,e,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?n-1:0,p=i?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;0<c;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)},Fn=function(t,e,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,h=c>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?p/l:p*Math.pow(2,1-h))*l&&(a++,l/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(e*l-1)*Math.pow(2,n),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;t[i+f]=255&s,f+=d,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;t[i+f]=255&a,f+=d,a/=256,u-=8);t[i+f-d]|=128*y},Gn=Hn;function Hn(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Hn.Varint=0,Hn.Fixed64=1,Hn.Bytes=2,Hn.Fixed32=5;var Bn=4294967296,Un=1/Bn;function Vn(t){return t.type===Hn.Bytes?t.readVarint()+t.pos:t.pos+1}function qn(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Yn(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;t<=n;n--)i.buf[n+r]=i.buf[n]}function Wn(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Zn(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Kn(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Xn(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Jn(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Qn(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function $n(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function to(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function eo(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function io(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function ro(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function no(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Hn.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,o=this.pos;this.type=7&r,t(n,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=io(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=no(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=io(this.buf,this.pos)+io(this.buf,this.pos+4)*Bn;return this.pos+=8,t},readSFixed64:function(){var t=io(this.buf,this.pos)+no(this.buf,this.pos+4)*Bn;return this.pos+=8,t},readFloat:function(){var t=zn(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=zn(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,i=e[this.pos++],r=127&i;return i<128?r:(r|=(127&(i=e[this.pos++]))<<7,i<128?r:(r|=(127&(i=e[this.pos++]))<<14,i<128?r:(r|=(127&(i=e[this.pos++]))<<21,i<128?r:function(t,e,i){var r,n,o=i.buf;if(r=(112&(n=o[i.pos++]))>>4,n<128)return qn(t,r,e);if(r|=(127&(n=o[i.pos++]))<<3,n<128)return qn(t,r,e);if(r|=(127&(n=o[i.pos++]))<<10,n<128)return qn(t,r,e);if(r|=(127&(n=o[i.pos++]))<<17,n<128)return qn(t,r,e);if(r|=(127&(n=o[i.pos++]))<<24,n<128)return qn(t,r,e);if(r|=(1&(n=o[i.pos++]))<<31,n<128)return qn(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(i=e[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,i){for(var r,n,o,a="",s=e;s<i;){var l=t[s],u=null,c=239<l?4:223<l?3:191<l?2:1;if(i<s+c)break;1===c?l<128&&(u=l):2===c?128==(192&(r=t[s+1]))&&(u=(31&l)<<6|63&r)<=127&&(u=null):3===c?(r=t[s+1],n=t[s+2],128==(192&r)&&128==(192&n)&&((u=(15&l)<<12|(63&r)<<6|63&n)<=2047||55296<=u&&u<=57343)&&(u=null)):4===c&&(r=t[s+1],n=t[s+2],o=t[s+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&((u=(15&l)<<18|(63&r)<<12|(63&n)<<6|63&o)<=65535||1114112<=u)&&(u=null)),null===u?(u=65533,c=1):65535<u&&(u-=65536,a+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),a+=String.fromCharCode(u),s+=c}return a}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var i=Vn(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=Vn(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Hn.Varint)for(;127<this.buf[this.pos++];);else if(e===Hn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Hn.Fixed32)this.pos+=4;else{if(e!==Hn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e,i=this.length||16;i<this.pos+t;)i*=2;i!==this.length&&((e=new Uint8Array(i)).set(this.buf),this.buf=e,this.length=i)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ro(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ro(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ro(this.buf,-1&t,this.pos),ro(this.buf,Math.floor(t*Un),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ro(this.buf,-1&t,this.pos),ro(this.buf,Math.floor(t*Un),this.pos+4),this.pos+=8},writeVarint:function(t){268435455<(t=+t||0)||t<0?function(t,e){var i,r;if(0<=t?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:r=r+1|(i=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e){e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos]=127&t}(i,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,o=0;o<e.length;o++){if(55295<(r=e.charCodeAt(o))&&r<57344){if(!n){56319<r||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;128<=i&&Yn(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Fn(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Fn(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;128<=r&&Yn(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,Hn.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){this.writeMessage(t,Wn,e)},writePackedSVarint:function(t,e){this.writeMessage(t,Zn,e)},writePackedBoolean:function(t,e){this.writeMessage(t,Jn,e)},writePackedFloat:function(t,e){this.writeMessage(t,Kn,e)},writePackedDouble:function(t,e){this.writeMessage(t,Xn,e)},writePackedFixed32:function(t,e){this.writeMessage(t,Qn,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,$n,e)},writePackedFixed64:function(t,e){this.writeMessage(t,to,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,eo,e)},writeBytesField:function(t,e){this.writeTag(t,Hn.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Hn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Hn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Hn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Hn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Hn.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Hn.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Hn.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Hn.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Hn.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}},Yr.prototype.loadGeometry=function(t){var e=this._pbf;e.pos=this._geometry;for(var i,r,n=e.readVarint()+e.pos,o=1,a=0,s=0,l=0,u=[];e.pos<n;)if(a<=0&&(o=7&(r=e.readVarint()),a=r>>3),a--,1===o||2===o)s+=e.readSVarint(),l+=e.readSVarint(),1===o&&(i&&u.push(i),i=[]),i.push([s*t,l*t]);else{if(7!==o)throw new Error("unknown command "+o);i&&i.push(i[0].slice())}return i&&u.push(i),u};function oo(t){var e=[],i=t&&t.features;if(i)for(var r=0,n=i.length;r<n;r++){var o=i[r],a=o.type,s=void 0;switch(a){case 1:s={type:"MultiPoint",coordinates:o.geometry.map((function(t){return t.slice()}))};break;case 2:case 3:if(s={type:"MultiLineString",coordinates:o.geometry.map((function(t){return t.map((function(t){return t.slice()}))}))},3===a&&null==(s=ao(s)))continue;break;default:continue}e.push({id:o.id,type:"Feature",geometry:s,properties:o.tags})}return{type:"FeatureCollection",features:e}}function ao(t){for(var e,i=[],r=[],n=0,o=t.coordinates.length;n<o;n++){var a=t.coordinates[n],s=Qr.ringWinding(a);null!=s&&(s===(e=e||s)&&r.length&&(i.push(r),r=[]),r.push(a))}return 0<r.length&&i.push(r),1===i.length?(t.type="Polygon",t.coordinates=i[0]):1<i.length?(t.type="MultiPolygon",t.coordinates=i):t=null,t}var so={type:"FeatureCollection",features:[]},lo=function(){wr(e,Dn);var t=Mr(e);function e(i,r){return vr(this,e),i.tiled=!0,t.call(this,i,r)}return _r(e,[{key:"fetchTile",value:function(t,e,i){return this.provider?this.provider.requestTileAsPromise(t,e,i).then((function(t){return t.data})):Promise.resolve()}},{key:"_load",value:function(t){var e=this,i=Qr.wrapTile(t.coords,{x:!0,y:!0}),r=i.x,n=i.y,o=i.z;return un.postMessage(this.target_name+".fetchTile",r,n,o).then((function(i){var r;return i instanceof ArrayBuffer?(r=new Gn(new Uint8Array(i)),t.source_data.layers=function(t){var e={};for(var i in t.layers){for(var r=t.layers[i],n=[],o=Qr.tile_scale/r.extent,a=0,s=r.length;a<s;a++){var l=r.feature(a),u=Yr.types[l.type],c=l.loadGeometry(o),h=null;switch(u){case"Point":h=function(t){var e=t.coordinates.length;if(1<e){t.type="MultiPoint";for(var i=[],r=0;r<e;r++)i.push(t.coordinates[r][0]);t.coordinates=i}else t.type="Point",t.coordinates=t.coordinates[0][0];return t}({coordinates:c});break;case"LineString":h=1===c.length?{type:u,coordinates:c[0]}:{type:"MultiLineString",coordinates:c};break;case"Polygon":h=ao({coordinates:c})}h&&h.coordinates&&n.push({type:"Feature",geometry:h,properties:l.properties})}e[i]={type:"FeatureCollection",features:n}}return e}(new qr(r))):i?t.source_data.error=i:t.source_data.layers={_default:so},e._postProcessTile(t),t}))}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();function uo(t){return Math.max(t,0)}function co(t){return isNaN(t)?0:t}function ho(t){return Array.isArray(t)?t.map(parseFloat).map(co):co(parseFloat(t))}function po(t){return Array.isArray(t)?t.map(ho).map(uo):uo(ho(t))}Rn.register(lo,"MVT"),Rn.register(lo,"OMV");var fo=a((function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(t){return(t=Math.round(t))<0?0:255<t?255:t}function n(t){return t<0?0:1<t?1:t}function o(t){return"%"===t[t.length-1]?r(parseFloat(t)/100*255):r(parseInt(t))}function a(t){return"%"===t[t.length-1]?n(parseFloat(t)/100):n(parseFloat(t))}function s(t,e,i){return i<0?i+=1:1<i&&--i,6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{e.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in i)return i[n].slice();if("#"===n[0])return 4===n.length?0<=(e=parseInt(n.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&0<=(e=parseInt(n.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=n.indexOf("("),u=n.indexOf(")");if(-1!==l&&u+1===n.length){var c=n.substr(0,l),h=n.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),y=a(h[2]),g=y<=.5?y*(d+1):y+d-y*d,v=2*y-g;return[r(255*s(v,g,f+1/3)),r(255*s(v,g,f)),r(255*s(v,g,f-1/3)),p];default:return null}}return null}}catch(t){}})),yo=(fo.parseCSSColor,{});Object.assign(yo,{clampPositive:uo,noNaN:co,parseNumber:ho,parsePositiveNumber:po}),yo.wrapFunction=function(t){return"\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(t," }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ")},yo.zeroPair=Object.freeze([0,0]),yo.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},yo.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},yo.getFeatureParseContext=function(t,e,i,r){return{feature:t,tile:e,global:i,sources:r,zoom:e.style_zoom,geometry:Qr.geometryType(t.geometry.type),meters_per_pixel:e.meters_per_pixel,meters_per_pixel_sq:e.meters_per_pixel_sq,units_per_meter_overzoom:e.units_per_meter_overzoom}};var go={STATIC:0,DYNAMIC:1,ZOOM:2};function vo(t){return"string"==typeof t&&"%"===t[t.length-1]}function mo(t){return"auto"===t}function _o(t){return vo(t)||mo(t)}yo.CACHE_TYPE=go,yo.createPropertyCache=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(null!=t){if(t.value)return{value:t.value,zoom:t.zoom?{}:null,type:t.type};var i={value:t,type:go.STATIC};return Array.isArray(i.value)&&Array.isArray(i.value[0])?(i.zoom={},i.type=go.ZOOM):"function"==typeof i.value&&(i.type=go.DYNAMIC),"function"==typeof e&&(i.zoom?i.value=i.value.map((function(t,i){return[t[0],e(t[1],i)]})):"function"!=typeof i.value&&(i.value=e(i.value,0))),i}},yo.createColorPropertyCache=function(t){return yo.createPropertyCache(t,(function(t){return"Style.color.pseudoRandomColor"===t?Tn.stringToFunction(yo.wrapFunction(yo.macros["Style.color.pseudoRandomColor"])):"Style.color.randomColor"===t?yo.macros["Style.color.randomColor"]:t}))};var bo="'size' can specify either width or height as derived from aspect ratio, but not both";yo.createPointSizePropertyCache=function(t){var e=null,i=null;if(vo(t))e=[!0];else if(Array.isArray(t))if(Array.isArray(t[0])){if(t.some((function(t){return Array.isArray(t[1])?t[1].some(_o):vo(t[1])}))&&(e=t.map((function(t){return Array.isArray(t[1])?t[1].map(vo):vo(t[1])})),(i=t.map((function(t){return Array.isArray(t[1])&&t[1].map(mo)}))).some((function(t){return Array.isArray(t)&&t.every((function(t){return t}))}))))throw bo}else if(t.some(_o)&&(e=[t.map(vo)],(i=[t.map(mo)])[0].every((function(t){return t}))))throw bo;return e?((t={value:t}).has_pct=e,t.has_ratio=i,t.sprites={}):t=yo.createPropertyCache(t,po),t},yo.evalCachedPointSizeProperty=function(t,e,i){return t.has_pct||t.has_ratio?e?(t.sprites[e.sprite]||(t.sprites[e.sprite]=yo.createPropertyCache(t.value,(function(i,r){return Array.isArray(i)?(i=i.map((function(e,i){return t.has_ratio[r][i]?e:po(e)})).map((function(i,n){return t.has_pct[r][n]?e.css_size[n]*i/100:i})),t.has_ratio[r][0]?i[0]=i[1]*e.aspect:t.has_ratio[r][1]&&(i[1]=i[0]/e.aspect)):(i=po(i),i=t.has_pct[r]?e.css_size.map((function(t){return t*i/100})):[i,i]),i}))),yo.evalCachedProperty(t.sprites[e.sprite],i)):void 0:yo.evalCachedProperty(t,i)},yo.evalCachedProperty=function(t,e){if(null!=t)return t.dynamic?t.dynamic(e):t.static?t.static:t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?Array.isArray(t.value)&&Array.isArray(t.value[0])?(t.zoom=t.zoom||{},t.zoom[e.zoom]=Tn.interpolate(e.zoom,t.value),t.zoom[e.zoom]):(t.static=t.value,t.static):(t.dynamic=t.value,t.dynamic(e))},yo.convertUnits=function(t,e){if(null!=t.val)return"px"===t.units?t.val*Qr.metersPerPixel(e.zoom):t.val;if("string"==typeof t)"px"===t.trim().slice(-2)?(t=ho(t),t*=Qr.metersPerPixel(e.zoom)):t=ho(t);else if(Array.isArray(t))return Array.isArray(t[0])?t.map((function(t){return[t[0],yo.convertUnits(t[1],e)]})):t.map((function(t){return yo.convertUnits(t,e)}));return t},yo.parseUnits=function(t){var e={val:ho(t)};return 0!==e.val&&"string"==typeof t&&"px"===t.trim().slice(-2)&&(e.units="px"),e},yo.evalCachedDistanceProperty=function(t,e){return t.dynamic?t.dynamic(e):t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?t.zoom?(t.zoom[e.zoom]=Tn.interpolate(e.zoom,t.value,(function(t){return yo.convertUnits(t,e)})),t.zoom[e.zoom]):yo.convertUnits(t.value,e):(t.dynamic=t.value,t.dynamic(e))},yo.string_colors={},yo.colorForString=function(t){if(yo.string_colors[t])return yo.string_colors[t];var e=null;return"none"!==t&&((e=fo.parseCSSColor(t))&&4===e.length?(e[0]/=255,e[1]/=255,e[2]/=255):e=yo.defaults.color),yo.string_colors[t]=e},yo.evalCachedColorProperty=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(t.dynamic){var i=t.dynamic(e);return"string"==typeof i&&(i=yo.colorForString(i)),i&&null==i[3]&&(i[3]=1),i}if(t.static)return t.static;if(t.zoom&&t.zoom[e.zoom])return t.zoom[e.zoom];if("function"==typeof t.value){t.dynamic=t.value;var r=t.dynamic(e);return"string"==typeof r&&(r=yo.colorForString(r)),r&&null==r[3]&&(r[3]=1),r}if("string"==typeof t.value)return t.static=yo.colorForString(t.value),t.static;if(t.zoom){if(!t.zoom_preprocessed){for(var n=0;n<t.value.length;n++){var o=t.value[n];o&&"string"==typeof o[1]&&(o[1]=yo.colorForString(o[1]))}t.zoom_preprocessed=!0}return t.zoom[e.zoom]=Tn.interpolate(e.zoom,t.value),t.zoom[e.zoom][3]=t.zoom[e.zoom][3]||1,t.zoom[e.zoom]}return t.static=t.value.map((function(t){return t})),t.static&&null==t.static[3]&&(t.static[3]=1),t.static},yo.parseColor=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof t&&(t=t(e)),"string"==typeof t)t=yo.colorForString(t);else if(Array.isArray(t)&&Array.isArray(t[0])){for(var i=0;i<t.length;i++){var r=t[i];"string"==typeof r[1]&&(r[1]=yo.colorForString(r[1]))}e.zoom&&(t=Tn.interpolate(e.zoom,t))}return Array.isArray(t)?null==(t=t.map((function(t){return t})))[3]&&(t[3]=1):t=[0,0,0,1],t},yo.calculateOrder=function(t,e){return"function"==typeof t?t=t(e):"string"==typeof t&&(t=e.feature.properties[t]?e.feature.properties[t]:po(t)),t},yo.evalProperty=function(t,e){return"function"==typeof t?t(e):t};var wo=function(){function t(e,i){vr(this,t),this.key=e,this.repeat_dist=i,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return _r(t,[{key:"check",value:function(t){for(var e=t.position,i=0;i<this.positions.length;i++){var r=this.positions[i],n=e[0]-r[0],o=e[1]-r[1],a=n*n+o*o;if(a<this.repeat_dist_sq)return{dist_sq:a,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(t){t&&t.position&&this.positions.push(t.position)}}],[{key:"clear",value:function(t){this.groups[t]={}}},{key:"check",value:function(t,e,i){if(e.repeat_distance&&e.repeat_group&&this.groups[i][e.repeat_group])return this.groups[i][e.repeat_group].check(t)}},{key:"add",value:function(e,i,r){i.repeat_distance&&i.repeat_group&&(null==this.groups[r][i.repeat_group]&&(this.groups[r][i.repeat_group]=new t(i.repeat_group,i.repeat_distance*i.repeat_scale)),this.groups[r][i.repeat_group].add(e))}}]),t}();wo.groups={};var xo=function(){function t(e,i,r){vr(this,t);var n=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(i/r);for(var a=0;a<this.xCellCount*this.yCellCount;a++)n.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=i,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/i,this.boxUid=0,this.circleUid=0}return _r(t,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}},{key:"insertCircle",value:function(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)}},{key:"insertCircleList",value:function(t,e){for(var i=0;i<e.length-2;i+=3)this.insertCircle("".concat(t,"/").concat(i),e[i],e[i+1],e[i+2])}},{key:"_insertBoxCell",value:function(t,e,i,r,n,o){this.boxCells[n].push(o)}},{key:"_insertCircleCell",value:function(t,e,i,r,n,o){this.circleCells[n].push(o)}},{key:"_query",value:function(t,e,i,r,n,o){if(i<0||t>this.width||r<0||e>this.height)return!n&&[];var a=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var u=this.circles[3*l],c=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:u-h,y1:c-h,x2:u+h,y2:c+h})}return o?a.filter(o):a}var p={hitTest:n,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,i,r,this._queryCell,a,p,o),n?0<a.length:a}},{key:"_queryCircle",value:function(t,e,i,r,n){var o=t-i,a=t+i,s=e-i,l=e+i;if(a<0||o>this.width||l<0||s>this.height)return!r&&[];var u=[],c={hitTest:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,u,c,n),r?0<u.length:u}},{key:"query",value:function(t,e,i,r,n){return this._query(t,e,i,r,!1,n)}},{key:"hitTest",value:function(t,e,i,r,n){return this._query(t,e,i,r,!0,n)}},{key:"hitTestCircle",value:function(t,e,i,r){return this._queryCircle(t,e,i,!0,r)}},{key:"hitTestCircleList",value:function(t,e){for(var i=0;i<t.length-2;i+=3)if(this.hitTestCircle(t[i],t[i+1],t[i+2],e))return!0;return!1}},{key:"_queryCell",value:function(t,e,i,r,n,o,a,s){var l=a.seenUids,u=this.boxCells[n];if(null!==u){var c,h=this.bboxes,p=Nr(u);try{for(p.s();!(c=p.n()).done;){var f=c.value;if(!l.box[f]){l.box[f]=!0;var d=4*f;if(t<=h[2+d]&&e<=h[3+d]&&i>=h[0+d]&&r>=h[1+d]&&(!s||s(this.boxKeys[f]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[f],x1:h[d],y1:h[1+d],x2:h[2+d],y2:h[3+d]})}}}}catch(t){p.e(t)}finally{p.f()}}var y=this.circleCells[n];if(null!==y){var g,v=this.circles,m=Nr(y);try{for(m.s();!(g=m.n()).done;){var _=g.value;if(!l.circle[_]){l.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(v[b],v[1+b],v[2+b],t,e,i,r)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var w=v[b],x=v[1+b],E=v[2+b];o.push({key:this.circleKeys[_],x1:w-E,y1:x-E,x2:w+E,y2:x+E})}}}}catch(t){m.e(t)}finally{m.f()}}}},{key:"_queryCellCircle",value:function(t,e,i,r,n,o,a,s){var l=a.circle,u=a.seenUids,c=this.boxCells[n];if(null!==c){var h,p=this.bboxes,f=Nr(c);try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!u.box[d]){u.box[d]=!0;var y=4*d;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+y],p[1+y],p[2+y],p[3+y])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}}catch(t){f.e(t)}finally{f.f()}}var g=this.circleCells[n];if(null!==g){var v,m=this.circles,_=Nr(g);try{for(_.s();!(v=_.n()).done;){var b=v.value;if(!u.circle[b]){u.circle[b]=!0;var w=3*b;if(this._circlesCollide(m[w],m[1+w],m[2+w],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}}catch(t){_.e(t)}finally{_.f()}}}},{key:"_forEachCell",value:function(t,e,i,r,n,o,a,s){for(var l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(i),h=this._convertToYCellCoord(r),p=l;p<=c;p++)for(var f=u;f<=h;f++){var d=this.xCellCount*f+p;if(n.call(this,t,e,i,r,d,o,a,s))return}}},{key:"_convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"_convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}},{key:"_circlesCollide",value:function(t,e,i,r,n,o){var a=r-t,s=n-e,l=i+o;return a*a+s*s<l*l}},{key:"_circleAndRectCollide",value:function(t,e,i,r,n,o,a){var s=(o-r)/2,l=Math.abs(t-(r+s));if(s+i<l)return!1;var u=(a-n)/2,c=Math.abs(e-(n+u));if(u+i<c)return!1;if(l<=s||c<=u)return!0;var h=l-s,p=c-u;return h*h+p*p<=i*i}}]),t}(),Eo=function(t,e,i,r){var n;if(r&&(n=function(t){return t!==r.id}),!e){if("point"===t.type&&!t.angle){var o=t.getAABB(),a=o.left,s=o.top,l=o.right,u=o.bottom;if(i.hitTest(a,-s,l,-u,n)){if(Array.isArray(t.layout.anchor))for(var c=1;c<t.layout.anchor.length;c++){t.setAnchor(t.layout.anchor[c]);var h=t.getAABB(),p=h.left,f=h.top,d=h.right,y=h.bottom;if(!i.hitTest(p,-f,d,-y,n))return!1}return!0}return!1}var g=t.getBoundingCircles();return i.hitTestCircleList(g,n)}if(e){if("point"===t.type&&!t.isFlat()){var v=t.getScreenSpaceBoundingBox(),m=v.left,_=v.top,b=v.right,w=v.bottom;return i.hitTest(m,_,b,w,n)}var x=t.getBoundingCircles();return i.hitTestCircleList(x,n)}return!1},Ao={tiles:{},startTile:function(t,e){var i=1<arguments.length&&void 0!==e?e:{},r=i.apply_repeat_groups,n=void 0===r||r,o=i.return_hidden,a=void 0!==o&&o,s=i.grid_index,l=void 0===s?null:s,u=this.tiles[t]={grid_index:l||new xo(Qr.tile_scale,Qr.tile_scale,240),objects:{},labels:{},styles:{},repeat:n,return_hidden:a};null==u.complete&&(u.complete=new Promise((function(t,e){u.resolve=t,u.reject=e})))},resetTile:function(t){delete this.tiles[t]},abortTile:function(t){this.tiles[t]&&this.tiles[t].resolve&&this.tiles[t].resolve([]),this.resetTile(t)},addStyle:function(t,e){this.tiles[e].styles[t]=!0},collide:function(t,e,i){var r=this.tiles[i];if(!r)return Promise.resolve([]);for(var n=r.objects,o=0;o<t.length;o++){var a=t[o],s=a.label.layout.priority;n[s]=n[s]||{},n[s][e]=n[s][e]||[],n[s][e].push(a)}return delete r.styles[e],0===Object.keys(r.styles).length&&this.endTile(i),r.complete.then((function(){return r.resolve=null,r.labels[e]||[]}))},endTile:function(t){var e=this.tiles[t],i=e.labels;e.repeat&&wo.clear(t);for(var r=Object.keys(e.objects).sort((function(t,e){return t-e})),n=0;n<r.length;n++){var o=e.objects[r[n]];if(o)for(var a in o){var s=o[a];i[a]=i[a]||[];for(var l=0;l<s.length;l++){var u=s[l];this.canBePlaced(u,t,u.linked,e)?u.linked?this.canBePlaced(u.linked,t,u,e)?(u.show=!0,(u.label.breach||u.linked.label.breach)&&(u.label.breach=!0,u.linked.label.breach=!0),i[a].push(u),this.place(u,t,e),this.place(u.linked,t,e)):e.return_hidden&&(u.show=!1,i[a].push(u)):(u.show=!0,i[a].push(u),this.place(u,t,e)):e.return_hidden&&(u.show=!1,i[a].push(u))}}}delete this.tiles[t],e.resolve()},canBePlaced:function(t,e,i,r){var n=2<arguments.length&&void 0!==i?i:null,o=(3<arguments.length&&void 0!==r?r:{}).repeat,a=void 0===o||o,s=t.label,l=t.label.layout;if(null!==s.placed)return s.placed;var u=this.tiles[e].grid_index;if(l.collide&&Eo(s,"main"===e,u,n&&n.label))l.collide&&(s.placed=!1);else{if(!a||!wo.check(s,l,e))return!0;s.placed=!1}return s.placed},place:function(t,e,i){var r=t.label,n=i.repeat,o=void 0===n||n;null===r.placed&&(o&&wo.add(r,r.layout,e),function(t,e,i){var r,n,o,a,s,l,u,c,h,p,f,d,y=t.id;t.placed=!0,e||("point"!==t.type||t.angle?(r=t.getBoundingCircles(),i.insertCircleList(y,r)):(o=(n=t.getAABB()).left,a=n.top,s=n.right,l=n.bottom,i.insert(y,o,-a,s,-l))),e&&("point"!==t.type||t.isFlat()?(u=t.getBoundingCircles(),i.insertCircleList(y,u)):(h=(c=t.getScreenSpaceBoundingBox()).left,p=c.top,f=c.right,d=c.bottom,i.insert(y,h,p,f,d)))}(r,"main"===e,this.tiles[e].grid_index))}},To={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:An((function(){To.ignore_user_moving_view=!0}),0,500),add:function(t){t.id=To.id++,t.max_time=t.max_time||To.max_time,t.pause_factor=t.pause_factor||1;var e=new Promise((function(e,i){t.resolve=e,t.reject=i}));return t.promise=e,t.total_elapsed=0,t.stats={calls:0},this.queue.push(t),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<To.max_time&&this.process(t),t.promise},remove:function(t){var e=this.queue.indexOf(t);-1<e&&this.queue.splice(e,1)},process:function(t){if(!this.state.user_moving_view||!1!==t.user_moving_view||this.ignore_user_moving_view)return t.pause?(t.pause--,!0):(t.stats.calls++,t.start_time=performance.now(),t.run(t));To._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var t=0;t<this.queue.length;t++){var e=this.queue[t];if(!0!==this.process(e)&&(e.pause||(e.pause=e.elapsed>e.max_time?e.pause_factor:0),e.total_elapsed+=e.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=To.max_time){this.start_time=null;break}}},finish:function(t,e){return t.elapsed=performance.now()-t.start_time,t.total_elapsed+=t.elapsed,this.remove(t),t.resolve(e),t.promise},cancel:function(t){var e;t.cancel instanceof Function&&(e=t.cancel(t)),t.resolve(e||{})},shouldContinue:function(t){return t.elapsed=performance.now()-t.start_time,this.elapsed=performance.now()-this.start_time,t.elapsed<t.max_time&&this.elapsed<To.max_time},removeForTile:function(t){for(var e=this.queue.length-1;0<=e;e--)this.queue[e].tile_id===t&&(this.cancel(this.queue[e]),this.queue.splice(e,1))},setState:function(t){this.state=t},hasPendingTasks:function(){return!!this.queue.length}};function ko(t){return{coords:t.coords,uid:t.uid,filtering:t.filtering,sprites:t.sprites,url:t.url,element:t.element,data:t.data,width:t.width,height:t.height,density:t.density,repeat:t.repeat,TEXTURE_WRAP_S:t.TEXTURE_WRAP_S,TEXTURE_WRAP_T:t.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:t.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:t.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var So=function(){function t(e,i,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};vr(this,t),n=ko(n),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.manager=r,this.bind(),this.name=i,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=n.filtering,this.density=n.density||1,this.sprites=n.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:i},n)),this.load(n),En("trace","creating Texture ".concat(this.name))}return _r(t,[{key:"destroy",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).force;0<this.retain_count&&!e?En("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,En("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&En("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;this.valid&&(this.manager.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.manager.activeUnit=e,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(t){var e=this;return t?(this.loading=null,"string"==typeof t.url?(this.config_type="url",this.setUrl(t.url,t)):t.element?(this.config_type="element",this.setElement(t.element,t)):t.data&&t.width&&t.height&&(this.config_type="data",this.setData(t.width,t.height,t.data,t)),this.loading=this.loading&&this.loading.then((function(){return e.calculateSprites(),e}))||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(t,e){var i=this,r=1<arguments.length&&void 0!==e?e:{};if(this.valid)return this.url=t,this.loading=new Promise((function(t,e){var n=new Image;n.onload=function(){try{i.setElement(n,r)}catch(t){i.loaded=!1,En("warn","Texture '".concat(i.name,"': failed to load url: '").concat(i.url,"'"),t,r),i.manager.trigger("warning",{message:"Failed to load texture from ".concat(i.url),error:t,texture:r})}i.loaded=!0,t(i)},n.onerror=function(e){i.loaded=!1,En("warn","Texture '".concat(i.name,"': failed to load url: '").concat(i.url,"'"),e,r),i.manager.trigger("warning",{message:"Failed to load texture from ".concat(i.url),error:e,texture:r}),t(i)},Tn.isSafari()&&"data:"===i.url.slice(0,5)||(n.crossOrigin="anonymous"),n.src=i.url})),this.loading}},{key:"setData",value:function(t,e,i,r){var n=3<arguments.length&&void 0!==r?r:{};return this.width=t,this.height=e,Array.isArray(i)&&(i=new Uint8Array(i)),this.update(i,n),this.setFiltering(n),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var i,r=t;return"string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement?(this.update(t,e),this.setFiltering(e)):(this.loaded=!1,i="the 'element' parameter (`element: ".concat(JSON.stringify(r),"`) must be a CSS "),i+="selector string, or a <canvas>, <image> or <video> object",En("warn","Texture '".concat(this.name,"': ").concat(i),e),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(i),texture:e})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(t,e){var i=1<arguments.length&&void 0!==e?e:{};this.valid&&(this.bind(),t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof HTMLImageElement&&t.complete?(this.width=t.width,this.height=t.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==i.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)):(this._byte_length=t?t.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(t){var e,i=0<arguments.length&&void 0!==t?t:{};this.valid&&(i.filtering=i.filtering||"linear",e=this.gl,this.bind(),Tn.isPowerOf2(this.width)&&Tn.isPowerOf2(this.height)?(this.power_of_2=!0,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.TEXTURE_WRAP_S||i.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.TEXTURE_WRAP_T||i.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),"mipmap"===i.filtering?(this.filtering="mipmap",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.generateMipmap(e.TEXTURE_2D)):"linear"===i.filtering?(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)):"nearest"===i.filtering&&(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST))):(this.power_of_2=!1,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),"nearest"===i.filtering?(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var t in this.sprites){var e=this.sprites[t];this.texcoords[t]=this.manager.getTexcoordsForSprite([e[0],e[1]],[e[2],e[3]],[this.width,this.height]),this.sizes[t]=[e[2],e[3]],this.css_sizes[t]=[e[2]/this.density,e[3]/this.density],this.aspects[t]=e[2]/e[3]}}}]),t}();function Mo(t){var e=[];return Object.assign(t,{subscribe:function(t){-1===e.indexOf(t)&&e.push(t)},unsubscribe:function(t){var i=e.indexOf(t);-1<i&&e.splice(i,1)},unsubscribeAll:function(){e=[]},trigger:function(t){for(var i=arguments.length,r=new Array(1<i?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];e.forEach((function(e){if("function"==typeof e[t])try{e[t].apply(e,r)}catch(e){En("warn","Caught exception in listener for event '".concat(t,"':"),e)}}))},hasSubscribersFor:function(t){var i=!1;return e.forEach((function(e){"function"==typeof e[t]&&(i=!0)})),i}})}var Io=function(){function t(e){vr(this,t),this.default=t.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=e,un.addTarget("Texture"+this.scene_id,this),Mo(this)}return _r(t,[{key:"create",value:function(e,i,r){for(var n=t.matchers_,o=0;o<n.length;o++){var a=n[o][0],s=n[o][1];if(s&&s(r))return new a(e,i,this,r)}return new So(e,i,this,r)}},{key:"retain",value:function(t){this.textures[t]&&this.textures[t].retain()}},{key:"release",value:function(t){this.textures[t]&&this.textures[t].release()}},{key:"getRetainCount",value:function(t){if(this.textures[t])return this.textures[t].retain_count}},{key:"getByteLength",value:function(t){if(this.textures[t])return this.textures[t].getByteLength()}},{key:"destroy",value:function(t){var e=this;Object.keys(this.textures).forEach((function(i){var r=e.textures[i];i!==e.default&&r.gl===t&&r.destroy({force:!0})}))}},{key:"getSpriteInfo",value:function(t,e){var i=this.textures[t];return i&&{size:i.sizes[e],css_size:i.css_sizes[e],aspect:i.aspects[e],texcoords:i.texcoords[e]}}},{key:"getTexcoordsForSprite",value:function(t,e,i){var r=i[1]-t[1]-e[1];return[t[0]/i[0],r/i[1],(e[0]+t[0])/i[0],(e[1]+r)/i[1]]}},{key:"createFromObject",value:function(t,e){var i=[];if(e)for(var r in e){var n,o=e[r];this.changed(r,o)&&(n=this.create(t,r,o),i.push(n.loading))}return Promise.all(i)}},{key:"createDefault",value:function(t){return this.create(t,this.default)}},{key:"changed",value:function(t,e){var i=this.textures[t];if(i){if("element"===i.config_type||null!=e.element)return!0;if(e=ko(e),this.texture_configs[t]===JSON.stringify(Object.assign({name:t},e)))return!1}return!0}},{key:"getInfo",value:function(t){var e=this;if(t=t||Object.keys(this.textures),Array.isArray(t))return Promise.all(t.map((function(t){return e.getInfo(t)})));var i=this.textures[t];return i?(i.loading||Promise.resolve(i)).then((function(){return{name:i.name,width:i.width,height:i.height,density:i.density,sprites:i.sprites,texcoords:i.texcoords,sizes:i.sizes,css_sizes:i.css_sizes,aspects:i.aspects,filtering:i.filtering,power_of_2:i.power_of_2,valid:i.valid}})):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(t){var e=this;return ln.is_main?Promise.all(t.map((function(t){var i=e.textures[t];return i&&i.loading||Promise.resolve()}))).then((function(){return e.textures})):un.postMessage("Texture"+this.scene_id+".getInfo",t).then((function(t){return t.forEach((function(t){e.textures[t.name]=t})),e.textures}))}},{key:"getMaxTextureSize",value:function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(e,i){var r=t.matchers_;if(!(e instanceof Function&&i instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(e),r.push([e,i])}},{key:"deRegister",value:function(e){for(var i=t.matchers_,r=0;r<i.length;r++)i[r][0]===e&&i.splice(r,1)}}]),t}();Io.DEFAULT_TEXTURE_NAME="__default",Io.matchers_=[];var Oo={};function Lo(t){return Oo[t]||(Oo[t]=new Io(t)),Oo[t]}var Co=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ro=function(t,e,i){var r=new Float64Array(3);return r[0]=t,r[1]=e,r[2]=i,r},No=function(t,e,i){var r=e[0],n=e[1],o=e[2],a=i[3]*r+i[7]*n+i[11]*o+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*n+i[8]*o+i[12])/a,t[1]=(i[1]*r+i[5]*n+i[9]*o+i[13])/a,t[2]=(i[2]*r+i[6]*n+i[10]*o+i[14])/a,t},Po=function(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],y=e[12],g=e[13],v=e[14],m=e[15],_=i[0],b=i[1],w=i[2],x=i[3];return t[0]=_*r+b*s+w*h+x*y,t[1]=_*n+b*l+w*p+x*g,t[2]=_*o+b*u+w*f+x*v,t[3]=_*a+b*c+w*d+x*m,_=i[4],b=i[5],w=i[6],x=i[7],t[4]=_*r+b*s+w*h+x*y,t[5]=_*n+b*l+w*p+x*g,t[6]=_*o+b*u+w*f+x*v,t[7]=_*a+b*c+w*d+x*m,_=i[8],b=i[9],w=i[10],x=i[11],t[8]=_*r+b*s+w*h+x*y,t[9]=_*n+b*l+w*p+x*g,t[10]=_*o+b*u+w*f+x*v,t[11]=_*a+b*c+w*d+x*m,_=i[12],b=i[13],w=i[14],x=i[15],t[12]=_*r+b*s+w*h+x*y,t[13]=_*n+b*l+w*p+x*g,t[14]=_*o+b*u+w*f+x*v,t[15]=_*a+b*c+w*d+x*m,t},jo=function(t,e,i){var r,n,o,a,s,l,u,c,h,p,f,d,y=i[0],g=i[1],v=i[2];return e===t?(t[12]=e[0]*y+e[4]*g+e[8]*v+e[12],t[13]=e[1]*y+e[5]*g+e[9]*v+e[13],t[14]=e[2]*y+e[6]*g+e[10]*v+e[14],t[15]=e[3]*y+e[7]*g+e[11]*v+e[15]):(r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=r*y+s*g+h*v+e[12],t[13]=n*y+l*g+p*v+e[13],t[14]=o*y+u*g+f*v+e[14],t[15]=a*y+c*g+d*v+e[15]),t},Do=Co,zo=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],y=e[13],g=e[14],v=e[15],m=i*s-r*a,_=i*l-n*a,b=i*u-o*a,w=r*l-n*s,x=r*u-o*s,E=n*u-o*l,A=c*y-h*d,T=c*g-p*d,k=c*v-f*d,S=h*g-p*y,M=h*v-f*y,I=p*v-f*g,O=m*I-_*M+b*S+w*k-x*T+E*A;return O?(O=1/O,t[0]=(s*I-l*M+u*S)*O,t[1]=(n*M-r*I-o*S)*O,t[2]=(y*E-g*x+v*w)*O,t[3]=(p*x-h*E-f*w)*O,t[4]=(l*k-a*I-u*T)*O,t[5]=(i*I-n*k+o*T)*O,t[6]=(g*b-d*E-v*_)*O,t[7]=(c*E-p*b+f*_)*O,t[8]=(a*M-s*k+u*A)*O,t[9]=(r*k-i*M-o*A)*O,t[10]=(d*x-y*b+v*m)*O,t[11]=(h*b-c*x-f*m)*O,t[12]=(s*T-a*S-l*A)*O,t[13]=(i*S-r*T+n*A)*O,t[14]=(y*_-d*w-g*m)*O,t[15]=(c*w-h*_+p*m)*O,t):null},Fo=function(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*o+i[12]*a,t[1]=i[1]*r+i[5]*n+i[9]*o+i[13]*a,t[2]=i[2]*r+i[6]*n+i[10]*o+i[14]*a,t[3]=i[3]*r+i[7]*n+i[11]*o+i[15]*a,t},Go=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},Ho=function(){function t(e,i){vr(this,t),this._gl=e,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var r=Lo(i).create(this._gl,"selection_fbo",{filtering:"nearest"});r.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,r.texture,0);var n=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,n),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,n),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return _r(t,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var e;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(e=this._gl).clearColor.apply(e,Lr(t.defaultColor))}},{key:"getFeatureAt",value:function(e,i,r){var n=i.radius,o=i.top_most_only,a=void 0===o||o;!e||e.x<0||e.y<0||1<e.x||1<e.y?r({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:e,radius:n,top_most_only:a,ttl:a?1:t.MAX_PICKING_TRIES,callback:r})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var t in this._requests)this._requests[t].callback(new Error("cleared")),delete this._requests[t];this._pending_deep_request=null}},{key:"read",value:function(t){if(this.hasPendingRequests()){var e=this._gl;for(var i in e.bindFramebuffer(e.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,t),this._requests)if(this.processRequest(this._requests[i],t))break;e.bindFramebuffer(e.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(e,i){var r,n,o,a=this._gl,s=255,l=e.point,u=e.radius,c=(o=u?(n=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*u.x*this._fbo_size.width),n),y:Math.min(Math.ceil(2*u.y*this._fbo_size.height),n)}):(u={x:0,y:0},{x:1,y:1})).x*o.y*4;if(null==this._pixels||this._pixels.byteLength<c)this._pixels=new Uint8Array(c);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,c);else for(var h=0;h<c;h++)this._pixels[h]=0;a.readPixels(Math.round((l.x-u.x)*this._fbo_size.width),Math.round((1-l.y-u.y)*this._fbo_size.height),o.x,o.y,a.RGBA,a.UNSIGNED_BYTE,this._pixels),e.ttl--;var p=Math.floor(o.x/2),f=Math.floor(o.y/2),d=4*(f*o.x+p),y=this._pixels.slice(d,d+4),g=y[0]+(y[1]<<8)+(y[2]<<16);if(0<g)r=g+(y[3]<<24)>>>0,s=y[3];else if(4<c)for(var v=1/0,m=(d=0,0);m<o.y;m++)for(var _,b=0;b<o.x;b++,d+=4)0<(g=(y=this._pixels.slice(d,d+4))[0]+(y[1]<<8)+(y[2]<<16))&&(_=Math.pow(b-p,2)+Math.pow(m-f,2))<v&&(r=g+(y[3]<<24)>>>0,s=y[3],v=_);if(255!==s){var w=this._getFeatureByKey(r,i);if(e.features||(e.features=[]),!w)return void this._finishRead(e);if(e.features.every((function(t){return t.id!==w.id}))&&e.features.push(w),e.ttl)return this._pending_deep_request=e,t._discardColor(y),this._has_dirty_buffer=!0;this._finishRead(e)}else this._finishRead(e)}},{key:"_finishRead",value:function(e){var i=e.features||t.EMPTY_ARRAY;e.top_most_only||(this._pending_deep_request=null,t._resetDiscardedColors()),delete this._requests[e.id],e.callback({features:i})}},{key:"_getFeatureByKey",value:function(t,e){for(var i=null,r=0;r<e.length;r++){var n=e[r];if(n.selection_data&&(i=n.selection_data[t])){i.tile={coords:n.coords};break}}return i}},{key:"setupDiscards",value:function(e){for(var i=t.MAX_PICKING_TRIES;i--;)e.uniform("4fv","u_selection_discard".concat(i),t._discarded_colors[i]||t.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var t=255&this.map_entry,e=this.map_entry>>8&255,i=this.map_entry>>16&255,r=this.map_prefix;return{key:t+(e<<8)+(i<<16)+(r<<24)>>>0,color:[t/255,e/255,i/255,r/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(t){this.map_prefix=t}},{key:"_discardColor",value:function(t){this._discarded_colors.push([t[0]/255,t[1]/255,t[2]/255,t[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),t}();Ho._discarded_colors=[],Ho.map_entry=0,Ho.map_prefix=0,Ho.defaultColor=[0,0,0,1],Ho.MAX_PICKING_TRIES=10,Ho.EMPTY_ARRAY=Object.freeze([]);var Bo={parseUniforms:function(t){var e=[];for(var i in t){var r,n=i,o=t[i];if("number"==typeof o)e.push({type:"float",method:"1f",name:i,value:o,key:n,uniforms:t});else if(Array.isArray(o)){if("number"==typeof o[0])2<=o.length&&o.length<=4?e.push({type:"vec"+o.length,method:o.length+"fv",name:i,value:o,key:n,uniforms:t}):4<o.length&&e.push({type:"float[]",method:"1fv",name:i+"[0]",value:o,key:n,uniforms:t});else if("string"==typeof o[0])for(r=0;r<o.length;r++)e.push({type:"sampler2D",method:"1i",name:i+"["+r+"]",value:o[r],key:r,uniforms:o});else if(Array.isArray(o[0])&&"number"==typeof o[0][0]&&2<=o[0].length&&o[0].length<=4)for(r=0;r<o.length;r++)e.push({type:"vec"+o[0].length,method:o[r].length+"fv",name:i+"["+r+"]",value:o[r],key:r,uniforms:o})}else"boolean"==typeof o?e.push({type:"bool",method:"1i",name:i,value:o,key:n,uniforms:t}):"string"==typeof o&&e.push({type:"sampler2D",method:"1i",name:i,value:o,key:n,uniforms:t})}return e},defineVariable:function(t,e){var i,r;if("number"==typeof e)i="float";else if(Array.isArray(e))"number"==typeof e[0]?2<=e.length&&e.length<=4?i="vec"+e.length:(i="float",r=e.length):"string"==typeof e[0]&&(i="sampler2D",r=e.length);else if("boolean"==typeof e)i="bool";else{if("string"!=typeof e)return;i="sampler2D"}var n="";return n+="".concat(i," ").concat(t),r&&(n+="[".concat(r,"]")),n+";\n"},defineUniform:function(t,e){var i=Bo.defineVariable(t,e);if(i)return"uniform "+i},isUniformDefined:function(t,e){var i=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+t+"\\b","g");return!!e.match(i)},isSymbolReferenced:function(t,e){var i=new RegExp("\\b"+t+"\\b","g");return 0<=e.search(i)},expandVec3:function(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(2!==t.length)return t;e=[].concat(Lr(t),[i]).map(parseFloat)}else e=[t,t,t].map(parseFloat);if(e&&e.every((function(t){return"number"==typeof t&&!isNaN(t)})))return e},expandVec4:function(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(3!==t.length)return t;e=[].concat(Lr(t),[i]).map(parseFloat)}else e=[t,t,t,i].map(parseFloat);if(e&&e.every((function(t){return"number"==typeof t&&!isNaN(t)})))return e}},Uo=[];function Vo(t,e){var i=Uo.filter((function(e){return e[0]===t}))[0];return(i=i&&i[1])||(Uo.push([t,{}]),i=Uo[Uo.length-1][1]),i[e]||(i[e]=t.getExtension(e)),i[e]}function qo(t){var e,i,r=0;if(0===t.length)return r;for(e=0,i=t.length;e<i;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return r}var Yo=a((function(t){var e="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",i=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,r=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,n=t.exports=function(t,e){return t?n.block(n.line(t,e),e):""};n.block=function(t,i){i=i||{};var r=new RegExp("\\/\\*"+e,"gm");return i.safe&&(r=new RegExp("\\/\\*(?!\\*?\\!)"+e,"gm")),t?t.replace(r,""):""},n.line=function(t,e){var n=i;return(e=e||{}).safe&&(n=r),t?t.replace(n,""):""}})),Wo=/^\s*#pragma.*$/gm,Zo=/\\\s*\n/gm,Ko=function(){function t(e,i,r,n,o){if(vr(this,t),o=o||{},this.textureManager=Lo(n),this.gl=e,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!t.polyfills[n]){t.polyfills[n]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch(e){t.polyfills[n].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(e,i,r){t.polyfills[n].uniformMatrix3fv.call(this,e,i,new Float32Array(r))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch(e){t.polyfills[n].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(e,i,r){t.polyfills[n].uniformMatrix4fv.call(this,e,i,new Float32Array(r))}}}this.defines=Object.assign({},o.defines||{}),this.blocks=Object.assign({},o.blocks||{}),this.block_scopes=Object.assign({},o.block_scopes||{}),this.extensions=o.extensions||[],this.dependent_uniforms=o.uniforms,this.uniforms={},this.attribs={},this.vertex_source=i,this.fragment_source=r,this.id=t.id++,this.name=o.name}return _r(t,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(t.current!==this&&this.gl.useProgram(this.program),t.current=this)}},{key:"compile",value:function(){var e=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var i,r=this.checkExtensions(),n=this.buildDefineList(),o=this.buildShaderBlockList();for(var a in o){var s,l,u,c=o[a];!c||Array.isArray(c)&&0===c.length||(i=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+a+"\\s*$","m"),s=this.computed_vertex_source.match(i),l=this.computed_fragment_source.match(i),null==s&&null==l||(u="",c.forEach((function(t){var e="".concat(t.scope,", ").concat(t.key,", ").concat(t.num);u+="\n// tangram-block-start: ".concat(e,"\n"),u+=t.source,u+="\n// tangram-block-end: ".concat(e,"\n")})),null!=s&&(this.computed_vertex_source=this.computed_vertex_source.replace(i,u)),null!=l&&(this.computed_fragment_source=this.computed_fragment_source.replace(i,u)),n["TANGRAM_BLOCK_"+a.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(Wo,""),this.computed_fragment_source=this.computed_fragment_source.replace(Wo,""),this.ensureUniforms(this.dependent_uniforms);var h=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),p=h&&0<h.precision?"precision highp float;\n":"precision mediump float;\n";n.TANGRAM_VERTEX_SHADER=!0,n.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=p+t.buildDefineString(n)+this.computed_vertex_source,n.TANGRAM_VERTEX_SHADER=!1,n.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=t.buildExtensionString(r)+p+t.buildDefineString(n)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(Zo,""),this.computed_fragment_source=this.computed_fragment_source.replace(Zo,"");try{this.program=t.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(r){throw this.program=null,this.compiled=!1,this.compiling=!1,"vertex"!==(this.error=r).type&&"fragment"!==r.type||(this.shader_errors=r.errors,this.shader_errors.forEach((function(t){t.type=r.type,t.block=e.block(r.type,t.line)}))),r}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var e,i={};for(e in t.defines)i[e]=t.defines[e];for(e in this.defines)i[e]=this.defines[e];return i}},{key:"buildShaderBlockList",value:function(){var e,i,r={};for(e in t.blocks)r[e]=[],Array.isArray(t.blocks[e])?(i=r[e]).push.apply(i,Lr(t.blocks[e].map((function(t,i){return{key:e,source:t,num:i,scope:"ShaderProgram"}})))):r[e]=[{key:e,source:t.blocks[e],num:0,scope:"ShaderProgram"}];for(e in this.blocks)if(r[e]=r[e]||[],Array.isArray(this.blocks[e]))for(var n=this.block_scopes&&this.block_scopes[e]||[],o=null,a=0,s=0;s<this.blocks[e].length;s++)n[s]!==o&&(o=n[s],a=0),r[e].push({key:e,source:this.blocks[e][s],num:a,scope:o||this.name}),a++;else r[e].push({key:e,source:this.blocks[e],num:0,scope:this.name});return r}},{key:"ensureUniforms",value:function(t){if(t){var e,i=Yo(this.computed_vertex_source),r=Yo(this.computed_fragment_source),n=[],o=[];for(var a in t){var s=Bo.isUniformDefined(a,i),l=Bo.isUniformDefined(a,r);if(!s||!l){if(!(e=Bo.defineUniform(a,t[a])))continue;s||(En("trace","Program ".concat(this.name,": ").concat(a," not defined in vertex shader, injecting: '").concat(e,"'")),n.push(e)),l||(En("trace","Program ".concat(this.name,": ").concat(a," not defined in fragment shader, injecting: '").concat(e,"'")),o.push(e))}}0<n.length&&(this.computed_vertex_source=n.join("\n")+this.computed_vertex_source),0<o.length&&(this.computed_fragment_source=o.join("\n")+this.computed_fragment_source)}}},{key:"setUniforms",value:function(t,e){var i=!(1<arguments.length&&void 0!==e)||e;if(this.compiled){i&&(this.texture_unit=0);for(var r=Bo.parseUniforms(t),n=0;n<r.length;n++){var o=r[n];"sampler2D"===o.type?this.setTextureUniform(o.name,o.value):this.uniform(o.method,o.name,o.value)}}}},{key:"saveUniforms",value:function(t){var e=t||this.uniforms;for(var i in e){var r=this.uniforms[i];r&&(r.saved_value=r.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(t){var e=t||this.uniforms;for(var i in e){var r=this.uniforms[i];r&&r.saved_value&&(r.value=r.saved_value,this.updateUniform(r))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(t,e){var i=this.textureManager.textures[e];null!=i?(i.bind(this.texture_unit),this.uniform("1i",t,this.texture_unit),this.texture_unit++):En("warn","Cannot find texture '".concat(e,"'"))}},{key:"uniform",value:function(t,e,i){var r;this.compiled&&(this.uniforms[e]=this.uniforms[e]||{},(r=this.uniforms[e]).name=e,void 0===r.location&&(r.location=this.gl.getUniformLocation(this.program,e)),r.method=t,r.value=i,this.updateUniform(r))}},{key:"updateUniform",value:function(t){this.compiled&&t&&null!=t.location&&(this.use(),this.commitUniform(t))}},{key:"commitUniform",value:function(t){var e=t.location,i=t.value;switch(t.method){case"1i":this.gl.uniform1i(e,i);break;case"1f":this.gl.uniform1f(e,i);break;case"2f":this.gl.uniform2f(e,i[0],i[1]);break;case"3f":this.gl.uniform3f(e,i[0],i[1],i[2]);break;case"4f":this.gl.uniform4f(e,i[0],i[1],i[2],i[3]);break;case"1iv":this.gl.uniform1iv(e,i);break;case"3iv":this.gl.uniform3iv(e,i);break;case"1fv":this.gl.uniform1fv(e,i);break;case"2fv":this.gl.uniform2fv(e,i);break;case"3fv":this.gl.uniform3fv(e,i);break;case"4fv":this.gl.uniform4fv(e,i);break;case"Matrix3fv":this.gl.uniformMatrix3fv(e,!1,i);break;case"Matrix4fv":this.gl.uniformMatrix4fv(e,!1,i)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var t in this.uniforms){var e=this.uniforms[t];e.location=this.gl.getUniformLocation(this.program,t),this.updateUniform(e)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(t){if(this.compiled){var e=this.attribs[t]=this.attribs[t]||{};return null!=e.location||(e.name=t,e.location=this.gl.getAttribLocation(this.program,t)),e}}},{key:"source",value:function(t){return"vertex"===t?this.computed_vertex_source:"fragment"===t?this.computed_fragment_source:void 0}},{key:"lines",value:function(t){var e=this.source(t);return e?e.split("\n"):[]}},{key:"line",value:function(t,e){var i=this.lines(t);if(i)return i[e]}},{key:"block",value:function(t,e){for(var i,r=this.lines(t),n=0;n<e&&n<r.length;n++){var o=r[n],a=o.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);a&&1<a.length?i={scope:a[1],name:a[2],num:a[3]}:(a=o.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<a.length&&(i=null),i&&(i.line=null==i.line?-1:i.line+1,i.source=o)}return i}},{key:"checkExtensions",value:function(){var t=this,e=[];return this.extensions.forEach((function(i){var r=Vo(t.gl,i),n="TANGRAM_EXTENSION_".concat(i);t.defines[n]=null!=r,r?e.push(i):En("debug","Could not enable extension '".concat(i,"'"))})),e}}]),t}();Ko.polyfills={},Ko.id=0,Ko.current=null,Ko.defines={},Ko.blocks={},Ko.reset=function(){Ko.programs_by_source={},Ko.shaders_by_source={}},Ko.reset(),Ko.buildDefineString=function(t){var e="";for(var i in t)null!=t[i]&&!1!==t[i]&&("boolean"==typeof t[i]&&!0===t[i]?e+="#define "+i+"\n":"number"==typeof t[i]&&Math.floor(t[i])===t[i]?e+="#define "+i+" "+t[i].toFixed(1)+"\n":e+="#define "+i+" "+t[i]+"\n");return e},Ko.buildExtensionString=function(t){var e="";return(t=t||[]).forEach((function(t){e+="#ifdef GL_".concat(t,"\n#extension GL_").concat(t," : enable\n#endif\n")})),e},Ko.addBlock=function(t){var e;Ko.blocks[t]=Ko.blocks[t]||[];for(var i=arguments.length,r=new Array(1<i?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];(e=Ko.blocks[t]).push.apply(e,r)},Ko.removeBlock=function(t){Ko.blocks[t]=[]},Ko.replaceBlock=function(t){Ko.removeBlock(t);for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];Ko.addBlock.apply(Ko,[t].concat(i))},Ko.updateProgram=function(t,e,i,r){var n=qo(t._tangram_id+"::"+i+"::"+r);if(Ko.programs_by_source[n])return En("trace","Reusing identical source GL program object"),Ko.programs_by_source[n];var o=Ko.createShader(t,i,t.VERTEX_SHADER),a=Ko.createShader(t,r,t.FRAGMENT_SHADER);if(t.useProgram(null),null!=e)for(var s=t.getAttachedShaders(e),l=0;l<s.length;l++)t.detachShader(e,s[l]);else e=t.createProgram();if(null==o||null==a)return e;if(t.attachShader(e,o),t.attachShader(e,a),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS))return Ko.programs_by_source[n]=e;var u=new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(t.getProgramParameter(e,t.VALIDATE_STATUS),"\n            ERROR: ").concat(t.getError(),"\n            --- Vertex Shader ---\n            ").concat(i,"\n            --- Fragment Shader ---\n            ").concat(r));throw Object.assign(new Error(u),{type:"program"})};var Xo,Jo={disabled:!(Ko.createShader=function(t,e,i){var r=qo(t._tangram_id+"::"+e);if(Ko.shaders_by_source[r])return En("trace","Reusing identical source GL shader object"),Ko.shaders_by_source[r];var n=t.createShader(i);if(t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return Ko.shaders_by_source[r]=n;var o=i===t.VERTEX_SHADER?"vertex":"fragment",a=t.getShaderInfoLog(n),s=function(t){t=String(t);for(var e,i=[];e=t.match(/ERROR\:([^\n]+)/);){t=t.slice(e.index+1);var r=(a=e[1].trim()).split(":"),n=r.slice(2).join(":").trim(),o=parseInt(r[0],10),a=parseInt(r[1],10);i.push({message:n,file:o,line:a})}return i}(a);throw Object.assign(new Error(a),{type:o,errors:s})}),bound_vao:[],init:function(t){var e;!0!==this.disabled&&(e=Vo(t,"OES_vertex_array_object")),null!=e?En("info","Vertex Array Object extension available"):!0!==this.disabled?En("warn","Vertex Array Object extension NOT available"):En("warn","Vertex Array Object extension force disabled")},create:function(t,e,i){var r={};r.setup=e,r.teardown=i;var n=Vo(t,"OES_vertex_array_object");return null!=n&&(r._vao=n.createVertexArrayOES(),n.bindVertexArrayOES(r._vao)),r.setup(!0),r},getCurrentBinding:function(t){var e=this.bound_vao.filter((function(e){return e[0]===t}))[0];return e&&e[1]},setCurrentBinding:function(t,e){var i=this.bound_vao,r=i.filter((function(e){return e[0]===t}))[0];null==r?i.push([t,e]):r[1]=e},bind:function(t,e){var i,r=Vo(t,"OES_vertex_array_object");null!=e?null!=r&&null!=e._vao?(r.bindVertexArrayOES(e._vao),this.setCurrentBinding(t,e)):e.setup(!1):(i=this.getCurrentBinding(t),null!=r?r.bindVertexArrayOES(null):null!=i&&"function"==typeof i.teardown&&i.teardown(),this.setCurrentBinding(t,null))},destroy:function(t,e){var i=Vo(t,"OES_vertex_array_object");null!=i&&null!=e&&null!=e._vao&&(i.deleteVertexArrayOES(e._vao),e._vao=null)}},Qo=function(){function t(e,i,r,n,o,a){vr(this,t),a=a||{},this.textureManager=Lo(o),this.gl=e,this.vertex_data=i,this.element_data=r,this.vertex_layout=n,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=a.draw_mode||this.gl.TRIANGLES,this.data_usage=a.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=a.uniforms,this.textures=a.textures,this.retain=a.retain||!1,this.created_at=+new Date,this.fade_in_time=a.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return _r(t,[{key:"render",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};if(!this.valid)return!1;var i=e.program||Ko.current;i.use(),this.uniforms&&(i.saveUniforms(this.uniforms),i.setUniforms(this.uniforms,!1));var r=(new Date-this.created_at)/1e3;return i.uniform("1f","u_visible_time",r),this.bind(i),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),Jo.bind(this.gl,null),this.uniforms&&i.restoreUniforms(this.uniforms),r<this.fade_in_time}},{key:"bind",value:function(t){var e=this,i=this.vaos[t.id];i?Jo.bind(this.gl,i):this.vaos[t.id]=Jo.create(this.gl,(function(i){e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.vertex_buffer),e.toggle_element_array&&e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.element_buffer),e.vertex_layout.enable(e.gl,t,i)}))}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var t=this;if(!this.valid)return!1;for(var e in this.valid=!1,this.vaos)Jo.destroy(this.gl,this.vaos[e]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach((function(e){return t.textureManager.release(e)})),!0}}]),t}(),$o=["emission","ambient","diffuse","specular"],ta=function(){function t(e){var i=this;vr(this,t),e=e||{},$o.forEach((function(t){var r=e[t];null!=r&&(r.texture?i[t]={texture:r.texture,mapping:r.mapping||"spheremap",scale:Bo.expandVec3(null!=r.scale?r.scale:1),amount:Bo.expandVec4(null!=r.amount?r.amount:1)}:"number"==typeof r||Array.isArray(r)?i[t]={amount:Bo.expandVec4(r)}:i[t]="string"==typeof r?{amount:yo.parseColor(r)}:r)})),this.specular&&(this.specular.shininess=e.shininess?parseFloat(e.shininess):.2),null!=e.normal&&(this.normal={texture:e.normal.texture,mapping:e.normal.mapping||"triplanar",scale:Bo.expandVec3(null!=e.normal.scale?e.normal.scale:1),amount:null!=e.normal.amount?e.normal.amount:1})}return _r(t,[{key:"inject",value:function(e){var i=this;$o.forEach((function(t){var r="TANGRAM_MATERIAL_".concat(t.toUpperCase()),n=r+"_TEXTURE";e.defines[r]=null!=i[t],i[t]&&i[t].texture&&(e.defines[n]=!0,e.defines[n+"_"+i[t].mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(i[t].mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===i[t].mapping)})),this.normal&&this.normal.texture&&(e.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,e.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===this.normal.mapping),e.replaceShaderBlock(t.block,"/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}","Material"),e.addShaderBlock("setup","\nmaterial = u_material;\n","Material")}},{key:"setupProgram",value:function(t){var e=this;$o.forEach((function(i){e[i]&&(e[i].texture?(t.setTextureUniform("u_material_".concat(i,"_texture"),e[i].texture),t.uniform("3fv","u_material.".concat(i,"Scale"),e[i].scale),t.uniform("4fv","u_material.".concat(i),e[i].amount)):e[i].amount&&t.uniform("4fv","u_material.".concat(i),e[i].amount))})),this.specular&&t.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(t.setTextureUniform("u_material_normal_texture",this.normal.texture),t.uniform("3fv","u_material.normalScale",this.normal.scale),t.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(t){return null!=t&&(null!=t.emission||null!=t.ambient||null!=t.diffuse||null!=t.specular)}}]),t}();ta.block="material";var ea=Xo={};Xo.copy=function(t){for(var e=[],i=t.length,r=0;r<i;r++)e[r]=t[r];return e},Xo.neg=function(t){for(var e=[],i=t.length,r=0;r<i;r++)e[r]=-t[r];return e},Xo.add=function(t,e){for(var i=[],r=Math.min(t.length,e.length),n=0;n<r;n++)i[n]=t[n]+e[n];return i},Xo.sub=function(t,e){for(var i=[],r=Math.min(t.length,e.length),n=0;n<r;n++)i[n]=t[n]-e[n];return i},Xo.signed_area=function(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])},Xo.mult=function(t,e){var i,r=[],n=t.length;if("number"==typeof e)for(i=0;i<n;i++)r[i]=t[i]*e;else for(n=Math.min(t.length,e.length),i=0;i<n;i++)r[i]=t[i]*e[i];return r},Xo.multMatrix=function(t,e){return[t[0][0]*e[0]+t[0][1]*e[1],t[1][0]*e[0]+t[1][1]*e[1]]},Xo.div=function(t,e){var i=[];if("number"==typeof e)for(n=0;n<t.length;n++)i[n]=t[n]/e;else for(var r=Math.min(t.length,e.length),n=0;n<r;n++)i[n]=t[n]/e[n];return i},Xo.perp=function(t,e){return[e[1]-t[1],t[0]-e[0]]},Xo.rot=function(t,e){var i=Math.cos(e),r=Math.sin(e);return[t[0]*i-t[1]*r,t[0]*r+t[1]*i]},Xo.angle=function(t){var e=Or(t,2),i=e[0],r=e[1];return Math.atan2(r,i)},Xo.angleBetween=function(t,e){var i=Xo.dot(Xo.normalize(Xo.copy(t)),Xo.normalize(Xo.copy(e)));return 1<i&&(i=1),Math.acos(i)},Xo.signedAngleBetween=function(t,e){return Math.atan2(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])},Xo.isEqual=function(t,e){for(var i=t.length,r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0},Xo.lengthSq=function(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:3<=t.length?t[0]*t[0]+t[1]*t[1]+t[2]*t[2]:0},Xo.length=function(t){return Math.sqrt(Xo.lengthSq(t))},Xo.normalize=function(t){var e;if(2===t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e):(t[0]=0,t[1]=0)}else if(3<=t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0)}return t},Xo.cross=function(t,e){return 2===t.length?t[0]*e[1]-t[1]*e[0]:3===t.length?[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]:void 0},Xo.dot=function(t,e){for(var i=0,r=Math.min(t.length,e.length),n=0;n<r;n++)i+=t[n]*e[n];return i};var ia=function(){function t(e,i){vr(this,t),this.name=i.name,this.view=e,null==i.ambient||"number"==typeof i.ambient?this.ambient=Bo.expandVec3(i.ambient||0):this.ambient=yo.parseColor(i.ambient).slice(0,3),null==i.diffuse||"number"==typeof i.diffuse?this.diffuse=Bo.expandVec3(null!=i.diffuse?i.diffuse:1):this.diffuse=yo.parseColor(i.diffuse).slice(0,3),null==i.specular||"number"==typeof i.specular?this.specular=Bo.expandVec3(i.specular||0):this.specular=yo.parseColor(i.specular).slice(0,3)}return _r(t,[{key:"inject",value:function(){var e="\n            uniform ".concat(this.struct_name," u_").concat(this.name,";\n            ").concat(this.struct_name," ").concat(this.name,";\n            "),i="\n            ".concat(this.name," = u_").concat(this.name,";\n\n        ");Ko.addBlock(t.block,e),Ko.addBlock("setup",i)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),t.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),t.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(e,i){if(t.types[i.type])return new t.types[i.type](e,i)}},{key:"setMode",value:function(e,i){!0===e&&(e="fragment"),e=t.enabled&&(null!=e?e:"fragment"),i.defines.TANGRAM_LIGHTING_FRAGMENT="fragment"===e,i.defines.TANGRAM_LIGHTING_VERTEX="vertex"===e}},{key:"inject",value:function(e){if(Ko.removeBlock(t.block),t.enabled){var i="";if(e&&0<Object.keys(e).length){var r={};for(var n in e)r[e[n].type]=!0;for(var o in r)t.types[o].inject();for(var a in e)e[a].inject(),i+="calculateLight(".concat(a,", _eyeToPoint, _normal);\n")}var s="\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(i,"\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");Ko.addBlock(t.block,s)}}}]),t}();ia.types={},ia.block="lighting",ia.enabled=!0;var ra=function(){wr(e,ia);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).type="ambient",n.struct_name="AmbientLight",n}return _r(e,[{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){Ko.addBlock(ia.block,"/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}")}}]),e}();ia.types.ambient=ra;var na=function(){wr(e,ia);var t=Mr(e);function e(i,r){var n,o;return vr(this,e),(n=t.call(this,i,r)).type="directional",n.struct_name="DirectionalLight",r.direction?n._direction=r.direction:(o=Math.sin(60*Math.PI/180),n._direction=[Math.cos(135*Math.PI/180)*o,Math.sin(135*Math.PI/180)*o,-.5]),null==r.ambient&&(n.ambient=Bo.expandVec3(.5)),n.direction=n._direction.map(parseFloat),n._initial_direction=[n.direction[0],n.direction[1],n.direction[2]],n}return _r(e,[{key:"update",value:function(){No(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(t){Ir(xr(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=ea.normalize(ea.copy(t))}}],[{key:"inject",value:function(){Ko.addBlock(ia.block,"/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}")}}]),e}();ia.types.directional=na;var oa=function(){wr(e,ia);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).type="point",n.struct_name="PointLight",n.position=r.position||[0,0,"100px"],n.position_eye=[],n.origin=r.origin||"ground",n.attenuation=isNaN(parseFloat(r.attenuation))?0:parseFloat(r.attenuation),r.radius?Array.isArray(r.radius)&&2===r.radius.length?n.radius=r.radius:n.radius=[null,r.radius]:n.radius=null,n}return _r(e,[{key:"inject",value:function(){Ir(xr(e.prototype),"inject",this).call(this),Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=0!==this.attenuation,Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=null!=this.radius&&null!=this.radius[0],Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=null!=this.radius}},{key:"update",value:function(){var t,e,i,r=this.view.lookAtManipulator.getLookAtData().zoom;"world"===this.origin?(e=(t=Or(Qr.latLngToMeters(this.position),2))[0],i=t[1],this.position_eye[0]=e-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=i-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=yo.convertUnits(this.position[2],{zoom:r,meters_per_pixel:Qr.metersPerPixel(r)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):"ground"!==this.origin&&"camera"!==this.origin||(this.position_eye=yo.convertUnits(this.position,{zoom:r,meters_per_pixel:Qr.metersPerPixel(r)}),"ground"===this.origin&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(t){Ir(xr(e.prototype),"setupProgram",this).call(this,t),t.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&t.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var i=this.view.lookAtManipulator.getLookAtData().zoom;Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&t.uniform("1f","u_".concat(this.name,".innerRadius"),yo.convertUnits(this.radius[0],{zoom:i,meters_per_pixel:Qr.metersPerPixel(i)})),Ko.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&t.uniform("1f","u_".concat(this.name,".outerRadius"),yo.convertUnits(this.radius[1],{zoom:i,meters_per_pixel:Qr.metersPerPixel(i)}))}}],[{key:"inject",value:function(){Ko.addBlock(ia.block,"/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}")}}]),e}();ia.types.point=oa;var aa=function(){wr(e,oa);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).type="spotlight",n.struct_name="SpotLight",n.direction=n._direction=(r.direction||[0,0,-1]).map(parseFloat),n._initial_direction=[n.direction[0],n.direction[1],n.direction[2]],n.exponent=r.exponent?parseFloat(r.exponent):.2,n.angle=r.angle?parseFloat(r.angle):20,n}return _r(e,[{key:"setupProgram",value:function(t){Ir(xr(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction),t.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),t.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){Ir(xr(e.prototype),"update",this).call(this),No(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=ea.normalize(ea.copy(t))}}],[{key:"inject",value:function(){Ko.addBlock(ia.block,"/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}")}}]),e}();function sa(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(i)for(var r in i){var n=i[r];null===n||"object"!==gr(n)||Array.isArray(n)?void 0!==n&&(t[r]=n):null===t[r]||"object"!==gr(t[r])||Array.isArray(t[r])?t[r]=sa({},n):t[r]=sa(t[r],n)}}return t}ia.types.spotlight=aa;var la="#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n",ua={init:function(t){var e=0<arguments.length&&void 0!==t?t:{},i=e.generation,r=e.styles,n=e.sources,o=void 0===n?{}:n,a=e.introspection,s=e.id,l=void 0!==s?s+"/":"";this.scene_id=s,this.textureManager=Lo(s),this.main_thread_target="".concat(l,"Style/").concat(this.name),this.setGeneration(i),this.styles=r,this.sources=o,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=a||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,null==this.blend_order&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof ta||(ta.isValid(this.material)||(this.material=yo.defaults.material),this.material=new ta(this.material)),this.material.inject(this),ia.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),un.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(t){this.generation=t,ln.is_main&&un.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(t,e,i,r){var n=r.size,o=void 0===(o=r.offset)?0:o,a=t.index[e];if(void 0!==a)for(var s=0;s<n;++s){var l=i.length>s?i[s]:i;this.vertex_template[a+s+o]=l}else En("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(e,"'"))},startData:function(t){this.tile_data[t.id]=this.tile_data[t.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(t){var e=this.tile_data[t.id];if(this.tile_data[t.id]=null,e&&0<Object.keys(e.meshes).length){for(var i in e.meshes){var r=e.meshes[i];0!==r.vertex_data.vertex_count?(r.vertex_data.end(),r.vertex_elements=r.vertex_data.element_buffer,r.vertex_data=r.vertex_data.vertex_buffer):delete e.meshes[i]}return t.mesh_data[this.name]=e,this.buildRasterTextures(t,e).then((function(t){return t}))}return Promise.resolve(null)},hasDataForTile:function(t){return null!=this.tile_data[t.id]},getTileMesh:function(t,e){var i=this.tile_data[t.id].meshes;return null==i[e.key]&&(i[e.key]={variant:e,vertex_data:this.vertexLayoutForMeshVariant(e).createVertexData()}),i[e.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(t,e){this.style_mesh_variants[t]||(this.style_mesh_variants[t]={variants:{}});var i=this.computeVariantForDraw(e);return this.style_mesh_variants[t].variants[i.key]={variant:i,times_unref:0},this.style_mesh_variants[t].variants[i.key].variant},getMeshVariantTypeForDraw:function(t){return this.getMeshVariantType(this.base,t)},getMeshVariantType:function(t,e){void 0===t&&(t="default");var i=this.style_mesh_variants[t];if(void 0===e.variantKey||!i||!i.variants[e.variantKey])return this.addMeshVariantForDraw(t,e);var r=e.variantKey,n=i.variants[r];return n.times_unref=0,n.variant},updateMeshVariantTypeCache:function(t){for(var e in this.style_mesh_variants){var i=this.style_mesh_variants[e].variants;for(var r in i){var n=i[r];n.times_unref++,n.times_unref>t&&("default"!==e||0!=+r)&&(delete i[r],0===Object.keys(i).length&&delete this.style_mesh_variants[e])}}},computeVariantForDraw:function(){return this.default_mesh_variant},addFeature:function(t,e,i){var r=i.tile;this.tile_data[r.id]||this.startData(r);var n,o,a,s,l=this.parseFeature(t,e,i);l&&(n="lines"===this.base?this.getMeshVariantTypeForDraw(e):this.getMeshVariantTypeForDraw(l),a=(o=this.getTileMesh(r,n)).vertex_data.offset,s=o.vertex_data.vertex_count,0<this.buildGeometry(t.geometry,l,o,i)?t.generation=this.generation:o.vertex_data.vertex_count>s&&(o.vertex_data.vertex_buffer.fill(0,a,o.vertex_data.offset),o.vertex_data.vertex_count=s,o.vertex_data.offset=a))},buildGeometry:function(t,e,i,r){var n;return"Polygon"===t.type?n=this.buildPolygons([t.coordinates],e,i,r):"MultiPolygon"===t.type?n=this.buildPolygons(t.coordinates,e,i,r):"LineString"===t.type?n=this.buildLines([t.coordinates],e,i,r):"MultiLineString"===t.type?n=this.buildLines(t.coordinates,e,i,r):"Point"===t.type?n=this.buildPoints([t.coordinates],e,i,r):"MultiPoint"===t.type&&(n=this.buildPoints(t.coordinates,e,i,r)),n},parseFeature:function(t,e,i){try{var r,n,o,a=this.feature_style;if(a.order=this.parseOrder(e.order,i),null==a.order&&"overlay"!==this.blend){var s="Layer '".concat(e.layers.join(", "),"', draw group '").concat(e.group,"': ");return s+="'order' parameter is required unless blend mode is 'overlay'",null!=e.order&&(s+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",s+="or JS function), but evaluated to null for one or more features"),void En({level:"warn",once:!0},s)}if(!(a=this._parseFeature(t,e,i)))return;return this.selection?a.interactive=yo.evalProperty(this.introspection||e.interactive,i):a.interactive=!1,!0===a.interactive?(n=(r=Ho.makeEntry()).color,o=r.key,a.selection_color=n,i.tile.selection_data||(i.tile.selection_data={}),i.tile.selection_data[o]={id:t.id||o,properties:t.properties,source_name:i.source,source_layer:i.layer,layers:i.layers}):a.selection_color=Ho.defaultColor,a}catch(e){En("error","Style.parseFeature: style parsing error",t,a,e.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(t,e){if(!t.preprocessed){if(this.draw)for(var i in this.draw){var r=this.draw[i];"object"!==gr(r)||Array.isArray(r)?null==t[i]&&(t[i]=r):t[i]=sa({},r,t[i])}var n=e||"";if(!(t=this._preprocess(t,n)))return;t.preprocessed=!0}return t},_preprocess:function(t){return t},parseOrder:function(t,e){return"number"!=typeof t?yo.calculateOrder(t,e):t},scaleOrder:function(t){return 2*t},parseColor:function(t,e){return t?yo.evalCachedColorProperty(t,e):this.shaders.blocks.color||this.shaders.blocks.filter?yo.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(t){this.gl=t,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:{},n=this.vertexLayoutForMeshVariant(r.variant);return new Qo(this.gl,t,e,n,this.scene_id,r)},render:function(t){return t.render()},getProgram:function(t){var e=0<arguments.length&&void 0!==t?t:"program";this.compileSetup();var i=this[e];if(i&&!i.error){if(!i.compiled)try{i.compile()}catch(t){En("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(e,"')"),this,t.stack)}return i}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var t,e=this.buildDefineList();this.selection&&((t=Object.assign({},e)).TANGRAM_FEATURE_SELECTION=!0);var i=this.shaders&&this.shaders.blocks,r=this.shaders&&this.shaders.block_scopes,n=Object.assign({},this.shaders&&this.shaders.uniforms);for(var o in n)null==n[o]&&En({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(o,"': uniform values must be non-null"));var a=this.shaders&&this.shaders.extensions;"string"==typeof a&&(a=[a]),this.program=new Ko(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:e,uniforms:n,blocks:i,block_scopes:r,extensions:a}),this.selection?this.selection_program=new Ko(this.gl,this.vertex_shader_src,this.crop_by_tile?"\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}":"\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",this.scene_id,{name:this.name+" (selection)",defines:t,uniforms:n,blocks:i,block_scopes:r,extensions:a}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[t]=this.shaders.blocks[t]||[],this.shaders.blocks[t].push(e),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[t]=this.shaders.block_scopes[t]||[],this.shaders.block_scopes[t].push(r)},removeShaderBlock:function(t){this.shaders.blocks&&(this.shaders.blocks[t]=null)},replaceShaderBlock:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:null;this.removeShaderBlock(t),this.addShaderBlock(t,e,r)},buildDefineList:function(){var t={};if(null!=this.defines)for(var e in this.defines)t[e]=this.defines[e];if(null!=this.shaders&&null!=this.shaders.defines)for(e in this.shaders.defines)t[e]=this.shaders.defines[e];return t},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!ln.is_main)return!1;if(!this.hasRasters())return!1;"color"===this.raster?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:"normal"===this.raster&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var t=!1;for(var e in this.sources)if(this.sources[e]instanceof da){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",la,"Raster"),!0)},buildRasterTextures:function(t,e){var i=this;if(!this.hasRasters())return Promise.resolve(e);var r={};return t.rasters.map((function(t){return i.sources[t]})).filter((function(t){return t})).forEach((function(e,i){var n;e instanceof da&&(n=e.tileTexture(t),r[n.url]=n)})),0===Object.keys(r).length?Promise.resolve(e):un.postMessage(this.main_thread_target+".loadTextures",r).then((function(i){if(!i||i.length<1)return En("trace","Missing texture info for tile ".concat(t.key)),null;if(i.some((function(t){return!t.loaded})))return null;e.uniforms=e.uniforms||{},e.textures=e.textures||[];var n,o,a=i[0].name,s=r[a].coords;return e.uniforms.u_raster=a,e.textures.push(a),t.coords.z>s.z?(n=t.coords.z-s.z,o=Math.pow(2,n),e.uniforms.u_raster_offset=[(t.coords.x%o+o)%o/o,(o-1-t.coords.y%o)/o,1/o]):e.uniforms.u_raster_offset=[0,0,1],e}))},loadTextures:function(t){var e=this;return this.textureManager.createFromObject(this.gl,t).then((function(){return Promise.all(Object.keys(t).map((function(t){return e.textureManager.textures[t]&&e.textureManager.textures[t].load()})).filter((function(t){return t})))})).then((function(t){return t.forEach((function(t){return t.retain()})),t.map((function(t){return{name:t.name,width:t.width,height:t.height,loaded:t.loaded}}))}))},setup:function(){this.setUniforms(),this.material.setupProgram(Ko.current)},setUniforms:function(){var t=Ko.current;t&&t.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(t){var e=[],i={};for(var r in t.forEach((function(t){var e=parseInt(t.name,10)||0;i[e]||(i[e]=[]),i[e].push(t)})),i)e.push.apply(e,Lr(i[r].sort(ua.blendOrderSort)));return e},blendOrderSort:function(t,e){return"opaque"===t.blend||"opaque"===e.blend?"opaque"===t.blend&&"opaque"===e.blend?t.name<e.name?-1:1:"opaque"===t.blend?-1:1:t.blend_order<e.blend_order||!(t.blend_order>e.blend_order)&&(ua.default_blend_orders[t.blend]<ua.default_blend_orders[e.blend]||!(ua.default_blend_orders[t.blend]>ua.default_blend_orders[e.blend])&&t.name<e.name)?-1:1}},ca=0,ha=0,pa=function(){function t(e){var i=e.coords,r=e.style_zoom,n=e.source,o=e.worker,a=e.view,s=e.sceneId;vr(this,t),this.textureManager=Lo(s),this.id=ca++,this.worker=o,this.view=a,this.source=n,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=r,this.coords=t.normalizedCoordinate(i,this.source,this.style_zoom),this.key=t.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Qr.metersForTile(this.coords),this.max=Qr.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Qr.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Qr.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Qr.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return _r(t,[{key:"freeResources",value:function(){for(var t in this.meshes)this.meshes[t].forEach((function(t){return t.destroy()}));this.meshes={}}},{key:"destroy",value:function(){To.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return un.postMessage.apply(un,[this.worker].concat(e))}},{key:"build",value:function(t,e){var i=(1<arguments.length&&void 0!==e?e:{}).fade_in,r=void 0===i||i;return this.generation=t,this.fade_in=r,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(t,e){if(!this.error){this.build_id=ha++;var i={},r=this.mesh_data;if(r)for(var n in r){for(var o in r[n].meshes){var a=r[n].meshes[o];if(a.vertex_data){if(!t[n]){En("warn","Could not create mesh because style '".concat(n,"' not found, for tile ").concat(this.key,", aborting tile"));break}var s=Object.assign({},r[n]);s.uniforms=Object.assign({},s.uniforms,a.uniforms),s.variant=a.variant,a.textures&&(s.textures=a.textures),a.labels&&(s.retain=!0);var l=t[n].makeMesh(a.vertex_data,a.vertex_elements,s);l.variant=s.variant,l.labels=a.labels,i[n]=i[n]||[],i[n].push(l),null==l.variant.order&&(l.variant.order=i[n].length-1)}}i[n]&&i[n].sort((function(t,e){var i=t.variant.order,r=e.variant.order;return null!=i&&(null==r||i<r)?-1:1}))}for(var u in delete this.mesh_data,i)this.meshes[u]&&this.meshes[u].forEach((function(t){return t.destroy()})),this.meshes[u]=i[u],this.new_mesh_styles.push(u);if(e.done){for(var c in this.meshes)-1===this.new_mesh_styles.indexOf(c)&&(this.meshes[c].forEach((function(t){return t.destroy()})),delete this.meshes[c]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(t){t?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(t),this.proxy_depth=1,t.proxied_as=t.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return null!=this.proxy_for}},{key:"shouldProxyForStyle",value:function(t){return!this.proxy_for||this.proxy_for.some((function(e){return null==e.meshes[t]}))}},{key:"setupProgram",value:function(t,e){var i=t.model,r=t.model32;e.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),e.uniform("1f","u_tile_proxy_depth",this.proxy_depth),Do(i),jo(i,i,Ro(this.min.x,this.min.y,0)),function(t,e,i){var r=i[0],n=i[1],o=i[2];t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(i,i,Ro(this.span.x/Qr.tile_scale,-1*this.span.y/Qr.tile_scale,1)),function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(r,i),e.uniform("Matrix4fv","u_model",r),e.uniform("1i","u_tile_fade_in",this.fade_in&&"child"!==this.proxied_as)}},{key:"merge",value:function(t){return this.loading=t.loading,this.loaded=t.loaded,this.generation=t.generation,this.error=t.error,this.mesh_data=t.mesh_data,this.selection_data?Object.assign(this.selection_data,t.selection_data):this.selection_data=t.selection_data,this}}],[{key:"coord",value:function(e){return{x:e.x,y:e.y,z:e.z,key:t.coordKey(e)}}},{key:"coordKey",value:function(t){return t.x+"/"+t.y+"/"+t.z}},{key:"key",value:function(t,e,i){if(!(t.y<0||t.y>=1<<t.z||t.z<0))return[e.name,i,t.x,t.y,t.z].join("/")}},{key:"normalizedKey",value:function(e,i,r){return t.key(t.normalizedCoordinate(e,i,r),i,r)}},{key:"normalizedCoordinate",value:function(e,i){return i.zoom_bias&&(e=t.coordinateAtZoom(e,Math.max(0,e.z-i.zoom_bias))),t.coordinateWithMaxZoom(e,i.max_zoom)}},{key:"coordinateAtZoom",value:function(e,i){var r,n=e.x,o=e.y,a=e.z;return a!==i&&(r=Math.pow(2,a-i),n=Math.floor(n/r),o=Math.floor(o/r),a=i),t.coord({x:n,y:o,z:a})}},{key:"coordinateWithMaxZoom",value:function(e,i){var r=e.x,n=e.y,o=e.z;return void 0!==i&&i<o?t.coordinateAtZoom({x:r,y:n,z:o},i):t.coord({x:r,y:n,z:o})}},{key:"childrenForCoordinate",value:function(e){var i=e.x,r=e.y,n=e.z,o=e.key;return t.coord_children[o]||(n++,i*=2,r*=2,t.coord_children[o]=[t.coord({x:i,y:r,z:n}),t.coord({x:i+1,y:r,z:n}),t.coord({x:i,y:r+1,z:n}),t.coord({x:i+1,y:r+1,z:n})]),t.coord_children[o]}},{key:"isDescendant",value:function(e,i){if(i.z>e.z){var r=t.coordinateAtZoom(i,e.z),n=r.x,o=r.y;return e.x===n&&e.y===o}return!1}},{key:"cancel",value:function(e){e&&(e.canceled=!0,e.source_data&&e.source_data.request_id&&(Tn.cancelRequest(e.source_data.request_id),e.source_data.request_id=null),t.abortBuild(e))}},{key:"buildGeometry",value:function(e,i){var r=i.scene_id,n=i.layers,o=i.styles,a=i.global,s=i.sources,l=i.meshVariantMaxLife,u=e.source_data;for(var c in Ao.startTile(e.id,{apply_repeat_groups:!0}),n){var h=n[c];if(h&&h.config_data){if(h.config_data.source===e.source)for(var p=t._getDataForSource(u,h.config_data,c),f=0;f<p.length;f++){var d=p[f],y=d.geom;if(y)for(var g=0;g<y.features.length;g++){var v=y.features[g];if(null!=v.geometry){var m=yo.getFeatureParseContext(v,e,a,s);m.winding=e.default_winding,m.source=e.source,m.layer=d.layer;var _=h.buildDrawGroups(m,!0);if(_)for(var b in _){var w=_[b],x=w.style||b,E=o[x];E?null!=(w=E.preprocess(w,e.source))&&!1!==w.visible&&(m.layers=w.layers,E.addFeature(v,w,m)):En("warn","Style '".concat(x,"' not found, skipping layer '").concat(c,"':"),w,v)}}}}}else En("warn","Layer ".concat(c," was defined without a geometry data source and will not be rendered."))}var A=t._stylesForTile(e,o);t._sendStyleGroups(e,A,{scene_id:r,meshVariantMaxLife:l},(function(t){return t.collision?"collision":"non-collision"}))}},{key:"_stylesForTile",value:function(t,e){var i=[];for(var r in e)e[r].hasDataForTile(t)&&i.push(e[r]);return i}},{key:"_sendStyleGroups",value:function(e,i,r,n){var o=r.scene_id,a=r.meshVariantMaxLife,s={};i.forEach((function(t){var e=n(t);s[e]=s[e]||[],s[e].push(t)})),0<Object.keys(s).length?function(){var i={start:!0};for(var r in e.mesh_data={},s)!function(r){var n=s[r];Promise.all(n.map((function(t){return t.endData(e)}))).then((function(){En("trace","Finished style group '".concat(r,"' for tile ").concat(e.key)),s[r]=[],Object.keys(s).every((function(t){return 0===s[t].length}))&&(i.done=!0),un.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),un.withTransferables({tile:t.slice(e,["mesh_data","selection_data"]),progress:i})),i.start=null,e.mesh_data={},e.selection_data={},i.done&&Ao.resetTile(e.id)}),(function(t){En("error","Error for style group '".concat(r,"' for tile ").concat(e.key),t)}))}(r);ua.updateMeshVariantTypeCache(a)}():(un.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),un.withTransferables({tile:t.slice(e),progress:{start:!0,done:!0}})),Ao.resetTile(e.id))}},{key:"_getDataForSource",value:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:null,n=[];return null!=e&&null!=t&&null!=t.layers&&(!e.layer&&t.layers._default||"string"==typeof e.layer&&!t.layers[e.layer]&&new RegExp("^\\d+_"+e.layer+"$").test(r)&&t.layers._default?n.push({geom:t.layers._default}):!e.layer&&r?n.push({layer:r,geom:t.layers[r]}):"string"==typeof e.layer?n.push({layer:e.layer,geom:t.layers[e.layer]}):Array.isArray(e.layer)&&e.layer.forEach((function(e){t.layers[e]&&t.layers[e].features&&n.push({layer:e,geom:t.layers[e]})}))),n}},{key:"abortBuild",value:function(t,e){if(To.removeForTile(t.id),Ao.abortTile(t.id),t.mesh_data)for(var i in t.mesh_data){var r=t.mesh_data[i].textures;r&&r.forEach((function(i){var r=Lo(e).textures[i];r&&(En("trace","releasing texture ".concat(i," for tile ").concat(t.key)),r.release())}))}}},{key:"slice",value:function(t,e){var i=["id","key","loading","loaded","generation","error","debug"];Array.isArray(e)&&i.push.apply(i,Lr(e));for(var r={},n=0;n<i.length;n++){var o=i[n];r[o]=t[o]}return r}}]),t}();pa.coord_children={};var fa,da=function(){wr(e,jn);var t=Mr(e);function e(i,r){var n;return vr(this,e),-1===(n=t.call(this,i,r)).rasters.indexOf(n.name)&&n.rasters.unshift(n.name),n.filtering=i.filtering,n.textures={},n}return _r(e,[{key:"load",value:function(t){t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=Lr(this.rasters);var e=Qr.tile_scale;return t.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[e,0],[e,-e],[0,-e],[0,0]]]},properties:{}}]}},t.default_winding="CW",Promise.resolve(t)}},{key:"tileTexture",value:function(t){var e,i,r=t.coords.key;return this.textures[r]||(e=pa.coordinateWithMaxZoom(t.coords,this.max_zoom),i=this.formatUrl(this.url,{coords:e}),this.textures[r]={url:i,filtering:this.filtering,coords:e}),this.textures[r]}}]),e}();Rn.register(da,"Raster");var ya=fa={};function ga(t,e,i,r){for(var n,o=r,a=i-e>>1,s=i-e,l=t[e],u=t[e+1],c=t[i],h=t[i+1],p=e+3;p<i;p+=3){var f,d=function(t,e,i,r,n,o){var a,s=n-i,l=o-r;return 0===s&&0===l||(1<(a=((t-i)*s+(e-r)*l)/(s*s+l*l))?(i=n,r=o):0<a&&(i+=s*a,r+=l*a)),(s=t-i)*s+(l=e-r)*l}(t[p],t[p+1],l,u,c,h);o<d?(n=p,o=d):d!==o||(f=Math.abs(p-a))<s&&(n=p,s=f)}r<o&&(3<n-e&&ga(t,e,n,r),t[n+2]=o,3<i-n&&ga(t,n,i,r))}function va(t,e,i,r){var n={id:void 0===t?null:t,type:e,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)ma(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<e.length;r++)ma(t,e[r]);else if("MultiPolygon"===i)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)ma(t,e[r][n])}(n),n}function ma(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function _a(t,e){var i=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)ba(i,t.features[r],e,r);else"Feature"===t.type?ba(i,t,e):ba(i,{geometry:t},e);return i}function ba(t,e,i,r){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===o)wa(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)wa(n[u],s);else if("LineString"===o)xa(n,s,a,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(u=0;u<n.length;u++)s=[],xa(n[u],s,a,!1),t.push(va(l,"LineString",s,e.properties));return}Ea(n,s,a,!1)}else if("Polygon"===o)Ea(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<e.geometry.geometries.length;u++)ba(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},i,r);return}for(u=0;u<n.length;u++){var c=[];Ea(n[u],c,a,!0),s.push(c)}}t.push(va(l,o,s,e.properties))}}function wa(t,e){e.push(Aa(t[0])),e.push(Ta(t[1])),e.push(0)}function xa(t,e,i,r){for(var n,o,a=0,s=0;s<t.length;s++){var l=Aa(t[s][0]),u=Ta(t[s][1]);e.push(l),e.push(u),e.push(0),0<s&&(a+=r?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=e.length-3;e[2]=1,ga(e,0,c,i),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Ea(t,e,i,r){for(var n=0;n<t.length;n++){var o=[];xa(t[n],o,i,r),e.push(o)}}function Aa(t){return t/360+.5}function Ta(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:1<i?1:i}function ka(t,e,i,r,n,o,a,s){if(r/=e,(i/=e)<=o&&a<r)return t;if(a<i||r<=o)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,f=0===n?c.minX:c.minY,d=0===n?c.maxX:c.maxY;if(i<=f&&d<r)l.push(c);else if(!(d<i||r<=f)){var y=[];if("Point"===p||"MultiPoint"===p)!function(t,e,i,r,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];i<=a&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}(h,y,i,r,n);else if("LineString"===p)Sa(h,y,i,r,n,!1,s.lineMetrics);else if("MultiLineString"===p)Ia(h,y,i,r,n,!1);else if("Polygon"===p)Ia(h,y,i,r,n,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var v=[];Ia(h[g],v,i,r,n,!0),v.length&&y.push(v)}if(y.length){if(s.lineMetrics&&"LineString"===p){for(g=0;g<y.length;g++)l.push(va(c.id,p,y[g],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===y.length?(p="LineString",y=y[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===y.length?"Point":"MultiPoint"),l.push(va(c.id,p,y,c.tags))}}}return l.length?l:null}function Sa(t,e,i,r,n,o,a){for(var s,l,u=Ma(t),c=0===n?La:Ca,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],y=t[p+2],g=t[p+3],v=t[p+4],m=0===n?f:d,_=0===n?g:v,b=!1;a&&(s=Math.sqrt(Math.pow(f-g,2)+Math.pow(d-v,2))),m<i?i<_&&(l=c(u,f,d,g,v,i),a&&(u.start=h+s*l)):r<m?_<r&&(l=c(u,f,d,g,v,r),a&&(u.start=h+s*l)):Oa(u,f,d,y),_<i&&i<=m&&(l=c(u,f,d,g,v,i),b=!0),r<_&&m<=r&&(l=c(u,f,d,g,v,r),b=!0),!o&&b&&(a&&(u.end=h+s*l),e.push(u),u=Ma(t)),a&&(h+=s)}var w=t.length-3;f=t[w],d=t[w+1],y=t[w+2],i<=(m=0===n?f:d)&&m<=r&&Oa(u,f,d,y),w=u.length-3,o&&3<=w&&(u[w]!==u[0]||u[w+1]!==u[1])&&Oa(u,u[0],u[1],u[2]),u.length&&e.push(u)}function Ma(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Ia(t,e,i,r,n,o){for(var a=0;a<t.length;a++)Sa(t[a],e,i,r,n,o,!1)}function Oa(t,e,i,r){t.push(e),t.push(i),t.push(r)}function La(t,e,i,r,n,o){var a=(o-e)/(r-e);return t.push(o),t.push(i+(n-i)*a),t.push(1),a}function Ca(t,e,i,r,n,o){var a=(o-i)/(n-i);return t.push(e+(r-e)*a),t.push(o),t.push(1),a}function Ra(t,e){var i=e.buffer/e.extent,r=t,n=ka(t,1,-1-i,i,0,-1,2,e),o=ka(t,1,1-i,2+i,0,-1,2,e);return(n||o)&&(r=ka(t,1,-i,1+i,0,-1,2,e)||[],n&&(r=Na(n,1).concat(r)),o&&(r=r.concat(Na(o,-1)))),r}function Na(t,e){for(var i=[],r=0;r<t.length;r++){var n,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=Pa(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(Pa(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(Pa(o.geometry[s][u],e));n.push(l)}i.push(va(o.id,a,n,o.tags))}return i}function Pa(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var r=0;r<t.length;r+=3)i.push(t[r]+e,t[r+1],t[r+2]);return i}function ja(t,e){if(t.transformed)return t;for(var i,r=1<<t.z,n=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],l=s.geometry,u=s.type;if(s.geometry=[],1===u)for(i=0;i<l.length;i+=2)s.geometry.push(Da(l[i],l[i+1],e,r,n,o));else for(i=0;i<l.length;i++){for(var c=[],h=0;h<l[i].length;h+=2)c.push(Da(l[i][h],l[i][h+1],e,r,n,o));s.geometry.push(c)}}return t.transformed=!0,t}function Da(t,e,i,r,n,o){return[Math.round(i*(t*r-n)),Math.round(i*(e*r-o))]}function za(t,e,i,r,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,function(t,e,i,r){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Fa(a,n,t,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)Fa(a,n[s],t,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)Fa(a,u[s],t,i,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}(a,t[s],o,n);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Fa(t,e,i,r,n,o){var a=r*r;if(0<r&&e.size<(n?a:r))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>a)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;n&&function(t,e){for(var i=0,r=0,n=t.length,o=n-2;r<n;o=r,r+=2)i+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(0<i===e)for(r=0,n=t.length;r<n/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[n-2-r],t[r+1]=t[n-1-r],t[n-2-r]=a,t[n-1-r]=s}}(s,o),t.push(s)}}var Ga={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!(fa.deepClone=function(t){return Array.isArray(t)?t.map(fa.deepClone):t}),promoteId:null,generateId:!1};function Ha(t,e,i,r,n){var o=Object.assign({},Ga,n),a=_a(t,o),s=function(t){var e,i=2,r=-1,n=1,o=0,a=Nr(t);try{for(a.s();!(e=a.n()).done;){var s=e.value;s.minX<i&&(i=s.minX),s.maxX>r&&(r=s.maxX),s.minY<n&&(n=s.minY),s.maxY>o&&(o=s.maxY)}}catch(t){a.e(t)}finally{a.f()}return{minX:i,maxX:r,minY:n,maxY:o}}(a=Ra(a,o)),l=s.minX,u=s.minY,c=s.maxX,h=s.maxY,p=1<<e,f=o.buffer/o.extent,d=1+f;return a=ka(a,p,i-f,i+d,0,l,c,o)||[],ja(za(a=ka(a,p,r-f,r+d,1,u,h,o)||[],e,i,r,o),o.extent)}function Ba(t,e){this.items=[],this.algorithm=t;var i=void 0===(e=e||{}).sort||e.sort;this.sort=i}Ba.prototype={addItem:function(t){this.items.push(t)},normalizeCoordinates:function(){var t=this.items,e=1/0,i=1/0;t.forEach((function(t){var r=t;e=Math.min(e,r.x),i=Math.min(i,r.y)})),t.forEach((function(t){var r=t;r.x-=e,r.y-=i}))},getStats:function(){var t=this.items.map((function(t){return t})),e=t.map((function(t){return t.x})),i=t.map((function(t){return t.y})),r=t.map((function(t){return t.x+t.width})),n=t.map((function(t){return t.y+t.height}));return{minX:Math.max.apply(Math,e),minY:Math.max.apply(Math,i),maxX:Math.max.apply(Math,r),maxY:Math.max.apply(Math,n)}},getItems:function(){return this.items},processItems:function(){var t=this.items;return this.sort&&(t=this.algorithm.sort(t)),t=this.algorithm.placeItems(t),this.items=t},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var t=this.exportItems(),e=this.getStats();return{height:e.maxY,width:e.maxX,items:t}}};var Ua=Ba,Va=[],qa=[],Ya="undefined"!=typeof Uint8Array?Uint8Array:Array,Wa=!1;function Za(){Wa=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=t.length;e<i;++e)Va[e]=t[e],qa[t.charCodeAt(e)]=e;qa["-".charCodeAt(0)]=62,qa["_".charCodeAt(0)]=63}function Ka(t,e,i){for(var r,n,o=[],a=e;a<i;a+=3)r=(t[a]<<16)+(t[a+1]<<8)+t[a+2],o.push(Va[(n=r)>>18&63]+Va[n>>12&63]+Va[n>>6&63]+Va[63&n]);return o.join("")}function Xa(t){var e;Wa||Za();for(var i=t.length,r=i%3,n="",o=[],a=0,s=i-r;a<s;a+=16383)o.push(Ka(t,a,s<a+16383?s:a+16383));return 1==r?(e=t[i-1],n+=Va[e>>2],n+=Va[e<<4&63],n+="=="):2==r&&(e=(t[i-2]<<8)+t[i-1],n+=Va[e>>10],n+=Va[e>>4&63],n+=Va[e<<2&63],n+="="),o.push(n),o.join("")}function Ja(t,e,i,r,n){var o,a,s=8*n-r-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?n-1:0,p=i?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=s;0<c;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=r;0<c;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),o-=u}return(f?-1:1)*a*Math.pow(2,o-r)}function Qa(t,e,i,r,n,o){var a,s,l,u=8*o-n-1,c=(1<<u)-1,h=c>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?p/l:p*Math.pow(2,1-h))*l&&(a++,l/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(e*l-1)*Math.pow(2,n),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;t[i+f]=255&s,f+=d,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;t[i+f]=255&a,f+=d,a/=256,u-=8);t[i+f-d]|=128*y}var $a={}.toString,ts=Array.isArray||function(t){return"[object Array]"==$a.call(t)};ns.TYPED_ARRAY_SUPPORT=void 0===Wr.TYPED_ARRAY_SUPPORT||Wr.TYPED_ARRAY_SUPPORT;var es=is();function is(){return ns.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function rs(t,e){if(is()<e)throw new RangeError("Invalid typed array length");return ns.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=ns.prototype:(null===t&&(t=new ns(e)),t.length=e),t}function ns(t,e,i){if(!(ns.TYPED_ARRAY_SUPPORT||this instanceof ns))return new ns(t,e,i);if("number"!=typeof t)return os(this,t,e,i);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return ss(this,t)}function os(t,e,i,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,r){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,i):new Uint8Array(e,i,r),ns.TYPED_ARRAY_SUPPORT?(t=e).__proto__=ns.prototype:t=ls(t,e),t}(t,e,i,r):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!ns.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|hs(e,i),n=(t=rs(t,r)).write(e,i);return n!==r&&(t=t.slice(0,n)),t}(t,e,i):function(t,e){if(cs(e)){var i=0|us(e.length);return 0===(t=rs(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?rs(t,0):ls(t,e);if("Buffer"===e.type&&ts(e.data))return ls(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function as(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function ss(t,e){if(as(e),t=rs(t,e<0?0:0|us(e)),!ns.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function ls(t,e){var i=e.length<0?0:0|us(e.length);t=rs(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function us(t){if(t>=is())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+is().toString(16)+" bytes");return 0|t}function cs(t){return null!=t&&t._isBuffer}function hs(t,e){if(cs(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return Ms(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Is(t).length;default:if(r)return Ms(t).length;e=(""+e).toLowerCase(),r=!0}}function ps(t,e,i){var r,n,o,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return function(t,e,i){var r=t.length;(!e||e<0)&&(e=0),(!i||i<0||r<i)&&(i=r);for(var n="",o=e;o<i;++o)n+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[o]);return n}(this,e,i);case"utf8":case"utf-8":return ms(this,e,i);case"ascii":return function(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;++n)r+=String.fromCharCode(127&t[n]);return r}(this,e,i);case"latin1":case"binary":return function(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;++n)r+=String.fromCharCode(t[n]);return r}(this,e,i);case"base64":return r=this,o=i,0===(n=e)&&o===r.length?Xa(r):Xa(r.slice(n,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,i){for(var r=t.slice(e,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}(this,e,i);default:if(a)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function fs(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function ds(t,e,i,r,n){if(0===t.length)return-1;if("string"==typeof i?(r=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(n)return-1;i=t.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof e&&(e=ns.from(e,r)),cs(e))return 0===e.length?-1:ys(t,e,i,r,n);if("number"==typeof e)return e&=255,ns.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):ys(t,[e],i,r,n);throw new TypeError("val must be string, number or Buffer")}function ys(t,e,i,r,n){var o=1,a=t.length,s=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a/=o=2,s/=2,i/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n)for(var u=-1,c=i;c<a;c++)if(l(t,c)===l(e,-1===u?0:c-u)){if(-1===u&&(u=c),c-u+1===s)return u*o}else-1!==u&&(c-=c-u),u=-1;else for(a<i+s&&(i=a-s),c=i;0<=c;c--){for(var h=!0,p=0;p<s;p++)if(l(t,c+p)!==l(e,p)){h=!1;break}if(h)return c}return-1}function gs(t,e,i,r){return Os(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,r)}function vs(t,e,i,r){return Os(function(t,e){for(var i,r,n,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(i=t.charCodeAt(a))>>8,n=i%256,o.push(n),o.push(r);return o}(e,t.length-i),t,i,r)}function ms(t,e,i){i=Math.min(t.length,i);for(var r=[],n=e;n<i;){var o,a,s,l,u=t[n],c=null,h=239<u?4:223<u?3:191<u?2:1;if(n+h<=i)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[n+1]))&&127<(l=(31&u)<<6|63&o)&&(c=l);break;case 3:o=t[n+1],a=t[n+2],128==(192&o)&&128==(192&a)&&2047<(l=(15&u)<<12|(63&o)<<6|63&a)&&(l<55296||57343<l)&&(c=l);break;case 4:o=t[n+1],a=t[n+2],s=t[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,h=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),n+=h}return function(t){var e=t.length;if(e<=_s)return String.fromCharCode.apply(String,t);for(var i="",r=0;r<e;)i+=String.fromCharCode.apply(String,t.slice(r,r+=_s));return i}(r)}ns.poolSize=8192,ns._augment=function(t){return t.__proto__=ns.prototype,t},ns.from=function(t,e,i){return os(null,t,e,i)},ns.TYPED_ARRAY_SUPPORT&&(ns.prototype.__proto__=Uint8Array.prototype,ns.__proto__=Uint8Array),ns.alloc=function(t,e,i){return r=null,o=e,a=i,as(n=t),n<=0||void 0===o?rs(r,n):"string"==typeof a?rs(r,n).fill(o,a):rs(r,n).fill(o);var r,n,o,a},ns.allocUnsafe=function(t){return ss(null,t)},ns.allocUnsafeSlow=function(t){return ss(null,t)},ns.isBuffer=Ls,ns.compare=function(t,e){if(!cs(t)||!cs(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,r=e.length,n=0,o=Math.min(i,r);n<o;++n)if(t[n]!==e[n]){i=t[n],r=e[n];break}return i<r?-1:r<i?1:0},ns.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ns.concat=function(t,e){if(!ts(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return ns.alloc(0);if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;for(var i=ns.allocUnsafe(e),r=0,n=0;n<t.length;++n){var o=t[n];if(!cs(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},ns.byteLength=hs,ns.prototype._isBuffer=!0,ns.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)fs(this,e,e+1);return this},ns.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)fs(this,e,e+3),fs(this,e+1,e+2);return this},ns.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)fs(this,e,e+7),fs(this,e+1,e+6),fs(this,e+2,e+5),fs(this,e+3,e+4);return this},ns.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?ms(this,0,t):ps.apply(this,arguments)},ns.prototype.equals=function(t){if(!cs(t))throw new TypeError("Argument must be a Buffer");return this===t||0===ns.compare(this,t)},ns.prototype.inspect=function(){var t="";return 0<this.length&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(t+=" ... ")),"<Buffer "+t+">"},ns.prototype.compare=function(t,e,i,r,n){if(!cs(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),e<0||i>t.length||r<0||n>this.length)throw new RangeError("out of range index");if(n<=r&&i<=e)return 0;if(n<=r)return-1;if(i<=e)return 1;if(this===t)return 0;for(var o=(n>>>=0)-(r>>>=0),a=(i>>>=0)-(e>>>=0),s=Math.min(o,a),l=this.slice(r,n),u=t.slice(e,i),c=0;c<s;++c)if(l[c]!==u[c]){o=l[c],a=u[c];break}return o<a?-1:a<o?1:0},ns.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},ns.prototype.indexOf=function(t,e,i){return ds(this,t,e,i,!0)},ns.prototype.lastIndexOf=function(t,e,i){return ds(this,t,e,i,!1)},ns.prototype.write=function(t,e,i,r){if(void 0===e)r="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)r=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-e;if((void 0===i||n<i)&&(i=n),0<t.length&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var o,a,s,l,u=!1;;)switch(r){case"hex":return function(t,e,i,r){i=Number(i)||0;var n=t.length-i;(!r||n<(r=Number(r)))&&(r=n);var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<r&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[i+a]=s}return a}(this,t,e,i);case"utf8":case"utf-8":return s=e,l=i,Os(Ms(t,this.length-s),this,s,l);case"ascii":case"latin1":case"binary":return gs(this,t,e,i);case"base64":return o=e,a=i,Os(Is(t),this,o,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vs(this,t,e,i);default:if(u)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),u=!0}},ns.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _s=4096;function bs(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(i<t+e)throw new RangeError("Trying to access beyond buffer length")}function ws(t,e,i,r,n,o){if(!cs(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<e||e<o)throw new RangeError('"value" argument is out of bounds');if(i+r>t.length)throw new RangeError("Index out of range")}function xs(t,e,i,r){e<0&&(e=65535+e+1);for(var n=0,o=Math.min(t.length-i,2);n<o;++n)t[i+n]=(e&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function Es(t,e,i,r){e<0&&(e=4294967295+e+1);for(var n=0,o=Math.min(t.length-i,4);n<o;++n)t[i+n]=e>>>8*(r?n:3-n)&255}function As(t,e,i,r){if(i+r>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Ts(t,e,i,r,n){return n||As(t,0,i,4),Qa(t,e,i,r,23,4),i+4}function ks(t,e,i,r,n){return n||As(t,0,i,8),Qa(t,e,i,r,52,8),i+8}ns.prototype.slice=function(t,e){var i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),e<t&&(e=t),ns.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=ns.prototype;else for(var r=e-t,n=new ns(r,void 0),o=0;o<r;++o)n[o]=this[o+t];return n},ns.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||bs(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return r},ns.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||bs(t,e,this.length);for(var r=this[t+--e],n=1;0<e&&(n*=256);)r+=this[t+--e]*n;return r},ns.prototype.readUInt8=function(t,e){return e||bs(t,1,this.length),this[t]},ns.prototype.readUInt16LE=function(t,e){return e||bs(t,2,this.length),this[t]|this[t+1]<<8},ns.prototype.readUInt16BE=function(t,e){return e||bs(t,2,this.length),this[t]<<8|this[t+1]},ns.prototype.readUInt32LE=function(t,e){return e||bs(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},ns.prototype.readUInt32BE=function(t,e){return e||bs(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},ns.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||bs(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return(n*=128)<=r&&(r-=Math.pow(2,8*e)),r},ns.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||bs(t,e,this.length);for(var r=e,n=1,o=this[t+--r];0<r&&(n*=256);)o+=this[t+--r]*n;return(n*=128)<=o&&(o-=Math.pow(2,8*e)),o},ns.prototype.readInt8=function(t,e){return e||bs(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},ns.prototype.readInt16LE=function(t,e){e||bs(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},ns.prototype.readInt16BE=function(t,e){e||bs(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},ns.prototype.readInt32LE=function(t,e){return e||bs(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},ns.prototype.readInt32BE=function(t,e){return e||bs(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},ns.prototype.readFloatLE=function(t,e){return e||bs(t,4,this.length),Ja(this,t,!0,23,4)},ns.prototype.readFloatBE=function(t,e){return e||bs(t,4,this.length),Ja(this,t,!1,23,4)},ns.prototype.readDoubleLE=function(t,e){return e||bs(t,8,this.length),Ja(this,t,!0,52,8)},ns.prototype.readDoubleBE=function(t,e){return e||bs(t,8,this.length),Ja(this,t,!1,52,8)},ns.prototype.writeUIntLE=function(t,e,i,r){t=+t,e|=0,i|=0,r||ws(this,t,e,i,Math.pow(2,8*i)-1,0);var n=1,o=0;for(this[e]=255&t;++o<i&&(n*=256);)this[e+o]=t/n&255;return e+i},ns.prototype.writeUIntBE=function(t,e,i,r){t=+t,e|=0,i|=0,r||ws(this,t,e,i,Math.pow(2,8*i)-1,0);var n=i-1,o=1;for(this[e+n]=255&t;0<=--n&&(o*=256);)this[e+n]=t/o&255;return e+i},ns.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,1,255,0),ns.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},ns.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,2,65535,0),ns.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):xs(this,t,e,!0),e+2},ns.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,2,65535,0),ns.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):xs(this,t,e,!1),e+2},ns.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,4,4294967295,0),ns.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Es(this,t,e,!0),e+4},ns.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,4,4294967295,0),ns.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Es(this,t,e,!1),e+4},ns.prototype.writeIntLE=function(t,e,i,r){var n;t=+t,e|=0,r||ws(this,t,e,i,(n=Math.pow(2,8*i-1))-1,-n);var o=0,a=1,s=0;for(this[e]=255&t;++o<i&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},ns.prototype.writeIntBE=function(t,e,i,r){var n;t=+t,e|=0,r||ws(this,t,e,i,(n=Math.pow(2,8*i-1))-1,-n);var o=i-1,a=1,s=0;for(this[e+o]=255&t;0<=--o&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+i},ns.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,1,127,-128),ns.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},ns.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,2,32767,-32768),ns.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):xs(this,t,e,!0),e+2},ns.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,2,32767,-32768),ns.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):xs(this,t,e,!1),e+2},ns.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,4,2147483647,-2147483648),ns.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Es(this,t,e,!0),e+4},ns.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||ws(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),ns.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Es(this,t,e,!1),e+4},ns.prototype.writeFloatLE=function(t,e,i){return Ts(this,t,e,!0,i)},ns.prototype.writeFloatBE=function(t,e,i){return Ts(this,t,e,!1,i)},ns.prototype.writeDoubleLE=function(t,e,i){return ks(this,t,e,!0,i)},ns.prototype.writeDoubleBE=function(t,e,i){return ks(this,t,e,!1,i)},ns.prototype.copy=function(t,e,i,r){if(i=i||0,r||0===r||(r=this.length),e>=t.length&&(e=t.length),e=e||0,0<r&&r<i&&(r=i),r===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-i&&(r=t.length-e+i);var n,o=r-i;if(this===t&&i<e&&e<r)for(n=o-1;0<=n;--n)t[n+e]=this[n+i];else if(o<1e3||!ns.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)t[n+e]=this[n+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),e);return o},ns.prototype.fill=function(t,e,i,r){if("string"==typeof t){var n;if("string"==typeof e?(r=e,e=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1!==t.length||(n=t.charCodeAt(0))<256&&(t=n),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!ns.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;if(e>>>=0,i=void 0===i?this.length:i>>>0,"number"==typeof(t=t||0))for(s=e;s<i;++s)this[s]=t;else for(var o=cs(t)?t:Ms(new ns(t,r).toString()),a=o.length,s=0;s<i-e;++s)this[s+e]=o[s%a];return this};var Ss=/[^+\/0-9A-Za-z-_]/g;function Ms(t,e){var i;e=e||1/0;for(var r=t.length,n=null,o=[],a=0;a<r;++a){if(55295<(i=t.charCodeAt(a))&&i<57344){if(!n){if(56319<i){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(e-=3)&&o.push(239,191,189);continue}n=i;continue}if(i<56320){-1<(e-=3)&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&-1<(e-=3)&&o.push(239,191,189);if(n=null,i<128){if(--e<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function Is(t){return function(t){var e,i,r,n;Wa||Za();var o=t.length;if(0<o%4)throw new Error("Invalid string. Length must be a multiple of 4");r="="===t[o-2]?2:"="===t[o-1]?1:0,n=new Ya(3*o/4-r),e=0<r?o-4:o;for(var a=0,s=0;s<e;s+=4,0)i=qa[t.charCodeAt(s)]<<18|qa[t.charCodeAt(s+1)]<<12|qa[t.charCodeAt(s+2)]<<6|qa[t.charCodeAt(s+3)],n[a++]=i>>16&255,n[a++]=i>>8&255,n[a++]=255&i;return 2==r?(i=qa[t.charCodeAt(s)]<<2|qa[t.charCodeAt(s+1)]>>4,n[a++]=255&i):1==r&&(i=qa[t.charCodeAt(s)]<<10|qa[t.charCodeAt(s+1)]<<4|qa[t.charCodeAt(s+2)]>>2,n[a++]=i>>8&255,n[a++]=255&i),n}(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(Ss,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Os(t,e,i,r){for(var n=0;n<r&&!(n+i>=e.length||n>=t.length);++n)e[n+i]=t[n];return n}function Ls(t){return null!=t&&(!!t._isBuffer||Cs(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&Cs(e.slice(0,0)));var e}function Cs(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Rs=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:es,Buffer:ns,SlowBuffer:function(t){return+t!=t&&(t=0),ns.alloc(+t)},isBuffer:Ls});Wr.setTimeout,Wr.clearTimeout,Wr.performance;var Ns="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){function i(){}t.super_=e,i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t},Ps=Ns;function js(t,e){var i={seen:[],stylize:zs};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),Bs(e)?i.showHidden=e:e&&function(t,e){if(e&&Ws(e))for(var i=Object.keys(e),r=i.length;r--;)t[i[r]]=e[i[r]]}(i,e),qs(i.showHidden)&&(i.showHidden=!1),qs(i.depth)&&(i.depth=2),qs(i.colors)&&(i.colors=!1),qs(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=Ds),Fs(i,t,i.depth)}function Ds(t,e){var i=js.styles[e];return i?"["+js.colors[i][0]+"m"+t+"["+js.colors[i][1]+"m":t}function zs(t,e){return t}function Fs(t,e,i){if(t.customInspect&&e&&Xs(e.inspect)&&e.inspect!==js&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return Vs(r)||(r=Fs(t,r,i)),r}var n=function(t,e){if(qs(e))return t.stylize("undefined","undefined");if(Vs(e)){var i="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(i,"string")}return"number"==typeof e?t.stylize(""+e,"number"):Bs(e)?t.stylize(""+e,"boolean"):Us(e)?t.stylize("null","null"):void 0}(t,e);if(n)return n;var o,a=Object.keys(e),s=(o={},a.forEach((function(t,e){o[t]=!0})),o);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),Ks(e)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return Gs(e);if(0===a.length){if(Xs(e)){var l=e.name?": "+e.name:"";return t.stylize("[Function"+l+"]","special")}if(Ys(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Zs(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Ks(e))return Gs(e)}var u,c,h="",p=!1,f=["{","}"];return u=e,Array.isArray(u)&&(p=!0,f=["[","]"]),Xs(e)&&(h=" [Function"+(e.name?": "+e.name:"")+"]"),Ys(e)&&(h=" "+RegExp.prototype.toString.call(e)),Zs(e)&&(h=" "+Date.prototype.toUTCString.call(e)),Ks(e)&&(h=" "+Gs(e)),0!==a.length||p&&0!=e.length?i<0?Ys(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=p?function(t,e,i,r,n){for(var o=[],a=0,s=e.length;a<s;++a)$s(e,String(a))?o.push(Hs(t,e,i,r,String(a),!0)):o.push("");return n.forEach((function(n){n.match(/^\d+$/)||o.push(Hs(t,e,i,r,n,!0))})),o}(t,e,i,s,a):a.map((function(r){return Hs(t,e,i,s,r,p)})),t.seen.pop(),function(t,e,i){return 60<t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)?i[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+i[1]:i[0]+e+" "+t.join(", ")+" "+i[1]}(c,h,f)):f[0]+h+f[1]}function Gs(t){return"["+Error.prototype.toString.call(t)+"]"}function Hs(t,e,i,r,n,o){var a,s,l=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]};if(l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),$s(r,n)||(a="["+n+"]"),s||(t.seen.indexOf(l.value)<0?-1<(s=Us(i)?Fs(t,l.value,null):Fs(t,l.value,i-1)).indexOf("\n")&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),qs(a)){if(o&&n.match(/^\d+$/))return s;a=(a=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function Bs(t){return"boolean"==typeof t}function Us(t){return null===t}function Vs(t){return"string"==typeof t}function qs(t){return void 0===t}function Ys(t){return Ws(t)&&"[object RegExp]"===Qs(t)}function Ws(t){return"object"==typeof t&&null!==t}function Zs(t){return Ws(t)&&"[object Date]"===Qs(t)}function Ks(t){return Ws(t)&&("[object Error]"===Qs(t)||t instanceof Error)}function Xs(t){return"function"==typeof t}function Js(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function Qs(t){return Object.prototype.toString.call(t)}function $s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tl(t,e){if(t===e)return 0;for(var i=t.length,r=e.length,n=0,o=Math.min(i,r);n<o;++n)if(t[n]!==e[n]){i=t[n],r=e[n];break}return i<r?-1:r<i?1:0}js.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},js.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var el,il=Object.prototype.hasOwnProperty,rl=Object.keys||function(t){var e=[];for(var i in t)il.call(t,i)&&e.push(i);return e},nl=Array.prototype.slice;function ol(){return void 0!==el?el:el="foo"===function(){}.name}function al(t){return Object.prototype.toString.call(t)}function sl(t){if(!Ls(t)&&"function"==typeof Wr.ArrayBuffer){if("function"==typeof ArrayBuffer.isView)return ArrayBuffer.isView(t);if(t)return t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)}}function ll(t,e){t||dl(t,!0,e,"==",yl)}var ul=/\s*function\s+([^\(\s]*)\s*/;function cl(t){if(Xs(t)){if(ol())return t.name;var e=t.toString().match(ul);return e&&e[1]}}function hl(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=pl(fl(this.actual),128)+" "+this.operator+" "+pl(fl(this.expected),128),this.generatedMessage=!0);var e,i,r,n,o,a=t.stackStartFunction||dl;Error.captureStackTrace?Error.captureStackTrace(this,a):(e=new Error).stack&&(o=e.stack,i=cl(a),0<=(r=o.indexOf("\n"+i))&&(n=o.indexOf("\n",r+1),o=o.substring(n+1)),this.stack=o)}function pl(t,e){return"string"!=typeof t||t.length<e?t:t.slice(0,e)}function fl(t){if(ol()||!Xs(t))return js(t);var e=cl(t);return"[Function"+(e?": "+e:"")+"]"}function dl(t,e,i,r,n){throw new hl({message:i,actual:t,expected:e,operator:r,stackStartFunction:n})}function yl(t,e){t||dl(t,!0,e,"==",yl)}function gl(t,e,i,r){if(t===e)return!0;if(Ls(t)&&Ls(e))return 0===tl(t,e);if(Zs(t)&&Zs(e))return t.getTime()===e.getTime();if(Ys(t)&&Ys(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(sl(t)&&sl(e)&&al(t)===al(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===tl(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(Ls(t)!==Ls(e))return!1;var n=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==n&&n===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,i,r){if(null==t||null==e)return!1;if(Js(t)||Js(e))return t===e;if(i&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var n=vl(t),o=vl(e);if(n&&!o||!n&&o)return!1;if(n)return gl(t=nl.call(t),e=nl.call(e),i);var a,s,l=rl(t),u=rl(e);if(l.length!==u.length)return!1;for(l.sort(),u.sort(),s=l.length-1;0<=s;s--)if(l[s]!==u[s])return!1;for(s=l.length-1;0<=s;s--)if(!gl(t[a=l[s]],e[a],i,r))return!1;return!0}(t,e,i,r))}return i?t===e:t==e}function vl(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function ml(t,e){if(t&&e){if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return 1}catch(t){}if(!Error.isPrototypeOf(e))return!0===e.call({},t)}}function _l(t,e,i,r){var n;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(r=i,i=null),n=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(i&&i.name?" ("+i.name+").":".")+(r?" "+r:"."),t&&!n&&dl(n,i,"Missing expected exception"+r);var o="string"==typeof r,a=!t&&n&&!i;if((!t&&Ks(n)&&o&&ml(n,i)||a)&&dl(n,i,"Got unwanted exception"+r),t&&n&&i&&!ml(n,i)||!t&&n)throw n}function bl(){}Ps(ll.AssertionError=hl,Error),ll.fail=dl,ll.ok=yl,ll.equal=function t(e,i,r){e!=i&&dl(e,i,r,"==",t)},ll.notEqual=function t(e,i,r){e==i&&dl(e,i,r,"!=",t)},ll.deepEqual=function t(e,i,r){gl(e,i,!1)||dl(e,i,r,"deepEqual",t)},ll.deepStrictEqual=function t(e,i,r){gl(e,i,!0)||dl(e,i,r,"deepStrictEqual",t)},ll.notDeepEqual=function t(e,i,r){gl(e,i,!1)&&dl(e,i,r,"notDeepEqual",t)},ll.notDeepStrictEqual=function t(e,i,r){gl(e,i,!0)&&dl(e,i,r,"notDeepStrictEqual",t)},ll.strictEqual=function t(e,i,r){e!==i&&dl(e,i,r,"===",t)},ll.notStrictEqual=function t(e,i,r){e===i&&dl(e,i,r,"!==",t)},ll.throws=function(t,e,i){_l(!0,t,e,i)},ll.doesNotThrow=function(t,e,i){_l(!1,t,e,i)},ll.ifError=function(t){if(t)throw t};var wl={sort:function(t){return t.sort((function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))})),t},placeItems:function(t){var e=0,i=0;return t.forEach((function(t){t.x=e,t.y=i,e+=t.width,i+=t.height})),t}},xl={sort:function(t){return t.sort((function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))})),t},placeItems:function(t){var e=0,i=0;return t.forEach((function(t){var r=t.width;t.x=e-r,t.y=i,e-=r,i+=t.height})),t}};bl.prototype={fit:function(t){var e,i,r,n,o=t.length,a=0<o?t[0].width:0,s=0<o?t[0].height:0;for(this.root={x:0,y:0,width:a,height:s},e=0;e<o;e++)r=t[e],n=(i=this.findNode(this.root,r.width,r.height))?this.splitNode(i,r.width,r.height):this.growNode(r.width,r.height),r.x=n.x,r.y=n.y},findNode:function(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.width&&i<=t.height?t:null},splitNode:function(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,width:t.width,height:t.height-i},t.right={x:t.x+e,y:t.y,width:t.width-e,height:i},t},growNode:function(t,e){var i=t<=this.root.width,r=e<=this.root.height,n=r&&this.root.height>=this.root.width+t,o=i&&this.root.width>=this.root.height+e;return n?this.growRight(t,e):o?this.growDown(t,e):r?this.growRight(t,e):i?this.growDown(t,e):null},growRight:function(t,e){var i;return this.root={used:!0,x:0,y:0,width:this.root.width+t,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:t,height:this.root.height}},(i=this.findNode(this.root,t,e))?this.splitNode(i,t,e):null},growDown:function(t,e){var i;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+e,down:{x:0,y:this.root.height,width:this.root.width,height:e},right:this.root},(i=this.findNode(this.root,t,e))?this.splitNode(i,t,e):null}};var El=bl,Al={sort:function(t){return t},placeItems:function(t){return function(t,e){e=e||{};var i=new El,r=e.inPlace||!1,n=(n=t.map((function(t){return r?t:{width:t.width,height:t.height,item:t}}))).sort((function(t,e){return e.width*e.height-t.width*t.height}));i.fit(n);var o={width:n.reduce((function(t,e){return Math.max(t,e.x+e.width)}),0),height:n.reduce((function(t,e){return Math.max(t,e.y+e.height)}),0)};r||(o.items=n)}(t,{inPlace:!0}),t}},Tl={};function kl(t,e){var i=t||"top-down";return"string"==typeof i&&ll(i=Tl[t],"Sorry, the '"+t+"' algorithm could not be loaded."),new Ua(i,e)}function Sl(t,e){Tl[t]=e}kl.PackingSmith=Ua,kl.addAlgorithm=Sl,kl.algorithms=Tl,Sl("top-down",{sort:function(t){return t.sort((function(t,e){return t.height-e.height})),t},placeItems:function(t){var e=0;return t.forEach((function(t){t.x=0,t.y=e,e+=t.height})),t}}),Sl("left-right",{sort:function(t){return t.sort((function(t,e){return t.width-e.width})),t},placeItems:function(t){var e=0;return t.forEach((function(t){t.x=e,t.y=0,e+=t.width})),t}}),Sl("diagonal",wl),Sl("alt-diagonal",xl),Sl("binary-tree",Al);var Ml=kl;function Il(t){var e;try{t.getContext("2d").getImageData(0,0,1,1)}catch(t){e=t.message}return e}function Ol(t,e,i){var r;return t instanceof HTMLImageElement&&((r=t.ownerDocument.createElement("canvas")).width=e,r.height=i,r.getContext("2d").drawImage(t,0,0,e,i),t=r),t}var Ll=Qr.metersToLatLng([Qr.half_circumference_meters,Qr.half_circumference_meters]),Cl=Math.log(Qr.tile_size)/Math.LN2,Rl=function(){wr(e,Dn);var t=Mr(e);function e(i,r){var n;return vr(this,e),n=t.call(this,i,r),ln.is_worker&&(n._quad_tree=new Zr.H.geo.QuadTree,n._marker_quad_tree=new Zr.H.geo.QuadTree,n._tree_entries_by_object_id={},n._groups_by_id={},n._layersCache=new Zr.H.util.Cache(100)),ln.is_main&&(n._objects_by_id={},n._commands=[],n._sendCommands=An(n._sendCommands,100,200),n.dispatchUpdate=n.dispatchUpdate.bind(Sr(n))),n}return _r(e,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var t,e,i=this.provider.getRootGroup(),r=i.getObjects(!0),n=[];for(r.push(i),t=r.length;t--;)e=r[t],this._isObjectSupported(e)&&this._shouldBeStored(e)&&(this._objects_by_id[e.getId()]=e,n.push(e.forWorkerMessage()));var o=[{method_name:"addObjects",arguments:[n]}];this._sendImmediateCommands(o)}},{key:"onProviderUpdate",value:function(t){var e,i,r,n,o=t.target,a=t.currentTarget.getInvalidations(o.type);this._isObjectSupported(o)&&(e=this._synced_at,i=o.getId(),a.isRemove(e)?(delete this._objects_by_id[i],this._commands.push({method_name:"removeObjectsByIds",arguments:[[i],!0]})):a.isAdd(e)?this._shouldBeStored(o)&&(this._objects_by_id[i]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]})):a.isSpatial(e)||a.isZOrder(e)?this._shouldBeStored(o)&&(r=[{method_name:"removeObjectsByIds",arguments:[[i],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[i]=o).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(r):this._commands.push(r[0],r[1])):a.isVisual(e)?this._shouldBeStored(o)&&(n={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[i]=o).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([n]):this._commands.push(n)):a.isVolatility(e)&&(delete this._objects_by_id[i],this._commands.push({method_name:"removeObjectsByIds",arguments:[[i],!0]}),this._shouldBeStored(o)&&(this._objects_by_id[i]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=a.getMark()}},{key:"_shouldBeStored",value:function(t){return 16===t.type||(!t.getIcon||1===t.getIcon().getState())&&this._hasSameVolatility(t)}},{key:"_hasSameVolatility",value:function(t){return t.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(t){t.length&&un.postMessage(this.worker,this.target_name+".executeCommands",t).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(t){return t.forWorkerMessage&&8!==t.type}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(t){return this._objects_by_id[t]}},{key:"getIconBitmapByObjectId",value:function(t,e){var i=this.getMapObjectById(t);if(i){var r=i.getIcon();if(r.uid===e&&1===r.getState()){var n=r.getSize();return Ol(r.getBitmap(),n.w,n.h)}}}},{key:"_getRastersForMarkers",value:function(t){for(var e={},i=Ml("binary-tree"),r=0;r<t.length;r++){var n=t[r],o=n.properties.icon;e[o.id]||(i.addItem({width:o.size.w,height:o.size.h,meta:{objectId:n.id,id:o.id}}),e[o.id]=!0)}return i.export()}},{key:"fetchFeaturesForTile",value:function(t){var i=[],r=[],n=[],o=[],a=[],s=this._marker_quad_tree.intersectBoundingBox(Qr.getTileBoundingBox(t.coords,this.tile_size));t.source_data.error=null;for(var l=0;l<s.length;l++){var u={id:s[l].$feature$.id,properties:Object.assign({},s[l].$feature$.properties),geometry:{type:s[l].$feature$.geometry.type,coordinates:ya.deepClone(s[l].$feature$.geometry.coordinates)}};i.push(u)}s=this._quad_tree.intersectBoundingBox(Qr.getTileBoundingBox(t.coords,this.tile_size,100));for(var c=0;c<s.length;c++){var h,p={id:s[c].$feature$.id,properties:Object.assign({},s[c].$feature$.properties),geometry:{type:s[c].$feature$.geometry.type,coordinates:ya.deepClone(s[c].$feature$.geometry.coordinates)}};p.properties.overlay?r.push(p):p.geometry.type.includes("LineString")?n.push(p):p.geometry.type.includes("Polygon")&&(o.push(p),h={id:p.id,properties:p.properties,geometry:{type:p.geometry.type,coordinates:ya.deepClone(p.geometry.coordinates)}},a.push(h))}i.sort(e._compareZInfo),o.sort(e._compareZInfo),r.sort(e._compareZInfo);var f=this.has_volatile_data?4096:0;a.sort(e._compareZInfo);for(var d=0;d<a.length;d++)a[d].properties.effectiveZIdx=f++;n.sort(e._compareZInfo);for(var y=0;y<n.length;y++)n[y].properties.effectiveZIdx=f++;t.source_data.layers.markers={type:"FeatureCollection",features:i},t.source_data.layers.polylines={type:"FeatureCollection",features:n},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},t.source_data.layers.overlays={type:"FeatureCollection",features:r}}},{key:"tileTexture",value:function(t){var e=t.source_data.layers.overlays;if(e){var i=this.name+"_"+t.coords.key,r=pa.coordinateWithMaxZoom(t.coords,this.max_zoom),n=e.features[0].properties.overlays_config;return{name:i,filtering:this.filtering,coords:r,width:Qr.tile_size,height:Qr.tile_size,overlays_config:n,source:this.name}}}},{key:"_load",value:function(t){var e=Qr.wrapTile(t.coords,{x:!0}),i=e.z,r=e.x,n=e.y,o="".concat(i,"_").concat(r,"_").concat(n),a=this._layersCache.get(o),s=!1;if(a)t.source_data.layers=a;else{this.fetchFeaturesForTile(t);var l={maxZoom:this.max_zoom,tolerance:1.5,extent:Qr.tile_scale},u=t.source_data.layers.overlays;u.features.length&&delete t.source_data.layers.overlays;var c=t.source_data.layers.markers;for(var h in c.features.length&&delete t.source_data.layers.markers,t.source_data.layers){var p,f=t.source_data.layers[h];f.features.length&&(l.buffer=h.includes("lines")?100*Qr.units_per_pixel:0,p=Ha(f,i,r,n,l),t.source_data.layers[h]=oo(p))}t.source_data.layers.overlays=this._processOverlays(t,u);for(var d=t.source_data.layers.overlays.features.length;d--;)if(!t.source_data.layers.overlays.features[d].id){s=!0,this._layersCache.drop(o);break}t.source_data.layers.markers=this._processMarkers(t,c),this._postProcessTile(t),s||this._layersCache.add(o,t.source_data.layers,1)}return t.rasters=this._getRastersForMarkers(t.source_data.layers.markers.features),Promise.resolve(t)}},{key:"_processMarkers",value:function(t,e){var i=e.features.length;if(i){for(var r=Qr.unitsPerMeter(t.coords.z),n=Qr.wrapTile(t.coords,{x:!0}),o=Qr.metersForTile(n),a=Qr.isLastTile(n),s=Qr.wrapMeters(t.min),l=Qr.wrapMeters(t.max),u=function(e){Rn.coordsToMeters(e);var i=Or(e,2),n=i[0],u=i[1],c=n>=s.x&&(a.column||n<l.x)&&u>=l.y&&(a.row||!t.coords.y||u<s.y);return Rn.metersToTileUnits(r,o,e),c},c=[],h=0;h<i;h++){var p,f=e.features[h].geometry,d=!1;"Point"===f.type?u(p=f.coordinates)?f.coordinates=p:d=!0:"MultiPoint"===f.type&&(f.coordinates=f.coordinates.filter(u),0===f.coordinates.length&&(d=!0)),d||c.push(e.features[h])}e.features=c}return e}},{key:"_processOverlays",value:function(t,e){var i=this;if(!e.features.length)return e;var r={coords:t.coords,min:Qr.metersForTile(Qr.wrapTile(t.coords,{x:!0}))},n={coords:t.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:e.features}}}},o=Math.pow(2,t.coords.z+Cl);Dn.projectData(n.source_data),Dn.scaleData(n.source_data,r);var a=e.features.map((function(t){var e=t.geometry.coordinates[0],i=e[0],r=e[5===e.length?2:3],n=Math.floor(i[0]/Qr.tile_scale*Qr.tile_size),a=Math.floor(i[1]/Qr.tile_scale*Qr.tile_size),s=Math.floor(r[0]/Qr.tile_scale*Qr.tile_size),l=Math.floor(r[1]/Qr.tile_scale*Qr.tile_size)-a,u=s<=n,c=u?o-(n-s):s-n,h=[];return n<=Qr.tile_size&&h.push([n,a,c,l]),u&&0<s&&h.push([n-o,a,c,l]),{id:t.id,properties:t.properties,texcoords:h}})).filter((function(e){return i._isVisible(e.properties)&&i.isInMinMaxRange(e.properties,t.style_zoom)})),s=Qr.tile_scale;return t.pad_scale=this.pad_scale,t.default_winding="CW",e.features=a.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[s,0],[s,s],[0,s],[0,0]]]},properties:{overlays_config:a}}]:a,e}},{key:"executeCommands",value:function(t){for(var e,i=t.length<10,r=0;r<t.length;r++){var n=t[r];n.arguments.push(i);var o=this[n.method_name].apply(this,n.arguments);i&&(o&&e?e.mergeRect(o,!0,e):o&&(e=o))}return e?e.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(t){var e=t.geometry.boundingBox;return new Zr.H.geo.Rect(Xr.clamp(e[0],-Ll[1],Ll[1]),e[1],Xr.clamp(e[2],-Ll[1],Ll[1]),e[3])}},{key:"addObjects",value:function(t,i){for(var r,n=1<arguments.length&&void 0!==i&&i,o=0;o<t.length;o++){var a,s,l,u=t[o];"Group"===u.type?(u.$children_ids$={},this._groups_by_id[u.id]=u):(e._preprocessGeometry(u.geometry),a=this._getClampedGeoRectForFeature(u),n&&(r?r.mergeRect(a,!0,r):r=a),(l=(s=-1!==u.geometry.type.indexOf("Point")?this._marker_quad_tree:this._quad_tree).insertBoundingBox(a)).$tree=s,l.$feature$=u,this._tree_entries_by_object_id[u.id]=l)}for(var c=0;c<t.length;c++){var h=t[c];h.properties.parent&&(this._groups_by_id[h.properties.parent].$children_ids$[h.id]=h.id),h.properties.ref={effectiveVisibility:this._isVisible(h.properties),zInfo:this._getZInfo([],h)}}return this._layersCache.removeAll(),r}},{key:"removeObjectsByIds",value:function(t,e,i){for(var r,n=2<arguments.length&&void 0!==i&&i,o=0;o<t.length;o++){var a,s=t[o],l=void 0,u=void 0;(l=this._tree_entries_by_object_id[s])?(n&&(a=this._getClampedGeoRectForFeature(l.$feature$),r?r.mergeRect(a,!0,r):r=a),delete this._groups_by_id[l.$feature$.properties.parent].$children_ids$[s],l.$tree.remove(l),delete this._tree_entries_by_object_id[s]):(u=this._groups_by_id[s])&&(u.properties.parent&&delete this._groups_by_id[u.properties.parent].$children_ids$[s],e&&this.removeObjectsByIds(Object.keys(u.$children_ids$),!0),delete this._groups_by_id[s])}return this._layersCache.removeAll(),r}},{key:"updateObjectProperties",value:function(t,e){var i,r=1<arguments.length&&void 0!==e&&e;return"Group"===t.type?(sa(this._groups_by_id[t.id].properties,t.properties),this._groups_by_id[t.id].properties.ref.effectiveVisibility=this._isVisible(t.properties)):(this._tree_entries_by_object_id[t.id]||this.addObjects([t]),sa(this._tree_entries_by_object_id[t.id].$feature$.properties,t.properties),this._tree_entries_by_object_id[t.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(t.properties),r&&(i=this._getClampedGeoRectForFeature(t))),i}},{key:"_getZInfo",value:function(t,e){var i=e.properties.zIdx,r=e.properties.sIdx;return t[0]|=void 0!==i,t.splice(1,0,i||0,r<0?e.id:r),0===e.properties.parent?t:this._getZInfo(t,this._groups_by_id[e.properties.parent])}},{key:"_isVisible",value:function(t){var e=t.visible,i=!t.parent||this._isVisible(this._groups_by_id[t.parent].properties);return e&&i}},{key:"isInMinMaxRange",value:function(t,e){var i=t.min<=e&&t.max>=e,r=!t.parent||this.isInMinMaxRange(this._groups_by_id[t.parent].properties,e);return i&&r}},{key:"dispose",value:function(){this._commands=[],Ir(xr(e.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(t,e){for(var i,r=t.properties.ref.zInfo,n=e.properties.ref.zInfo,o=r.length,a=n.length,s=Math.min(o,a),l=1;l<s;l++)if(i=r[l]-n[l])return i;return o-a}},{key:"_preprocessGeometry",value:function(t){var i=t.type;t.coordinates="Point"===i?e._processPointCoordinates(t.coordinates):"MultiPoint"===i?t.coordinates.map(e._processPointCoordinates):"LineString"===i?e._processLineStringCoordinates(t.coordinates):"MultiLineString"===i?t.coordinates.map(e._processLineStringCoordinates):"Polygon"===i?t.coordinates.map(e._processPolygonCoordinates):"MultiPolygon"===i?t.coordinates.map(e._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(t){return[t[1],t[0],t[2]]}},{key:"_processLineStringCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!1)}},{key:"_processPolygonCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!0)}},{key:"_processMultiPolygonCoordinates",value:function(t){return t.map(e._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(t,e){for(var i=[],r=t.length,n=0;n<r;n+=3)i.push([t[n+1],t[n]]);return e&&i.push([t[1],t[0]]),i}}]),e}();Dn.register(Rl,"ObjectSource");var Nl=function(){function t(){vr(this,t),this._map={}}return _r(t,[{key:"set",value:function(t,e,i){var r;this._map[t]?this._map[t].accumulator.add(i):((r=new Set).add(i),this._map[t]={value:e,accumulator:r})}},{key:"get",value:function(t){return this._map[t]&&this._map[t].value}},{key:"delete",value:function(t,e){var i=this._map[t];i&&i.accumulator&&(i.accumulator.delete(e),0===i.accumulator.size&&delete this._map[t])}}]),t}(),Pl=function(){wr(e,Dn);var t=Mr(e);function e(i,r){var n;return vr(this,e),n=t.call(this,i,r),ln.is_worker||(n._icons=new Nl),n}return _r(e,[{key:"onProviderUpdate",value:function(t){t.target instanceof H.map.provider.Tile?this.dispatchUpdate(t.target,t.data):this.dispatchUpdate(void 0,t.data)}},{key:"onReady",value:function(){var t=this.provider;t.setTileCanvasRendering&&t.setTileCanvasRendering(!1),t.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),t.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){Ir(xr(e.prototype),"dispose",this).call(this);var t=this.provider;t.providesMarkers()&&t.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(t,e){this.provider.cacheFilter(t)&&this._deleteIcons(t,e.data)}},{key:"_deleteIcons",value:function(t,e){for(var i=0,r=e.length;i<r;i++){var n=e[i].getIcon();this._icons.delete(n.uid,t)}}},{key:"getIconBitmapByObjectId",value:function(t,e){var i=this._icons.get(e);return i&&i.getBitmap()}},{key:"requestMarkerTile",value:function(t){var e=this;return new Promise((function(i,r){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then((function(t){var r,n,o=[];if(t.data)for(n=(r=t.data).length;n--;){var a=r[n],s=a.getIcon();e._icons.set(s.uid,s,t.key),o.push(a.forWorkerMessage())}i(o)})):i([])}))}},{key:"requestSpatialTile",value:function(t){var e=this;return new Promise((function(i,r){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then((function(t){var e,r=[];if(t.getObjects){e=t.getObjects();for(var n=0;n<e.length;n++){var o=e[n];r.push({id:o.getId(),geometries:o.getGeometriesForTile(t),isClosed:o.isClosed(),style:o.getStyle().forWorkerMessage()})}}i(r)})):i([])}))}},{key:"_pointToArray",value:function(t){var e=Qr.tile_scale/this.tile_size;return[t.x*e,t.y*e]}},{key:"_getGeoJsonMultiPolygon",value:function(t){for(var e=t.geometries,i=e.length,r=[],n={coordinates:r,type:"MultiPolygon"},o=0;o<i;o++){var a=e[o],s=a.paths,l=s.length,u=a.interiorsIndex,c=a.outlinesIndex,h=Math.min(u,c,l),p=void 0,f=void 0;for(f=0;f<h;f++)p=[s[f].map(this._pointToArray,this)],r.push(p);if(1===h)for(h=Math.min(c,l),f=u;f<h;f++)p.push(s[f].map(this._pointToArray,this))}return n}},{key:"_getGeoJsonMultiLineString",value:function(t,e){for(var i=1<arguments.length&&void 0!==e&&e,r={coordinates:[],type:"MultiLineString"},n=t.geometries,o=0;o<n.length;o++)for(var a=n[o],s=i?a.outlinesIndex:0,l=i?a.paths.length:Math.min(a.interiorsIndex,a.outlinesIndex,a.paths.length),u=s;u<l;u++){var c=a.paths[u].map(this._pointToArray,this);r.coordinates.push(c)}return r}},{key:"_getGeoJsonGeometry",value:function(t,e){var i=1===e?this._getGeoJsonMultiPolygon(t):this._getGeoJsonMultiLineString(t,3===e);return i.coordinates.length?i:null}},{key:"_load",value:function(t){var e=this;return new Promise((function(i,r){var n=un.postMessage(e.target_name+".requestMarkerTile",t.coords).then(e._prepareTileData.bind(e,t)),o=new Promise((function(i,r){un.postMessage(e.target_name+".requestSpatialTile",t.coords).then((function(r){for(var n=[],o=[],a=[],s=0;s<r.length;s++){var l,u=r[s],c=void 0,h=u.isClosed?(c=o,1):(c=n,2),p=e._getGeoJsonGeometry(u,h);p&&(l={id:u.id,type:"Feature",properties:{height:0,style:u.style},geometry:p},2===h&&(l.properties.effectiveZIdx=n.length),c.push(l));var f=e._getGeoJsonGeometry(u,3);f&&a.push({id:u.id,type:"Feature",properties:{height:0,style:u.style,effectiveZIdx:a.length},geometry:f})}t.source_data.layers.polylines={type:"FeatureCollection",features:n},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},i(t)}))}));Promise.all([n,o]).then((function(r){e._postProcessTile(t),i(t)}))}))}},{key:"_prepareTileData",value:function(t,e){var i=Qr.wrapTile(t.coords,{x:!0,y:!0}),r=Qr.metersForTile(i);t.source_data.layers={markers:{features:e,type:"FeatureCollection"}};var n={coords:i,min:r},o=t.source_data,a=Ml("binary-tree"),s={};for(var l in o.layers)for(var u=o.layers[l].features.length,c=0;c<u;c++){var h=o.layers[l].features[c],p=h.properties.icon;s[p.id]||(a.addItem({width:p.size.w,height:p.size.h,meta:{objectId:h.id,id:p.id}}),s[p.id]=!0),Qr.transformGeometry(h.geometry,(function(t){var e=t[0];t[0]=t[1],t[1]=e}))}return t.rasters=a.export(),Dn.projectData(t.source_data),Dn.scaleData(t.source_data,n),t}}]),e}();Dn.register(Pl,"ObjectTileSource");var jl=function(){wr(e,da);var t=Mr(e);function e(i,r){var n;return vr(this,e),(n=t.call(this,i,r)).uid_=i.uid,n}return _r(e,[{key:"initialize",value:function(t,e){this.provider=t,this._on_update=e,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(t){return Object.assign(Ir(xr(e.prototype),"tileTexture",this).call(this,t),{uid:this.uid_,url:this.uid_+"_"+t.coords.key,coords:t.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}();function Dl(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=_a(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(r=Ra(r,e)).length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zl(t,e,i){return 32*((1<<t)*i+e)+t}Rn.register(jl,"RemoteRasterTileSource"),Dl.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Dl.prototype.splitTile=function(t,e,i,r,n,o,a){for(var s=[t,e,i,r],l=this.options,u=l.debug;s.length;){r=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var c,h,p,f,d,y,g,v,m,_,b,w=1<<e,x=zl(e,i,r),E=this.tiles[x];if(E||(1<u&&console.time("creation"),E=this.tiles[x]=za(t,e,i,r,l),this.tileCoords.push({z:e,x:i,y:r}),u&&(1<u&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,r,E.numFeatures,E.numPoints,E.numSimplified),console.timeEnd("creation")),c="z"+e,this.stats[c]=(this.stats[c]||0)+1,this.total++)),E.source=t,n){if(e===l.maxZoom||e===n)continue;var A=1<<n-e;if(i!==Math.floor(o/A)||r!==Math.floor(a/A))continue}else if(e===l.indexMaxZoom||E.numPoints<=l.indexMaxPoints)continue;E.source=null,0!==t.length&&(1<u&&console.time("clipping"),p=.5-(h=.5*l.buffer/l.extent),d=1+h,m=y=g=v=null,_=ka(t,w,i-h,i+(f=.5+h),0,E.minX,E.maxX,l),b=ka(t,w,i+p,i+d,0,E.minX,E.maxX,l),t=null,_&&(m=ka(_,w,r-h,r+f,1,E.minY,E.maxY,l),y=ka(_,w,r+p,r+d,1,E.minY,E.maxY,l),_=null),b&&(g=ka(b,w,r-h,r+f,1,E.minY,E.maxY,l),v=ka(b,w,r+p,r+d,1,E.minY,E.maxY,l),b=null),1<u&&console.timeEnd("clipping"),s.push(m||[],e+1,2*i,2*r),s.push(y||[],e+1,2*i,2*r+1),s.push(g||[],e+1,2*i+1,2*r),s.push(v||[],e+1,2*i+1,2*r+1))}},Dl.prototype.getTile=function(t,e,i){var r=this.options,n=r.extent,o=r.debug;if(t<0||24<t)return null;var a=1<<t,s=zl(t,e=(e%a+a)%a,i);if(this.tiles[s])return ja(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,u=t,c=e,h=i;!l&&0<u;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[zl(u,c,h)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",u,c,h),1<o&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,i),1<o&&console.timeEnd("drilling down"),this.tiles[s]?ja(this.tiles[s],n):null):null};var Fl={type:"FeatureCollection",features:[]},Gl=function(){wr(e,Dn);var t=Mr(e);function e(i,r){return vr(this,e),i.tiled=!0,i.url="",t.call(this,i,r)}return _r(e,[{key:"fetchTile",value:function(t,e,i){return this.provider?this.provider.requestTileAsPromise(t,e,i).then((function(t){return t.data})):Promise.resolve(Fl)}},{key:"_load",value:function(t){var e=this,i=Qr.wrapTile(t.coords,{x:!0,y:!0}),r={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Qr.tile_scale};return un.postMessage(this.target_name+".fetchTile",i.x,i.y,i.z).then((function(n){for(var o in t.source_data.layers="FeatureCollection"===n.type?{_default:n}:n,t.source_data.layers){var a=new Dl(t.source_data.layers[o],r).getTile(i.z,i.x,i.y);t.source_data.layers[o]=oo(a)}return e._postProcessTile(t),t}))}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();Rn.register(Gl,"GeoJSONTileSource");var Hl,Bl={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},Ul=function(){wr(e,Rn);var t=Mr(e);function e(i,r){return vr(this,e),i.max_zoom=0,t.call(this,i,r)}return _r(e,[{key:"load",value:function(t){return t.source_data="0/0/0"===t.coords.key?Bl:void 0,Promise.resolve(t)}}]),e}();Rn.register(Ul,"SkyBox");var Vl,ql=Hl={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function Yl(t,e){var i={};return e.forEach((function(e){return i[e]=t[e]})),i}var Wl,Zl=Vl={},Kl=0;Vl.getContext=function(t,e){var i=!1;null==t&&((t=document.createElement("canvas")).style.position="absolute",t.style.top=0,t.style.left=0,t.style.zIndex=-1,document.body.appendChild(t),i=!0);var r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!r)throw new Error("Couldn't create WebGL context.");return r._tangram_id=Kl++,i?(Vl.resize(r,window.innerWidth,window.innerHeight,e.device_pixel_ratio),window.addEventListener("resize",(function(){Vl.resize(r,window.innerWidth,window.innerHeight,e.device_pixel_ratio)}))):Vl.resize(r,parseFloat(t.style.width),parseFloat(t.style.height),e.device_pixel_ratio),r},Vl.resize=function(t,e,i,r){t.canvas.style.width=e+"px",t.canvas.style.height=i+"px",t.canvas.width=Math.round(e*r),t.canvas.height=Math.round(i*r),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.canvas.width,t.canvas.height)};var Xl=Wl={};Wl.BYTE=5120,Wl.UNSIGNED_BYTE=5121,Wl.SHORT=5122,Wl.UNSIGNED_SHORT=5123,Wl.INT=5124,Wl.UNSIGNED_INT=5125,Wl.FLOAT=5126;var Jl,Ql=Math.pow(2,16)-1,$l=!1,tu=function(){function t(e){vr(this,t),this.size_=e||1024,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return _r(t,[{key:"push",value:function(t){if(!this.overflows_||$l){if(Ql<t){if(this.overflows_=!0,!$l)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=t,this.position_+=1}}},{key:"end",value:function(){if(0===this.position_)return!1;var t=this.buffer_,e=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,t.subarray(0,e)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var t=new this.ArrayType_(this.size_);t.set(this.buffer_),this.buffer_=t}}]),t}();tu.setElementIndexUint=function(t){$l=t};var eu=(br(Jl={},Xl.FLOAT,Float32Array),br(Jl,Xl.BYTE,Int8Array),br(Jl,Xl.UNSIGNED_BYTE,Uint8Array),br(Jl,Xl.INT,Int32Array),br(Jl,Xl.UNSIGNED_INT,Uint32Array),br(Jl,Xl.SHORT,Int16Array),br(Jl,Xl.UNSIGNED_SHORT,Uint16Array),Jl),iu=function(){function t(e){var i=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prealloc,r=void 0===i?500:i;vr(this,t),this.vertex_layout=e,this.vertex_elements=new tu,this.stride=this.vertex_layout.stride,0<t.array_pool.length?(this.vertex_buffer=t.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),En("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=r,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return _r(t,[{key:"setBufferViews",value:function(){var t=this;this.views={},this.views[Xl.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach((function(e){var i;null==t.views[e.type]&&(i=eu[e.type],t.views[e.type]=new i(t.vertex_buffer.buffer))}))}},{key:"checkBufferSize",value:function(){var e;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(e=new Uint8Array(this.byte_length)).set(this.vertex_buffer),t.array_pool.push(this.vertex_buffer),this.vertex_buffer=e,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(t){this.checkBufferSize(),this.vertexLayoutAddVertex(t,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),En("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),t}();iu.array_pool=[];var ru=function(){function t(e){vr(this,t),this.attribs=e,this.dynamic_attribs=this.attribs.filter((function(t){return!t.static})),this.components=[],this.index={},this.offset={};for(var i=this.stride=0,r=0,n=0;n<this.attribs.length;n++){var o=this.attribs[n];if(null==o.static){o.offset=this.stride,o.byte_size=o.size;var a=0;switch(o.type){case Xl.FLOAT:case Xl.INT:case Xl.UNSIGNED_INT:o.byte_size*=4,a=2;break;case Xl.SHORT:case Xl.UNSIGNED_SHORT:o.byte_size*=2,a=1}3&o.byte_size&&(o.byte_size+=4-(3&o.byte_size)),this.stride+=o.byte_size;for(var s=o.offset>>a,l=0;l<o.size;l++)this.components.push({type:o.type,shift:a,offset:s++,index:r++});this.index[o.name]=i,i+=o.size,this.offset[o.name]=o.offset}else o.static=Array.isArray(o.static)?o.static:[o.static],o.method="vertexAttrib".concat(o.static.length,"fv")}}return _r(t,[{key:"enable",value:function(e,i,r){for(var n,o,a=0;a<this.attribs.length;a++)n=this.attribs[a],-1!==(o=i.attribute(n.name).location)&&(null==n.static?(t.enabled_attribs[o]&&!r||e.enableVertexAttribArray(o),e.vertexAttribPointer(o,n.size,n.type,n.normalized,this.stride,n.offset),t.enabled_attribs[o]=i):e[n.method]instanceof Function&&(e.enableVertexAttribArray(o),e[n.method](o,n.static),e.disableVertexAttribArray(o),delete t.enabled_attribs[o]));for(o in t.enabled_attribs)this.disableUnusedAttribute(e,o,i)}},{key:"disableUnusedAttribute",value:function(e,i,r){t.enabled_attribs[i]!==r&&(e.disableVertexAttribArray(i),delete t.enabled_attribs[i])}},{key:"createVertexData",value:function(){return new iu(this)}},{key:"getAddVertexFunction",value:function(){return null==this.addVertex&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var e=qo(JSON.stringify(this.attribs));if(null==t.add_vertex_funcs[e]){var i,r=["var t, o;"],n=Lr(this.components);n.sort((function(t,e){return t.type!==e.type?t.type-e.type:t.index-e.index}));for(var o=0;o<n.length;o++){var a=n[o];i!==a.type&&(r.push("t = vs[".concat(a.type,"];")),r.push("o = off".concat(a.shift?" >> "+a.shift:"",";")),i=a.type),r.push("t[o + ".concat(a.offset,"] = v[").concat(a.index,"];"))}r=r.join("\n");var s=new Function("v","vs","off",r);t.add_vertex_funcs[e]=s}this.addVertex=t.add_vertex_funcs[e]}}]),t}();ru.enabled_attribs={},ru.add_vertex_funcs={};var nu=[{x:0,y:0},{x:Qr.tile_scale,y:-Qr.tile_scale}],ou=[0,0,1,1];function au(t,e,i){var r=nu[0],n=nu[1];return t[0]<=r.x+i&&e[0]<=r.x+i||t[0]>=n.x-i&&e[0]>=n.x-i||t[1]>=r.y-i&&e[1]>=r.y-i||t[1]<=n.y+i&&e[1]<=n.y+i}function su(t,e){e=e||0;var i=nu[0],r=nu[1];return t[0]<=i.x+e||t[0]>=r.x-e||t[1]>=i.y-e||t[1]<=r.y+e}var lu=uu;function uu(t,e,i){i=i||2;var r,n,o,a,s,l,u,c=e&&e.length,h=c?e[0]*i:t.length,p=cu(t,0,h,i,!0),f=[];if(!p)return f;if(c&&(p=function(t,e,i,r){var n,o,a,s=[];for(n=0,o=e.length;n<o;n++)(a=cu(t,e[n]*r,n<o-1?e[n+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),s.push(function(t){for(var e=t,i=t;e.x<i.x&&(i=e),(e=e.next)!==t;);return i}(a));for(s.sort(fu),n=0;n<s.length;n++)!function(t,e){var i;(e=function(t,e){var i,r=e,n=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&a<s){if((a=s)===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===a)return i.prev;var l,u=i,c=i.x,h=i.y,p=1/0;for(r=i.next;r!==u;)n>=r.x&&r.x>=c&&yu(o<h?n:a,o,c,h,o<h?a:n,o,r.x,r.y)&&((l=Math.abs(o-r.y)/(n-r.x))<p||l===p&&r.x>i.x)&&_u(r,t)&&(i=r,p=l),r=r.next;return i}(t,e))&&hu(i=bu(e,t),i.next)}(s[n],i),i=hu(i,i.next);return i}(t,e,p,i)),t.length>80*i){r=o=t[0],n=a=t[1];for(var d=i;d<h;d+=i)(s=t[d])<r&&(r=s),(l=t[d+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);u=Math.max(o-r,a-n)}return pu(p,f,i,r,n,u),f}function cu(t,e,i,r,n){var o,a;if(n===0<Au(t,e,i,r))for(o=e;o<i;o+=r)a=wu(o,t[o],t[o+1],a);else for(o=i-r;e<=o;o-=r)a=wu(o,t[o],t[o+1],a);return a&&vu(a,a.next)&&(xu(a),a=a.next),a}function hu(t,e){if(!t)return t;e=e||t;var i,r=t;do{if(i=!1,r.steiner||!vu(r,r.next)&&0!==gu(r.prev,r,r.next))r=r.next;else{if(xu(r),(r=e=r.prev)===r.next)return null;i=!0}}while(i||r!==e);return e}function pu(t,e,i,r,n,o,a){if(t){!a&&o&&function(t,e,i,r){for(var n=t;null===n.z&&(n.z=du(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==t;);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,o,a,s,l,u=1;do{for(i=t,o=t=null,a=0;i;){for(a++,r=i,e=s=0;e<u&&(s++,r=r.nextZ);e++);for(l=u;0<s||0<l&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(i=(n=i).nextZ,s--):(r=(n=r).nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,u*=2}while(1<a)}(n)}(t,r,n,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?function(t,e,i,r){var n=t.prev,o=t,a=t.next;if(0<=gu(n,o,a))return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,u=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,c=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,h=du(s,l,e,i,r),p=du(u,c,e,i,r),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&yu(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=gu(f.prev,f,f.next))return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&yu(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=gu(f.prev,f,f.next))return!1;f=f.prevZ}return!0}(t,r,n,o):function(t){var e=t.prev,i=t,r=t.next;if(0<=gu(e,i,r))return!1;for(var n=t.next.next;n!==t.prev;){if(yu(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&0<=gu(n.prev,n,n.next))return!1;n=n.next}return!0}(t))e.push(s.i/i),e.push(t.i/i),e.push(l.i/i),xu(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?pu(t=function(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!vu(n,o)&&mu(n,r,r.next,o)&&_u(n,o)&&_u(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),xu(r),xu(r.next),r=t=o),r=r.next}while(r!==t);return r}(t,e,i),e,i,r,n,o,2):2===a&&function(t,e,i,r,n,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&mu(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&_u(t,e)&&_u(e,t)&&function(t,e){for(var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;i.y>o!=i.next.y>o&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),(i=i.next)!==t;);return r}(t,e)}(a,s)){var l=bu(a,s);return a=hu(a,a.next),l=hu(l,l.next),pu(a,e,i,r,n,o),pu(l,e,i,r,n,o)}s=s.next}a=a.next}while(a!==t)}(t,e,i,r,n,o):pu(hu(t),e,i,r,n,o,1);break}}}function fu(t,e){return t.x-e.x}function du(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)/n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function yu(t,e,i,r,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(r-s)-(i-a)*(e-s)&&0<=(i-a)*(o-s)-(n-a)*(r-s)}function gu(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function vu(t,e){return t.x===e.x&&t.y===e.y}function mu(t,e,i,r){return vu(t,e)&&vu(i,r)||vu(t,r)&&vu(i,e)||0<gu(t,e,i)!=0<gu(t,e,r)&&0<gu(i,r,t)!=0<gu(i,r,e)}function _u(t,e){return gu(t.prev,t,t.next)<0?0<=gu(t,e,t.next)&&0<=gu(t,t.prev,e):gu(t,e,t.prev)<0||gu(t,t.next,e)<0}function bu(t,e){var i=new Eu(t.i,t.x,t.y),r=new Eu(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(i.next=n).prev=i,(r.next=i).prev=r,(o.next=r).prev=o,r}function wu(t,e,i,r){var n=new Eu(t,e,i);return r?(n.next=r.next,(n.prev=r).next.prev=n,r.next=n):(n.prev=n).next=n,n}function xu(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Eu(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Au(t,e,i,r){for(var n=0,o=e,a=i-r;o<i;o+=r)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}uu.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,a=Math.abs(Au(t,0,o,i));if(n)for(var s=0,l=e.length;s<l;s++){var u=e[s]*i,c=s<l-1?e[s+1]*i:t.length;a-=Math.abs(Au(t,u,c,i))}var h=0;for(s=0;s<r.length;s+=3){var p=r[s]*i,f=r[s+1]*i,d=r[s+2]*i;h+=Math.abs((t[p]-t[d])*(t[1+f]-t[1+p])-(t[p]-t[f])*(t[1+d]-t[1+p]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},uu.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[n][o][a]);0<n&&(r+=t[n-1].length,i.holes.push(r))}return i};var Tu=[0,0,1];function ku(t,e,i,r){var n,o,a,s,l,u=r.texcoord_index,c=r.texcoord_scale,h=r.texcoord_normalize,p=e.vertex_elements;u&&(h=h||1,o=(n=Or(c||ou,4))[0],a=n[1],s=n[2],l=n[3]);for(var f,d=0,y=t.length,g=0;g<y;g++){var v,m,_,b,w,x=e.vertex_count,E=t[g];u&&(m=(v=Or(Qr.findBoundingBox(E),4))[0],_=v[1],b=(s-o)/(v[2]-m),w=(l-a)/(v[3]-_));for(var A=0;A<E.length;A++)for(var T=E[A],k=0;k<T.length;k++){var S=T[k];i[0]=S[0],i[1]=S[1],u&&(i[u+0]=((S[0]-m)*b+o)*h,i[u+1]=((S[1]-_)*w+a)*h),e.addVertex(i)}for(var M=(f=lu.flatten(E),lu(f.vertices,f.holes,f.dimensions)),I=0;I<M.length;I++)p.push(x+M[I]);d+=M.length/3}return d}var Su="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}",Mu="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}",Iu=Object.create(ua);Object.assign(Iu,{name:"polygons",built_in:!0,vertex_shader_src:Su,fragment_shader_src:Mu,selection:!0,init:function(){ua.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:Xl.SHORT,normalized:!1},{name:"a_normal",size:3,type:Xl.BYTE,normalized:!0},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&t.push({name:"a_texcoord",size:2,type:Xl.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new ru(t)),this.vertex_layout},_parseFeature:function(t,e,i){var r=this.feature_style;return r.color=this.parseColor(e.color,i),r.color?(r.z=e.z&&yo.evalCachedDistanceProperty(e.z,i)||yo.defaults.z,r.z*=Qr.height_scale,r.extrude=yo.evalProperty(e.extrude,i),r.extrude&&(!0===r.extrude?(r.height=void 0!==t.properties.height?t.properties.height:yo.defaults.height,r.min_height=void 0!==t.properties.min_height?t.properties.min_height:yo.defaults.min_height):"number"==typeof r.extrude?(r.height=r.extrude,r.min_height=0):Array.isArray(r.extrude)&&(r.min_height=r.extrude[0],r.height=r.extrude[1]),r.height*=Qr.height_scale,r.min_height*=Qr.height_scale),r.tile_edges=e.tile_edges,r):null},_preprocess:function(t){return t.color=yo.createColorPropertyCache(t.color),t.z=yo.createPropertyCache(t.z,yo.parseUnits),t},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=127,this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.texcoords&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildPolygons:function(t,e,i,r){var n=this.makeVertexTemplate(e),o={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!e.tile_edges,tile_edge_tolerance:Qr.tile_scale*r.tile.pad_scale*4,winding:r.winding};return e.extrude&&e.height?function(t,e,i,r,n,o,a,s,l){var u=l.remove_tile_edges,c=l.tile_edge_tolerance,h=l.texcoord_index,p=l.texcoord_scale,f=l.texcoord_normalize,d=l.winding,y=e+(r||0),g=e+i;o[2]=g;var v,m,_,b,w,x,E=ku(t,n,o,{texcoord_index:h,texcoord_scale:p,texcoord_normalize:f}),A=n.vertex_elements,T=n.vertex_count;h&&(f=f||1,m=(v=Or(p||ou,4))[0],_=v[1],b=v[2],x=[[m,w=v[3]],[m,_],[b,_],[b,w]]);for(var k=t.length,S=0;S<k;S++)for(var M=t[S],I=0;I<M.length;I++)for(var O=M[I],L=0;L<O.length-1;L++)if(!u||!au(O[L],O[L+1],c)){var C,R=void 0,N=[[O[C="CCW"===d?(R=L)+1:(R=L+1,L)][0],O[C][1],g],[O[C][0],O[C][1],y],[O[R][0],O[R][1],y],[O[R][0],O[R][1],g]],P=ea.normalize([O[C][0]-O[R][0],O[C][1]-O[R][1],0]),j=ea.cross(Tu,P);o[a+0]=127*j[0],o[a+1]=127*j[1],o[a+2]=127*j[2];for(var D=0;D<N.length;D++)o[0]=N[D][0],o[1]=N[D][1],o[2]=N[D][2],h&&(o[h+0]=x[D][0]*f,o[h+1]=x[D][1]*f),n.addVertex(o);A.push(T+0),A.push(T+1),A.push(T+2),A.push(T+2),A.push(T+3),A.push(T+0),T+=4,E+=2}return E}(t,e.z,e.height,e.min_height,i.vertex_data,n,this.vertex_layout.index.a_normal,0,o):ku(t,i.vertex_data,n,o)}});var Ou=[0,0],Lu={butt:0,square:1,round:2},Cu={miter:0,bevel:1,round:2},Ru=Qr.tile_scale,Nu=[0,0],Pu=[1,0],ju=[.5,0];function Du(t,e){if(!(t.length<2)){var i,r,n=e.join_type,o=e.cap_type,a=e.closed_polygon,s=e.remove_tile_edges,l=e.tile_edge_tolerance,u=e.v_scale,c=e.miter_len_sq,h=e.crop_by_tile,p=null!=e.texcoord_index,f=0;if(a&&n===Cu.miter){var d=function(t){if(su(t[0]))return 0;for(var e=0;e<t.length;e++)if(su(t[t.length-1-e]))return t.length-1-e;return 0}(t);if(0!==d){var y=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=(r+e)%t.length;0!=n&&i.push(t[n])}return i.push(i[0]),i}(t,d);return e.extra_lines=e.extra_lines||[],void e.extra_lines.push(y)}}var g=0,v=t.length-1,m=0;for(E=t[g],A=t[g+1];ea.isEqual(E,A);)if(E=A,A=t[1+ ++g],m++,g===t.length-1)return;for(;ea.isEqual(t[v],t[v-1]);)if(m++,0==--v)return;if(!(t.length<2+m))if(r=ea.normalize(ea.perp(E,A)),s&&au(E,A,l)){var _=zu(t,g,l);_&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(_))}else{a?function(t,e,i,r,n){void 0===r||su(t)&&!n.crop_by_tile?(Uu(t,i,i,1,0,n,1),Uu(t,i,i,0,0,n,-1)):r===Cu.miter?Gu(0,t,e,i,n.miter_len_sq,!0,n):Hu(r,0,t,e,i,!0,n)}(E,i=ea.normalize(ea.perp(t[v-1],E)),r,n,e):(!h&&su(E)||(Yu(E,f,r,o,!0,e),p&&o!==Lu.butt&&(f+=.5*u*e.texcoord_width)),Uu(E,r,r,1,f,e,1),Uu(E,r,r,0,f,e,-1)),p&&(f+=u*ea.length(ea.sub(A,E)));for(var b=g+1;b<v;b++){var w=b,x=b+1,E=t[w],A=t[x];if(!ea.isEqual(E,A)){if(s&&au(E,A,l)){Uu(E,r,r,1,f,e,1),Uu(E,r,r,0,f,e,-1),Bu(1,e);var T=zu(t,w+1,l);return void(T&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(T)))}i=r,r=ea.normalize(ea.perp(E,A)),n===Cu.miter?Gu(f,E,i,r,c,!1,e):Hu(n,f,E,i,r,!1,e),p&&(f+=u*ea.length(ea.sub(A,E)))}}E=A,i=r,a?function(t,e,i,r,n,o){var a;su(t)&&!o.crop_by_tile?(Uu(t,e,e,1,n,o,1),Uu(t,e,e,0,n,o,-1)):(a=Fu(e,i),r===Cu.miter&&ea.lengthSq(a)>o.miter_len_sq&&(r=Cu.bevel),r===Cu.miter?(Uu(t,a,e,1,n,o,1),Uu(t,a,e,0,n,o,-1)):(Uu(t,e,e,1,n,o,1),Uu(t,e,e,0,n,o,-1))),Bu(1,o)}(E,i,r=ea.normalize(ea.perp(E,t[1])),n,f,e):(Uu(E,i,r,1,f,e,1),Uu(E,i,r,0,f,e,-1),Bu(1,e),!h&&su(E)||Yu(E,f,i,o,!1,e))}}}function zu(t,e,i){for(var r=e;t[r+1]&&au(t[r],t[r+1],i);)r++;return 2<=t.length-r&&t.slice(r)}function Fu(t,e){var i=ea.normalize(ea.add(t,e)),r=2/(1+Math.abs(ea.dot(t,i)));return ea.mult(i,r*r)}function Gu(t,e,i,r,n,o,a){var s=Fu(i,r);ea.lengthSq(s)>n?Hu(Cu.bevel,t,e,i,r,o,a):(Uu(e,s,s,1,t,a,1),Uu(e,s,s,0,t,a,-1),o||Bu(1,a))}function Hu(t,e,i,r,n,o,a){var s=Fu(r,n),l=0<n[0]*r[1]-n[1]*r[0];null!=a.texcoord_index&&(Nu[1]=e,Pu[1]=e),l?(Uu(i,s,s,1,e,a,1),Uu(i,r,s,0,e,a,-1),o||Bu(1,a),qu(i,ea.neg(r),s,ea.neg(n),s,Nu,Pu,Nu,!1,t===Cu.bevel,a),Uu(i,s,s,1,e,a,1),Uu(i,n,s,0,e,a,-1)):(Uu(i,r,s,1,e,a,1),Uu(i,s,s,0,e,a,-1),o||Bu(1,a),qu(i,r,ea.neg(s),n,s,Pu,Nu,Pu,!1,t===Cu.bevel,a),Uu(i,n,s,1,e,a,1),Uu(i,s,s,0,e,a,-1))}function Bu(t,e){for(var i=e.vertex_data.vertex_elements,r=e.vertex_data.vertex_count-2*t-2,n=0;n<t;n++)i.push(r+2*n+2),i.push(r+2*n+1),i.push(r+2*n),i.push(r+2*n+2),i.push(r+2*n+3),i.push(r+2*n+1),e.geom_count+=2}function Uu(t,e,i,r,n,o,a){var s=o.vertex_template,l=o.vertex_data;s[0]=t[0],s[1]=t[1];var u=o.half_width*a;s[o.extrude_index+0]=e[0]*u,s[o.extrude_index+1]=e[1]*u,o.offset&&(s[o.offset_index+0]=i[0]*o.offset,s[o.offset_index+1]=i[1]*o.offset),null!=o.texcoord_index&&(s[o.texcoord_index+0]=r*o.texcoord_normalize,s[o.texcoord_index+1]=n*o.texcoord_normalize),l.addVertex(s)}var Vu=[0,0];function qu(t,e,i,r,n,o,a,s,l,u,c){for(var h=e[0]*r[1]-e[1]*r[0],p=ea.dot(e,r),f=Math.atan2(h,p);f>=Math.PI;)f-=2*Math.PI;if(u)d=1;else{var d=function(t,e){t<0&&(t=-t);var i=e>10?Math.log2(e/5):1;return Math.ceil(t/Math.PI*i)}(f,c.half_width);if(d<1)return}var y=c.vertex_data.vertex_count,g=c.vertex_data.vertex_elements;Uu(t,i,n,a[0],a[1],c,1),Uu(t,e,n,o[0],o[1],c,1);var v,m,_=e,b=null!=c.texcoord_index;b&&(l?v=ea.sub(o,a):(Vu=ea.copy(o),m=ea.div(ea.sub(s,o),d)));for(var w,x=f/d,E=f<0?-1:1,A=0<h?(w=2,1):(w=1,2),T=0;T<d;T++)0===T&&f<0&&(_=ea.neg(_)),_=ea.rot(_,x),b&&(l?(v=ea.rot(v,x),Vu[0]=v[0]+a[0],Vu[1]=v[1]*c.texcoord_width*c.v_scale+a[1]):Vu=ea.add(Vu,m)),Uu(t,_,n,Vu[0],Vu[1],c,E),g.push(y+T+w),g.push(y),g.push(y+T+A)}function Yu(t,e,i,r,n,o){var a,s=ea.neg(i),l=null!=o.texcoord_index;switch(r){case Lu.square:n?(a=[i[1],-i[0]],Uu(t,ea.add(i,a),i,1,e,o,1),Uu(t,ea.add(s,a),i,0,e,o,1),l&&(e+=.5*o.texcoord_width*o.v_scale),Uu(t,i,i,1,e,o,1),Uu(t,s,i,0,e,o,1)):(a=[-i[1],i[0]],Uu(t,i,i,1,e,o,1),Uu(t,s,i,0,e,o,1),l&&(e+=.5*o.texcoord_width*o.v_scale),Uu(t,ea.add(i,a),i,1,e,o,1),Uu(t,ea.add(s,a),i,0,e,o,1)),Bu(1,o);break;case Lu.round:var u,c,h=Nu,p=Pu,f=ju;n?(u=i,c=s,l&&(e+=.5*o.texcoord_width*o.v_scale,h=Pu,p=Nu,f=ju)):(u=s,c=i),l&&(Nu[1]=e,Pu[1]=e,ju[1]=e),qu(t,u,Ou,c,i,h,f,p,!0,!1,o);break;case Lu.butt:return}}var Wu=[255,255,255,255],Zu=[0,0,0,0],Ku=Object.create(ua);function Xu(t,e,i,r,n,o){for(var a={closed:o,vertex_data:i,vertex_template:r,half_width:e/2,vertex_layout_index:n,geom_count:0},s=0,l=t.length;s<l;s++)!function(t,e){if(!(t.length<2)){for(var i=[t[0]],r=0,n=[],o=[],a=1,s=t.length;a<s;a++){var l,u;t[a][0]===t[a-1][0]&&t[a][1]===t[a-1][1]||(i.push(t[a]),l=ea.sub(t[a],t[a-1]),u=ea.length(l),n.push(l),o.push([r,r+u]),r+=u)}if(!(i.length<2)){var c=0,h=n[n.length-1],p=n[0],f=n[1],d=[0,0];2<i.length&&(e.closed&&(d[0]=ea.signedAngleBetween(h,p)),d[1]=ea.signedAngleBetween(p,f));var y=i[0],g=o[0];e.closed?($u(y,e,c++,g,r,d,[h,p]),$u(y,e,c++,g,r,d,[h,p])):($u(y,e,c++,g,r,d,[p,p]),$u(y,e,c++,g,r,d,[p,p]));for(var v=1,m=i.length-1;v<m;v++)y=i[v],h=n[v-1],p=n[v],f=n[v+1],$u(y,e,c++,g=o[v-1],r,d,[h,p]),$u(y,e,c++,g,r,d,[h,p]),Ju(e),g=o[v],d[0]=d[1],d[1]=v!==m-1?ea.signedAngleBetween(p,f):e.closed?ea.signedAngleBetween(p,n[0]):0,$u(y,e,c++,g,r,d,[h,p]),$u(y,e,c++,g,r,d,[h,p]);y=i[i.length-1],g=o[o.length-1],p=n[n.length-1],e.closed?($u(y,e,c++,g,r,d,[p,n[0]]),$u(y,e,c++,g,r,d,[p,n[0]])):($u(y,e,c++,g,r,d,[p,p]),$u(y,e,c++,g,r,d,[p,p])),Ju(e)}}}(t[s],a);return a.geom_count}function Ju(t){var e=t.vertex_data.vertex_elements,i=t.vertex_data.vertex_count-4;e.push(2+i),e.push(1+i),e.push(i),e.push(2+i),e.push(3+i),e.push(1+i),t.geom_count+=2}Ku.vertex_layouts=[[],[]],Ku.dash_textures={},Object.assign(Ku,{name:"lines",built_in:!0,vertex_shader_src:Su,fragment_shader_src:Mu,selection:!0,init:function(){ua.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(t,e){return t&&yo.evalCachedDistanceProperty(t,e)||0},calcDistanceNextZoom:function(t,e){e.zoom++;var i=this.calcDistance(t,e);return e.zoom--,i},calcWidth:function(t,e,i){var r=this.calcDistance(t.width,i);if(!(r<0)){var n,o=t.next_width?this.calcDistanceNextZoom(t.next_width,i):r/2;return!(0===r&&0===o||o<0||(e.width_unscaled=r,e.next_width_unscaled=o,t.next_width?(n=.5*(r+(o*=2)),e.width=n*i.units_per_meter_overzoom,e.width_scale=1-o/n):(e.width=r*i.units_per_meter_overzoom,e.width_scale=0),t.texcoords&&(t.inline_texcoord_width?e.texcoord_width=t.inline_texcoord_width:e.texcoord_width=(e.width_unscaled||e.next_width_unscaled)*i.units_per_meter_overzoom/i.tile.overzoom2),0))}},calcOffset:function(t,e,i){var r,n;t.offset_precalc?(e.offset=t.offset_precalc,e.offset_scale=t.offset_scale_precalc):t.offset?(r=this.calcDistance(t.offset,i),t.next_offset?(n=2*this.calcDistanceNextZoom(t.next_offset,i),Math.abs(r)>=Math.abs(n)?(e.offset=r*i.units_per_meter_overzoom,e.offset_scale=0!==r?1-n/r:0):(e.offset=n*i.units_per_meter_overzoom,e.offset_scale=0!=n?-1*(1-r/n):0)):(e.offset=r*i.units_per_meter_overzoom,e.offset_scale=0)):(e.offset=0,e.offset_scale=0),yo.evalProperty(t.offset_reverse,i)&&(e.offset*=-1)},_parseFeature:function(t,e,i){var r,n,o=this.feature_style;if(!1!==this.calcWidth(e,o,i)&&(this.calcOffset(e,o,i),o.color=this.parseColor(e.color,i),o.color))return o.variantKey=e.variantKey,o.z=e.z&&yo.evalCachedDistanceProperty(e.z||0,i)||yo.defaults.z,o.height=t.properties.height||yo.defaults.height,o.extrude=yo.evalProperty(e.extrude,i),o.extrude&&("number"==typeof o.extrude?o.height=o.extrude:Array.isArray(o.extrude)&&(o.height=o.extrude[1])),o.extrude&&o.height&&(o.z+=o.height),o.z*=Qr.height_scale,o.height*=Qr.height_scale,o.cap=yo.evalProperty(e.cap,i),o.join=yo.evalProperty(e.join,i),o.miter_limit=yo.evalProperty(e.miter_limit,i),o.tile_edges=e.tile_edges,o.outline=o.outline||{width:{},next_width:{},preprocessed:!0},e.outline&&!1!==e.outline.visible&&e.outline.color&&e.outline.width?(r=2*this.calcDistance(e.outline.width,i),n=2*this.calcDistanceNextZoom(e.outline.next_width,i),0==r&&0==n||r<0||n<0?(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null,o.outline.texcoords=!1):(o.outline.width.value=r+o.width_unscaled,o.outline.next_width.value=n+o.next_width_unscaled,o.outline.inline_texcoord_width=o.texcoord_width,o.outline.offset_precalc=o.offset,o.outline.offset_scale_precalc=o.offset_scale,o.outline.color=e.outline.color,o.outline.cap=e.outline.cap,o.outline.join=e.outline.join,o.outline.miter_limit=e.outline.miter_limit,o.outline.texcoords=e.outline.texcoords,o.outline.style=e.outline.style,o.outline.variantKey=e.outline.variantKey,e.outline.order?o.outline.order=this.parseOrder(e.outline.order,i):o.outline.order=o.order,o.outline.order>o.order&&(o.outline.order=o.order),o.outline.order-=.5,o.outline.variant_order=0)):(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null),o},_preprocess:function(t,e){var i,r=this.sources[e]?this.sources[e].config.uid:"";return t.color=yo.createColorPropertyCache(t.color),t.width=yo.createPropertyCache(t.width,yo.parseUnits),t.width&&t.width.type!==yo.CACHE_TYPE.STATIC&&(t.next_width=yo.createPropertyCache(t.width,yo.parseUnits)),t.offset=t.offset&&yo.createPropertyCache(t.offset,yo.parseUnits),t.offset&&t.offset.type!==yo.CACHE_TYPE.STATIC&&(t.next_offset=yo.createPropertyCache(t.offset,yo.parseUnits)),t.z=yo.createPropertyCache(t.z,yo.parseUnits),t.dash=void 0!==t.dash?t.dash:this.dash,t.dash_key=t.dash&&this.dashTextureKey(t.dash,r),t.dash_background_color=void 0!==t.dash_background_color?t.dash_background_color:this.dash_background_color,t.dash_background_color=t.dash_background_color&&yo.parseColor(t.dash_background_color),t.texture_merged=t.dash_key||(void 0!==t.texture?t.texture:this.texture),t.texcoords=this.texcoords||t.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t),t.outline&&(t.outline.style=t.outline.style||this.name,t.outline.color=yo.createColorPropertyCache(t.outline.color),t.outline.width=yo.createPropertyCache(t.outline.width,yo.parseUnits),t.outline.next_width=yo.createPropertyCache(t.outline.width,yo.parseUnits),t.outline.cap=t.outline.cap||t.cap,t.outline.join=t.outline.join||t.join,t.outline.miter_limit=t.outline.miter_limit||t.miter_limit,t.outline.offset=t.offset,(i=this.styles[t.outline.style])?(t.outline.dash=void 0!==t.outline.dash?t.outline.dash:i.dash,t.outline.texture=void 0!==t.outline.texture?t.outline.texture:i.texture,null!=t.outline.dash?(t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,r),t.outline.texture_merged=t.outline.dash_key):null===t.outline.dash||null!=t.outline.texture?(t.outline.dash_key=null,t.outline.texture_merged=t.outline.texture):(t.outline.dash=t.dash,t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,r),t.outline.texture_merged=t.outline.dash_key),t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:i.dash_background_color,t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:t.dash_background_color,t.outline.dash_background_color=t.outline.dash_background_color&&yo.parseColor(t.outline.dash_background_color),t.outline.texcoords=i.texcoords||t.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t.outline)):(En({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(t.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),t.outline=null)),t},dashTextureKey:function(t,e){return"__dash_"+e+"_"+this.scene_id+"_"+JSON.stringify(t)},getDashTexture:function(t,e){var i,r=this.dashTextureKey(t,this.sources[e].config.uid);null==Ku.dash_textures[r]&&(Ku.dash_textures[r]=!0,i=function(t,e){var i=1<arguments.length&&void 0!==e?e:{},r=i.dash_color||Wu,n=i.background_color||Zu,o=t,a=i.scale||1;o.length%2==1&&Array.prototype.push.apply(o,o);for(var s=!0,l=[],u=0;u<o.length;u++){for(var c=Math.floor(o[u]*a),h=0;h<c;h++)Array.prototype.push.apply(l,s?r:n);s=!s}return{pixels:l=new Uint8Array(l),length:l.length/4}}(t,{scale:20}),this.textureManager.create(this.gl,r,{data:i.pixels,height:i.length,width:1,filtering:"nearest"}))},endData:function(t){var e=this;return ua.endData.call(this,t).then((function(i){if(i){i.uniforms.u_has_line_texture=!1,i.uniforms.u_texture=e.textureManager.default,i.uniforms.u_v_scale_adjust=Qr.tile_scale;var r=[];for(var n in i.meshes)!function(n){var o,a,s=i.meshes[n].variant;s.texture&&((o=i.meshes[n].uniforms=i.meshes[n].uniforms||{}).u_has_line_texture=!0,o.u_texture=s.texture,o.u_texture_ratio=1,s.dash&&(o.u_v_scale_adjust=20*Qr.tile_scale,o.u_dash_background_color=s.dash_background_color||[0,0,0,0]),s.dash_key&&null==Ku.dash_textures[s.dash_key]&&(Ku.dash_textures[s.dash_key]=!0,un.postMessage(e.main_thread_target+".getDashTexture",s.dash,t.source)),null==e.textureManager.textures[s.texture]?r.push(e.textureManager.syncTexturesToWorker([s.texture]).then((function(t){var e=t[s.texture];e&&(o.u_texture_ratio=e.height/e.width)}))):(a=e.textureManager.textures[s.texture],o.u_texture_ratio=a.height/a.width))}(n);return t.mesh_data[e.name]=i,Promise.all(r).then((function(){return i}))}return i}))},computeVariantForDraw:function(t){var e=t.offset?1:0;return t.dash_key&&(e+=t.dash_key,t.dash_background_color&&(e+=t.dash_background_color)),t.texture_merged&&(e+=t.texture_merged),e=qo(e+="/"+t.texcoords),{key:t.variantKey=e,order:t.variant_order,offset:t.offset?1:0,texcoords:t.texcoords,texture:t.texture_merged,dash:t.dash,dash_key:t.dash_key,dash_background_color:t.dash_background_color}},vertexLayoutForMeshVariant:function(t){var e;return null==Ku.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:Xl.SHORT,normalized:!1},{name:"a_extrude",size:2,type:Xl.SHORT,normalized:!1},{name:"a_offset",size:2,type:Xl.SHORT,normalized:!1,static:t.offset?null:[0,0]},{name:"a_scaling",size:2,type:Xl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:Xl.UNSIGNED_SHORT,normalized:!0,static:t.texcoords?null:[0,0]},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0}],Ku.vertex_layouts[t.key]=new ru(e)),Ku.vertex_layouts[t.key]},makeVertexTemplate:function(t,e){var i=0;return this.vertex_template[i++]=0,this.vertex_template[i++]=0,this.vertex_template[i++]=t.z||0,this.vertex_template[i++]=this.scaleOrder(t.order),this.vertex_template[i++]=0,this.vertex_template[i++]=0,e.variant.offset&&(this.vertex_template[i++]=0,this.vertex_template[i++]=0),this.vertex_template[i++]=1024*t.width_scale,this.vertex_template[i++]=1024*t.offset_scale,e.variant.texcoords&&(this.vertex_template[i++]=0,this.vertex_template[i++]=0),this.vertex_template[i++]=255*t.color[0],this.vertex_template[i++]=255*t.color[1],this.vertex_template[i++]=255*t.color[2],this.vertex_template[i++]=255*t.color[3],this.selection&&(this.vertex_template[i++]=255*t.selection_color[0],this.vertex_template[i++]=255*t.selection_color[1],this.vertex_template[i++]=255*t.selection_color[2],this.vertex_template[i++]=255*t.selection_color[3]),this.vertex_template},buildLines:function(t,e,i,r,n){var o;this.feature_style=this.outline_feature_style,!e.outline||null==e.outline.color||null==e.outline.width.value||(o=this.styles[e.outline.style])&&o.addFeature(r.feature,e.outline,r),this.feature_style=this.inline_feature_style;var a=i.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(e,i);return function(t,e,i,r,n){var o,a,s=n.texcoord_index,l=n.texcoord_width,u=n.texcoord_ratio,c=n.texcoord_normalize,h=n.join,p=n.cap,f=n.miter_limit,d=h?Cu[h]:Cu.miter;d===Cu.miter&&(o=(f=f||3)*f),s&&(c=c||1,a=1/(l*(u=u||1)*Ru));for(var y={closed_polygon:n.closed_polygon,remove_tile_edges:n.remove_tile_edges,tile_edge_tolerance:n.tile_edge_tolerance,miter_len_sq:o,join_type:d,cap_type:p?Lu[p]:Lu.butt,vertex_data:i,vertex_template:r,half_width:e/2,extrude_index:n.extrude_index,offset_index:n.offset_index,v_scale:a,texcoord_index:s,texcoord_width:l,texcoord_normalize:c,offset:n.offset,geom_count:0,crop_by_tile:n.crop_by_tile},g=0;g<t.length;g++)Du(t[g],y);if(y.extra_lines)for(var v=0;v<y.extra_lines.length;v++)Du(y.extra_lines[v],y);return y.geom_count}(t,e.width,a,l,{cap:e.cap,join:e.join,miter_limit:e.miter_limit,extrude_index:s.index.a_extrude,offset_index:s.index.a_offset,texcoord_index:s.index.a_texcoord,texcoord_width:e.texcoord_width,texcoord_normalize:65535,closed_polygon:n&&n.closed_polygon,remove_tile_edges:!e.tile_edges&&n&&n.remove_tile_edges,tile_edge_tolerance:Qr.tile_scale*r.tile.pad_scale*2,offset:e.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(t,e,i,r){for(var n=0,o=0;o<t.length;o++)n+=this.buildLines(t[o],e,i,r,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return n}});var Qu=[[1,1],[1,-1],[-1,1],[-1,-1]];function $u(t,e,i,r,n,o,a){var s,l=e.vertex_template,u=e.vertex_data;tc(e,"a_position",t),tc(e,"a_width",e.half_width),e.vertex_layout_index.a_barycentric&&((s=[0,0,0])[i%3]=1,tc(e,"a_barycentric",s)),tc(e,"a_tangents",a[0].concat(a[1])),tc(e,"a_segment",r),tc(e,"a_texcoord",Qu[i%4]),tc(e,"a_length",n),tc(e,"a_closed",e.closed?1:0),tc(e,"a_angles",o),u.addVertex(l)}function tc(t,e,i){var r=i.length,n=t.vertex_template,o=t.vertex_layout_index[e],a=0;if(r)for(;a!==r;)n[o+a]=i[a],a++;else n[o+a]=i}function ec(t,e){for(var i=t.reduce((function(t,e){return t+e})),r=0,n=[],o=0,a=t.length;o<=a;o+=2){var s=Math.max(1e-4,t[o%a]),l=Math.max(1e-4,t[(o+1)%a]);n.push(r,r+s),r+=s+l}for(var u=new Uint8Array(4*e),c=0,h=0;h<e;h++)!function(t){var r=i*t/(e-1),o=function(t){for(var e=t[0],i=0,r=1,n=t.length;r<n;r++)t[r]<e&&(e=t[i=r]);return i}(n.map((function(t){return Math.abs(t-r)}))),a=void 0,s=void 0,l=o%2==0?(a=r<=n[o]?1:0,s=n[o],n[o+1]):(a=r>n[o]?2:0,s=n[o-1],n[o]);u[c++]=n[o],u[c++]=a,u[c++]=s,u[c++]=l}(h);return u}var ic=Object.create(ua),rc={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},nc={miter:0,round:1,bevel:2},oc=rc.round,ac=nc.miter,sc=[0,0],lc="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");Object.assign(ic,{name:"pattern-lines",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka ±1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,±1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}",selection:!0,init:function(){ua.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},ic.vertex_layouts=[]},calcDistance:function(t,e){return t&&yo.evalCachedDistanceProperty(t,e)||0},calcDash:function(t,e){var i=yo.evalProperty(t.dash,e),r=0;return i&&((i=Array.isArray(i)&&i.length?i:sc).length%2==1&&(i=i.concat(i)),r=+(r=i.reduce((function(t,e){return t+e})))||0),{dash:i,dash_period:r}},calcWidth:function(t,e,i){var r=this.calcDistance(t.width,i);return!(r<0||(e.width=r*i.units_per_meter_overzoom,0))},getCapType:function(t,e,i){var r=yo.evalProperty(t,e);return void 0!==rc[r]?rc[r]:i},_parseFeature:function(t,e,i){if(!1!==this.calcWidth(e,this.feature_style,i)){var r=this.parseColor(e.color,i);if(r&&0!==r[3]){var n=this.getCapType(e.cap,i,oc),o=yo.evalProperty(e.join,i),a=+yo.evalProperty(e.miter_limit,i),s=this.calcDash(e,i),l=s.dash,u=s.dash_period,c=Object.assign({color:r,antialias:e.antialias,linecaps:[this.getCapType(e.tail_cap,i,n),this.getCapType(e.head_cap,i,n)],join:void 0!==nc[o]?nc[o]:ac,miter_limit:0<=a?a:3,dash_index:0===u?0:1,dash:l,dash_caps:[this.getCapType(e.tail_cap,i,n),this.getCapType(e.head_cap,i,n)],dash_phase:+yo.evalProperty(e.dash_phase,i)||0,dash_period:u},this.feature_style);return c.z=e.z&&yo.evalCachedDistanceProperty(e.z||0,i)||yo.defaults.z,c.z*=Qr.height_scale,c.extrude=yo.evalProperty(e.extrude,i),c.extrude&&(!0===c.extrude?(c.height=void 0!==t.properties.height?t.properties.height:yo.defaults.height,c.min_height=void 0!==t.properties.min_height?t.properties.min_height:yo.defaults.min_height):"number"==typeof c.extrude?(c.height=c.extrude,c.min_height=0):Array.isArray(c.extrude)&&(c.min_height=c.extrude[0],c.height=c.extrude[1]),c.height*=Qr.height_scale,c.min_height*=Qr.height_scale),this.addMeshVariantForDraw(this.base,c),c}}},_preprocess:function(t){t.color=yo.createColorPropertyCache(t.color),t.width=yo.createPropertyCache(t.width,yo.parseUnits),t.width&&t.width.type!==yo.CACHE_TYPE.STATIC&&(t.next_width=yo.createPropertyCache(t.width,yo.parseUnits)),t.z=yo.createPropertyCache(t.z,yo.parseUnits);var e=+t.antialias;return t.antialias=isNaN(e)?0:e,t},buildRasterTextures:function(t,e){var i=[];for(var r in e.meshes){var n,o=this.getMeshVariantTypeForDraw({variantKey:r}),a=o.uniforms,s=o.pattern;a.u_dash_index&&(n="__dash_"+s.join("_")+"_"+t.key+"_"+t.id,i.push({name:n,data:ec(s,1024)}),a.u_dash_atlas=n,e.meshes[r].textures=[n]),e.meshes[r].uniforms=a}return e.uniforms=e.uniforms||{},i.length?un.postMessage(this.main_thread_target+".loadTextures",i).then((function(t){return e})):Promise.resolve(e)},loadTextures:function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i],n=(n=this.textureManager.textures[r.name])||this.textureManager.create(this.gl,r.name,{filtering:"nearest",repeat:!0,width:1024,height:1,data:r.data});e.push(n.loading)}return Promise.all(e).then((function(t){return t.map((function(t){return t.retain(),t.name}))}))},computeVariantForDraw:function(t){var e=function(t){for(var e=[],i=0,r=lc.length;i<r;i++){var n=t[lc[i]];Array.isArray(n)?e.push(n.join("_")):"boolean"==typeof n?e.push(n?1:0):n&&e.push(n.toString())}return e.join("/")}(t);return{key:t.variantKey=e,order:t.variant_order,uniforms:{u_antialias:t.antialias,u_linecaps:t.linecaps,u_linejoin:t.join,u_miter_limit:t.miter_limit,u_dash_index:t.dash_index,u_dash_caps:t.dash_caps,u_dash_phase:t.dash_phase,u_dash_period:t.dash_period},pattern:t.dash}},vertexLayoutForMeshVariant:function(t){var e;return null==ic.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:Xl.SHORT,normalized:!1},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:Xl.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:Xl.FLOAT,normalized:!1},{name:"a_segment",size:2,type:Xl.FLOAT,normalized:!1},{name:"a_angles",size:2,type:Xl.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:Xl.FLOAT,normalized:!0},{name:"a_length",size:1,type:Xl.FLOAT,normalized:!1},{name:"a_closed",size:1,type:Xl.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&e.push({name:"a_barycentric",size:3,type:Xl.SHORT,normalized:!1}),ic.vertex_layouts[t.key]=new ru(e)),ic.vertex_layouts[t.key]},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z+t.height||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildLines:function(t,e,i,r,n){var o=4<arguments.length&&void 0!==n&&n,a=i.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(e,i);return Xu(t,e.width,a,l,s.index,o)},buildPolygons:function(t,e,i,r){for(var n=0,o=0,a=t.length;o<a;o++)n+=this.buildLines(t[o],e,i,r,!0);return n}});var uc=0,cc={id_prefix:"",nextLabelId:function(){return"".concat(cc.id_prefix,"/").concat(uc++)}};function hc(t){return{priority:t.priority,collide:t.collide,repeat_distance:t.repeat_distance,repeat_group:t.repeat_group,buffer:t.buffer,italic:t.italic}}var pc=["left","top-left","bottom-left"],fc=["right","top-right","bottom-right"],dc=["top","top-left","top-right"],yc=["bottom","bottom-left","bottom-right"],gc={computeOffset:function(t,e,i,r){var n=3<arguments.length&&void 0!==r?r:null;if(!i||"center"===i)return t;var o=[t[0],t[1]];return n=n||this.default_buffer,this.isLeftAnchor(i)?(o[0]-=e[0]/2,"left"===i&&(o[0]-=n[0])):this.isRightAnchor(i)&&(o[0]+=e[0]/2,"right"===i&&(o[0]+=n[1])),this.isTopAnchor(i)?(o[1]-=e[1]/2,"top"===i&&(o[1]-=n[2])):this.isBottomAnchor(i)&&(o[1]+=e[1]/2,"bottom"===i&&(o[1]+=n[3])),o},alignForAnchor:function(t){if(t&&"center"!==t){if(this.isLeftAnchor(t))return"right";if(this.isRightAnchor(t))return"left"}return"center"},isLeftAnchor:function(t){return-1<pc.indexOf(t)},isRightAnchor:function(t){return-1<fc.indexOf(t)},isTopAnchor:function(t){return-1<dc.indexOf(t)},isBottomAnchor:function(t){return-1<yc.indexOf(t)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function vc(t,e,i,r,n){var o=[],a=i-t,s=r-e,l=Xr.getLineLength(t,e,i,r),u=2*n;if((c=l/u)<=1)o.push(t+a/2,e+s/2,n);else{var c,h=u/l,p=a*h,f=s*h;(c=l/n/2)%1&&o.push(i-p/2,r-f/2,n),c|=0;for(var d=t+p/2,y=e+f/2;c--;)o.push(d,y,n),d+=p,y+=f}return o}var mc=function(){function t(e,i,r,n){vr(this,t),this.id=cc.nextLabelId(),this.position=[e[0],e[1]],void 0!==e[2]&&this.position.push(e[2]),this.size=i,this.layout=n,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||gc.alignForAnchor(this.anchor),this._is_flat=r}return _r(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:hc(this.layout)}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,i=t.top,r=t.right,n=t.bottom;return Tn.pointInTile([e,i])&&Tn.pointInTile([r,n])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(t){this._circles=void 0,this._aabb=void 0,this.anchor=t,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var t,e=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(t=this.parent,e=gc.computeOffset(e,t.size,t.anchor,gc.zero_buffer),e=gc.computeOffset(e,t.size,this.anchor,gc.zero_buffer),t.offset!==yo.zeroPair&&(e===yo.zeroPair?e=t.offset:(e[0]+=t.offset[0],e[1]+=t.offset[1]))),gc.computeOffset(e,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(t=this.layout.units_per_pixel,n=-(i=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(r=e*Math.sin(this.angle)),s=(a=Or(this.position,2))[0],l=a[1],i+=s,r+=l*=-1,n+=s,o+=l,u=this.size[1]/2*t,this._circles=vc(i,r,n,o,u)),this._circles):[];var t,e,i,r,n,o,a,s,l,u}},{key:"getAABB",value:function(){var t,e,i,r,n;return this._aabb||(t=this.layout.units_per_pixel,e=(this.size[0]/2+this.layout.buffer[0])*t,i=(this.size[1]/2+this.layout.buffer[1])*t,r=this.position[0]+this.offset[0]*t,n=this.position[1]-this.offset[1]*t,this._aabb={left:r-e,top:n+i,right:r+e,bottom:n-i}),this._aabb}},{key:"getSides",value:function(){var t=this.getAABB(),e=t.left,i=t.top,r=t.right,n=(i+t.bottom)/2;return[e,n,r,n]}}]),t}();mc.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var _c=mc.PLACEMENT;function bc(t,e,i,r){var n=[],o=r.placement,a=Math.max(e[0],e[1])*r.placement_min_length_ratio*r.units_per_pixel;switch(o){case _c.SPACED:var s=function(t,e,i){var r=i.units_per_pixel,n=(i.placement_spacing||80)*r,o=function(t){for(var e=0,i=0;i<t.length-1;i++)e+=xc(t[i],t[i+1]);return e}(t);if(o<=e)return!1;for(var a=Math.max(Math.floor(o/n),1),s=[],l=[],u=.5*(o-(a-1)*n),c=0;c<a;c++){var h=function(t,e,i,r){for(var n,o,a=0,s=0;s<t.length-1;s++){var l=t[s],u=t[s+1],c=xc(l,u);if(!(c<=i)&&e<(a+=c)){n=function(t,e,i){var r=i/xc(t,e);return[r*t[0]+(1-r)*e[0],r*t[1]+(1-r)*e[1]]}(l,u,a-e),o=wc(l,u,r.angle);break}}return{position:n,angle:o}}(t,u,e,i),p=h.position,f=h.angle;null!=p&&null!=f&&(s.push(p),l.push(f)),u+=n}return{positions:s,angles:l}}(t,a,r);if(!s)return[];for(var l=s.positions,u=s.angles,c=0;c<l.length;c++){var h,p=l[c],f=u[c];!0!==r.tile_edges&&su(p)||((h=new mc(p,e,i,r)).angle=f,n.push(h))}break;case _c.VERTEX:for(var d,y,g,v=0;v<t.length-1;v++)d=t[v],y=t[v+1],!0!==r.tile_edges&&su(d)||((g=new mc(d,e,i,r)).angle=wc(d,y,r.angle),n.push(g));(g=new mc(y,e,i,r)).angle=wc(d,y,r.angle),n.push(g);break;case _c.MIDPOINT:for(var m=0;m<t.length-1;m++){var _,b=t[m],w=t[m+1],x=[.5*(b[0]+w[0]),.5*(b[1]+w[1])];!0!==r.tile_edges&&su(x)||(!a||xc(b,w)>a)&&((_=new mc(x,e,i,r)).angle=wc(b,w,r.angle),n.push(_))}}return n}function wc(t,e,i){var r=2<arguments.length&&void 0!==i?i:0;return"auto"===r?Math.atan2(e[0]-t[0],e[1]-t[1]):r}function xc(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}var Ec={key:function(t){return[t.style,t.weight,t.family,t.px_size,t.fill,t.stroke,t.stroke_width,t.transform,t.text_wrap,t.max_lines,t.supersample,t.background_color,t.outline_color,t.outline_width,t.padding,Tn.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(t,e,i){var r={};if(e.font=e.font||this.defaults,r.can_articulate=e.can_articulate,r.fill=e.font.fill&&Tn.toCSSColor(yo.evalCachedColorProperty(e.font.fill,i))||this.defaults.fill,r.style=e.font.style||this.defaults.style,r.weight=e.font.weight||this.defaults.weight,e.font.family?(r.family=e.font.family,r.family!==this.defaults.family&&(r.family+=", "+this.defaults.family)):r.family=this.defaults.family,r.transform=e.font.transform,r.size=e.font.size||this.defaults.size,r.supersample=e.supersample_text?1.5:1,r.px_size=yo.evalCachedProperty(e.font.px_size,i)*r.supersample,0!==r.px_size){e.font.stroke&&e.font.stroke.color&&(r.stroke=Tn.toCSSColor(yo.evalCachedColorProperty(e.font.stroke.color,i)||this.defaults.stroke),r.stroke_width=yo.evalCachedProperty(e.font.stroke.width,i)||this.defaults.stroke_width),r.font_css=this.fontCSS(r);var n=e.text_wrap;return null==n&&"line"!==Qr.geometryType(t.geometry.type)&&(n=!0),!0===n&&(n=this.defaults.text_wrap),r.text_wrap=n,r.max_lines=e.max_lines||this.defaults.max_lines,r.background_color=e.background&&e.background.color&&!e.can_articulate?Tn.toCSSColor(yo.evalCachedColorProperty(e.background.color,i)):this.defaults.background_color,r.outline_color=e.outline&&e.outline.color&&!e.can_articulate?Tn.toCSSColor(yo.evalCachedColorProperty(e.outline.color,i)):this.defaults.outline_color,r.outline_width=e.outline&&e.outline.width&&!e.can_articulate?yo.evalCachedProperty(e.outline.width,i):this.defaults.outline_width,r.padding=e.padding&&!e.can_articulate?yo.evalCachedProperty(e.padding,i):this.defaults.padding,r}},fontCSS:function(t){return[t.style,t.weight,t.px_size+"px",t.family].filter((function(t){return t})).join(" ")}},Ac=a((function(t){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function i(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function r(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function n(t){var e=t.a.offsetWidth,i=e+100;return t.f.style.width=i+"px",t.c.scrollLeft=i,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,1)}function o(t,i){function r(){var t=o;n(t)&&t.a.parentNode&&i(t.g)}var o=t;e(t.b,r),e(t.c,r),n(t)}function a(t,e){var i=e||{};this.family=t,this.style=i.style||"normal",this.weight=i.weight||"normal",this.stretch=i.stretch||"normal"}function s(t,e){return[t.style,t.weight,function(){if(null===c){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}c=""!==t.style.font}return c}()?t.stretch:"","100px",e].join(" ")}var l,u,c,h;h=c=u=l=null,a.prototype.load=function(t,e){var n=this,a=t||"BESbswy",c=0,p=e||3e3,f=(new Date).getTime();return new Promise((function(t,e){var d,y,g;null===h&&(h=!!document.fonts),(d=h)&&(null===u&&(u=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),d=!u),d?(d=new Promise((function(t,e){!function i(){(new Date).getTime()-f>=p?e():document.fonts.load(s(n,'"'+n.family+'"'),a).then((function(e){1<=e.length?t():setTimeout(i,25)}),(function(){e()}))}()})),y=new Promise((function(t,e){c=setTimeout(e,p)})),Promise.race([y,d]).then((function(){clearTimeout(c),t(n)}),(function(){e(n)}))):(g=function(){function u(){var e;(e=-1!=g&&-1!=v||-1!=g&&-1!=m||-1!=v&&-1!=m)&&((e=g!=v&&g!=m&&v!=m)||(null===l&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),e=l&&(g==_&&v==_&&m==_||g==b&&v==b&&m==b||g==w&&v==w&&m==w)),e=!e),e&&(x.parentNode&&x.parentNode.removeChild(x),clearTimeout(c),t(n))}var h=new i(a),d=new i(a),y=new i(a),g=-1,v=-1,m=-1,_=-1,b=-1,w=-1,x=document.createElement("div");x.dir="ltr",r(h,s(n,"sans-serif")),r(d,s(n,"serif")),r(y,s(n,"monospace")),x.appendChild(h.a),x.appendChild(d.a),x.appendChild(y.a),document.body.appendChild(x),_=h.a.offsetWidth,b=d.a.offsetWidth,w=y.a.offsetWidth,function t(){var i;(new Date).getTime()-f>=p?(x.parentNode&&x.parentNode.removeChild(x),e(n)):(!0!==(i=document.hidden)&&void 0!==i||(g=h.a.offsetWidth,v=d.a.offsetWidth,m=y.a.offsetWidth,u()),c=setTimeout(t,50))}(),o(h,(function(t){g=t,u()})),r(h,s(n,'"'+n.family+'",sans-serif')),o(d,(function(t){v=t,u()})),r(d,s(n,'"'+n.family+'",serif')),o(y,(function(t){m=t,u()})),r(y,s(n,'"'+n.family+'",monospace'))},document.body?g():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),g()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),g())})))}))},t.exports=a})),Tc={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(t){var e=this,i=JSON.stringify(t)===this.last_loaded;return t&&!i&&function(){var i=[];for(var r in t)!function(r){Array.isArray(t[r])?t[r].forEach((function(t){return i.push(e.loadFontFace(r,t))})):i.push(e.loadFontFace(r,t[r]))}(r);e.last_loaded=JSON.stringify(t),e.fonts_loaded=Promise.all(i.filter((function(t){return t})))}(),this.fonts_loaded},loadFontFace:function(t,e){if(null!=e&&("object"===gr(e)||"external"===e)){var i={family:t},r=Promise.resolve();"object"===gr(e)&&(Object.assign(i,e),"string"==typeof e.url&&(r=this.injectFontFace(i)));var n=new Ac(t,i);return r.then((function(){return n.load()})).then((function(){En("debug","Font face '".concat(t,"' is available"),i)}),(function(){En("debug","Font face '".concat(t,"' is NOT available"),i)}))}},injectFontFace:function(t){var e=this,i=t.family,r=t.url,n=t.weight,o=t.style;void 0===this.supports_native_font_loading&&(this.supports_native_font_loading=void 0!==window.FontFace);var a=Promise.resolve(r);return"blob:"===r.slice(0,5)&&(a=Tn.io(r,6e4,"arraybuffer").then((function(t){var i=new Uint8Array(t);if(e.supports_native_font_loading)return i;for(var r="",n=0;n<i.length;n++)r+=String.fromCharCode(i[n]);return"data:font/opentype;base64,"+btoa(r)}))),a.then((function(t){var r,a,s;e.supports_native_font_loading?("string"==typeof t?r=new FontFace(i,"url(".concat(encodeURI(t),")"),{weight:n,style:o}):t instanceof Uint8Array&&(r=new FontFace(i,t,{weight:n,style:o})),document.fonts.add(r),En("trace","Adding FontFace to document.fonts:",r)):(a="\n                    @font-face {\n                        font-family: '".concat(i,"';\n                        font-weight: ").concat(n||"normal",";\n                        font-style: ").concat(o||"normal",";\n                        src: url(").concat(encodeURI(t),");\n                    }\n                "),(s=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(s),s.sheet.insertRule(a,0),En("trace","Injecting CSS font face:",a))}))}},kc=function(){function t(){vr(this,t),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=Ml("binary-tree")}return _r(t,[{key:"createCanvas",value:function(t,e){var i=document.createElement("canvas");return t&&e&&(i.width=t,i.height=e),i.style.backgroundColor="transparent",i}},{key:"setFont",value:function(t,e){var i=e.font_css,r=e.fill,n=e.stroke,o=e.stroke_width,a=e.px_size,s=e.supersample;this.px_size=a;var l=Tn.device_pixel_ratio*s;n&&0<o&&(t.strokeStyle=n,t.lineWidth=o*l),t.fillStyle=r,t.textBaseline="bottom",t.font=i,t.miterLimit=2}},{key:"textSizes",value:function(t,e,i){var r=this;return Tc.loadFonts().then((function(){return To.add({type:"textSizes",run:r.processTextSizesTask.bind(r),texts:e,tile_id:t,cursor:{ctx:i,styles:Object.keys(e),texts:null,style_idx:null,text_idx:null}})}))}},{key:"processTextSizesTask",value:function(t){var e,i=t.cursor,r=t.texts,n=i.ctx;for(i.style_idx=i.style_idx||0;i.style_idx<i.styles.length;){var o=i.styles[i.style_idx];null==i.text_idx&&(i.text_idx=0,i.texts=Object.keys(r[o]));for(var a=r[o],s=!0;i.text_idx<i.texts.length;){var l=i.texts[i.text_idx],u=a[l],c=u.text_settings;if(s&&(this.setFont(n,c),s=!1),u.size=this.textSize(n,o,l,c).size,c.can_articulate){var h=!1,p=!1;if(Mc(l)&&(Lc(l)?h=!0:p=!0),u.isRTL=h,u.no_curving=p||(e=l,Fc.test(e)),u.vertical_buffer=this.vertical_text_buffer+c.outline_width+(c.padding[0]+c.padding[2])/2,u.segment_sizes=[],!u.no_curving){var f=function(t,e){var i=e?1:Gc;if(t.length<i)return[t];var r=t;if(kc.cache.segment[r])return kc.cache.stats.segment_hits++,kc.cache.segment[r];var n=[];if(Cc.exec(t)){n=t.split(Rc);for(var o,a=-1,s=0;s<n.length-1;s++)0<s&&(o=Nc.exec(n[s]))&&(n[s]=n[s].substring(o[0].length),n[s-1]+=o[0],a+=o[0].length),a+=1+n[s].length,n[s]+=t.slice(a,a+1);t=""}for(;t.length;){for(var l="",u=t,c=0;c<i&&u.length;c++){var h=(jc.exec(u)||u)[0];l+=h,u=u.substring(h.length)}n.push(l),t=t.substring(l.length)}return e&&n.reverse(),kc.cache.stats.segment_misses++,kc.cache.segment[r]=n}(l,h);u.segments=f;for(var d=0;d<f.length;d++)u.segment_sizes.push(this.textSize(n,o,f[d],c).size)}}if(i.text_idx++,!To.shouldContinue(t))return!1}i.text_idx=null,i.style_idx++}return To.finish(t,{texts:r}),!0}},{key:"textSize",value:function(e,i,r,n){var o=n.transform,a=n.text_wrap,s=n.max_lines,l=n.stroke_width,u=void 0===l?0:l,c=n.supersample,h=n.padding,p=n.outline_width,f=n.can_articulate;if(t.cache.text[i]=t.cache.text[i]||{},t.cache.text[i][r])return t.cache.stats.text_hits++,t.cache.text[i][r];t.cache.stats.text_misses++,t.cache.text_count++;var d=Tn.device_pixel_ratio*c,y=this.applyTextTransform(r,o),g=d*(this.vertical_text_buffer+p+(h[0]+h[2])/2),v=d*(this.horizontal_text_buffer+p+u+(h[1]+h[3])/2),m=2*d,_=this.px_size+m,b=Hc.parse(y,a,s,_,e),w=b.height,x=b.width,E=b.lines,A=[x/d,w/d];f||(A[0]+=2*v/d,A[1]+=2*g/d);var T=[x+2*v,w+2*g],k=[T[0]/d,T[1]/d];return t.cache.text[i][r]={lines:E,size:{collision_size:A,texture_size:T,logical_size:k,line_height:_}},t.cache.text[i][r]}},{key:"drawTextMultiLine",value:function(t,e,i,r,n,o){var a=Or(i,2),s=a[0],l=a[1],u=Tn.device_pixel_ratio*n.supersample,c=n.stroke_width||0,h=n.stroke;n.background_color&&(t.fillStyle=n.background_color,t.fillRect(s,l,r.texture_size[0],r.texture_size[1]));var p=n.outline_width*u,f=n.outline_color;p&&f&&(t.strokeStyle=f,t.lineWidth=p,t.strokeRect(s+p/2,l+p/2,r.texture_size[0]-p,r.texture_size[1]-p)),(n.background_color||p&&f)&&this.setFont(t,n);for(var d,y,g,v,m=r.line_height,_=l,b=0;b<e.length;b++){var w=e[b];this.drawTextLine(t,w,[s,_],r,n,o),_+=m}ql.draw_label_collision_boxes&&(t.save(),d=u*(this.horizontal_text_buffer+n.outline_width+c+(n.padding[1]+n.padding[3])/2),y=u*(this.vertical_text_buffer+n.outline_width+(n.padding[0]+n.padding[2])/2),g=r.collision_size,t.strokeStyle="blue",t.lineWidth=2,t.strokeRect(s+d,l+y,u*g[0],u*g[1]),"curved"===o&&h&&0<c&&t.strokeRect(s+r.texture_size[0]+d,l+y,u*g[0],u*g[1]),t.restore()),ql.draw_label_texture_boxes&&(t.save(),v=r.texture_size,t.strokeStyle="green",t.lineWidth=2,t.strokeRect(s+2,l+2,v[0]-4,v[1]-4),"curved"===o&&h&&0<c&&t.strokeRect(s+2+r.texture_size[0],l+2,v[0]-4,v[1]-4),t.restore())}},{key:"drawTextLine",value:function(t,e,i,r,n,o){var a,s=Or(i,2),l=s[0],u=s[1],c=n.stroke,h=n.stroke_width,p=void 0===h?0:h,f=n.transform,d=n.align,y=n.supersample,g=n.padding,v=n.outline_width,m=Tn.device_pixel_ratio*y,_=(d=d||"center",r.texture_size),b=r.line_height,w=m*(this.vertical_text_buffer+v),x=m*(this.horizontal_text_buffer+v+p),E=this.applyTextTransform(e.text,f);"left"===d?a=l+x+g[3]*m:"center"===d?a=l+_[0]/2-e.width/2-(g[1]-g[3])*m/2:"right"===d&&(a=l+_[0]-e.width-x-g[1]*m);var A,T=u+w+b+g[0]*m;c&&0<p&&(A="curved"===o?_[0]:0,t.strokeText(E,a+A,T)),t.fillText(E,a,T)}},{key:"rasterize",value:function(e,i,r,n,o,a){return To.removeForTile(r),To.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:t.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:e,textures:i,texture_prefix:n,gl:o,tile_id:r,texture_manager:a,cursor:{styles:Object.keys(e),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(t){if(!To.shouldContinue(t))return!1;for(var e=t.cursor,i=t.texts,r=t.textures;e.texture_idx<t.textures.length;){for(var n=!1,o=r[e.texture_idx],a=this.createCanvas.apply(this,Lr(o.texture_size)),s=a.getContext("2d");e.style_idx<e.styles.length;){var l=e.styles[e.style_idx];null==e.text_idx&&(e.text_idx=0,e.texts=Object.keys(i[l]));for(var u=i[l],c=!0;e.text_idx<e.texts.length;){var h=e.texts[e.text_idx],p=u[h],f=p.text_settings;if(c&&(this.setFont(s,f),c=!1),f.can_articulate){p.texcoords=p.texcoords||{};for(var d=0;d<p.type.length;d++){var y=p.type[d];switch(y){case"straight":if(p.textures[d]!==e.texture_idx)continue;var g,v,m,_,b=p.isRTL?h.split().reverse().join():h,w=o.texcoord_cache[l][b],x=void 0;w.texcoord?x=w.texcoord:(g=w.texture_position,m=(v=this.textSize(s,l,b,f)).size,_=v.lines,this.drawTextMultiLine(s,_,g,m,f,y),x=t.texture_manager.getTexcoordsForSprite(g,m.texture_size,o.texture_size),w.texcoord=x),p.texcoords[y]={texcoord:x,texture_id:w.texture_id};break;case"curved":var E=p.segments;p.texcoords.curved=[],p.texcoords_stroke=[];for(var A,T,k,S,M,I,O,L,C=0;C<E.length;C++)p.textures[d][C]===e.texture_idx&&(A=E[C],S=k=void 0,(T=o.texcoord_cache[l][A]).texcoord&&T.texcoord_stroke?(k=T.texcoord,S=T.texcoord_stroke):(M=T.texture_position,O=(I=this.textSize(s,l,A,f)).size,L=I.lines,this.drawTextMultiLine(s,L,M,O,f,y),k=t.texture_manager.getTexcoordsForSprite(M,O.texture_size,o.texture_size),S=f.stroke&&0<f.stroke_width?t.texture_manager.getTexcoordsForSprite([M[0]+O.texture_size[0],M[1]],O.texture_size,o.texture_size):(n=!0,t.texture_manager.getTexcoordsForSprite([o.texture_size[0],o.texture_size[1]],[0,0],o.texture_size)),T.texcoord=k,T.texcoord_stroke=S),p.texcoords_stroke.push(S),p.texcoords.curved.push({texcoord:k,texture_id:T.texture_id}))}}}else{var R=this.textSize(s,l,h,f).lines;for(var N in p.align)p.align[N].texture_id===e.texture_idx&&(this.drawTextMultiLine(s,R,p.align[N].texture_position,p.size,{stroke:f.stroke,stroke_width:f.stroke_width,transform:f.transform,supersample:f.supersample,align:N,background_color:f.background_color,outline_width:f.outline_width,outline_color:f.outline_color,padding:f.padding,fill:f.fill,font_css:f.font_css,px_size:f.px_size}),p.align[N].texcoords=t.texture_manager.getTexcoordsForSprite(p.align[N].texture_position,p.size.texture_size,o.texture_size))}e.text_idx++}e.text_idx=null,e.style_idx++}!0===n&&(s.fillStyle="rgba(0, 0, 0, 0)",s.fillRect(a.width-1,a.height-1,1,1));var P=t.texture_prefix+e.texture_idx;t.texture_manager.create(t.gl,P,{element:a,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),e.texture_names.push(P),e.texture_idx++,e.style_idx=0,a.width=0,a.height=0}return To.finish(t,e.texture_names),!0}},{key:"setTextureTextPositions",value:function(t){var e={texture_id:0,texcoord_cache:{}},i=[];for(var r in t){var n=t[r];for(var o in n){var a=n[o],s=a.text_settings,l=s.can_articulate,u=s.stroke,c=s.stroke_width;if(l){a.textures=[],e.texcoord_cache[r]=e.texcoord_cache[r]||{};for(var h=0;h<a.type.length;h++)switch(a.type[h]){case"straight":var p,f=a.isRTL?o.split().reverse().join():o;e.texcoord_cache[r][f]||(p=a.size.texture_size,e.texcoord_cache[r][f]={},this.placeText(p[0],p[1],{can_articulate:l,style:r,word:f})),a.textures[h]=e.texture_id;break;case"curved":a.textures[h]=[];for(var d=0;d<a.segment_sizes.length;d++){var y,g,v=a.segments[d];e.texcoord_cache[r][v]||(g=(y=a.segment_sizes[d].texture_size)[0],u&&0<c&&(g*=2),e.texcoord_cache[r][v]={},this.placeText(g,y[1],{can_articulate:l,style:r,word:v})),a.textures[h].push(e.texture_id)}}}else{var m=a.size.texture_size;this.placeText(m[0],m[1],{can_articulate:l,text_info:a})}}}var _=this.layout.export(),b=_.items,w=_.width,x=_.height;e.texcoord_cache={};for(var E=0,A=b.length;E<A;E++){var T=b[E],k=T.x,S=T.y;if(T.meta.can_articulate){var M=T.meta,I=M.style,O=M.word;e.texcoord_cache[I]=e.texcoord_cache[I]||{},e.texcoord_cache[I][O]||(e.texcoord_cache[I][O]={texture_id:e.texture_id,texture_position:[k,S]})}else{var L=T.meta.text_info;for(var C in L.align)L.align[C].texture_id=e.texture_id,L.align[C].texture_position=[k,S]}}return 0<w&&0<x&&(i[e.texture_id]={texture_size:[w,x],texcoord_cache:e.texcoord_cache}),i}},{key:"placeText",value:function(t,e,i){this.layout.addItem({width:t+this.vertical_text_buffer,height:e+this.vertical_text_buffer,meta:i})}},{key:"applyTextTransform",value:function(t,e){return"capitalize"===e?t.replace(/\w\S*/g,(function(t){return t.charAt(0).toUpperCase()+t.substr(1)})):"uppercase"===e?t.toUpperCase():"lowercase"===e?t.toLowerCase():t}}],[{key:"fontPixelSize",value:function(e){if(null!=e){var i=Or((e="string"==typeof e?e:String(e)).match(t.font_size_re)||[],3),r=i[1],n=i[2];return"em"===(n=n||"px")?r*=16:"pt"===n?r/=.75:"%"===n&&(r/=6.25),(r=yo.parsePositiveNumber(r))*Tn.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){t.cache.text_count>t.cache.text_count_max&&(t.cache.text={},t.cache.text_count=0,En("debug","CanvasText: pruning text cache")),Object.keys(t.cache.segment).length>t.cache.segment_count_max&&(t.cache.segment={},En("debug","CanvasText: pruning segment cache"))}}]),t}();kc.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,kc.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},kc.EMPTY_TEXTURES_ARR=[],kc.returnNoTextures=function(){return kc.EMPTY_TEXTURES_ARR};var Sc=new RegExp("[֑-߿‏‫‮יִ-﷽ﹰ-ﻼ]");function Mc(t){return Sc.test(t)}var Ic="\0-/:-@[-`{-¿×÷ʹ-˿ -⯿‐-\u2029‬ -⯿",Oc=new RegExp("["+Ic+"]+");function Lc(t){return Oc.test(t)}var Cc=new RegExp("^["+Ic+"؀-ۿ]+"),Rc=new RegExp("["+Ic+"آ-إاد-زوٱ-ٷڈ-ڙۄ-ۋۏےۓۮۯ]"),Nc=new RegExp("^[ؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ۭ]+"),Pc="[̀-֑ͯ-ׇֽֿׁׂׅׄަ-ްऀ-ःऺ-ौॎॏ॑-ॗॢॣঁ-ঃ়া-ৌৗৢৣਁ-ਃ਼-ੌੑઁ-ઃ઼ા-ૌૢૣଁ-ଃ଼ା-ୌୖୗୢୣஂா-்ௗఀ-ఃా-ౌౕౖౢౣಁ-ಃ಼ಾ-ೌೕೖೢೣഁ-ഃാ-ൌൎൗൢൣංඃ්-ෟෲෳัิ-ฺ็-๎ັິ-ຼ່-ໍ༹༘༙༵༷༾༿ཱ-ྃ྆྇ྍ-ྼ࿆ါ-း်-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ឴-៑៓ᩕ-ᩞᩡ-᩼᷀-᷿⃐-⃿]",jc=new RegExp("^.(?:"+Pc+"+)?([्্੍્୍్್്྄္្᩠᩿]\\W(?:"+Pc+"+)?)*"),Dc={Mongolian:"᠀-᢯"},zc=Object.keys(Dc).map((function(t){return Dc[t]})).join(""),Fc=new RegExp("["+zc+"]"),Gc=2,Hc=function(){function t(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;vr(this,t),this.width=0,this.height=0,this.lines=[],this.max_lines=i,this.text_wrap=r,this.context=e}return _r(t,[{key:"createLine",value:function(t){return this.lines.length<this.max_lines&&new Bc(t,this.text_wrap)}},{key:"push",value:function(t){if(this.lines.length<this.max_lines){var e=this.context.measureText(t.text).width;return(t.width=e)>this.width&&(this.width=Math.ceil(e)),this.lines.push(t),this.height+=t.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(t,e){return!!this.push(t)&&this.createLine(e)}},{key:"addEllipsis",value:function(){var e=this.lines[this.lines.length-1],i=Math.ceil(this.context.measureText(t.ellipsis).width);e.append(t.ellipsis),e.width+=i,e.width>this.width&&(this.width=e.width)}},{key:"finish",value:function(t){t?this.push(t):this.addEllipsis()}}],[{key:"parse",value:function(e,i,r,n,o){for(var a="number"==typeof i?e.split(" "):[e],s=new t(o,r,i),l=s.createLine(n),u=0;u<a.length;u++){for(var c=a[u].split("\n"),h=0===u,p=0;p<c.length&&l;p++){var f=c[p];Mc(f)&&Lc(f[f.length-1])&&(f+="‏");var d=h?f:" "+f;if(i&&0<u&&l.exceedsTextwrap(d)){if(!(l=s.advance(l,n)))break;l.append(f),h=!0}else l.append(d);p<c.length-1&&(l=s.advance(l,n),h=!0)}u===a.length-1&&s.finish(l)}return s}}]),t}();Hc.ellipsis="...";var Bc=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;vr(this,t),this.chars=0,this.text="",this.height=Math.ceil(e),this.text_wrap=i}return _r(t,[{key:"append",value:function(t){this.chars+=t.length,this.text+=t}},{key:"exceedsTextwrap",value:function(t){return t.length+this.chars>this.text_wrap}}]),t}(),Uc={resetText:function(){this.texts={}},freeText:function(t){delete this.texts[t.id]},parseTextFeature:function(t,e,i,r){var n=this.parseTextSource(t,e,i);if(null!=n&&""!==n){var o=Ec.compute(t,e,i);if(o){var a=Ec.key(o);this.texts[r.id]=this.texts[r.id]||{};var s=this.texts[r.id][a]=this.texts[r.id][a]||{};if(n instanceof Object){var l=[],u=n.left+"-"+n.right;for(var c in n){var h,p=n[c];p&&(h=this.computeTextLayout({},t,e,i,r,p,o,u,c),s[p]||(s[p]={text_settings:o,ref:0}),l.push({draw:e,text:p,text_settings_key:a,layout:h}))}return 0<l.length&&l}var f=this.computeTextLayout({},t,e,i,r,n,o);return s[n]||(s[n]={text_settings:o,ref:0}),{draw:e,text:n,text_settings_key:a,layout:f}}}},parseTextSource:function(t,e,i){var r,n=e.text_source||"name";if(null!=n&&"object"===gr(n))for(var o in r={},n)r[o]=this.parseTextSourceValue(n[o],t,i);else r=this.parseTextSourceValue(n,t,i);return r},parseTextSourceValue:function(t,e,i){var r;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("string"==typeof t[n]?r=e.properties[t[n]]:"function"==typeof t[n]&&(r=t[n](i)),r)return r}else"string"==typeof t?r=e.properties[t]:t instanceof Function&&(r=t(i));return r},prepareTextLabels:function(t,e,i){var r=this;return 0===Object.keys(this.texts[t.id]||{}).length?Promise.resolve([]):un.postMessage(this.main_thread_target+".calcTextSizes",t.id,this.texts[t.id]).then((function(e){var n=e.texts;return t.canceled?(En("trace","Style ".concat(r.name,": stop tile build because tile was canceled: ").concat(t.key,", post-calcTextSizes()")),[]):(r.texts[t.id]=n||[],n?r.buildTextLabels(t,i):(Ao.abortTile(t.id),[]))}))},collideAndRenderTextLabels:function(t,e,i){var r=this;return this.prepareTextLabels(t,e,i).then((function(i){return 0===i.length?(Ao.collide([],e,t.id),Promise.resolve({})):Ao.collide(i,e,t.id).then((function(e){if(t.canceled)return En("trace","stop tile build because tile was canceled: ".concat(t.key,", post-collide()")),{};var i=r.texts[t.id];return null==i||0===e.length?{}:(r.cullTextStyles(i,e),e.forEach((function(t){var e=t.text_settings_key,r=i[e]&&i[e][t.text];r.text_settings.can_articulate?(r.type||(r.type=[]),-1===r.type.indexOf(t.label.type)&&r.type.push(t.label.type)):(r.align=r.align||{},r.align[t.label.align]={})})),{labels:e,texts:i,textures:[]})}))}))},cullTextStyles:function(t,e){for(var i=0;i<e.length;i++){var r=e[i];t[r.text_settings_key][r.text].ref++}for(var n in t)for(var o in t[n])t[n][o].ref<1&&delete t[n][o];for(var a in t)0===Object.keys(t[a]).length&&delete t[a]},calcTextSizes:function(t,e){return this._canvas_text||(this._canvas_text=new kc,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(t,e,this._canvas_ctx_for_sizes)},preprocessText:function(t){if(t&&t.font&&"object"===gr(t.font))return t.font.fill=yo.createPropertyCache(t.font.fill),t.font.stroke&&(t.font.stroke.color=yo.createPropertyCache(t.font.stroke.color)),t.background&&t.background.color&&(t.background.color=yo.createPropertyCache(t.background.color)),t.outline&&(t.outline.color&&(t.outline.color=yo.createPropertyCache(t.outline.color)),t.outline.width&&(t.outline.width=yo.createPropertyCache(t.outline.width,yo.parsePositiveNumber))),t.padding&&(Array.isArray(t.padding)?2===t.padding.length&&(t.padding=[t.padding[0],t.padding[1],t.padding[0],t.padding[1]]):t.padding=Array(4).fill(t.padding),t.padding=yo.createPropertyCache(t.padding,(function(t){return t.map(yo.parsePositiveNumber)}))),t.font.px_size=yo.createPropertyCache(t.font.size||Ec.defaults.size,kc.fontPixelSize),t.font.stroke&&null!=t.font.stroke.width&&(t.font.stroke.width=yo.createPropertyCache(t.font.stroke.width,yo.parsePositiveNumber)),t.offset=yo.createPropertyCache(t.offset,(function(t){return Array.isArray(t)&&t.map(yo.parseNumber)})),t.buffer=yo.createPropertyCache(t.buffer,(function(t){return(Array.isArray(t)?t:[t,t]).map(yo.parsePositiveNumber)})),t.repeat_distance=yo.createPropertyCache(t.repeat_distance||Qr.tile_size,yo.parsePositiveNumber),t},computeTextLayout:function(t,e,i,r,n,o,a,s,l){var u=t||{};return(u=this.computeLayout(u,e,i,r,n)).repeat_distance&&(s&&(u.repeat_group+="/"+s),u.repeat_group+="/"+o),u.subdiv=n.overzoom2,u.align=i.align,u.italic="normal"!==a.style,"right"===l?u.orientation=1:"left"===l&&(u.orientation=-1),u}},Vc=Math.PI/180,qc=function(){function t(e,i){vr(this,t),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=e,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),i?this.setLookAtData(i):this._updateMatrices(),Ko.replaceBlock("camera","\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }")}return _r(t,[{key:"getZoomForBounds",value:function(t,e,i,r){var n,o=this.clone(),a=this._max_zoom,s=this._min_zoom,l=(a-s)/2,u=a-l,c=e,h=Xr.getBBoxCenter(Xr.getBBox(t));for(void 0===c?c=h:(n=h[0]-c[0],Math.abs(n)>Qr.half_circumference_meters+1e-8&&(c[0]+=Math.round(n/Qr.circumference_meters)*Qr.circumference_meters));.001<l;)!function(){o.setLookAtData({zoom:u,position:c,tilt:i,heading:r});var e,n,h,p,f,d=o.getLookAtData().bounds;t.every((function(t){return Xr.isPointInsidePolygon(t,d)}))?s=u:(n=(e=Or(Xr.getBBox(d),4))[0],h=e[1],p=e[2],f=e[3],p-n+1e-8>=Qr.circumference_meters&&f-h+1e-8>=Qr.circumference_meters?s=u:a=u),u=a-(l=(a-s)/2)}();return s}},{key:"setZoomConstraints",value:function(t,e){this._min_zoom=t,this._max_zoom=e,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(t,e){var i,r,n,o,a,s=t.position,l=t.zoom;s===i&&t.bounds!==i&&(s=Xr.getBBoxCenter(Xr.getBBox(t.bounds))),l===i&&t.bounds!==i&&(l=this.getZoomForBounds(t.bounds,s,t.tilt,t.heading)),e!==i&&(r=s||this.screenToWorld(e)),l!==i&&(l=Xr.clamp(l,this._min_zoom,this._max_zoom),(n=Tn.zoomToTileLevel(l))!==(o=this._lookAtData.tile_level)&&(this._zoom_direction=o<n?1:-1),this._lookAtData.zoom=l,this._lookAtData.tile_level=n),t.tilt!==i&&(this._lookAtData.tilt=t.tilt),t.heading!==i&&(this._lookAtData.heading=t.heading),e!==i?(this._updateMatrices(),a=this.screenToWorld(e),this._lookAtData.position[0]-=a[0]-r[0],this._lookAtData.position[1]-=a[1]-r[1]):s&&(this._lookAtData.position=s),this._lookAtData.position[2]=0,this._lookAtData.position[1]=Xr.clamp(this._lookAtData.position[1],-Qr.half_circumference_meters,Qr.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,i=this._viewport,r=i.width,n=i.height;this._viewport_aspect_ratio=r/n;var o=this._viewport.center.x-(r/2<<0),a=this._viewport.center.y-(n/2<<0);this._center_offset[0]=o,this._center_offset[1]=a,this._center_offset_normalized[0]=o/r,this._center_offset_normalized[1]=a/-n,e||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(t,e){Po(t.model_view32,this._view_matrix,t.model),e.uniform("Matrix4fv","u_modelView",t.model_view32),function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],f=e[11],d=e[12],y=e[13],g=e[14],v=e[15],m=i*s-r*a,_=i*l-n*a,b=i*u-o*a,w=r*l-n*s,x=r*u-o*s,E=n*u-o*l,A=c*y-h*d,T=c*g-p*d,k=c*v-f*d,S=h*g-p*y,M=h*v-f*y,I=p*v-f*g,O=m*I-_*M+b*S+w*k-x*T+E*A;O&&(O=1/O,t[0]=(s*I-l*M+u*S)*O,t[1]=(l*k-a*I-u*T)*O,t[2]=(a*M-s*k+u*A)*O,t[3]=(n*M-r*I-o*S)*O,t[4]=(i*I-n*k+o*T)*O,t[5]=(r*k-i*M-o*A)*O,t[6]=(y*E-g*x+v*w)*O,t[7]=(g*b-d*E-v*_)*O,t[8]=(d*x-y*b+v*m)*O)}(t.normal32,t.model_view32),function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=c*a-s*u,p=-c*o+s*l,f=u*o-a*l,d=i*h+r*p+n*f;d&&(d=1/d,t[0]=h*d,t[1]=(-c*r+n*u)*d,t[2]=(s*r-n*a)*d,t[3]=p*d,t[4]=(c*i-n*l)*d,t[5]=(-s*i+n*o)*d,t[6]=f*d,t[7]=(-u*i+r*l)*d,t[8]=(a*i-r*o)*d)}(t.inverse_normal32,t.normal32),e.uniform("Matrix3fv","u_normalMatrix",t.normal32),e.uniform("Matrix3fv","u_inverseNormalMatrix",t.inverse_normal32)}},{key:"_updateMatrices",value:function(){var t=this._viewport.height*Qr.metersPerPixel(this._lookAtData.zoom),e=Tn.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=t/2*e;var i=this._lookAtData.position[0],r=this._lookAtData.position[1];(function(t,e,i,r){var n,o,a,s,l,u,c,h,p,f,d=e[0],y=e[1],g=e[2],v=r[0],m=r[1],_=r[2],b=i[0],w=i[1],x=i[2];Math.abs(d-b)<1e-6&&Math.abs(y-w)<1e-6&&Math.abs(g-x)<1e-6?Co(t):(c=d-b,h=y-w,p=g-x,n=m*(p*=f=1/Math.sqrt(c*c+h*h+p*p))-_*(h*=f),o=_*(c*=f)-v*p,a=v*h-m*c,(f=Math.sqrt(n*n+o*o+a*a))?(n*=f=1/f,o*=f,a*=f):a=o=n=0,s=h*a-p*o,l=p*n-c*a,u=c*o-h*n,(f=Math.sqrt(s*s+l*l+u*u))?(s*=f=1/f,l*=f,u*=f):u=l=s=0,t[0]=n,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=u,t[10]=p,t[11]=0,t[12]=-(n*d+o*y+a*g),t[13]=-(s*d+l*y+u*g),t[14]=-(c*d+h*y+p*g),t[15]=1)})(this._view_matrix,Ro(i,r,0),Ro(i,r,-1),Ro(0,1,0)),this._heading_matrix=Do(this._heading_matrix);var n=180-this._lookAtData.heading;n*=Vc,this._heading_matrix[0]=Math.cos(n),this._heading_matrix[1]=-Math.sin(n),this._heading_matrix[4]=Math.sin(n),this._heading_matrix[5]=Math.cos(n),this._tilt_matrix=Do(this._tilt_matrix),n=0<(n=this._lookAtData.tilt?this._lookAtData.tilt*Vc:0)?-n:n,this._tilt_matrix[5]=Math.cos(n),this._tilt_matrix[6]=Math.sin(n),this._tilt_matrix[9]=-Math.sin(n),this._tilt_matrix[10]=Math.cos(n),Po(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),Po(this._view_matrix,this._transformation_matrix,this._view_matrix);var o=2*Math.atan(1/e),a=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(a),function(t,e,i,r,n){var o=1/Math.tan(e/2),a=1/(r-n);t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*r*a,t[15]=0}(this._projection_matrix,o,this._viewport_aspect_ratio,1,a),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],jo(this._projection_matrix,this._projection_matrix,Ro(0,0,-this._lookAtData.distance)),this._camera_matrix=Po(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var t,e,i,r,n,o=this._viewport,a=o.width,s=o.height,l=o.padding,u=this._lookAtData.tilt*Math.PI/180;this._horizon=Math.max((l.top+s)/2-Math.cos(u)*(l.top*(1-Math.sin(u))+.75*s),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([a,this._horizon]),this.screenToWorld([a,s]),this.screenToWorld([0,s])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),0===l.left&&0===l.top&&0===l.right&&0===l.bottom?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(t=l.left,e=Math.max(this._horizon,l.top),i=a-l.right,r=s-l.bottom,n=[this.screenToWorld([t,e]),this.screenToWorld([i,e]),this.screenToWorld([i,r]),this.screenToWorld([t,r])],this._lookAtData.bounds=this._clipAgainstGeoBounds(n))}},{key:"_clipAgainstGeoBounds",value:function(t){var e,i=Or(Xr.getBBox(t),4),r=i[0],n=i[1],o=i[2],a=i[3],s=Qr.half_circumference_meters,l=[[r-1,+s],[o+1,+s],[o+1,-s],[r-1,-s]],u=Xr.clipPolygon(l,t)[0],c=Or(Xr.getBBox(u),4);r=c[0],n=c[1],o=c[2],a=c[3],o-r>=Qr.circumference_meters&&(u=[[(e=(o-r)/2)-s,a],[e+s,a],[e+s,n],[e-s,n]]);var h=[];return u&&(h=Xr.splitLegs(u,s)),h}},{key:"applyPxOffset",value:function(t){var e=Or(t,2),i=e[0],r=e[1],n=Math.PI-this._lookAtData.heading*Vc,o=Qr.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(i*Math.cos(n)+r*Math.sin(n))*o,this._lookAtData.position[1]-=(r*Math.cos(n)-i*Math.sin(n))*o,this._lookAtData.position[1]=Xr.clamp(this._lookAtData.position[1],-Qr.half_circumference_meters,Qr.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(t){var e=Or(t,2),i=e[0],r=e[1],n=this._viewport,o=n.width,a=n.height;return 0===o||0===a?[0,0]:(i-=o/2,r-=a/2,this._clipCoordsToWorldPlaneCoords([2*(i+o/2)/o-1,1-2*(r+a/2)/a,-1,1]))}},{key:"_clipToScreenCoords",value:function(t){var e=this._viewport,i=e.width,r=e.height;return[(.5*t[0]+.5)*i,r-(.5*t[1]+.5)*r]}},{key:"_isScreenPointInViewPort",value:function(t){var e=this._viewport,i=e.width,r=e.height;return 0<=t[0]&&t[0]<=i&&0<=t[1]&&t[1]<=r}},{key:"worldToScreen",value:function(t,e){var i,r,n,o,a,s,l=1<arguments.length&&void 0!==e&&e;return t[2]||(t[2]=0),l?(i=this._worldToClipCoords(t),a=this._clipToScreenCoords(i)):(r=Math.sign(this._lookAtData.position[0]),n=Math.trunc(this._lookAtData.position[0]/Qr.circumference_meters+r/2),t[0]+=Qr.circumference_meters*n,o=this._worldToClipCoords(t),s=a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]+Qr.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]-Qr.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o)),this._isScreenPointInViewPort(a)||(a=s))),a}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(t){var e=[],i=this._lookAtData.distance,r=this._lookAtData.position,n=[0,0,i,0],o=0,a=i*Math.sin(Vc*this._lookAtData.tilt)*Math.cos(Vc*this._lookAtData.heading),s=i*Math.sin(Vc*this._lookAtData.tilt)*Math.sin(Vc*this._lookAtData.heading),l=new Float64Array(16),u=new Float64Array(16);return zo(l,this._projection_matrix),Fo(e,t,l),e[2]=-1,e[3]=0,zo(u,this._view_matrix),Fo(e,e,u),function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=i*i+r*r+n*n+o*o;0<a&&(a=1/Math.sqrt(a),t[0]=i*a,t[1]=r*a,t[2]=n*a,t[3]=o*a)}(e,e),Fo(n,n,this._transformation_matrix),0!==e[2]&&(o=-n[2]/e[2]),Go(e,e,o),[r[0]+(e[0]+s),r[1]+(e[1]+a)]}},{key:"_worldToClipCoords",value:function(t){var e=[t[0],t[1],t[2],1];return Fo(e,e,this._view_matrix),Fo(e,e,this._projection_matrix),Go(e,e,1/e[3]),e}},{key:"setupProgram",value:function(t){t.uniform("Matrix4fv","u_projection",this._projection_matrix),t.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),t.uniform("2fv","u_center_offset",this._center_offset_normalized),t.uniform("1f","u_tilt",this._lookAtData.tilt*Vc),t.uniform("1f","u_heading",this._lookAtData.heading*Vc),t.uniform("1f","u_near_plane",1),t.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var e=new t(this._viewport,this._lookAtData);return e.setZoomConstraints(this._min_zoom,this._max_zoom),e}},{key:"getViewport",value:function(){return this._viewport}}]),t}();function Yc(t){return void 0===t.x?t[0]:t.x}function Wc(t){return void 0===t.y?t[1]:t.y}function Zc(t,e){return Yc(t)-Yc(e)}function Kc(t,e){return Wc(t)-Wc(e)}function Xc(t){return t.sort(Zc)}function Jc(t,e){for(var i,r=t[0],n=r,o=0;o<t.length;o+=1)e(i=t[o],r)<0?r=i:0<e(i,n)&&(n=i);return[r,n]}function Qc(t,e){return Object.values(e.reduce((function(e,i){var r=i[+t];return e[r]||(e[r]=[]),e[r].push(i),e}),{}))}function $c(t,e,i){var r=+t,n=e[r],o=i[r];if(o<n)return[];var a=[e];if(o<n)return a;for(var s=e[(1+r)%2],l=t?function(t){return a.push([s,t])}:function(t){return a.push([t,s])},u=n+1;u<o;u+=1)l(u);return a.push(i),a}function th(t,e){return $c(!1,t,e)}function eh(t,e){return $c(!0,t,e)}function ih(t){var e={},i=[];return t.forEach((function(t){var r=t.key||(Array.isArray(t)?"".concat(t[0],"/").concat(t[1]):"".concat(t.x,"/").concat(t.y));e[r]||(e[r]=!0,i.push(t))})),i}function rh(t){return t.reduce((function(t,e){return t.concat(e)}))}function nh(t,e,i){var r=function(t,e,i){var r=Or(t,2),n=r[0],o=r[1],a=Or(e,2),s=a[0],l=a[1],u=Or(i,2),c=u[0],h=u[1],p=n+(l-o)/(h-o)*(c-n);return[[[n,o]].concat(Lr(Xc([[s,l],[p,l]]))),[].concat(Lr(Xc([[s,l],[p,l]])),[[c,h]])]}.apply(void 0,Lr([t,e,i].sort(Kc))),n=Or(r,2),o=n[0],a=n[1];return ih(function(t,e,i){var r=Or(t,2),n=r[0],o=r[1],a=Or(e,2),s=a[0],l=a[1];return oh(n,s,Or(i,1)[0],o,l)}.apply(void 0,Lr(o)).concat(function(t,e,i){var r=Or(t,2),n=r[0],o=r[1],a=Or(e,1)[0],s=Or(i,2);return oh(s[0],n,a,s[1],o)}.apply(void 0,Lr(a))))}function oh(t,e,i,r,n){var o,a,s,l,u,c,h,p,f,d,y=Math.min(t,e),g=Math.max(t,i),v=Math.min(r,n),m=Math.max(r,n);if(Math.floor(r)===Math.floor(n))return lh(y,g,r);if(m-v<.125)return o=[g,m],s=(a=Or([y,v],2))[0],l=a[1],c=(u=Or(o,2))[0],h=u[1],f=ah(p=sh(s,c),l),d=ah(p,h),f.concat(d);function _(t){k=k.concat(lh(S,M,Math.floor(t))),S+=A,M+=T}var b,w,x=.125*((w=m)-(b=v))/(Math.ceil(w)-Math.floor(b)),E=(m-v)/x,A=(e-t)/E,T=(i-t)/E,k=[],S=t,M=t;if(r<n)for(var I=v;I<=m;I+=x)_(I);else for(var O=m;v<=O;O-=x)_(O);return ih(k)}function ah(t,e){return t.map((function(t){return[t,e]}))}function sh(t,e){var i=Math.floor(t),r=Math.floor(e);if(r<i)return[];if(i===r)return[i];for(var n=[],o=i;o<=r;o+=1)n.push(o);return n}function lh(t,e,i){return ah(sh(t,e),i)}var uh=function(){function t(e,i){vr(this,t),Mo(this),this.scene=e,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=!1!==i.wrapView,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new qc(i.viewport),this._viewport=i.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return _r(t,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,i=this._viewport,r=i.width,n=i.height;this.size.css={width:r,height:n},this.size.device={width:Math.round(r*Tn.device_pixel_ratio),height:Math.round(n*Tn.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),e||this.updateBounds()}},{key:"setLookAtData",value:function(e,i){t._setLookAtDataForManipulator(this.lookAtManipulator,e,i),this.updateBounds()}},{key:"getLookAtData",value:function(e){var i=0<arguments.length&&void 0!==e&&e;return t._getLookAtDataFromManipulator(this.lookAtManipulator,i)}},{key:"getBestLookAtData",value:function(e,i,r){var n=2<arguments.length&&void 0!==r&&r,o=this.lookAtManipulator.clone();return t._setLookAtDataForManipulator(o,e,i),t._getLookAtDataFromManipulator(o,n)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(t){var e=this._offset_buffer;e[0]+=t[0],e[1]+=t[1];var i,r,n=Math.abs(e[0]),o=Math.abs(e[1]);(1<=n||1<=o)&&(i=~~e[0],r=~~e[1],this.lookAtManipulator.applyPxOffset([n<1?0:i,o<1?0:r]),1<=n&&(e[0]-=i),1<=o&&(e[1]-=r),this.updateBounds())}},{key:"setPanning",value:function(t){this.panning=t,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return"number"==typeof this.size.css.width&&"number"==typeof this.size.css.height}},{key:"updateBounds",value:function(){var t,e;this.markUserInput(),this.ready()&&(this.center_tile=Qr.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),t=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),e=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:t[0],y:t[1]},ne:{x:e[0],y:e[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(t,e,i,r,n,o){var a,s=4<arguments.length&&void 0!==n?n:0,l=!(5<arguments.length&&void 0!==o)||o,u=this.lookAtManipulator.getLookAtData().tile_level,c=Qr.tileForMeters([e,t],u),h=Qr.tileForMeters([r,i],u);c.x-=s,c.y-=s,h.x+=s,h.y+=s,!1===l&&(a=(1<<u)-1,c.x=Math.min(Math.max(0,c.x),a),c.y=Math.min(Math.max(0,c.y),a),h.x=Math.min(Math.max(0,h.x),a),h.y=Math.min(Math.max(0,h.y),a));for(var p=[],f={},d=c.x;d<=h.x;d++)for(var y=c.y;y<=h.y;y++){var g=pa.coord(Qr.wrapTile({x:d,y,z:u},{x:!l,y:!0}));f[g.key]||(f[g.key]=!0,p.push(g))}return p}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return function(t,e,i){function r(e){return Object.values(Qr.metersToExactTileCoords(e,t.tile_level))}var n,o,a,s,l,u,c,h,p;return ih((n=function(t,e){return e<=0?t:ih((i=rh(Qc(!1,t).map((function(t){var i=Or(Jc(t,Kc),2),r=i[0],n=i[1],o=[r[0],r[1]-e],a=[n[0],n[1]+e];return t.concat(eh(o,r),eh(n,a))}))),rh(Qc(!0,i).map((function(t){var i=Or(Jc(t,Zc),2),r=i[0],n=i[1],o=[r[0]-e,r[1]],a=[n[0]+e,n[1]];return t.concat(th(o,r),th(n,a))})))));var i}((s=r(t.tetragon[0]),l=r(t.tetragon[1]),u=r(t.tetragon[3]),c=r(t.tetragon[2]),h=nh(l,s,u),p=nh(u,c,l),ih(h.concat(p))),e),o=t.tile_level,a=i,n.map((function(t){var e=Or(t,2),i=e[0],r=e[1];return pa.coord(Qr.wrapTile({x:i,y:r,z:o},{x:!a,y:!0}))}))))}(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var t=this.lookAtManipulator.getLookAtData(),e=t.tilt,i=t.heading;return 0===e&&180===i?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(t,e){t.setupProgram(this.matrices,e),this.lookAtManipulator.setupMatrices(this.matrices,e)}},{key:"setupProgram",value:function(t){var e=this.lookAtManipulator.getLookAtData();t.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),t.uniform("3fv","u_map_position",[e.position[0],e.position[1],Math.trunc(1e5*e.zoom)/1e5]),t.uniform("1f","u_meters_per_pixel",Qr.metersPerPixel(e.zoom)),t.uniform("1f","u_device_pixel_ratio",Tn.device_pixel_ratio),t.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),t.uniform("1i","u_view_panning",this.panning),t.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(t)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=.5}},{key:"xyToGeo",value:function(t,e){var i=this.lookAtManipulator.screenToWorld([t,e]),r=Or(Qr.metersToLatLng(i),2),n=r[0];return{lat:r[1],lng:n}}},{key:"geoToPixel",value:function(t){var e=Qr.latLngToMeters([t.lng,t.lat]);e.push(t.alt||0);var i=this.lookAtManipulator.worldToScreen(e);return{x:Math.floor(i[0]),y:Math.floor(i[1])}}},{key:"geoToMeters",value:function(t){var e=Or(Qr.latLngToMeters([t.lng,t.lat]),2);return{x:e[0],y:e[1],z:t.alt||0}}},{key:"metersToGeo",value:function(t){var e=Or(Qr.metersToLatLng([t.x,t.y]),2),i=e[0];return{lat:e[1],lng:i,alt:t.z||0}}},{key:"setZoomConstraints",value:function(t,e){this.lookAtManipulator.setZoomConstraints(t,e)}}],[{key:"_setLookAtDataForManipulator",value:function(t,e,i){var r=e.position,n=e.zoom,o=e.tilt,a=e.heading,s=e.bounds,l={zoom:n,tilt:o,heading:a};if(r&&"number"==typeof r.lng&&"number"==typeof r.lat&&(l.position=Qr.latLngToMeters([r.lng,r.lat])),s){var u=s.getExterior().getLatLngAltArray(),c=u.length/3,h=Array(c);if(s.getBoundingBox().isCDB())for(var p=u[1],f=0,d=0;d<c;d++){var y,g=u[3*d+1];0<d&&(y=g-p,180<Math.abs(y)&&(f+=p<g?-360:360)),p=g,h[d]=Qr.latLngToMeters([g+f,u[3*d]])}else for(var v=0;v<c;v++)h[v]=Qr.latLngToMeters([u[3*v+1],u[3*v]]);l.bounds=h}t.setLookAtData(l,i)}},{key:"_getLookAtDataFromManipulator",value:function(t,e){var i=1<arguments.length&&void 0!==e&&e,r=t.getLookAtData(),n=r.heading,o=r.incline,a=r.tilt,s=r.zoom,l=r.position,u=r.bounds,c=r.unpadded_bounds,h=Or(Qr.metersToLatLng(l),2),p=h[0],f=h[1],d=new H.geo.LineString;return(i?c:u).forEach((function(t){var e=Qr.metersToLatLng(t);d.pushLatLngAlt(e[1],e[0],0)})),{heading:n,incline:o,tilt:a,zoom:s,bounds:new H.geo.Polygon(d),position:{lat:f,lng:p,alt:l[2]}}}}]),t}(),ch=mc.PLACEMENT,hh=128/Math.PI,ph=16384/Math.PI,fh=Object.create(ua);Object.assign(fh,Uc),Object.assign(fh,{name:"points",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}",selection:!0,collision:!0,blend:"overlay",init:function(t){var e=0<arguments.length&&void 0!==t?t:{};ua.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=1,this.defines.TANGRAM_POINT_TYPE_LABEL=2,this.defines.TANGRAM_POINT_TYPE_SHADER=3,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){"overlay"!==this.blend&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,ql.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),ql.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=2),ql.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(t,e,i){var r,n,o,a=i.tile,s={};if(s.color=this.parseColor(e.color,i),s.texture=e.texture,s.label_texture=null,s.color||s.texture){if(this.hasSprites(s)){if(!(r=this.parseSprite(s,e,i)))return;s.texcoords=r.texcoords}if(s.size=e.size,s.size){if(s.size=yo.evalCachedPointSizeProperty(e.size,r,i),null==s.size)return void En({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(e.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");"number"==typeof s.size&&(s.size=[s.size,s.size])}else s.size=r&&r.css_size||[16,16];e.outline&&(s.outline_width=yo.evalCachedProperty(e.outline.width,i)||yo.defaults.outline.width,s.outline_color=this.parseColor(e.outline.color,i)),s.outline_edge_pct=0,s.outline_width&&s.outline_color&&(n=s.outline_width,s.size[0]+=n,s.size[1]+=n,s.outline_edge_pct=n/Math.min(s.size[0],s.size[1])*2),s.size[0]=Math.min(s.size[0],256),s.size[1]=Math.min(s.size[1],256),s.placement=e.placement,s.placement_min_length_ratio=yo.evalCachedProperty(e.placement_min_length_ratio,i),s.placement===ch.SPACED&&e.placement_spacing&&(s.placement_spacing=yo.evalCachedProperty(e.placement_spacing,i)),s.angle=yo.evalProperty(e.angle,i)||0,s.elevate_by_altitude=!!e.elevate_by_altitude,s.z=e.z?Xr.clamp(yo.evalCachedDistanceProperty(e.z,i),0,32767):yo.defaults.z,s.flat=e.flat,s.tile_edges=e.tile_edges,this.computeLayout(s,t,e,i,a),e.stick&&!s.flat&&(o=yo.parseNumber(yo.evalProperty(e.stick.height,i)),s.stick={color:this.parseColor(e.stick.color,i)||yo.defaults.color,height:o?Math.max(o,0):0});var l=e.text&&!1!==yo.evalProperty(e.text.visible,i)&&this.parseTextFeature(t,e.text,i,a);Array.isArray(l)&&En({level:"warn",once:!(l=null)},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(e.text.text_source))),l&&(l.layout.parent=s,l.layout.priority=e.text.priority?Math.max(l.layout.priority,s.priority+.5):s.priority+.5,l.layout.move_into_tile=!1,Ao.addStyle(this.collision_group_text,a.id)),this.queueFeature({feature:t,draw:e,context:i,style:s,text_feature:l},a),Ao.addStyle(this.collision_group_points,a.id)}},hasSprites:function(t){return t.texture&&this.textureManager.textures[t.texture]&&this.textureManager.textures[t.texture].sprites},getSpriteInfo:function(t,e){var i=this.textureManager.textures[t.texture].sprites[e]&&this.textureManager.getSpriteInfo(t.texture,e);return e&&!i?(this.texture_missing_sprites[t.texture]=this.texture_missing_sprites[t.texture]||{},this.texture_missing_sprites[t.texture][e]||(En("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(e,"' for texture '").concat(t.texture,"'")),this.texture_missing_sprites[t.texture][e]=!0)):i&&(i.sprite=e),i},parseSprite:function(t,e,i){var r=yo.evalProperty(e.sprite,i);return this.getSpriteInfo(t,r)||this.getSpriteInfo(t,e.sprite_default)},queueFeature:function(t,e){this.tile_data[e.id]&&this.queues[e.id]||this.startData(e),this.queues[e.id]=this.queues[e.id]||[],this.queues[e.id].push(t)},endData:function(t){var e=this;if(t.canceled)return En("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(t.key)),Promise.resolve();var i=this.queues[t.id];delete this.queues[t.id];var r=[],n=[];return i.forEach((function(t){for(var i=t.style,o=t.feature,a=o.geometry,s=e.buildLabels(i.size,a,i),l=0;l<s.length;l++){var u,c=s[l],h={feature:o,draw:t.draw,context:t.context,style:i,label:c};n.push(h),t.text_feature&&(u={feature:o,draw:t.text_feature.draw,context:t.context,text:t.text_feature.text,text_settings_key:t.text_feature.text_settings_key,layout:t.text_feature.layout,point_label:c,linked:h},r.push(u),t.draw.text.optional||(h.linked=u))}})),Promise.all([Ao.collide(n,this.collision_group_points,t.id).then((function(t){t.forEach((function(t){e.feature_style=t.style,e.feature_style.label=t.label,e.feature_style.linked=t.linked,ua.addFeature.call(e,t.feature,t.draw,t.context)}))})),this.collideAndRenderTextLabels(t,this.collision_group_text,r)]).then((function(i){var r=Or(i,2)[1],n=r.labels,o=r.texts;return n&&o&&n.forEach((function(t){var i=t.text_settings_key,r=o[i]&&o[i][t.text],n=e.feature_style;n.label=t.label,n.linked=t.linked,n.size=r.size.logical_size,n.angle=0,t.label.text_data={text_info:r,text_settings_key:i,text:t.text},n.label_texture=e.textureManager.default,ua.addFeature.call(e,t.feature,t.draw,t.context)})),e.freeText(t),ua.endData.call(e,t)}))},_preprocess:function(t){t.color=yo.createColorPropertyCache(t.color),t.texture=void 0!==t.texture?t.texture:this.texture,t.outline&&(t.outline.color=yo.createColorPropertyCache(t.outline.color),t.outline.width=yo.createPropertyCache(t.outline.width,yo.parsePositiveNumber)),t.z=yo.createPropertyCache(t.z,yo.parseUnits);try{t.size=yo.createPointSizePropertyCache(t.size)}catch(e){return En({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"".concat(e," (").concat(JSON.stringify(t.size),"), skipping features in layer")),null}return t.offset=yo.createPropertyCache(t.offset,(function(t){return Array.isArray(t)&&t.map(yo.parseNumber)})),t.buffer=yo.createPropertyCache(t.buffer,(function(t){return(Array.isArray(t)?t:[t,t]).map(yo.parsePositiveNumber)})),t.repeat_distance=yo.createPropertyCache(t.repeat_distance,yo.parseNumber),null==t.repeat_group&&(t.repeat_group=t.layers.join("-")),t.placement=ch[t.placement&&t.placement.toUpperCase()],null==t.placement&&(t.placement=ch.VERTEX),t.placement_spacing=null!=t.placement_spacing?t.placement_spacing:80,t.placement_spacing=yo.createPropertyCache(t.placement_spacing,yo.parsePositiveNumber),t.placement_min_length_ratio=null!=t.placement_min_length_ratio?t.placement_min_length_ratio:1,t.placement_min_length_ratio=yo.createPropertyCache(t.placement_min_length_ratio,yo.parsePositiveNumber),"number"==typeof t.angle?t.angle=t.angle*Math.PI/180:t.angle=t.angle||0,t.text=this.preprocessText(t.text),t.text&&(t.text.variantKey=t.variantKey,t.text.group=t.group,t.text.layers=t.layers,t.text.order=t.order,t.text.repeat_group=t.text.repeat_group||t.repeat_group,t.text.anchor=t.text.anchor||this.default_anchor,t.text.optional="boolean"==typeof t.text.optional&&t.text.optional,t.text.interactive=t.text.interactive||t.interactive),t.stick&&(t.stick.color=yo.createColorPropertyCache(t.stick.color)),t},default_anchor:["bottom","top","right","left"],computeLayout:function(t,e,i,r,n){var o=t||{};o.id=e,o.units_per_pixel=n.units_per_pixel||1,o.collide=!1!==i.collide,o.anchor=i.anchor,o.offset=yo.evalCachedProperty(i.offset,r)||yo.zeroPair,o.buffer=yo.evalCachedProperty(i.buffer,r)||yo.zeroPair,o.repeat_distance=yo.evalCachedProperty(i.repeat_distance,r),o.repeat_distance&&(o.repeat_distance*=o.units_per_pixel,o.repeat_scale=1,"function"==typeof i.repeat_group?o.repeat_group=i.repeat_group(r):o.repeat_group=i.repeat_group);var a=i.priority;return null!=a?"function"==typeof a&&(a=a(r)):a=-1>>>0,o.priority=a,o},buildTextLabels:function(t,e){for(var i=[],r=0;r<e.length;r++){var n=e[r],o=this.texts[t.id][n.text_settings_key][n.text].size.collision_size;n.label=new mc(n.point_label.position,o,n.point_label.isFlat(),n.layout),i.push(n)}return i},buildLabels:function(t,e,i){var r=!!i.flat,n=[];if("Point"===e.type)n.push(new mc(e.coordinates,t,r,i));else if("MultiPoint"===e.type)for(var o=e.coordinates,a=0;a<o.length;++a){var s=o[a];n.push(new mc(s,t,r,i))}else if("LineString"===e.type)for(var l=bc(e.coordinates,t,r,i),u=0;u<l.length;++u)n.push(l[u]);else if("MultiLineString"===e.type)for(var c=e.coordinates,h=0;h<c.length;h++)for(var p=bc(c[h],t,r,i),f=0;f<p.length;++f)n.push(p[f]);else if("Polygon"===e.type)if(i.placement===ch.CENTROID){var d=Qr.centroid(e.coordinates);n.push(new mc(d,t,r,i))}else for(var y=e.coordinates,g=0;g<y.length;g++)for(var v=bc(y[g],t,r,i),m=0;m<v.length;++m)n.push(v[m]);else if("MultiPolygon"===e.type)if(i.placement===ch.CENTROID){var _=Qr.multiCentroid(e.coordinates);n.push(new mc(_,t,r,i))}else for(var b=e.coordinates,w=0;w<b.length;w++)for(var x=b[w],E=0;E<x.length;E++)for(var A=bc(x[E],t,r,i),T=0;T<A.length;++T)n.push(A[T]);return n},makeVertexTemplate:function(t,e){var i,r=t.color||yo.defaults.color,n=e.vertex_data.vertex_layout;return this.fillVertexTemplate(n,"a_position",0,{size:2}),this.fillVertexTemplate(n,"a_position",t.z||0,{size:1,offset:2}),this.fillVertexTemplate(n,"a_position",this.scaleOrder(t.order),{size:1,offset:3}),this.fillVertexTemplate(n,"a_shape",0,{size:4}),this.fillVertexTemplate(n,"a_shape",t.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(n,"a_texcoord",0,{size:2}),this.fillVertexTemplate(n,"a_offset",0,{size:2}),this.fillVertexTemplate(n,"a_color",ea.mult(r,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&e.variant.shader_point&&(i=t.outline_color||yo.defaults.outline.color,this.fillVertexTemplate(n,"a_outline_color",ea.mult(i,255),{size:4}),this.fillVertexTemplate(n,"a_outline_edge",t.outline_edge_pct||yo.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(n,"a_selection_color",ea.mult(t.selection_color,255),{size:4}),this.fillVertexTemplate(n,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&t.stick&&(this.fillVertexTemplate(n,"a_is_stick",0,{size:1}),this.fillVertexTemplate(n,"a_stick_height",t.stick.height,{size:1})),this.vertex_template},buildQuad:function(t,e,i,r,n,o,a,s,l,u,c,h,p,f,d,y,g,v,m){return e[0]<=0||e[1]<=0?0:function(t,e,i,r){var n,o,a,s,l,u,c=r.quad,h=r.offset,p=r.offsets,f=r.offsets_alt,d=r.pre_angles,y=r.pre_angles_alt,g=r.angle,v=r.angles,m=r.angles_alt,_=r.is_flat,b=r.elevate_by_altitude,w=r.build_stick_points,x=r.color,E=r.stick_color,A=r.curve,T=r.texcoord_scale,k=r.texcoord_normalize,S=r.pre_angles_normalize,M=r.angles_normalize,I=r.offsets_normalize,O=(O=r.quad_normalize)||1,L=c[0]/2*O,C=c[1]/2*O,R=[[-L,-C],[L,-C],[L,C],[-L,C]],N=e.vertex_elements,P=e.vertex_count,j=e.vertex_layout.index,D=j.a_texcoord,z=j.a_position,F=j.a_shape,G=j.a_offset,H=j.a_offsets,B=j.a_offsets_alt,U=j.a_pre_angles,V=j.a_pre_angles_alt,q=j.a_angles,Y=j.a_angles_alt,W=j.a_is_flat,Z=j.a_is_stick,K=j.a_color;D&&(k=k||1,u=[[o=(n=Or(T||ou,4))[0],a=n[1]],[s=n[2],a],[s,l=n[3]],[o,l]]);for(var X=0,J=t.length,Q=0;Q<J;Q++){var $=t[Q];if(w){for(var tt=.5*O,et=+O,it=[[-tt,0],[+tt,0],[+tt,et],[-tt,et]],rt=0;rt<4;rt++)D&&(i[D+0]=u[rt][0]*k,i[D+1]=u[rt][1]*k),i[z+0]=$[0],i[z+1]=$[1],b&&(i[z+2]=Xr.clamp($[2],0,32767)),i[F+0]=it[rt][0],i[F+1]=it[rt][1],i[F+2]=0,i[K+0]=E[0],i[K+1]=E[1],i[K+2]=E[2],i[K+3]=E[3],i[Z+0]=255,e.addVertex(i);N.push(P+0),N.push(P+1),N.push(P+2),N.push(P+2),N.push(P+3),N.push(P+0),P+=4,X+=2}for(var nt=0;nt<4;nt++)D&&(i[D+0]=u[nt][0]*k,i[D+1]=u[nt][1]*k),i[z+0]=$[0],i[z+1]=$[1],b&&(i[z+2]=Xr.clamp($[2],0,32767)),i[F+0]=R[nt][0],i[F+1]=R[nt][1],i[F+2]=g,i[K+0]=x[0],i[K+1]=x[1],i[K+2]=x[2],i[K+3]=x[3],i[G+0]=h[0],i[G+1]=h[1],i[W+0]=_?255:0,w&&(i[Z+0]=0),A&&(i[U+0]=S*d[0],i[U+1]=S*d[1],i[U+2]=S*d[2],i[U+3]=S*d[3],i[q+0]=M*v[0],i[q+1]=M*v[1],i[q+2]=M*v[2],i[q+3]=M*v[3],i[H+0]=I*p[0],i[H+1]=I*p[1],i[H+2]=I*p[2],i[H+3]=I*p[3],f&&(i[B+0]=I*f[0],i[B+1]=I*f[1],i[B+2]=I*f[2],i[B+3]=I*f[3],i[V+0]=S*y[0],i[V+1]=S*y[1],i[V+2]=S*y[2],i[V+3]=S*y[3],i[Y+0]=M*m[0],i[Y+1]=M*m[1],i[Y+2]=M*m[2],i[Y+3]=M*m[3])),e.addVertex(i);N.push(P+0),N.push(P+1),N.push(P+2),N.push(P+2),N.push(P+3),N.push(P+0),P+=4,X+=2}return X}(t,d,y,{quad:e,quad_normalize:256,offset:s,offsets:l,offsets_alt:u,pre_angles:o,pre_angles_alt:a,angle:4096*i,angles:r,angles_alt:n,is_flat:p,elevate_by_altitude:f,build_stick_points:g,stick_color:g&&ea.mult(v,255),color:ea.mult(m||yo.defaults.color,255),curve:h,texcoord_scale:c,texcoord_normalize:65535,pre_angles_normalize:hh,angles_normalize:ph,offsets_normalize:64})},build:function(t,e,i){var r=t.label;return"curved"===r.type?this.buildCurvedLabel(r,t,e,i):this.buildStraightLabel(r,t,e,i)},buildStraightLabel:function(t,e,i,r){var n,o=this.makeVertexTemplate(e,i),a=t.angle||e.angle,s="point"!==t.type?(n=e.size[t.type],ou):(n=e.size,e.texcoords||ou);i.uniforms=i.uniforms||{},e.label_texture?(i.uniforms.u_texture=e.label_texture,i.uniforms.u_point_type=2,i.uniforms.u_apply_color_blocks=!1):(e.texture?(i.uniforms.u_texture=e.texture,i.uniforms.u_point_type=1):(i.uniforms.u_texture=this.textureManager.default,i.uniforms.u_point_type=3),i.uniforms.u_apply_color_blocks=!0);var l=t.offset,u=this.defines.TANGRAM_POINT_DRAW_STICK&&!e.label_texture&&e.stick&&0<e.stick.height,c=this.buildQuad([t.position],n,a,null,null,null,null,l,null,null,s,!1,t.isFlat(),e.elevate_by_altitude,i.vertex_data,o,u,u&&e.stick.color,e.color),h=e.linked&&e.linked.label.id;return this.trackLabel(t,h,i,c,r,u),c},buildCurvedLabel:function(t,e,i,r){for(var n=this.makeVertexTemplate(e,i),o=t.angle,a=0,s=0;s<2;s++)for(var l=0;l<t.num_segments;l++){var u=e.size[t.type][l],c=ou,h=this.getTileMesh(r.tile,this.getMeshVariantTypeForDraw(e));h.uniforms=h.uniforms||{},h.uniforms.u_texture=e.label_texture,h.uniforms.u_point_type=2,h.uniforms.u_apply_color_blocks=!1;var p=t.offset||[0,0],f=t.position,d=t.angles[l],y=t.offsets[l],g=t.pre_angles[l],v=t.num_segments-l-1,m=t.alt_angles[v],_=t.alt_pre_angles[v],b=t.alt_offsets[v],w=this.buildQuad([f],u,o,d,m,g,_,p,y,b,c,!0,t.isFlat(),e.elevate_by_altitude,h.vertex_data,n,!1,!1,e.color);a+=w;var x=e.linked&&e.linked.label.id;this.trackLabel(t,x,i,w,r,!1)}return a},trackLabel:function(t,e,i,r,n,o){var a=5<arguments.length&&void 0!==o&&o;i.labels=i.labels||{},i.labels.collision=i.labels.collision||{},i.labels["non-collision"]=i.labels["non-collision"]||{};var s=t.layout.collide?i.labels.collision:i.labels["non-collision"];s[t.id]=s[t.id]||{container:{label:t.text_data?Object.assign(t.toJSON(),{text_data:t.text_data}):t.toJSON(),linked:e},ranges:[]};var l=2*r,u=i.vertex_data.offset-i.vertex_data.stride*l;s[t.id].ranges.push([u,l,a])},buildLines:function(t,e,i,r){return this.build(e,i,r)},buildPoints:function(t,e,i,r){return this.build(e,i,r)},buildPolygons:function(t,e,i,r){return this.build(e,i,r)},vertexLayoutForMeshVariant:function(t){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:Xl.SHORT,normalized:!1},{name:"a_shape",size:4,type:Xl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:Xl.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:Xl.SHORT,normalized:!1},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:Xl.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:Xl.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&e.push({name:"a_is_stick",size:1,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:Xl.FLOAT,normalized:!1}),this.vertex_layout=new ru(e),(e=e.map((function(t){return Object.assign({},t)}))).forEach((function(t){"a_outline_color"!==t.name&&"a_outline_edge"!==t.name||(t.static=null)})),this.vertex_layout_shader_point=new ru(e)),t.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(t){var e=t.label_texture||t.texture||this.default_mesh_variant.key;return{key:e,shader_point:e===this.default_mesh_variant.key,order:t.label_texture?1:0}},makeMesh:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:{};return r=Object.assign({},r,{fade_in_time:this.fade_in_time}),ua.makeMesh.call(this,t,e,r)}});var dh=[0,.33,.66,.99],yh=function(t,e,i,r,n){for(var o=[{type:"straight",tolerance:n.no_curving?1.8:1.5},{type:"curved"},{type:"straight",tolerance:2.3}],a=0;a<o.length;a++){var s=o[a],l=void 0;if("straight"===s.type?l=new vh(e,i,r,n,s.tolerance):"curved"===s.type&&!n.no_curving&&2<i.length&&(l=new mh(t,i,r,n)),l&&!l.throw_away)return l}return!1},gh=function(){function t(e,i){vr(this,t),this.id=cc.nextLabelId(),this.layout=i,this.position=[],this.angle=0,this.offset=i.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=e,this._circles=void 0,this.placed=null}return _r(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:hc(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,i=t.top,r=t.right,n=t.bottom;return Tn.pointInTile([e,i])&&Tn.pointInTile([r,n])}},{key:"getAABBForSegment",value:function(t,e,i,r){var n,o=this.unit_scale,a=e/2,s=i/2,l=Or(t,2),u=l[0],c=l[1];0===this.offset[0]&&0===this.offset[1]||(u+=(n=ea.rot(this.offset,this.angle))[0]*o,c-=n[1]*o);var h=[[Math.cos(r),-Math.sin(r)],[Math.sin(r),Math.cos(r)]],p=ea.multMatrix(h,[-a,-s]),f=ea.multMatrix(h,[a,-s]),d=ea.multMatrix(h,[a,s]),y=ea.multMatrix(h,[-a,s]);return{left:u+Math.min(p[0],f[0],d[0],y[0]),top:c+Math.max(p[1],f[1],d[1],y[1]),right:u+Math.max(p[0],f[0],d[0],y[0]),bottom:c+Math.min(p[1],f[1],d[1],y[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(t){for(var e=[t[0]],i=0,r=0,n=0,o=e,a=!1,s=1;s<t.length;s++){var l=t[s],u=t[s-1],c=ea.length(ea.sub(l,u));l[0]>u[0]?1===n?(e.push(l),r<(i+=c)&&(o=e,r=i,a=!1)):(e=[u,l],r<(i=c)&&(o=e,r=i,a=!1),n=1):l[0]<u[0]?-1===n?(e.unshift(l),r<(i+=c)&&(o=e,r=i,a=!0)):(e=[l,u],r<(i=c)&&(o=e,r=i,a=!0),n=-1):(-1===n?e.unshift(l):(e.push(l),n=1),r<(i+=c)&&(o=e,r=i,a=-1===n))}return[o,a]}}]),t}(),vh=function(){wr(e,gh);var t=Mr(e);function e(i,r,n,o,a){var s;return vr(this,e),(s=t.call(this,n,o)).type="straight",s.size=i,s.throw_away=!s.fit(i,r,o,a),s}return _r(e,[{key:"fit",value:function(t,e,i,r){var n,o=this.unit_scale,a=Or(gh.splitLineByOrientation(e),2);e=a[0],n=a[1],"number"==typeof i.orientation&&(this.offset[1]+=1.2*(t[1]-i.vertical_buffer),n&&(this.offset[1]*=-1),-1===i.orientation&&(this.offset[1]*=-1));for(var s=bh(e),l=t[0]*o,u=0;u<e.length-1;u++)for(var c=e[u],h=0,p=0,f=u+1,d=void 0;f<e.length;){var y=e[f-1],g=e[f],v=_h(y,g);if(f!==u+1&&(h+=function(t,e){var i,r;for(r=e<t?(i=e,t):(i=t,e);r-i>Math.PI;)i+=2*Math.PI;return Math.abs(r-i)}(v,d)),.1<Math.abs(h))break;if(l/(p+=s[f-1])<r){var m=ea.mult(ea.add(c,g),.5);return this.angle=-v,Math.abs(this.angle-Math.PI/2)<.01&&(this.angle=-Math.PI/2,"number"==typeof i.orientation&&(this.offset[1]*=-1)),this.position=m,this.breach=!this.inTileBounds(),!0}d=v,f++}return!1}},{key:"getBoundingCircles",value:function(){var t,e,i,r,n,o,a,s,l,u,c,h,p,f;return this._circles||(t=this.unit_scale,n=-(i=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(r=e*Math.sin(this.angle)),a=this.offset[0]*t,s=this.offset[1]*t,u=(l=Or(this.position,2))[0],c=l[1],c*=-1,a&&(h=[i,r],ea.normalize(h),h[0]*=a,h[1]*=a,u+=h[0],c+=h[1]),s&&(p=[r,-i],ea.normalize(p),p[0]*=s,p[1]*=s,u-=p[0],c-=p[1]),i+=u,r+=c,n+=u,o+=c,f=this.size[1]/2*t,this._circles=vc(i,r,n,o,f)),this._circles}},{key:"getAABB",value:function(){var t,e,i,r,n;return this._aabb||(t=this.unit_scale,e=this.size,i=this.layout.buffer,r=(e[0]+2*i[0])*t,n=(e[1]+2*i[1])*t,this._aabb=this.getAABBForSegment(this.position,r,n,this.angle)),this._aabb}}]),e}(),mh=function(){wr(e,gh);var t=Mr(e);function e(i,r,n,o){var a;return vr(this,e),(a=t.call(this,n,o)).type="curved",a.positions=[],a.angles=[],a._aabbs=[],a.pre_angles=[],a.offsets=[],a.num_segments=i.length,a.sizes=i,a.alt_angles=[],a.alt_pre_angles=[],a.alt_offsets=[],a.throw_away=!a.fit(a.sizes,r,o),a}return _r(e,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:hc(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(t,i,r){var n,o=this.unit_scale,a=Math.max.apply(Math,Lr(t.map((function(t){return t[1]})))),s=a*o,l=Or(gh.splitLineByOrientation(i),2);i=l[0],n=l[1],"number"==typeof r.orientation&&(this.offset[1]+=1.2*(a-r.vertical_buffer),n&&(this.offset[1]*=-1),-1===r.orientation&&(this.offset[1]*=-1));var u=bh(i),c=t.map((function(t){return t[0]*o})),h=u.reduce((function(t,e){return t+e}),0),p=c.reduce((function(t,e){return t+e}),0);if(h<p)return!1;var f=i.length-1;if(f<2)return!1;var d=e.curvaturePlacement(i,h,u,p,0,f),y=i[d];if(-1===d||f-d<2)return!1;this.position=y;for(var g=0;g<c.length;g++){this.positions[g]=[],this.offsets[g]=[],this.angles[g]=[],this.pre_angles[g]=[];for(var v=0;v<dh.length;v++){var m=dh[v],_=Or(e.scaleLine(m,i),2),b=_[0],w=_[1],x=(y=b[d],e.placeAtIndex(d,b,w,c)),E=x.positions,A=x.offsets,T=x.angles,k=x.pre_angles,S=A.map((function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o}));if(0===m){this.angle=1/T.length*T.reduce((function(t,e){return t+e}));for(var M=0;M<E.length;M++){var I=E[M],O=k[M],L=c[M],C=O+T[M];this._aabbs.push(this.getAABBForSegment(I,L,s,C))}}this.positions[g].push(E[g]),this.offsets[g].push(S[g]),this.angles[g].push(T[g]),this.pre_angles[g].push(k[g])}}c=t.slice().reverse().map((function(t){return t[0]*o}));for(var R=0;R<c.length;R++){this.alt_offsets[R]=[],this.alt_angles[R]=[],this.alt_pre_angles[R]=[];for(var N=0;N<dh.length;N++){var P=dh[N],j=Or(e.scaleLine(P,i),2),D=j[0],z=j[1];y=D[d];var F=e.placeAtIndex(d,D,z,c),G=F.offsets,H=F.angles,B=F.pre_angles,U=G.map((function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o}));0===P&&(this.alt_angle=1/H.length*H.reduce((function(t,e){return t+e}))),this.alt_offsets[R].push(U[R]),this.alt_angles[R].push(H[R]),this.alt_pre_angles[R].push(B[R])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var t=[],e=this.unit_scale,i=0;i<this.positions.length;i++){var r=this.sizes[i],n=this.angles[i][0],o=this.positions[i][0],a=r[0]/2*e,s=a*Math.cos(n),l=a*Math.sin(n),u=-s,c=-l,h=Or(o,2),p=h[0],f=h[1],d=vc(s+=p,l+=f*=-1,u+=p,c+=f,r[1]/2*e);Array.prototype.push.apply(t,d)}this._circles=t}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var t=1/0,e=-1/0,i=-1/0,r=1/0,n=0;n<this._aabbs.length;n++){var o=this._aabbs[n];t=Math.min(t,o.left),e=Math.max(e,o.top),i=Math.max(i,o.right),r=Math.min(r,o.bottom)}this._aabb={left:t,top:e,right:i,bottom:r}}return this._aabb}}],[{key:"curvaturePlacement",value:function(t,e,i,r,n,o){n=n||0,o=o||t.length-1;for(var a=[],s=n+1;s<o;s++){var l=t[s-1],u=t[s],c=t[s+1],h=ea.perp(u,l),p=ea.perp(c,u),f=ea.angleBetween(h,p);1<f&&(f=1/0),a.push(f)}a.push(1/0);for(var d=[],y=[],g=n,v=0,m=0;m<n;m++)v+=i[m];for(;v+r<e;){for(var _=v+r,b=v,w=g,x=0;w<o&&b+i[w]<_&&(x+=a[w])!==1/0;)b+=i[w],w++;if(0===x)return g;var E=x/(w-g);d.push(x),y.push(E),v+=i[g],g++}if(0===d.length)return-1;var A=Math.min.apply(null,d),T=y[d.indexOf(A)];return A<1.3&&T<.4?d.indexOf(A):-1}},{key:"scaleLine",value:function(t,e){var i=[e[0]],r=[];return e.forEach((function(n,o){var a,s;o!==e.length-1&&(a=ea.sub(e[o+1],e[o]),s=ea.mult(a,1+t),i.push(ea.add(i[o],s)),r.push(ea.length(s)))})),[i,r]}},{key:"placeAtIndex",value:function(t,i,r,n){var o=i[t],a=Or(e.getIndicesAndOffsets(t,r,n),2),s=a[0],l=a[1],u=e.getPositionsFromIndicesAndOffsets(i,s,l),c=Or(e.getAnglesFromIndicesAndOffsets(o,s,i,u),3);return{positions:u,offsets:c[0],angles:c[1],pre_angles:c[2]}}},{key:"getIndicesAndOffsets",value:function(t,e,i){for(var r=i.length,n=[],o=[],a=0,s=0,l=0;a<r;){for(var u=i[a];a<r&&s+.5*u<=l+e[t];){var c=s-l+.5*u;o.push(c),n.push(t),s+=u,u=i[++a]}l+=e[t],t++}return[n,o]}},{key:"getPositionsFromIndicesAndOffsets",value:function(t,e,i){for(var r=[],n=0;n<e.length;n++){var o=e[n],a=i[n],s=_h(t[o],t[o+1]),l=ea.rot([a,0],s),u=ea.add(t[o],l);r.push(u)}return r}},{key:"getAnglesFromIndicesAndOffsets",value:function(t,e,i,r){for(var n=[],o=[],a=[],s=0;s<r.length;s++){var l,u,c=r[s],h=e[s],p=ea.sub(c,t),f=-ea.angle(p),d=-_h(i[h],i[h+1])-f;0<s&&(l=n[s-1],u=o[s-1],Math.abs(f-l)>Math.PI&&(f+=l<f?-2*Math.PI:2*Math.PI),Math.abs(u-d)>Math.PI&&(d+=u<d?-2*Math.PI:2*Math.PI)),n.push(f),o.push(d),a.push(p)}return[a,n,o]}}]),e}();function _h(t,e){var i=ea.sub(e,t);return ea.angle(i)}function bh(t){for(var e=[],i=0;i<t.length-1;i++){var r=t[i],n=t[i+1],o=Math.hypot(r[0]-n[0],r[1]-n[1]);e.push(o)}return e}var wh=Object.create(fh);Object.assign(wh,{name:"text",super:fh,built_in:!0,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};ua.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(t,e){this.super.makeVertexTemplate.apply(this,arguments);var i=e.vertex_data.vertex_layout;return this.fillVertexTemplate(i,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(i,"a_offsets",0,{size:4}),this.fillVertexTemplate(i,"a_angles",0,{size:4}),this.fillVertexTemplate(i,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(i,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(i,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(t,e,i){var r=this,n=i.tile,o=t.geometry.type;e.can_articulate="LineString"===o||"MultiLineString"===o,e.supersample_text="LineString"===o||"MultiLineString"===o;var a=this.parseTextFeature(t,e,i,n);a&&(a instanceof Array?a.forEach((function(e){e.feature=t,e.context=i,e.layout.vertex=!1,r.queueFeature(e,n)})):(a.feature=t,a.context=i,a.layout.vertex=!1,this.queueFeature(a,n)),Ao.addStyle(this.name,n.id))},endData:function(t){var e=this,i=this.queues[t.id];return delete this.queues[t.id],this.collideAndRenderTextLabels(t,this.name,i).then((function(i){var r=i.labels,n=i.texts;return r&&n&&(e.texts[t.id]=n,r.forEach((function(i){var r=i.text_settings_key,n=e.texts[t.id][r]&&e.texts[t.id][r][i.text],o=e.feature_style;o.label=i.label,i.label.text_data={text_info:n,text_settings_key:r,text:i.text},o.label_texture=e.textureManager.default,n.text_settings.can_articulate?(o.size={},"straight"===i.label.type?o.size.straight=n.size.logical_size:o.size.curved=n.segment_sizes.map((function(t){return t.logical_size}))):o.size=n.size.logical_size,ua.addFeature.call(e,i.feature,i.draw,i.context)}))),e.freeText(t),ua.endData.call(e,t).then((function(i){if(i){for(var r in i.meshes)i.meshes[r].uniforms.u_apply_color_blocks=!0;t.mesh_data[e.name]=i}return i}))}))},_preprocess:function(t){return this.preprocessText(t)},buildTextLabels:function(t,e){for(var i=[],r=0;r<e.length;r++){var n,o,a=e[r],s=this.texts[t.id][a.text_settings_key][a.text];a.layout.vertical_buffer=s.vertical_buffer,o=s.text_settings.can_articulate?(n=s.segment_sizes.map((function(t){return t.collision_size})),a.layout.no_curving=s.no_curving,this.buildLabels(n,a.feature.geometry,a.layout,s.size.collision_size)):this.buildLabels(s.size.collision_size,a.feature.geometry,a.layout);for(var l=0;l<o.length;l++){var u=Object.create(a);u.label=o[l],i.push(u)}}return i},buildLabels:function(t,e,i,r){var n,o,a="Point"!==e.type,s=[];if("LineString"===e.type)Array.prototype.push.apply(s,this.buildLineLabels(e.coordinates,t,a,i,r));else if("MultiLineString"===e.type)for(var l=e.coordinates,u=0;u<l.length;++u)Array.prototype.push.apply(s,this.buildLineLabels(l[u],t,a,i,r));else if("Point"===e.type)s.push(new mc(e.coordinates,t,a,i));else if("MultiPoint"===e.type)for(var c=e.coordinates,h=0;h<c.length;++h)s.push(new mc(c[h],t,a,i));else"Polygon"===e.type?(n=Qr.centroid(e.coordinates),s.push(new mc(n,t,a,i))):"MultiPolygon"===e.type&&(o=Qr.multiCentroid(e.coordinates),s.push(new mc(o,t,a,i)));return s},buildLineLabels:function(t,e,i,r,n){var o,a=[],s=Math.min(r.subdiv,t.length-1);if(1<s)for(var l=(t.length-1)/s,u=0;u<s;u++){var c=Math.floor(u*l),h=Math.floor((u+1)*l)+1,p=t.slice(c,h),f=yh(e,n,p,i,r);f&&a.push(f)}return a.length<s&&(o=yh(e,n,t,i,r))&&a.push(o),a},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:Xl.SHORT,normalized:!1},{name:"a_shape",size:4,type:Xl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:Xl.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:Xl.SHORT,normalized:!1},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:Xl.SHORT,normalized:!1},{name:"a_offsets",size:4,type:Xl.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:Xl.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:Xl.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:Xl.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:Xl.SHORT,normalized:!1}],this.vertex_layout=new ru(t)),this.vertex_layout},getMeshVariantTypeForDraw:fh.getMeshVariantTypeForDraw}),wh.texture_id=0;var xh=Object.create(Iu);Object.assign(xh,{name:"raster",super:Iu,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(t){return t.color=t.color||yo.defaults.color,this.super._preprocess.apply(this,arguments)}});var Eh=Object.create(fh);Object.assign(Eh,{name:"custom_icons",collision:!1,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};fh.init.call(this,e)},loadTexture:function(t,e,i){var r,n=t.width,o=t.height,a=t.items,s=document.createElement("canvas"),l=Tn.device_pixel_ratio,u=this.sources[e],c={sprites:{}};if(s.width=n*l,s.height=o*l,u){var h,p=a.length,f=s.getContext("2d");for(f.scale(l,l);h=a[--p];){var d,y=u.getIconBitmapByObjectId(h.meta.objectId,h.meta.id);y&&((d=Il(y))?En("error",d):(f.drawImage(y,h.x,h.y,h.width,h.height),c.sprites[h.meta.id]=[h.x,h.y,h.width,h.height]))}}return c.element=s,(r=this.textureManager.create(this.gl,i,c)).retain(),r.loading.then((function(t){return t.name}))},buildRasterTextures:function(t,e){return un.postMessage(this.main_thread_target+".loadTexture",t.rasters,t.source,t.texture_name).then((function(t){return e.textures.push(t),e}))},addFeature:function(t,e,i){var r=i.tile.rasters,n={};r.items.forEach((function(t){n[t.meta.id]=[t.x,t.y,t.width,t.height]}));var o="".concat(i.tile.source,"_dyn_").concat(i.tile.coords.key,"_").concat(this.generation,"_").concat(i.tile.id);e.texture=i.tile.texture_name=o;var a=Object.assign({},Ah,{name:o,width:r.width,height:r.height,sprites:n,manager:this.textureManager});So.prototype.calculateSprites.apply(a),this.textureManager.textures[o]=a,fh.addFeature.apply(this,arguments),delete this.textureManager.textures[o]}});var Ah={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},Th=Object.create(Iu);Object.assign(Th,{name:"overlays",super:Iu,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};this.selection=e.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!ln.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var t=!1;for(var e in this.sources)if(this.sources[e]instanceof Rl){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",la,"Raster"),!0)},loadTextures:function(t,e){var i,r,n,o=this.sources[e],a=t.name;if(t.overlays_config.forEach((function(e){var a,s=e.texcoords,l=e.id,u=o.getMapObjectById(l),c=u.getBitmap();c&&((a=Il(c=Ol(c,c.width,c.height)))?En("error",a):(i||((i=document.createElement("canvas")).width=t.width,i.height=t.height,r=i.getContext("2d")),r.save(),r.globalAlpha=u.getOpacity(),s.forEach((function(t){return r.drawImage(c,t[0],t[1],t[2],t[3])})),r.restore(),n=!0))})),n){t.element=i;var s={};return s[a]=t,this.super.loadTextures.call(this,s)}var l=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:l.name,width:l.width,height:l.height,loaded:l.loaded}])},buildRasterTextures:function(t,e){var i=this.sources[t.source].tileTexture(t);return i?un.postMessage(this.main_thread_target+".loadTextures",i,t.source).then((function(t){if(!t||t.length<1)return e;if(t.some((function(t){return!t.loaded})))return null;var i=t[0].name;return e.uniforms=e.uniforms||{},e.textures=e.textures||[],e.uniforms.u_raster=i,e.uniforms.u_raster_offset=[0,0,1],e.textures.push(i),e})):Promise.resolve(e)}});var kh=Object.create(ua),Sh=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(kh,{name:"skybox",built_in:!0,vertex_shader_src:"uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",fragment_shader_src:"varying vec4 v_color;void main(void){gl_FragColor=v_color;}",selection:!1,blend:"inlay",blend_order:1,init:function(){ua.init.apply(this,arguments),this.selection=!1},_preprocess:function(t){return t.color={top:yo.createColorPropertyCache(t.color.zenith),bottom:yo.createColorPropertyCache(t.color.horizon),fog:yo.createColorPropertyCache(t.color.fog)},t},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:2,type:Xl.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:Xl.FLOAT,normalized:!0},{name:"a_color",size:4,type:Xl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:Xl.FLOAT,normalized:!0}],this.vertex_layout=new ru(t)),this.vertex_layout},makeVertexTemplate:function(){var t=0;return this.vertex_template[t++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(t,e,i){var r=this.feature_style;return e.color&&e.color.top&&e.color.bottom&&(r.color_top=this.parseColor(e.color.top,i),r.color_bottom=this.parseColor(e.color.bottom,i),r.color_fog=this.parseColor(e.color.fog||"white",i),Array.isArray(r.color_fog)&&(r.color_fog=r.color_fog.slice(),r.color_fog[3]=0)),r},buildGeometry:function(t,e,i){for(var r=this.makeVertexTemplate(e),n=i.vertex_data,o=i.vertex_data.vertex_layout,a=n.vertex_layout.index.a_position,s={top:e.color_top,bottom:e.color_bottom},l={top:e.color_bottom,bottom:e.color_fog},u=0,c=Sh.length-1;u<c;u+=2){r[a+0]=Sh[u],r[a+1]=Sh[u+1];var h=u<12,p=0<Sh[u+1],f=h?s:l;this.fillVertexTemplate(o,"a_is_sky",h?1:0,{size:1}),this.fillVertexTemplate(o,"a_is_top",p?1:0,{size:1}),this.fillVertexTemplate(o,"a_color",ea.mult(p?f.top:f.bottom,255),{size:4}),n.addVertex(r)}return 4}});var Mh=function(){function t(){vr(this,t),this.styles={},this.base_styles={},this.register(Object.create(Iu)),this.register(Object.create(Ku)),this.register(Object.create(ic)),this.register(Object.create(fh)),this.register(Object.create(wh)),this.register(Object.create(xh)),this.register(Object.create(Eh)),this.register(Object.create(Th)),this.register(Object.create(kh))}return _r(t,[{key:"init",value:function(){Ko.removeBlock("global"),Ko.removeBlock("setup"),Ko.addBlock("global","#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n"),Ko.addBlock("global","void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}"),Ko.addBlock("global","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n"),Ko.addBlock("global","uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}"),Ko.replaceBlock("utils","#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n"),Ko.replaceBlock("setup","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n"),Ko.defines.TANGRAM_EPSILON=1e-5,Ko.defines.TANGRAM_LAYER_DELTA=1/16384,Ko.defines.TANGRAM_TILE_SCALE="vec3(".concat(Qr.tile_scale,"., ").concat(Qr.tile_scale,"., u_meters_per_pixel * ").concat(Qr.tile_size,".)"),Ko.defines.TANGRAM_HEIGHT_SCALE=Qr.height_scale,Ko.defines.TANGRAM_ALPHA_TEST=.1,Ku.dash_textures={}}},{key:"destroy",value:function(t){var e=this;Object.keys(this.styles).forEach((function(i){var r=e.styles[i];r.gl===t&&(En("trace","StyleManager.destroy: destroying render style ".concat(r.name)),r.base&&e.remove(r.name),r.destroy())}))}},{key:"register",value:function(t){this.styles[t.name]=t,this.base_styles[t.name]=t}},{key:"remove",value:function(t){delete this.styles[t]}},{key:"mix",value:function(t,e){if(t.mixed)return t;t.mixed={};var i=[];t.mix&&(Array.isArray(t.mix)?i.push.apply(i,Lr(t.mix)):i.push(t.mix),(i=i.map((function(t){return e[t]})).filter((function(e){return e&&e!==t}))).forEach((function(e){return t.mixed[e.name]=!0}))),i.push(t),t.animated=i.some((function(t){return t&&t.animated})),t.texcoords=i.some((function(t){return t&&t.texcoords})),t.base=i.map((function(t){return t.base})).filter((function(t){return t})).pop(),t.lighting=i.map((function(t){return t.lighting})).filter((function(t){return null!=t})).pop(),t.texture=i.map((function(t){return t.texture})).filter((function(t){return t})).pop(),t.raster=i.map((function(t){return t.raster})).filter((function(t){return null!=t})).pop(),t.dash=i.map((function(t){return t.dash})).filter((function(t){return null!=t})).pop(),t.dash_background_color=i.map((function(t){return t.dash_background_color})).filter((function(t){return null!=t})).pop(),i.some((function(t){return t.hasOwnProperty("blend")&&t.blend}))&&(t.blend=i.map((function(t){return t.hasOwnProperty("blend")&&t.blend})).filter((function(t){return t})).pop()),t.blend_order=i.map((function(t){return t.blend_order})).filter((function(t){return null!=t})).pop(),t.defines=Object.assign.apply(Object,[{}].concat(Lr(i.map((function(t){return t.defines})).filter((function(t){return t}))))),t.material=Object.assign.apply(Object,[{}].concat(Lr(i.map((function(t){return t.material})).filter((function(t){return t})))));var r=i.map((function(t){return t.draw})).filter((function(t){return t}));return 0<r.length&&(t.draw=sa.apply(void 0,[{}].concat(Lr(r)))),this.mixShaders(t,e,i),t}},{key:"mixShaders",value:function(t,e,i){var r={},n=i.map((function(t){return t.shaders})).filter((function(t){return t}));if(r.defines=Object.assign.apply(Object,[{}].concat(Lr(n.map((function(t){return t.defines})).filter((function(t){return t}))))),r.uniforms={},r._uniforms=t.shaders&&t.shaders.uniforms||{},r._uniform_scopes={},i.filter((function(t){return t.shaders&&t.shaders.uniforms})).forEach((function(t){for(var i in t.shaders.uniforms)!function(i){r._uniform_scopes[i]=t.name,Object.defineProperty(r.uniforms,i,{enumerable:!0,configurable:!0,get:function(){return void 0!==r._uniforms[i]?r._uniforms[i]:e[r._uniform_scopes[i]].shaders.uniforms!==r.uniforms?e[r._uniform_scopes[i]].shaders.uniforms[i]:void 0},set:function(t){r._uniforms[i]=t}})}(i)})),r.extensions=Object.keys(n.map((function(t){return t.extensions})).filter((function(t){return t})).reduce((function(t,e){return"string"==typeof e?t[e]=!0:e.forEach((function(e){return t[e]=!0})),t}),{})||{}),t.shaders&&t.shaders.blocks)for(var o in t.shaders.block_scopes=t.shaders.block_scopes||{},t.shaders.blocks){var a,s=t.shaders.blocks[o];t.shaders.block_scopes[o]=t.shaders.block_scopes[o]||[],Array.isArray(s)?(a=t.shaders.block_scopes[o]).push.apply(a,Lr(s.map((function(){return t.name})))):t.shaders.block_scopes[o].push(t.name)}var l={};return n.forEach((function(t){if(t.blocks){r.blocks=r.blocks||{},r.block_scopes=r.block_scopes||{};var e={};for(var i in t.blocks){var n=t.blocks[i],o=t.block_scopes[i];r.blocks[i]=r.blocks[i]||[],r.block_scopes[i]=r.block_scopes[i]||[],n=Array.isArray(n)?n:[n],o=Array.isArray(o)?o:[o];for(var a=0;a<n.length;a++)l[o[a]]||(e[o[a]]=!0,r.blocks[i].push(n[a]),r.block_scopes[i].push(o[a]))}Object.assign(l,e)}})),Object.assign(t.mixed,l),t.shaders=r,t}},{key:"create",value:function(t,e,i){var r=2<arguments.length&&void 0!==i?i:{},n=sa({},e);return n.name=t,(n=this.mix(n,r)).base&&this.base_styles[n.base]?this.styles[t]=n=Object.assign(Object.create(this.base_styles[n.base]),n):n.base=null,n}},{key:"build",value:function(t){var e=this,i=Object.keys(t).sort((function(i,r){return e.inheritanceDepth(i,t)-e.inheritanceDepth(r,t)}));for(var r in this.styles)this.base_styles[r]?this.styles[r].reset():delete this.styles[r];var n={};return i.forEach((function(i){n[i]=e.create(i,t[i],n)})),this.styles}},{key:"initStyles",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};for(var i in this.styles)this.styles[i].init(e)}},{key:"inheritanceDepth",value:function(t,e){for(var i=this,r=0;;){var n=e[t];if(!n)break;if(!n.mix)break;if(r++,Array.isArray(n.mix)){r+=Math.max.apply(Math,Lr(n.mix.map((function(r){if(t!==r)return i.inheritanceDepth(r,e)}))));break}if(t===n.mix)break;t=n.mix}return r}}]),t}();function Ih(t){return null==t}var Oh={isNothing:Ih,isObject:function(t){return"object"==typeof t&&null!==t},toArray:function(t){return Array.isArray(t)?t:Ih(t)?[]:[t]},repeat:function(t,e){for(var i="",r=0;r<e;r+=1)i+=t;return i},isNegativeZero:function(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function(t,e){var i,r,n,o;if(e)for(i=0,r=(o=Object.keys(e)).length;i<r;i+=1)t[n=o[i]]=e[n];return t}};function Lh(t,e){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}((Lh.prototype=Object.create(Error.prototype)).constructor=Lh).prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e};var Ch=Lh;function Rh(t,e,i,r,n){this.name=t,this.buffer=e,this.position=i,this.line=r,this.column=n}Rh.prototype.getSnippet=function(t,e){var i,r,n,o,a;if(!this.buffer)return null;for(t=t||4,e=e||75,i="",r=this.position;0<r&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(r-1));)if(--r,this.position-r>e/2-1){i=" ... ",r+=5;break}for(n="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>e/2-1){n=" ... ",o-=5;break}return a=this.buffer.slice(r,o),Oh.repeat(" ",t)+i+a+n+"\n"+Oh.repeat(" ",t+this.position-r+i.length)+"^"},Rh.prototype.toString=function(t){var e,i="";return this.name&&(i+='in "'+this.name+'" '),i+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(i+=":\n"+e),i};var Nh=Rh,Ph=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],jh=["scalar","sequence","mapping"],Dh=function(t,e){var i,r;if(e=e||{},Object.keys(e).forEach((function(e){if(-1===Ph.indexOf(e))throw new Ch('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')})),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=(i=e.styleAliases||null,r={},null!==i&&Object.keys(i).forEach((function(t){i[t].forEach((function(e){r[String(e)]=t}))})),r),-1===jh.indexOf(this.kind))throw new Ch('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function zh(t,e,i){var r=[];return t.include.forEach((function(t){i=zh(t,e,i)})),t[e].forEach((function(t){i.forEach((function(e,i){e.tag===t.tag&&r.push(i)})),i.push(t)})),i.filter((function(t,e){return-1===r.indexOf(e)}))}function Fh(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach((function(t){if(t.loadKind&&"scalar"!==t.loadKind)throw new Ch("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=zh(this,"implicit",[]),this.compiledExplicit=zh(this,"explicit",[]),this.compiledTypeMap=function(){var t,e,i={};function r(t){i[t.tag]=t}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(r);return i}(this.compiledImplicit,this.compiledExplicit)}Fh.DEFAULT=null,Fh.create=function(t,e){var i,r;switch(arguments.length){case 1:i=Fh.DEFAULT,r=t;break;case 2:i=t,r=e;break;default:throw new Ch("Wrong number of arguments for Schema.create function")}if(i=Oh.toArray(i),r=Oh.toArray(r),!i.every((function(t){return t instanceof Fh})))throw new Ch("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!r.every((function(t){return t instanceof Dh})))throw new Ch("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Fh({include:i,explicit:r})};var Gh=Fh,Hh=new Gh({explicit:[new Dh("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),new Dh("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),new Dh("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}})]}),Bh=new Dh("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(t){if(null===t)return!0;var e=t.length;return 1===e&&"~"===t||4===e&&("null"===t||"Null"===t||"NULL"===t)},construct:function(){return null},predicate:function(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"}),Uh=new Dh("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(t){if(null===t)return!1;var e=t.length;return 4===e&&("true"===t||"True"===t||"TRUE"===t)||5===e&&("false"===t||"False"===t||"FALSE"===t)},construct:function(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"}),Vh=new Dh("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(t){if(null===t)return!1;var e,i,r,n,o=t.length,a=0,s=!1;if(!o)return!1;if("-"!==(e=t[a])&&"+"!==e||(e=t[++a]),"0"===e){if(a+1===o)return!0;if("b"===(e=t[++a])){for(a++;a<o;a++)if("_"!==(e=t[a])){if("0"!==e&&"1"!==e)return!1;s=!0}return s}if("x"===e){for(a++;a<o;a++)if("_"!==(e=t[a])){if(!(48<=(r=t.charCodeAt(a))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(e=t[a])){if(!(48<=(i=t.charCodeAt(a))&&i<=55))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(e=t[a])){if(":"===e)break;if(!(48<=(n=t.charCodeAt(a))&&n<=57))return!1;s=!0}return!!s&&(":"!==e||/^(:[0-5]?[0-9])+$/.test(t.slice(a)))},construct:function(t){var e,i,r=t,n=1,o=[];return-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(e=r[0])&&"+"!==e||("-"===e&&(n=-1),e=(r=r.slice(1))[0]),"0"===r?0:"0"===e?"b"===r[1]?n*parseInt(r.slice(2),2):"x"===r[1]?n*parseInt(r,16):n*parseInt(r,8):-1!==r.indexOf(":")?(r.split(":").forEach((function(t){o.unshift(parseInt(t,10))})),r=0,i=1,o.forEach((function(t){r+=t*i,i*=60})),n*r):n*parseInt(r,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!Oh.isNegativeZero(t)},represent:{binary:function(t){return"0b"+t.toString(2)},octal:function(t){return"0"+t.toString(8)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return"0x"+t.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),qh=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),Yh=/^[-+]?[0-9]+e/,Wh=new Gh({include:[Hh],implicit:[Bh,Uh,Vh,new Dh("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(t){return null!==t&&!!qh.test(t)},construct:function(t){var e,i=t.replace(/_/g,"").toLowerCase(),r="-"===i[0]?-1:1,n=[];return 0<="+-".indexOf(i[0])&&(i=i.slice(1)),".inf"===i?1==r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===i?NaN:0<=i.indexOf(":")?(i.split(":").forEach((function(t){n.unshift(parseFloat(t,10))})),i=0,e=1,n.forEach((function(t){i+=t*e,e*=60})),r*i):r*parseFloat(i,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||Oh.isNegativeZero(t))},represent:function(t,e){var i;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Oh.isNegativeZero(t))return"-0.0";return i=t.toString(10),Yh.test(i)?i.replace("e",".e"):i},defaultStyle:"lowercase"})]}),Zh=new Gh({include:[Wh]}),Kh=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$"),Xh=new Dh("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(t){return null!==t&&null!==Kh.exec(t)},construct:function(t){var e,i,r,n,o,a,s,l=0,u=null,c=Kh.exec(t);if(null===c)throw new Error("Date resolve error");if(e=+c[1],i=c[2]-1,r=+c[3],!c[4])return new Date(Date.UTC(e,i,r));if(n=+c[4],o=+c[5],a=+c[6],c[7]){for(l=c[7].slice(0,3);l.length<3;)l+="0";l=+l}return c[9]&&(u=6e4*(60*+c[10]+ +(c[11]||0)),"-"===c[9]&&(u=-u)),s=new Date(Date.UTC(e,i,r,n,o,a,l)),u&&s.setTime(s.getTime()-u),s},instanceOf:Date,represent:function(t){return t.toISOString()}}),Jh=new Dh("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(t){return"<<"===t||null===t}}),Qh=Rs.Buffer,$h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",tp=new Dh("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(t){if(null===t)return!1;for(var e,i=0,r=t.length,n=$h,o=0;o<r;o++)if(!(64<(e=n.indexOf(t.charAt(o))))){if(e<0)return!1;i+=6}return i%8==0},construct:function(t){for(var e,i=t.replace(/[\r\n=]/g,""),r=i.length,n=$h,o=0,a=[],s=0;s<r;s++)s%4==0&&s&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|n.indexOf(i.charAt(s));return 0==(e=r%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18==e?(a.push(o>>10&255),a.push(o>>2&255)):12==e&&a.push(o>>4&255),Qh?new Qh(a):a},predicate:function(t){return Qh&&Qh.isBuffer(t)},represent:function(t){for(var e,i="",r=0,n=t.length,o=$h,a=0;a<n;a++)a%3==0&&a&&(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]),r=(r<<8)+t[a];return 0==(e=n%3)?(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]):2==e?(i+=o[r>>10&63],i+=o[r>>4&63],i+=o[r<<2&63],i+=o[64]):1==e&&(i+=o[r>>2&63],i+=o[r<<4&63],i+=o[64],i+=o[64]),i}}),ep=Object.prototype.hasOwnProperty,ip=Object.prototype.toString,rp=new Dh("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(t){if(null===t)return!0;for(var e,i,r,n=[],o=t,a=0,s=o.length;a<s;a+=1){if(e=o[a],r=!1,"[object Object]"!==ip.call(e))return!1;for(i in e)if(ep.call(e,i)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==n.indexOf(i))return!1;n.push(i)}return!0},construct:function(t){return null!==t?t:[]}}),np=Object.prototype.toString,op=new Dh("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(t){if(null===t)return!0;for(var e,i,r=t,n=new Array(r.length),o=0,a=r.length;o<a;o+=1){if(e=r[o],"[object Object]"!==np.call(e))return!1;if(1!==(i=Object.keys(e)).length)return!1;n[o]=[i[0],e[i[0]]]}return!0},construct:function(t){if(null===t)return[];for(var e,i,r=t,n=new Array(r.length),o=0,a=r.length;o<a;o+=1)e=r[o],i=Object.keys(e),n[o]=[i[0],e[i[0]]];return n}}),ap=Object.prototype.hasOwnProperty,sp=new Gh({include:[Zh],implicit:[Xh,Jh],explicit:[tp,rp,op,new Dh("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(t){if(null===t)return!0;var e,i=t;for(e in i)if(ap.call(i,e)&&null!==i[e])return!1;return!0},construct:function(t){return null!==t?t:{}}})]}),lp=new Dh("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(t){return void 0===t},represent:function(){return""}}),up=new Dh("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(t){if(null===t)return!1;if(0===t.length)return!1;var e=t,i=/\/([gim]*)$/.exec(t),r="";if("/"===e[0]){if(i&&(r=i[1]),3<r.length)return!1;if("/"!==e[e.length-r.length-1])return!1}return!0},construct:function(t){var e=t,i=/\/([gim]*)$/.exec(t),r="";return"/"===e[0]&&(i&&(r=i[1]),e=e.slice(1,e.length-r.length-1)),new RegExp(e,r)},predicate:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},represent:function(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}});try{var cp=function(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}()}catch(o){"undefined"!=typeof window&&(cp=window.esprima)}var hp=new Dh("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(t){if(null===t)return!1;try{var e="("+t+")",i=cp.parse(e,{range:!0});return"Program"===i.type&&1===i.body.length&&"ExpressionStatement"===i.body[0].type&&"FunctionExpression"===i.body[0].expression.type}catch(t){return!1}},construct:function(t){var e,i="("+t+")",r=cp.parse(i,{range:!0}),n=[];if("Program"!==r.type||1!==r.body.length||"ExpressionStatement"!==r.body[0].type||"FunctionExpression"!==r.body[0].expression.type)throw new Error("Failed to resolve function");return r.body[0].expression.params.forEach((function(t){n.push(t.name)})),e=r.body[0].expression.body.range,new Function(n,i.slice(e[0]+1,e[1]-1))},predicate:function(t){return"[object Function]"===Object.prototype.toString.call(t)},represent:function(t){return t.toString()}}),pp=Gh.DEFAULT=new Gh({include:[sp],explicit:[lp,up,hp]}),fp=Object.prototype.hasOwnProperty,dp=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,yp=/[\x85\u2028\u2029]/,gp=/[,\[\]\{\}]/,vp=/^(?:!|!!|![a-z\-]+!)$/i,mp=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _p(t){return 10===t||13===t}function bp(t){return 9===t||32===t}function wp(t){return 9===t||32===t||10===t||13===t}function xp(t){return 44===t||91===t||93===t||123===t||125===t}function Ep(t){return 48===t?"\0":97===t?"":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"":95===t?" ":76===t?"\u2028":80===t?"\u2029":""}for(var Ap=new Array(256),Tp=new Array(256),kp=0;kp<256;kp++)Ap[kp]=Ep(kp)?1:0,Tp[kp]=Ep(kp);function Sp(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||pp,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function Mp(t,e){return new Ch(e,new Nh(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function Ip(t,e){throw Mp(t,e)}function Op(t,e){t.onWarning&&t.onWarning.call(null,Mp(t,e))}var Lp={YAML:function(t,e,i){var r,n,o;null!==t.version&&Ip(t,"duplication of %YAML directive"),1!==i.length&&Ip(t,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&Ip(t,"ill-formed argument of the YAML directive"),n=parseInt(r[1],10),o=parseInt(r[2],10),1!==n&&Ip(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&Op(t,"unsupported YAML version of the document")},TAG:function(t,e,i){var r,n;2!==i.length&&Ip(t,"TAG directive accepts exactly two arguments"),r=i[0],n=i[1],vp.test(r)||Ip(t,"ill-formed tag handle (first argument) of the TAG directive"),fp.call(t.tagMap,r)&&Ip(t,'there is a previously declared suffix for "'+r+'" tag handle'),mp.test(n)||Ip(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[r]=n}};function Cp(t,e,i,r){var n,o,a,s;if(e<i){if(s=t.input.slice(e,i),r)for(n=0,o=s.length;n<o;n+=1)9===(a=s.charCodeAt(n))||32<=a&&a<=1114111||Ip(t,"expected valid JSON character");else dp.test(s)&&Ip(t,"the stream contains non-printable characters");t.result+=s}}function Rp(t,e,i,r){var n,o,a,s;for(Oh.isObject(i)||Ip(t,"cannot merge mappings; the provided source object is unacceptable"),a=0,s=(n=Object.keys(i)).length;a<s;a+=1)o=n[a],fp.call(e,o)||(e[o]=i[o],r[o]=!0)}function Np(t,e,i,r,n,o){var a,s;if(n=String(n),null===e&&(e={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(a=0,s=o.length;a<s;a+=1)Rp(t,e,o[a],i);else Rp(t,e,o,i);else t.json||fp.call(i,n)||!fp.call(e,n)||Ip(t,"duplicated mapping key"),e[n]=o,delete i[n];return e}function Pp(t){var e=t.input.charCodeAt(t.position);10===e?t.position++:13===e?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):Ip(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function jp(t,e,i){for(var r=0,n=t.input.charCodeAt(t.position);0!==n;){for(;bp(n);)n=t.input.charCodeAt(++t.position);if(e&&35===n)for(;10!==(n=t.input.charCodeAt(++t.position))&&13!==n&&0!==n;);if(!_p(n))break;for(Pp(t),n=t.input.charCodeAt(t.position),r++,t.lineIndent=0;32===n;)t.lineIndent++,n=t.input.charCodeAt(++t.position)}return-1!==i&&0!==r&&t.lineIndent<i&&Op(t,"deficient indentation"),r}function Dp(t){var e=t.position,i=t.input.charCodeAt(e);return 45!==i&&46!==i||i!==t.input.charCodeAt(e+1)||i!==t.input.charCodeAt(e+2)||(e+=3,0!==(i=t.input.charCodeAt(e))&&!wp(i))?void 0:1}function zp(t,e){1===e?t.result+=" ":1<e&&(t.result+=Oh.repeat("\n",e-1))}function Fp(t,e){var i,r,n=t.tag,o=t.anchor,a=[],s=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),r=t.input.charCodeAt(t.position);0!==r&&45===r&&wp(t.input.charCodeAt(t.position+1));)if(s=!0,t.position++,jp(t,!0,-1)&&t.lineIndent<=e)a.push(null),r=t.input.charCodeAt(t.position);else if(i=t.line,Gp(t,e,3,!1,!0),a.push(t.result),jp(t,!0,-1),r=t.input.charCodeAt(t.position),(t.line===i||t.lineIndent>e)&&0!==r)Ip(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!s&&(t.tag=n,t.anchor=o,t.kind="sequence",t.result=a,!0)}function Gp(t,e,i,r,n){var o,a,s,l,u,c,h,p,f=1,d=!1,y=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=a=s=4===i||3===i,r&&jp(t,!0,-1)&&(d=!0,t.lineIndent>e?f=1:t.lineIndent===e?f=0:t.lineIndent<e&&(f=-1)),1===f)for(;function(t){var e,i,r,n=!1,o=!1,a=t.input.charCodeAt(t.position);if(33===a){if(null!==t.tag&&Ip(t,"duplication of a tag property"),60===(a=t.input.charCodeAt(++t.position))?(n=!0,a=t.input.charCodeAt(++t.position)):33===a?(o=!0,i="!!",a=t.input.charCodeAt(++t.position)):i="!",e=t.position,n){for(;0!==(a=t.input.charCodeAt(++t.position))&&62!==a;);t.position<t.length?(r=t.input.slice(e,t.position),a=t.input.charCodeAt(++t.position)):Ip(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!wp(a);)33===a&&(o?Ip(t,"tag suffix cannot contain exclamation marks"):(i=t.input.slice(e-1,t.position+1),vp.test(i)||Ip(t,"named tag handle cannot contain such characters"),o=!0,e=t.position+1)),a=t.input.charCodeAt(++t.position);r=t.input.slice(e,t.position),gp.test(r)&&Ip(t,"tag suffix cannot contain flow indicator characters")}return r&&!mp.test(r)&&Ip(t,"tag name cannot contain such characters: "+r),n?t.tag=r:fp.call(t.tagMap,i)?t.tag=t.tagMap[i]+r:"!"===i?t.tag="!"+r:"!!"===i?t.tag="tag:yaml.org,2002:"+r:Ip(t,'undeclared tag handle "'+i+'"'),1}}(t)||function(t){var e,i=t.input.charCodeAt(t.position);if(38===i){for(null!==t.anchor&&Ip(t,"duplication of an anchor property"),i=t.input.charCodeAt(++t.position),e=t.position;0!==i&&!wp(i)&&!xp(i);)i=t.input.charCodeAt(++t.position);return t.position===e&&Ip(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),1}}(t);)jp(t,!0,-1)?(d=!0,s=o,t.lineIndent>e?f=1:t.lineIndent===e?f=0:t.lineIndent<e&&(f=-1)):s=!1;if(s=s&&(d||n),1!==f&&4!==i||(h=1===i||2===i?e:e+1,p=t.position-t.lineStart,1===f?s&&(Fp(t,p)||function(t,e,i){var r,n,o,a,s=t.tag,l=t.anchor,u={},c={},h=null,p=null,f=null,d=!1,y=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=u),a=t.input.charCodeAt(t.position);0!==a;){if(r=t.input.charCodeAt(t.position+1),o=t.line,63!==a&&58!==a||!wp(r)){if(!Gp(t,i,2,!1,!0))break;if(t.line===o){for(a=t.input.charCodeAt(t.position);bp(a);)a=t.input.charCodeAt(++t.position);if(58===a)wp(a=t.input.charCodeAt(++t.position))||Ip(t,"a whitespace character is expected after the key-value separator within a block mapping"),d&&(Np(t,u,c,h,p,null),h=p=f=null),n=d=!(y=!0),h=t.tag,p=t.result;else{if(!y)return t.tag=s,t.anchor=l,1;Ip(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return t.tag=s,t.anchor=l,1;Ip(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===a?(d&&(Np(t,u,c,h,p,null),h=p=f=null),n=d=y=!0):d?n=!(d=!1):Ip(t,"incomplete explicit mapping pair; a key node is missed"),t.position+=1,a=r;if((t.line===o||t.lineIndent>e)&&(Gp(t,e,4,!0,n)&&(d?p=t.result:f=t.result),d||(Np(t,u,c,h,p,f),h=p=f=null),jp(t,!0,-1),a=t.input.charCodeAt(t.position)),t.lineIndent>e&&0!==a)Ip(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return d&&Np(t,u,c,h,p,null),y&&(t.tag=s,t.anchor=l,t.kind="mapping",t.result=u),y}(t,p,h))||function(t,e){var i,r,n,o,a,s,l,u,c,h=!0,p=t.tag,f=t.anchor,d={},y=t.input.charCodeAt(t.position);if(91===y)s=!(n=93),r=[];else{if(123!==y)return;n=125,s=!0,r={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=r),y=t.input.charCodeAt(++t.position);0!==y;){if(jp(t,!0,e),(y=t.input.charCodeAt(t.position))===n)return t.position++,t.tag=p,t.anchor=f,t.kind=s?"mapping":"sequence",t.result=r,1;h||Ip(t,"missed comma between flow collection entries"),c=null,o=a=!1,63===y&&wp(t.input.charCodeAt(t.position+1))&&(o=a=!0,t.position++,jp(t,!0,e)),i=t.line,Gp(t,e,1,!1,!0),u=t.tag,l=t.result,jp(t,!0,e),y=t.input.charCodeAt(t.position),!a&&t.line!==i||58!==y||(o=!0,y=t.input.charCodeAt(++t.position),jp(t,!0,e),Gp(t,e,1,!1,!0),c=t.result),s?Np(t,r,d,u,l,c):o?r.push(Np(t,null,d,u,l,c)):r.push(l),jp(t,!0,e),44===(y=t.input.charCodeAt(t.position))?(h=!0,y=t.input.charCodeAt(++t.position)):h=!1}Ip(t,"unexpected end of the stream within a flow collection")}(t,h)?y=!0:(a&&function(t,e){var i,r,n,o,a=1,s=!1,l=e,u=0,c=!1,h=t.input.charCodeAt(t.position);if(124===h)r=!1;else{if(62!==h)return;r=!0}for(t.kind="scalar",t.result="";0!==h;)if(43===(h=t.input.charCodeAt(++t.position))||45===h)1===a?a=43===h?3:2:Ip(t,"repeat of a chomping mode identifier");else{if(!(0<=(n=48<=(o=h)&&o<=57?o-48:-1)))break;0==n?Ip(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Ip(t,"repeat of an indentation width identifier"):(l=e+n-1,s=!0)}if(bp(h)){for(;bp(h=t.input.charCodeAt(++t.position)););if(35===h)for(;!_p(h=t.input.charCodeAt(++t.position))&&0!==h;);}for(;0!==h;){for(Pp(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<l)&&32===h;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>l&&(l=t.lineIndent),_p(h))u++;else{if(t.lineIndent<l){3===a?t.result+=Oh.repeat("\n",u):1===a&&s&&(t.result+="\n");break}for(r?bp(h)?(c=!0,t.result+=Oh.repeat("\n",u+1)):c?(c=!1,t.result+=Oh.repeat("\n",u+1)):0===u?s&&(t.result+=" "):t.result+=Oh.repeat("\n",u):t.result+=s?Oh.repeat("\n",u+1):Oh.repeat("\n",u),s=!0,u=0,i=t.position;!_p(h)&&0!==h;)h=t.input.charCodeAt(++t.position);Cp(t,i,t.position,!1)}}return 1}(t,h)||function(t,e){var i,r,n=t.input.charCodeAt(t.position);if(39===n){for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(n=t.input.charCodeAt(t.position));)if(39===n){if(Cp(t,i,t.position,!0),39!==(n=t.input.charCodeAt(++t.position)))return 1;i=r=t.position,t.position++}else _p(n)?(Cp(t,i,r,!0),zp(t,jp(t,!1,e)),i=r=t.position):t.position===t.lineStart&&Dp(t)?Ip(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);Ip(t,"unexpected end of the stream within a single quoted scalar")}}(t,h)||function(t,e){var i,r,n,o,a,s,l,u,c,h=t.input.charCodeAt(t.position);if(34===h){for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(h=t.input.charCodeAt(t.position));){if(34===h)return Cp(t,i,t.position,!0),t.position++,1;if(92===h){if(Cp(t,i,t.position,!0),_p(h=t.input.charCodeAt(++t.position)))jp(t,!1,e);else if(h<256&&Ap[h])t.result+=Tp[h],t.position++;else if(0<(a=120===(c=h)?2:117===c?4:85===c?8:0)){for(n=a,o=0;0<n;n--)u=void 0,0<=(a=48<=(l=h=t.input.charCodeAt(++t.position))&&l<=57?l-48:97<=(u=32|l)&&u<=102?u-97+10:-1)?o=(o<<4)+a:Ip(t,"expected hexadecimal character");t.result+=(s=o)<=65535?String.fromCharCode(s):String.fromCharCode(55296+(s-65536>>10),56320+(s-65536&1023)),t.position++}else Ip(t,"unknown escape sequence");i=r=t.position}else _p(h)?(Cp(t,i,r,!0),zp(t,jp(t,!1,e)),i=r=t.position):t.position===t.lineStart&&Dp(t)?Ip(t,"unexpected end of the document within a double quoted scalar"):(t.position++,r=t.position)}Ip(t,"unexpected end of the stream within a double quoted scalar")}}(t,h)?y=!0:function(t){var e,i,r=t.input.charCodeAt(t.position);if(42===r){for(r=t.input.charCodeAt(++t.position),e=t.position;0!==r&&!wp(r)&&!xp(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Ip(t,"name of an alias node must contain at least one character"),i=t.input.slice(e,t.position),t.anchorMap.hasOwnProperty(i)||Ip(t,'unidentified alias "'+i+'"'),t.result=t.anchorMap[i],jp(t,!0,-1),1}}(t)?(y=!0,null===t.tag&&null===t.anchor||Ip(t,"alias node should not have any properties")):function(t,e,i){var r,n,o,a,s,l,u,c=t.kind,h=t.result,p=t.input.charCodeAt(t.position);if(!wp(p)&&!xp(p)&&35!==p&&38!==p&&42!==p&&33!==p&&124!==p&&62!==p&&39!==p&&34!==p&&37!==p&&64!==p&&96!==p&&(63!==p&&45!==p||!(wp(r=t.input.charCodeAt(t.position+1))||i&&xp(r)))){for(t.kind="scalar",t.result="",n=o=t.position,a=!1;0!==p;){if(58===p){if(wp(r=t.input.charCodeAt(t.position+1))||i&&xp(r))break}else if(35===p){if(wp(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Dp(t)||i&&xp(p))break;if(_p(p)){if(s=t.line,l=t.lineStart,u=t.lineIndent,jp(t,!1,-1),t.lineIndent>=e){a=!0,p=t.input.charCodeAt(t.position);continue}t.position=o,t.line=s,t.lineStart=l,t.lineIndent=u;break}}a&&(Cp(t,n,o,!1),zp(t,t.line-s),n=o=t.position,a=!1),bp(p)||(o=t.position+1),p=t.input.charCodeAt(++t.position)}if(Cp(t,n,o,!1),t.result)return 1;t.kind=c,t.result=h}}(t,h,1===i)&&(y=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===f&&(y=s&&Fp(t,p))),null!==t.tag&&"!"!==t.tag)if("?"===t.tag){for(l=0,u=t.implicitTypes.length;l<u;l+=1)if((c=t.implicitTypes[l]).resolve(t.result)){t.result=c.construct(t.result),t.tag=c.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else fp.call(t.typeMap,t.tag)?(c=t.typeMap[t.tag],null!==t.result&&c.kind!==t.kind&&Ip(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+c.kind+'", not "'+t.kind+'"'),c.resolve(t.result)?(t.result=c.construct(t.result),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):Ip(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):Ip(t,"unknown tag !<"+t.tag+">");return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||y}function Hp(t,e){e=e||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var i=new Sp(t,e);for(i.input+="\0";32===i.input.charCodeAt(i.position);)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)!function(t){var e,i,r,n,o=t.position,a=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};0!==(n=t.input.charCodeAt(t.position))&&(jp(t,!0,-1),n=t.input.charCodeAt(t.position),!(0<t.lineIndent||37!==n));){for(a=!0,n=t.input.charCodeAt(++t.position),e=t.position;0!==n&&!wp(n);)n=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&Ip(t,"directive name must not be less than one character in length");0!==n;){for(;bp(n);)n=t.input.charCodeAt(++t.position);if(35===n){for(;0!==(n=t.input.charCodeAt(++t.position))&&!_p(n););break}if(_p(n))break;for(e=t.position;0!==n&&!wp(n);)n=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==n&&Pp(t),fp.call(Lp,i)?Lp[i](t,i,r):Op(t,'unknown document directive "'+i+'"')}jp(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,jp(t,!0,-1)):a&&Ip(t,"directives end mark is expected"),Gp(t,t.lineIndent-1,4,!1,!0),jp(t,!0,-1),t.checkLineBreaks&&yp.test(t.input.slice(o,t.position))&&Op(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Dp(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,jp(t,!0,-1)):t.position<t.length-1&&Ip(t,"end of the stream or a document separator is expected")}(i);return i.documents}function Bp(t,e,i){for(var r=Hp(t,i),n=0,o=r.length;n<o;n+=1)e(r[n])}function Up(t,e){var i=Hp(t,e);if(0!==i.length){if(1===i.length)return i[0];throw new Ch("expected a single document in the stream, but found more")}}var Vp={loadAll:Bp,load:Up,safeLoadAll:function(t,e,i){Bp(t,e,Oh.extend({schema:sp},i))},safeLoad:function(t,e){return Up(t,Oh.extend({schema:sp},e))}},qp=Object.prototype.toString,Yp=Object.prototype.hasOwnProperty,Wp=10,Zp={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Kp=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function Xp(t){this.schema=t.schema||pp,this.indent=Math.max(1,t.indent||2),this.skipInvalid=t.skipInvalid||!1,this.flowLevel=Oh.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function(t,e){var i,r,n,o,a,s,l;if(null===e)return{};for(i={},n=0,o=(r=Object.keys(e)).length;n<o;n+=1)a=r[n],s=String(e[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(l=t.compiledTypeMap[a])&&Yp.call(l.styleAliases,s)&&(s=l.styleAliases[s]),i[a]=s;return i}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Jp(t,e){for(var i,r=Oh.repeat(" ",e),n=0,o=-1,a="",s=t.length;n<s;)n=-1===(o=t.indexOf("\n",n))?(i=t.slice(n),s):(i=t.slice(n,o+1),o+1),i.length&&"\n"!==i&&(a+=r),a+=i;return a}function Qp(t,e){return"\n"+Oh.repeat(" ",t.indent*e)}function $p(t){this.source=t,this.result="",this.checkpoint=0}function tf(t,e){if(""===t)return t;for(var i,r,n=/[^\s] [^\s]/g,o="",a=0,s=0,l=n.exec(t);l;)e<(i=l.index)-s&&(r=a!==s?a:i,o&&(o+="\n"),o+=t.slice(s,r),s=r+1),a=i+1,l=n.exec(t);return o&&(o+="\n"),s!==a&&t.length-s>e?o+=t.slice(s,a)+"\n"+t.slice(a+1):o+=t.slice(s),o}function ef(t){return!(32<=t&&t<=126||133===t||160<=t&&t<=55295||57344<=t&&t<=65533||65536<=t&&t<=1114111)}function rf(t,e,i){for(var r,n,o,a=i?t.explicitTypes:t.implicitTypes,s=0,l=a.length;s<l;s+=1)if(((n=a[s]).instanceOf||n.predicate)&&(!n.instanceOf||"object"==typeof e&&e instanceof n.instanceOf)&&(!n.predicate||n.predicate(e))){if(t.tag=i?n.tag:"?",n.represent){if(o=t.styleMap[n.tag]||n.defaultStyle,"[object Function]"===qp.call(n.represent))r=n.represent(e,o);else{if(!Yp.call(n.represent,o))throw new Ch("!<"+n.tag+'> tag resolver accepts not "'+o+'" style');r=n.represent[o](e,o)}t.dump=r}return 1}}function nf(t,e,i,r,n,o){t.tag=null,t.dump=i,rf(t,i,!1)||rf(t,i,!0);var a=qp.call(t.dump);r=r&&(t.flowLevel<0||t.flowLevel>e);var s,l,u="[object Object]"===a||"[object Array]"===a;if(u&&(l=-1!==(s=t.duplicates.indexOf(i))),(null!==t.tag&&"?"!==t.tag||l||2!==t.indent&&0<e)&&(n=!1),l&&t.usedDuplicates[s])t.dump="*ref_"+s;else{if(u&&l&&!t.usedDuplicates[s]&&(t.usedDuplicates[s]=!0),"[object Object]"===a)r&&0!==Object.keys(t.dump).length?(function(t,e,i,r){var n,o,a,s,l,u,c="",h=t.tag,p=Object.keys(i);if(!0===t.sortKeys)p.sort();else if("function"==typeof t.sortKeys)p.sort(t.sortKeys);else if(t.sortKeys)throw new Ch("sortKeys must be a boolean or a function");for(n=0,o=p.length;n<o;n+=1)u="",r&&0===n||(u+=Qp(t,e)),s=i[a=p[n]],nf(t,e+1,a,!0,!0,!0)&&((l=null!==t.tag&&"?"!==t.tag||t.dump&&1024<t.dump.length)&&(t.dump&&Wp===t.dump.charCodeAt(0)?u+="?":u+="? "),u+=t.dump,l&&(u+=Qp(t,e)),nf(t,e+1,s,!0,l)&&(t.dump&&Wp===t.dump.charCodeAt(0)?u+=":":u+=": ",c+=u+=t.dump));t.tag=h,t.dump=c||"{}"}(t,e,t.dump,n),l&&(t.dump="&ref_"+s+t.dump)):(function(t,e,i){for(var r,n,o,a="",s=t.tag,l=Object.keys(i),u=0,c=l.length;u<c;u+=1)o="",0!==u&&(o+=", "),n=i[r=l[u]],nf(t,e,r,!1,!1)&&(1024<t.dump.length&&(o+="? "),o+=t.dump+": ",nf(t,e,n,!1,!1)&&(a+=o+=t.dump));t.tag=s,t.dump="{"+a+"}"}(t,e,t.dump),l&&(t.dump="&ref_"+s+" "+t.dump));else if("[object Array]"===a)r&&0!==t.dump.length?(function(t,e,i,r){for(var n="",o=t.tag,a=0,s=i.length;a<s;a+=1)nf(t,e+1,i[a],!0,!0)&&(r&&0===a||(n+=Qp(t,e)),n+="- "+t.dump);t.tag=o,t.dump=n||"[]"}(t,e,t.dump,n),l&&(t.dump="&ref_"+s+t.dump)):(function(t,e,i){for(var r="",n=t.tag,o=0,a=i.length;o<a;o+=1)nf(t,e,i[o],!1,!1)&&(0!==o&&(r+=", "),r+=t.dump);t.tag=n,t.dump="["+r+"]"}(t,e,t.dump),l&&(t.dump="&ref_"+s+" "+t.dump));else{if("[object String]"!==a){if(t.skipInvalid)return;throw new Ch("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&function(t,e,i,r){var n,o,a,s,l,u,c,h,p,f,d,y,g,v,m,_,b,w,x,E,A;if(0!==e.length)if(-1===Kp.indexOf(e)){for(n=!0,45!==(o=e.length?e.charCodeAt(0):0)&&63!==o&&64!==o&&96!==o||(n=!1),l=s=(a=32===o||32===e.charCodeAt(e.length-1))||-1<t.flowLevel&&t.flowLevel<=i?(a&&(n=!1),!1):!r,u=!0,c=new $p(e),h=!1,f=p=0,d=t.indent*i,-1===(y=t.lineWidth)&&(y=9007199254740991),d<40?y-=d:y=40,v=0;v<e.length;v++){if(g=e.charCodeAt(v),n){if(9!==(A=g)&&Wp!==A&&13!==A&&44!==A&&91!==A&&93!==A&&123!==A&&125!==A&&35!==A&&38!==A&&42!==A&&33!==A&&124!==A&&62!==A&&39!==A&&34!==A&&37!==A&&58!==A&&!Zp[A]&&!ef(A))continue;n=!1}u&&39===g&&(u=!1),m=Zp[g],_=ef(g),(m||_)&&(g!==Wp&&34!==g&&39!==g?l=s=!1:g===Wp&&(u=!(h=!0),0<v&&32===e.charCodeAt(v-1)&&(s=l=!1),s&&(b=v-p,p=v,f<b&&(f=b))),34!==g&&(u=!1),c.takeUpTo(v),c.escapeChar())}if(n&&function(t,e){for(var i=0,r=t.implicitTypes.length;i<r;i+=1)if(t.implicitTypes[i].resolve(e))return 1}(t,e)&&(n=!1),w="",(s||l)&&(x=0,e.charCodeAt(e.length-1)===Wp&&(x+=1,e.charCodeAt(e.length-2)===Wp&&(x+=1)),0===x?w="-":2===x&&(w="+")),(l&&f<y||null!==t.tag)&&(s=!1),h||(l=!1),n)t.dump=e;else if(u)t.dump="'"+e+"'";else if(s)E=function(t,e){var i,r="",n=0,o=t.length,a=/\n+$/.exec(t);for(a&&(o=a.index+1);n<o;)n=o<(i=t.indexOf("\n",n))||-1===i?(r&&(r+="\n\n"),r+=tf(t.slice(n,o),e),o):(r&&(r+="\n\n"),r+=tf(t.slice(n,i),e),i+1);return a&&"\n"!==a[0]&&(r+=a[0]),r}(e,y),t.dump=">"+w+"\n"+Jp(E,d);else if(l)w||(e=e.replace(/\n$/,"")),t.dump="|"+w+"\n"+Jp(e,d);else{if(!c)throw new Error("Failed to dump scalar value");c.finish(),t.dump='"'+c.result+'"'}}else t.dump="'"+e+"'";else t.dump="''"}(t,t.dump,e,o)}null!==t.tag&&"?"!==t.tag&&(t.dump="!<"+t.tag+"> "+t.dump)}return 1}function of(t,e){var i=new Xp(e=e||{});return i.noRefs||function(t,e){var i,r,n=[],o=[];for(function t(e,i,r){var n,o,a;if(null!==e&&"object"==typeof e)if(-1!==(o=i.indexOf(e)))-1===r.indexOf(o)&&r.push(o);else if(i.push(e),Array.isArray(e))for(o=0,a=e.length;o<a;o+=1)t(e[o],i,r);else for(o=0,a=(n=Object.keys(e)).length;o<a;o+=1)t(e[n[o]],i,r)}(t,n,o),i=0,r=o.length;i<r;i+=1)e.duplicates.push(n[o[i]]);e.usedDuplicates=new Array(r)}(t,i),nf(i,0,t,!0,!0)?i.dump+"\n":""}$p.prototype.takeUpTo=function(t){var e;if(t<this.checkpoint)throw(e=new Error("position should be > checkpoint")).position=t,e.checkpoint=this.checkpoint,e;return this.result+=this.source.slice(this.checkpoint,t),this.checkpoint=t,this},$p.prototype.escapeChar=function(){var t=this.source.charCodeAt(this.checkpoint),e=Zp[t]||function(t){var e,i,r=t.toString(16).toUpperCase();if(t<=255)e="x",i=2;else if(t<=65535)e="u",i=4;else{if(!(t<=4294967295))throw new Ch("code point within a string may not be greater than 0xFFFFFFFF");e="U",i=8}return"\\"+e+Oh.repeat("0",i-r.length)+r}(t);return this.result+=e,this.checkpoint+=1,this},$p.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var af={dump:of,safeDump:function(t,e){return of(t,Oh.extend({schema:sp},e))}};function sf(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}var lf={Type:Dh,Schema:Gh,FAILSAFE_SCHEMA:Hh,JSON_SCHEMA:Wh,CORE_SCHEMA:Zh,DEFAULT_SAFE_SCHEMA:sp,DEFAULT_FULL_SCHEMA:pp,load:Vp.load,loadAll:Vp.loadAll,safeLoad:Vp.safeLoad,safeLoadAll:Vp.safeLoadAll,dump:af.dump,safeDump:af.safeDump,YAMLException:Ch,MINIMAL_SCHEMA:Hh,SAFE_SCHEMA:sp,DEFAULT_SCHEMA:pp,scan:sf("scan"),parse:sf("parse"),compose:sf("compose"),addConstructor:sf("addConstructor")},uf=function(){function t(e,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;vr(this,t),this.url=e,!i||Ln(i)&&!Ln(this.url)?this.path=On(this.url):this.path=i,this.path_for_parent=i||this.path,this.parent=r,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return _r(t,[{key:"load",value:function(){return t=this.url,new Promise((function(e,i){"string"==typeof t?Tn.io(t).then((function(t){try{var r=function(t){var e;try{e=lf.safeLoad(t,{json:!0})}catch(t){throw t}return e}(t);e(r)}catch(t){i(t)}}),i):(t=Object.assign({},t),e(t))}));var t}},{key:"resourceFor",value:function(t){return{url:this.urlFor(t),path:this.pathFor(t),type:this.typeFor(t)}}},{key:"urlFor",value:function(t){return cf(t)?t:Ln(t)&&this.container?this.parent.urlFor(this.path_for_parent+t):function(t,e){if(!t||!Ln(t))return t;var i,r="/"!==t[0];return e?(i=document.createElement("a")).href=e:i=window.location,r?On(i.href)+t:(i.origin||i.protocol+"//"+i.host)+t}(t,this.path)}},{key:"pathFor",value:On},{key:"typeFor",value:function(t){var e=(t=t.split("/").pop()).lastIndexOf(".");if(-1<e)return t.substring(e+1)}},{key:"isContainer",value:function(){return!1}}]),t}();function cf(t){return!(!t||"global."!==t.slice(0,7))}function hf(t){return null!=t}function pf(t){return"("+t+")"}function ff(t){return"$"===t[0]?"context['"+t.substring(1)+"']":"context.feature.properties['"+t+"']"}function df(t,e){return pf(("string"==typeof(i=e)?'"'+i+'"':i)+" === "+ff(t));var i}function yf(t,e){return pf(t.filter(hf).map((function(t){return pf(t.join(" && "))})).join(" "+e+" "))}function gf(t,e,i){return e&&0<e.length?yf(e.map((function(t){return vf(t,i)})),"||"):"true"}function vf(t,e){var i=[];if("function"==typeof t)return[pf(t.toString()+"(context)")];if(Array.isArray(t))return[gf(0,t,e)];if(null==t)return["true"];for(var r,n,o,a,s,l,u,c,h=Object.keys(t),p=0;p<h.length;p++){var f=h[p],d=t[f],y=gr(d);if("string"===y||"number"===y)i.push(df(f,d));else if("boolean"===y)i.push((c=d,pf(ff(f)+(c?" != ":" == ")+"null")));else if("not"===f)i.push("!"+pf(vf(d,e).join(" && ")));else if("any"===f)i.push(gf(0,d,e));else if("all"===f)i.push(function(t,e){return t&&0<t.length?yf(t.map((function(t){return vf(t,e)})),"&&"):"true"}(d,e));else if("none"===f)i.push("!"+pf(gf(0,d,e)));else if(Array.isArray(d))i.push(function(t,e){return pf(e.map((function(e){return df(t,e)})).join(" || "))}(f,d));else if("object"===y&&null!=d)(d.max||d.min)&&i.push((r=f,n=d,u=l=s=a=void 0,l=[],u=(o=e)&&"function"==typeof o.rangeTransform&&o.rangeTransform,n.max&&(a=u?u(n.max):n.max,l.push(ff(r)+" < "+a)),n.min&&(s=u?s=u(n.min):n.min,l.push(ff(r)+" >= "+s)),pf(l.join(" && "))));else{if(null!=d)throw new Error("Unknown Query syntax: "+d);i.push(" true ")}}return 0===h.length?["true"]:i}function mf(t,e){return null==t?function(){return!0}:new Function("context","return "+pf(vf(t,e).join(" && "))+";")}var _f=["filter","draw","visible","enabled","data"],bf={},wf=["any","all","not","none"],xf=function(){function t(e){var i,r=e.layer,n=e.name,o=e.parent,a=e.draw,s=e.visible,l=e.enabled,u=e.filter,c=e.styles;if(vr(this,t),this.id=t.id++,this.config_data=r.data,this.parent=o,this.name=n,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=a,this.filter=u,this.styles=c,this.is_built=!1,l=void 0===l?s:l,this.parent&&!1===this.parent.visible?this.enabled=!1:this.enabled=!1!==l,this.draw)for(var h in this.draw)this.draw[h]=null==this.draw[h]?{}:this.draw[h],"object"!==gr(this.draw[h])?(i="Draw group '".concat(h,"' for layer ").concat(this.full_name," is invalid, must be an object, "),En("warn",i+="but was set to `".concat(h,": ").concat(this.draw[h],"` instead")),delete this.draw[h]):this.draw[h].layer_name=this.full_name}return _r(t,[{key:"build",value:function(){En("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){this.draw=Tn.stringsToFunctions(this.draw,yo.wrapFunction),this.calculatedDraw=function(t){var e,i=[];return t.parent&&(e=t.parent.calculatedDraw||[],i.push.apply(i,Lr(e))),i.push(t.draw),i}(this)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=Tn.stringsToFunctions(this.filter,yo.wrapFunction);var t=gr(this.filter);if(null==this.filter||"object"===t||"function"===t)try{this.buildZooms(),this.buildPropMatches(),null!=this.filter&&("function"==typeof this.filter||0<Object.keys(this.filter).length)?this.filter=mf(this.filter,kf):this.filter=null}catch(t){var e="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");En("warn",e+="failed with error '".concat(t.message,"', stack trace: ").concat(t.stack))}else{var i="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");En("warn",i+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var t=this.filter&&this.filter.$zoom,e=gr(t);if(null!=t&&"function"!==e){if(this.zooms={},"number"===e)this.zooms[t]=!0;else if(Array.isArray(t))for(var i=0;i<t.length;i++)this.zooms[t[i]]=!0;else if("object"===e&&(null!=t.min||null!=t.max))for(var r=t.min||0,n=t.max||25,o=r;o<n;o++)this.zooms[o]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var t=this;this.filter&&!Array.isArray(this.filter)&&"function"!=typeof this.filter&&Object.keys(this.filter).forEach((function(e){if(-1===wf.indexOf(e)){var i=t.filter[e],r=gr(i),n=Array.isArray(i);if(!n&&"string"!==r&&"number"!==r)return;"$"===e[0]?(t.context_prop_matches=t.context_prop_matches||[],t.context_prop_matches.push([e.substring(1),n?i:[i]])):(t.feature_prop_matches=t.feature_prop_matches||[],t.feature_prop_matches.push([e,n?i:[i]])),delete t.filter[e]}}))}},{key:"doPropMatches",value:function(t){if(this.feature_prop_matches)for(var e=0;e<this.feature_prop_matches.length;e++){var i=this.feature_prop_matches[e],r=t.feature.properties[i[0]];if(null==r||-1===i[1].indexOf(r))return!1}if(this.context_prop_matches)for(var n=0;n<this.context_prop_matches.length;n++){var o=this.context_prop_matches[n],a=t[o[0]];if(null==a||-1===o[1].indexOf(a))return!1}return!0}},{key:"doesMatch",value:function(t){if(!this.enabled)return!1;if(this.is_built||this.build(),null!=this.zooms&&!this.zooms[t.zoom])return!1;if(!this.doPropMatches(t))return!1;var e;if(this.filter instanceof Function)try{e=this.filter(t)}catch(e){var i="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");En("error",i+="failed with error '".concat(e.message,"', stack trace: ").concat(e.stack),t.feature)}else e=null==this.filter;return!!e&&(this.children_to_parse&&(function(t,e,i){for(var r in e){var n,o=e[r];"object"!==gr(o)||Array.isArray(o)?(n="Layer value must be an object: cannot create layer '".concat(r,": ").concat(JSON.stringify(o),"'"),n+=", under parent layer '".concat(t.full_name,"'."),i[t.name]&&(n+=" The parent name '".concat(t.name,"' is also the name of a style, did you mean to create a 'draw' group"),t.parent&&(n+=" under '".concat(t.parent.name,"'")),n+=" instead?"),En("warn",n)):Mf(r,o,t,i)}}(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),t}();xf.id=0;var Ef,Af=function(){wr(e,xf);var t=Mr(e);function e(i){var r;return vr(this,e),(r=t.call(this,i)).is_leaf=!0,r}return e}(),Tf=function(){wr(e,xf);var t=Mr(e);function e(i){var r;return vr(this,e),(r=t.call(this,i)).is_tree=!0,r.layers=i.layers||[],r}return _r(e,[{key:"addLayer",value:function(t){this.layers.push(t)}},{key:"buildDrawGroups",value:function(t){var e=[],i=[];if(function t(e,i,r,n){var o=!1;if(0!==i.length){for(var a=0;a<i.length;a++){var s=i[a];s.is_leaf?s.doesMatch(e)&&(o=!0,r.push(s),n.push(s.id)):s.is_tree&&s.doesMatch(e)&&(o=!0,t(e,s.layers,r,n)||(r.push(s),n.push(s.id)))}return o}}(t,[this],e,i),0<e.length){var r=function(t){if(1<t.length){for(var e=t[0],i=1;i<t.length;i++)e+="/"+t[i];return e}return t[0]}(i);if(void 0===bf[r]){for(var n=e.map((function(t){return t&&!1!==t.visible&&t.calculatedDraw})),o={},a=0;a<n.length;a++){var s=n[a];if(s)for(var l=0;l<s.length;l++){var u=s[l];for(var c in u)o[c]=!0}}for(var h in o)bf[r]=bf[r]||{},bf[r][h]=function(t,e){for(var i,r=0,n=0;n<t.length;n++)t[n].length>r&&(r=t[n].length);if(0===r)return null;for(var o={visible:!0},a=0;a<r;a++)!function(r){i=[],t.forEach((function(t){t[r]&&t[r][e]&&-1===i.indexOf(t[r][e])&&i.push(t[r][e])})),0!==i.length&&(i.sort((function(t,e){return(t&&t.layer_name)>(e&&e.layer_name)?1:-1})),sa.apply(void 0,[o].concat(Lr(i))),delete o.layer_name)}(a);return!1===o.visible?null:o}(n,h),bf[r][h]?(bf[r][h].key=r+"/"+h,bf[r][h].layers=e.map((function(t){return t&&t.full_name})),bf[r][h].group=h):delete bf[r][h];bf[r]&&0===Object.keys(bf[r]).length&&(bf[r]=null)}return bf[r]}}}]),e}(),kf={rangeTransform:function(t){return"string"==typeof t&&"px2"===t.trim().slice(-3)?"".concat(parseFloat(t)," * context.meters_per_pixel_sq"):t}};function Sf(t){return-1<_f.indexOf(t)}function Mf(t,e,i,r){var n,o={name:t,layer:e=null==e?{}:e,parent:i,styles:r},a=Or(function(t){var e={},i={};for(var r in t)Sf(r)?e[r]=t[r]:i[r]=t[r];return[e,i]}(e),2),s=a[0],l=a[1],u=(n=l,0===Object.keys(n).length),c=new(u&&null!=i?Af:Tf)(Object.assign(o,s));return c.enabled&&(i&&i.addLayer(c),c.children_to_parse=u?null:l),c}var If=/^global\.(.+)$/,Of=Ef={loadScene:function(t,e){var i=this,r=1<arguments.length&&void 0!==e?e:{},n=r.path,o=r.type,a=[];return this.loadSceneRecursive({url:t,path:n,type:o},null,a).then((function(t){return i.finalize(t)})).then((function(t){var e=t.config,r=t.bundle;return e?(0<a.length&&a.forEach((function(t){var e="Failed to import scene: ".concat(t.url);En("error",e,t),i.trigger("error",{type:"scene_import",message:e,error:t,url:t.url})})),{config:e,bundle:r}):Promise.reject(a[0])}))},loadSceneRecursive:function(t,e,i){var r=this,n=t.url,o=t.path,a=(t.type,2<arguments.length&&void 0!==i?i:[]);if(!n)return Promise.resolve({});var s=new uf(n,o,e);return s.load().then((function(t){if(null==t.import)return r.normalize(t,s),{config:t,bundle:s};Array.isArray(t.import)||(t.import=[t.import]);var e=[];return t.import.forEach((function(t){"object"===gr(t)&&(t=Cn(new Blob([JSON.stringify(t)]))),e.push(s.resourceFor(t))})),delete t.import,Promise.all(e.map((function(t){return r.loadSceneRecursive(t,s,a)}))).then((function(e){e.forEach((function(t){return r.normalize(t.config,t.bundle)}));var i=e.map((function(t){return t.config}));return t=sa.apply(void 0,Lr(i).concat([t])),r.normalize(t,s),{config:t,bundle:s}}))})).catch((function(t){return t.url=n,a.push(t),{}}))},normalize:function(t,e){return this.normalizeDataSources(t,e),this.normalizeFonts(t,e),this.normalizeTextures(t,e),this.hoistTextures(t,e),{config:t,bundle:e}},normalizeDataSources:function(t,e){for(var i in t.sources=t.sources||{},t.sources)this.normalizeDataSource(t.sources[i],e);return t},normalizeDataSource:function(t,e){if(t.url&&(t.url=e.urlFor(t.url)),t.scripts)for(var i in Array.isArray(t.scripts)&&(t.scripts=t.scripts.reduce((function(t,e){return t[e]=e,t}),{})),t.scripts)t.scripts[i]=e.urlFor(t.scripts[i]);return t},normalizeFonts:function(t,e){for(var i in t.fonts=t.fonts||{},t.fonts){var r;Array.isArray(t.fonts[i])?t.fonts[i].forEach((function(t){t.url=t.url&&e.urlFor(t.url)})):(r=t.fonts[i]).url=r.url&&e.urlFor(r.url)}return t},normalizeTextures:function(t,e){if(t.textures=t.textures||{},t.textures)for(var i in t.textures){var r=t.textures[i];r.url&&(r.url=e.urlFor(r.url))}},hoistTextures:function(t,e){var i=this;if(t.styles)for(var r in t.styles)!function(r){var n=t.styles[r],o=n.texture;"string"!=typeof o||t.textures[o]||(n.texture=i.hoistTexture(o,t,e)),n.material&&["emission","ambient","diffuse","specular","normal"].forEach((function(r){var o=null!=n.material[r]&&n.material[r].texture;"string"!=typeof o||t.textures[o]||(n.material[r].texture=i.hoistTexture(o,t,e))}))}(r);if(this.hoistStyleShaderUniformTextures(t,e,{include_globals:!1}),t.layers)for(var n=[t.layers];0<n.length;){var o=n.pop();if("object"===gr(o)&&!Array.isArray(o))for(var a in o)if("draw"===a){var s,l,u=o[a];for(var c in u)u[c].texture&&("string"!=typeof(s=u[c].texture)||t.textures[s]||(u[c].texture=this.hoistTexture(s,t,e))),u[c].outline&&u[c].outline.texture&&("string"!=typeof(l=u[c].outline.texture)||t.textures[l]||(u[c].outline.texture=this.hoistTexture(l,t,e)))}else{if(Sf(a))continue;n.push(o[a])}}},hoistStyleShaderUniformTextures:function(t,e,i){var r=this,n=i.include_globals;if(t.styles)for(var o in t.styles){var a=t.styles[o];a.shaders&&a.shaders.uniforms&&Bo.parseUniforms(a.shaders.uniforms).forEach((function(i){var o=i.type,a=i.value,s=i.key,l=i.uniforms;"sampler2D"!==o||"string"!=typeof a||t.textures[a]||!n&&cf(a)||(l[s]=r.hoistTexture(a,t,e))}))}},hoistTexture:function(t,e,i){var r=cf(t),n=r?t:i.urlFor(t),o=r?"texture-".concat(n):n;return e.textures[o]={url:n},o},applyGlobalProperties:function(t){if(!t.global||0===Object.keys(t.global).length)return t;var e=function t(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};for(var o in r=r?r+i:"",e){var a=r+o,s=e[o];"object"!==gr(n[a]=s)||Array.isArray(s)||t(s,i,a,n)}return n}(t.global);return function t(i){if("string"==typeof i){var r=function t(e,i,r){var n=2<arguments.length&&void 0!==r?r:[];if(-1<n.indexOf(e))En({level:"warn",once:!0},"Global properties: cyclical reference detected",n);else{n.push(e);var o=If.exec(e);if(o){var a=o[1];if(a){var s=i[a];if(void 0!==s)return"string"==typeof s&&If.exec(s)?t(s,i,n):s;En({level:"warn",once:!0},"Global property not found: "+e)}else En({level:"warn",once:!0},"Invalid global property reference: "+e)}}}(i,e);void 0!==r&&(i=r)}else if(Array.isArray(i))for(var n=0;n<i.length;n++)i[n]=t(i[n]);else if("object"===gr(i))for(var o in i)i[o]=t(i[o]);return i}(t)},finalize:function(t){var e=t.config,i=t.bundle;return e?(e.global=e.global||{},e.scene=e.scene||{},e.cameras=e.cameras||{},e.lights=e.lights||{},e.styles=e.styles||{},e.layers=e.layers||{},e.camera&&(e.cameras.default=e.camera),0===Object.keys(e.cameras).length&&(e.cameras.default={}),0!==Object.keys(e.lights).length&&!Object.keys(e.lights).every((function(t){return!1===e.lights[t].visible}))||(e.lights.default_light={type:"directional"}),{config:e,bundle:i}):{}}};Mo(Ef);var Lf=function(){function t(){vr(this,t),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return _r(t,[{key:"sourceTiles",value:function(t,e){return this.coords[t.key]&&this.coords[t.key].sources&&this.coords[t.key].sources[e.name]}},{key:"addTile",value:function(t){var e=t.coords.key,i=this.coords[e];(i=i||(this.coords[e]={descendants:0})).sources||(i.sources={}),i.sources[t.source.name]||(i.sources[t.source.name]={});for(var r=(i.sources[t.source.name][t.style_zoom]=t).coords.z-1;0<=r;r--){var n=pa.coordinateAtZoom(t.coords,r);this.coords[n.key]||(this.coords[n.key]={descendants:0}),this.coords[n.key].descendants++}}},{key:"removeTile",value:function(t){var e=this.sourceTiles(t.coords,t.source),i=t.coords.key;e&&(delete e[t.style_zoom],0===Object.keys(e).length&&(delete this.coords[i].sources[t.source.name],0===Object.keys(this.coords[i].sources).length&&(delete this.coords[i].sources,0===this.coords[i].descendants&&delete this.coords[i])));for(var r=t.coords.z-1;0<=r;r--){var n=pa.coordinateAtZoom(t.coords,r);this.coords[n.key]&&0<this.coords[n.key].descendants&&(this.coords[n.key].descendants--,0!==this.coords[n.key].descendants||this.coords[n.key].sources||delete this.coords[n.key])}}},{key:"getAncestor",value:function(t,e){var i=t.coords,r=t.style_zoom,n=t.source,o=1<arguments.length&&void 0!==e?e:1;if(!(o>this.max_proxy_ancestor_depth)){if(r>n.max_coord_zoom){var a=this.sourceTiles(i,n);if(a)for(var s=r-1;s>=n.max_coord_zoom;s--)if(a[s]&&a[s].loaded)return a[s];r=n.max_coord_zoom}r--;var l=pa.coordinateAtZoom(i,i.z-1),u=this.sourceTiles(l,n);return u&&u[r]&&u[r].loaded?u[r]:0<l.z?this.getAncestor({coords:l,style_zoom:r,source:n},o+1):void 0}}},{key:"getDescendants",value:function(t,e){var i=t.coords,r=t.style_zoom,n=t.source,o=1<arguments.length&&void 0!==e?e:1,a=[];if(r>=n.max_coord_zoom){var s=this.sourceTiles(i,n);if(s)for(var l=Math.max(Qr.default_view_max_zoom,r+this.max_proxy_descendant_depth),u=r+1;u<=l;u++)if(s[u]&&s[u].loaded)return a.push(s[u]),a;return a}if(this.coords[i.key]&&0<this.coords[i.key].descendants){r++;for(var c=pa.childrenForCoordinate(i),h=0;h<c.length;h++){var p=c[h],f=this.sourceTiles(p,n);f&&f[r]&&f[r].loaded?a.push(f[r]):o<=this.max_proxy_descendant_depth&&p.z<=n.max_coord_zoom&&a.push.apply(a,Lr(this.getDescendants({coords:p,source:n,style_zoom:r},o+1)))}}return a}}]),t}(),Cf=function(){function t(e,i,r,n){vr(this,t),Object.assign(this,e),this.placed=null,this._tile=n;var o=Qr.unitsPerMeter(n.coords.z)*Math.pow(2,r-n.style_zoom);this.layout=Object.assign({},e.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=o,this.position=Qr.tileSpaceToMeters(this.position,n.coords.z,n.min),this._worldToScreen=i,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return _r(t,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var t,e,i,r,n,o,a;return this._screenSpaceBoundingBox||((t=this._worldToScreen(this.position,!0))[0]+=this.offset[0],t[1]+=this.offset[1],e=this.size[0]/2+this.layout.buffer[0],i=this.size[1]/2+this.layout.buffer[1],r=t[0]-e,n=t[0]+e,o=t[1]-i,a=t[1]+i,this._screenSpaceBoundingBox={left:r,bottom:a,right:n,top:o}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles="point"===this.type?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var t=this._tile.coords.z,e=this._tile.min,i=Qr.tileSpaceToMeters([this.sides[0],this.sides[1]],t,e),r=Qr.tileSpaceToMeters([this.sides[2],this.sides[3]],t,e),n=Or(this._worldToScreen(i,!0),2),o=n[0],a=n[1],s=Or(this._worldToScreen(r,!0),2);return vc(o,a,s[0],s[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var t=[],e=this.circles,i=this._tile.coords.z,r=this._tile.min,n=0;n<e.length-2;n+=3){var o=Qr.tileSpaceToMeters([e[n],-e[n+1]],i,r),a=e[n+2]/Qr.unitsPerMeter(i),s=[o[0]+a,o[1]],l=this._worldToScreen(o,!0),u=this._worldToScreen(s,!0),c=Xr.getLineLength(l[0],l[1],u[0],u[1]);t.push(l[0],l[1],c)}return t}}]),t}(),Rf={},Nf={},Pf=120===new Uint8Array(new Uint32Array([305419896]).buffer)[0];function jf(t,e,i,r,n){var o=t.container,a=o.label,s=o.linked,l=t.ranges;return{label:new Cf(a,i,r,n),linked:s,ranges:l,mesh:e}}var Df=function(){function t(e){vr(this,t),this.textureManager=Lo(e),this.tiles={},this.meshes=[],this.containers=[]}return _r(t,[{key:"insertLabel",value:function(t,e){var i=t.label.text_data,r=i.text_settings_key,n=i.text,o=i.text_info;this.containers.push(t);var a=this._ensureTextSection(e,r);a[n]?t.label.text_data.text_info=a[n]:a[n]=o}},{key:"trackMesh",value:function(t){-1===this.meshes.indexOf(t)&&this.meshes.push(t)}},{key:"updateMeshes",value:function(){var t=this;return this.containers.forEach((function(e){var i,r,n,o,a,s,l,u,c,h;e.label.text_data&&(i=e.label.getTile(),(r=e.mesh).valid?(n=e.label.type,o=e.label.text_data.text_info,t.tiles[i.id]&&t.tiles[i.id].textures&&(a=t.tiles[i.id].textures[0],r.uniforms.u_texture=a,-1===r.textures.indexOf(a)&&r.textures.push(a),"point"===n||"straight"===n?(s="point"===n?o.align[e.label.align].texcoords:o.texcoords[n].texcoord,t.setTexCoords(r,e,s)):"curved"===n&&(l=o.segments.length,u=o.texcoords_stroke,c=o.texcoords.curved,t.setTexCoords(r,e,(function(t){return t<l?u[t]:c[t-l].texcoord}))))):t.tiles[i.id]&&t.tiles[i.id].textures&&(h=t.tiles[i.id].textures[0],t.textureManager.release(h)))})),this.meshes}},{key:"setTexCoords",value:function(t,e,i){var r,n,o,a,s,l,u=i instanceof Function;u||(n=(r=Or(i,4))[0],o=r[1],a=r[2],s=r[3],l=[[n,o],[a,o],[a,s],[n,s]]);var c=t.vertex_layout.stride,h=new DataView(t.vertex_data.buffer),p=t.vertex_layout.offset.a_texcoord;e.ranges.forEach((function(t,e){var r,n,o,a,s,f=Or(t,3),d=f[0],y=f[1],g=f[2];u&&(n=(r=Or(i(e),4))[0],o=r[1],a=r[2],s=r[3],l=[[n,o],[a,o],[a,s],[n,s]]);for(var v=g?y/2:0;v<y;v++){var m=l[v%4],_=d+v*c;h.setUint16(_+p,65535*m[0],Pf),h.setUint16(_+p+2,65535*m[1],Pf)}}))}},{key:"createTextures",value:function(t){var e=this;return Promise.all(Object.values(this.tiles).map((function(i){var r=i.id,n=i.key,o=i.texts;return e._createTexturesForTile(t,o,"labels-".concat(n,"-").concat(r),r,e.textureManager).then((function(t){t.length&&(t.forEach((function(t){e.textureManager.retain(t),1<e.textureManager.getRetainCount(t)&&e.textureManager.release(t)})),e.tiles[r].textures=t)}))})))}},{key:"_createTexturesForTile",value:function(t,e,i,r,n){var o=new kc,a=o.setTextureTextPositions(e);return o.rasterize(e,a,r,i,t,n)}},{key:"_ensureTile",value:function(t){var e=t.id,i=t.key;return this.tiles[e]||(this.tiles[e]={id:e,key:i,texts:{}}),this.tiles[e]}},{key:"_ensureTextSection",value:function(t,e){var i=this._ensureTile(t).texts;return i[e]||(i[e]={}),i[e]}}]),t}(),zf=function(){function t(e){var i=this,r=e.scene,n=e.view;vr(this,t),this._scene=r,this._view=n,this._visible_tiles={},this._pyramid=new Lf,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=An(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),un.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(function(){var t=.1;return navigator&&navigator.deviceMemory?t=5*navigator.deviceMemory/100:window&&window.screen&&(t=window.screen.width/512*window.screen.height/512*.03*3,t=Math.min(t,1)),1024*t*1024*1024}(),(function(t,e,r){i._visible_tiles[t]&&i._visible_tiles[t]===e||e.destroy()}))}return _r(t,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile((function(t){return t.destroy()})),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(t){this._visible_tiles[t.key]=t,this._pyramid.addTile(t)}},{key:"hasTile",value:function(t){return void 0!==this._visible_tiles[t]}},{key:"_forgetTile",value:function(t){var e,i;this.hasTile(t)&&(e=this._visible_tiles[t],this._pyramid.removeTile(e),delete this._visible_tiles[t],e.loaded?this._tile_cache.add(e.key,e,function(t){var e=0;for(var i in t.meshes)for(var r=t.meshes[i],n=0;n<r.length;n++){var o=r[n];e+=o.buffer_size;for(var a=0;a<o.textures.length;a++)e+=t.textureManager.getByteLength(o.textures[a])}return e}(e)):(i=this._tile_cache.get(e.key))?this._tile_cache.drop(i.key):e.destroy(),this._tileBuildStop(e))}},{key:"removeTile",value:function(t){this._forgetTile(t),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])}},{key:"removeTiles",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])&&this.removeTile(e)}},{key:"removeCachedTiles",value:function(t){var e=this;this._tile_cache.forEach((function(i,r){t(r)&&e._tile_cache.drop(i)}))}},{key:"updateTilesForView",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this._visible_coords={};for(var i=this._view.findVisibleTileCoordinates(),r=0;r<i.length;r++){var n=i[r];this._visible_coords[n.key]=n}this.updateTileStates(e)}},{key:"updateTileStates",value:function(t){var e=0<arguments.length&&void 0!==t&&t;for(var i in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(i,e);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(t){if(t.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[t.coords.key])return!1;for(var e in this._visible_coords)if(pa.isDescendant(t.coords,this._visible_coords[e]))return!1}return!t.isProxy()}},{key:"_updateLabels",value:function(){var t=this;this._building_tiles&&0!==Object.keys(this._building_tiles).length||(kc.pruneTextCache(),function(t,e,i,r,n,o){Nf=Rf,Rf={};var a={},s={},l=[],u=i.worldToScreen.bind(i),c=new Df(o);for(var h in t.forEach((function(t){for(var i in t.meshes)t.meshes[i].forEach((function(i){if(i.labels){for(var r in c.trackMesh(i),i.labels["non-collision"]){var n=jf(i.labels["non-collision"][r],i,u,e,t);n.label.text_data&&c.insertLabel(n,t)}for(var o in i.labels.collision){var l;a[o]||(l=jf(i.labels.collision[o],i,u,e,t),a[o]=l.label,s[o]=l)}}}))})),s){var p=s[h];p.linked&&(p.linked=s[p.linked]),l.push(p)}var f=i.getViewport(),d=f.width,y=f.height;return Ao.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new xo(d,y,30)}),Ao.addStyle("main","main"),Ao.collide(l,"main","main").then((function(t){return t.forEach((function(t){var e,i,n,o,a,s,l=t.mesh,u=t.label.getTile();l.valid&&(!(e=0)!==t.show||r&&t.label.breach&&!Nf[t.label.id]||(e=1),e&&(Rf[t.label.id]=!0),t.label.text_data&&c.insertLabel(t,u),i=l.vertex_layout.offset.a_shape,n=l.vertex_layout.stride,a=(o=l.vertex_layout.attribs.find((function(t){return"a_shape"===t.name}))).byte_size/o.size,i+=3*a,s=!0,t.ranges.forEach((function(t){if(s){for(var r=0;r<t[1];r++){if(l.vertex_data[t[0]+r*n+i]===e)return void(s=!1);l.vertex_data[t[0]+r*n+i]=e}c.trackMesh(l)}})))})),c.createTextures(n).then((function(){return c.updateMeshes()}))})).then((function(e){e.forEach((function(t){return t.valid&&t.upload()})),t.forEach((function(t){t.labeled=!0})),l=[],s={},a={}}))}(this._renderable_tiles.sort(Ff),function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,r=Math.pow(10,i);return Math.round(Math.floor(t*e)/e*r)/r}(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then((function(){t._is_labeled=!To.hasPendingTasks(),t._scene.immediateRedraw(),t._update_labels_on_queue_check=!1})))}},{key:"_updateProxyTiles",value:function(){var t,e=this,i=this._view.lookAtManipulator.getZoomDirection();0!==i&&(t=!1,this.forEachVisibleTile((function(r){var n;if(r.setProxyFor(null),1===i)r.built||(n=e._pyramid.getAncestor(r))&&(n.setProxyFor(r),t=!0);else if(-1===i&&!r.built)for(var o=e._pyramid.getDescendants(r),a=0;a<o.length;a++)o[a].setProxyFor(r),t=!0})),t||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var t in this._renderable_tiles=[],this._visible_tiles){var e=this._visible_tiles[t],i=this._tile_cache.get(t);e.loaded?(this._renderable_tiles.push(e),i&&i!==e&&this._tile_cache.drop(t)):i&&(i.generation===this._scene.generation?this._renderable_tiles.push(i):this._tile_cache.drop(t))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(t,e){return e.has_volatile_data?this._scene.getWorkers(1)[0]:e.tiled?this._scene.getWorkers(0)[Math.abs(t.x+t.y+t.z)%this._scene.num_workers]:this._scene.getWorkers(0)[e.id%this._scene.num_workers]}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var t=this._renderable_tiles,e={},i=0;i<t.length;i++){var r=t[i];Object.keys(r.meshes).forEach((function(t){return e[t]=!0}))}return this._active_styles=Object.keys(e),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var t=!1;for(var e in this._visible_tiles)if(!this._visible_tiles[e].built){t=!0;break}return t}},{key:"updateTilesVisibilityCounters",value:function(){var t=this;Object.keys(this._visible_coords).forEach((function(e){e in t._tile_visibility_counters||(t._tile_visibility_counters[e]=0)}));var e=Object.keys(this._tile_visibility_counters),i=[];e.forEach((function(e){e in t._visible_coords?(t._tile_visibility_counters[e]++,30<=t._tile_visibility_counters[e]&&i.push(t._visible_coords[e])):(t._tile_visibility_counters[e]--,t._tile_visibility_counters[e]<=0&&delete t._tile_visibility_counters[e])})),i.length&&this.loadCoordinates(i)}},{key:"loadCoordinates",value:function(t){var e=this;t.sort((function(t,i){var r=e._view.lookAtManipulator.getLookAtData().position,n=Qr.metersPerTile(t.z)/2,o=Qr.metersForTile(t);o.x+=n,o.y-=n;var a=Qr.metersForTile(i);a.x+=n,a.y-=n;var s=Math.abs(r[0]-o.x)+Math.abs(r[1]-o.y),l=Math.abs(r[0]-a.x)+Math.abs(r[1]-a.y);return(t.center_dist=s)<(i.center_dist=l)?-1:l===s?0:1})),t.forEach((function(t){return e.loadCoordinate(t)}))}},{key:"_keepCoordinate",value:function(t,e){var i=1<arguments.length&&void 0!==e&&e,r=this._visible_coords[t];if(r.z===this._view.center_tile.z)for(var n in this._scene.sources){var o,a,s,l=this._scene.sources[n];l.builds_geometry_tiles&&l.includesTile(r,this._view.lookAtManipulator.getLookAtData().tile_level)&&(o=pa.normalizedKey(r,l,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(o)&&((a=i&&this._tile_cache.get(o))||(this._all_visible_tiles_are_cached=!1),s=a||new pa({source:l,coords:r,worker:this.getWorkerForTile(r,l),style_zoom:Tn.zoomToTileLevel(r.z),view:this._view,sceneId:this._scene.id}),"ObjectSource"===l.config.type&&(s.syncedAt=l.getSyncedAt()),this.keepTile(s))}}},{key:"loadCoordinate",value:function(t){if(t.z===this._view.center_tile.z)for(var e in this._scene.sources){var i,r=this._scene.sources[e];r.builds_geometry_tiles&&r.includesTile(t,this._view.lookAtManipulator.getLookAtData().tile_level)&&(i=pa.normalizedKey(t,r,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(i)&&this.buildTile(this._visible_tiles[i]))}}},{key:"buildTile",value:function(t,e){this._building_tiles&&this._building_tiles[t.key]||t.built&&t.generation===this._scene.generation||(this._tileBuildStart(t.key),t.build(this._scene.generation,e))}},{key:"buildTileStylesCompleted",value:function(t){var e=t.tile,i=t.progress;if(null==this._visible_tiles[e.key])pa.abortBuild(e,this._scene.id);else if(e.generation!==this._scene.generation)pa.abortBuild(e,this._scene.id);else{if(e.id<this._visible_tiles[e.key].id)return void pa.abortBuild(e,this._scene.id);e=this._visible_tiles[e.key].merge(e),i.done&&(e.built=!0),e.buildMeshes(this._scene.styles,i),this.updateTileStates(),this._scene.requestRedraw()}i.done&&this._tileBuildStop(e)}},{key:"buildTileError",value:function(t){this._forgetTile(t.key),pa.abortBuild(t,this._scene.id)}},{key:"_tileBuildStart",value:function(t){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[t]=!0}},{key:"_tileBuildStop",value:function(t){this._building_tiles&&(t.source&&t.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[t.key],To.removeForTile(t.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&0!==Object.keys(this._building_tiles).length||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!To.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(t,e){var i=e.source;return!this._visible_tiles[t]&&(e.generation!==this._scene.generation||"ObjectSource"===i.config.type&&i.getSyncedAt()>e.syncedAt)}}]),t}();function Ff(t,e){var i=t.coords,r=e.coords;return i.z-r.z||i.x-r.x||i.y-r.y}function Gf(t){vr(this,Gf),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=t.BACK,this.defaults.blending=!1,this.defaults.blending_src=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=t.ONE,this.defaults.blending_dst_alpha=t.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,t.depthFunc(t.LESS),this.culling=new Hf({cull:this.defaults.culling,face:this.defaults.culling_face},(function(e){e.cull?(t.enable(t.CULL_FACE),t.cullFace(e.face)):t.disable(t.CULL_FACE)})),this.blending=new Hf({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},(function(e){e.blend?(t.enable(t.BLEND),e.src_alpha&&e.dst_alpha?t.blendFuncSeparate(e.src,e.dst,e.src_alpha,e.dst_alpha):t.blendFunc(e.src,e.dst)):t.disable(t.BLEND)})),this.depth_write=new Hf({depth_write:this.defaults.depth_write},(function(e){t.depthMask(e.depth_write)})),this.depth_test=new Hf({depth_test:this.defaults.depth_test},(function(e){e.depth_test?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)}))}var Hf=function(){function t(e,i){vr(this,t),i(e),this.value=e,this.setup=i}return _r(t,[{key:"get",value:function(){return this.value}},{key:"set",value:function(t){JSON.stringify(this.value)!==JSON.stringify(t)&&(this.setup(t),this.value=t)}}]),t}(),Bf=function(){function t(){vr(this,t),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return _r(t,[{key:"setCanvas",value:function(t,e){this.canvas=t,this.gl=e}},{key:"screenshot",value:function(t){var e=this,i=(0<arguments.length&&void 0!==t?t:{}).background;return null!=this.queue_screenshot||(this.queue_screenshot={background:i},this.queue_screenshot.promise=new Promise((function(t,i){e.queue_screenshot.resolve=t,e.queue_screenshot.reject=i}))),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(null!=this.queue_screenshot){var t=this.canvas.width,e=this.canvas.height,i=new Uint8Array(t*e*4);this.gl.readPixels(0,0,t,e,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i);for(var r=(r=this.queue_screenshot.background)&&"transparent"!==r?yo.parseColor(r).slice(0,3).map((function(t){return 255*t})):null,n=new Uint8ClampedArray(t*e*4),o=0;o<e;o++)for(var a=0;a<t;a++){var s=4*((e-o-1)*t+a),l=4*(o*t+a),u=i[3+s];n[0+l]=255*i[0+s]/u,n[1+l]=255*i[1+s]/u,n[2+l]=255*i[2+s]/u,n[3+l]=u,r&&(u/=255,n[0+l]=n[0+l]*u+r[0]*(1-u),n[1+l]=n[1+l]*u+r[1]*(1-u),n[2+l]=n[2+l]*u+r[2]*(1-u),n[3+l]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var c=this.screenshot_canvas;c.width=t,c.height=e,this.screenshot_context=this.screenshot_context||c.getContext("2d");var h=this.screenshot_context,p=new ImageData(n,t,e);h.putImageData(p,0,0);for(var f=c.toDataURL("image/png"),d=atob(f.slice(22)),y=new Uint8Array(d.length),g=0;g<d.length;++g)y[g]=d.charCodeAt(g);var v=new Blob([y],{type:"image/png"});this.queue_screenshot.resolve({url:f,blob:v,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var t=this;if("function"!=typeof window.MediaRecorder||!this.canvas||"function"!=typeof this.canvas.captureStream)return En("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return En("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var e=this.video_capture={};e.chunks=[],e.stream=this.canvas.captureStream(),e.options={mimeType:"video/webm"},e.media_recorder=new MediaRecorder(e.stream,e.options),e.media_recorder.ondataavailable=function(i){var r,n;0<i.data.size&&e.chunks.push(i.data),e.resolve&&(n=Cn(r=new Blob(e.chunks,{type:e.options.mimeType})),e.stream&&(e.stream.getTracks()||[]).forEach((function(t){t.stop(),e.stream.removeTrack(t)})),e.stream=null,e.media_recorder=null,t.video_capture=null,e.resolve({url:n,blob:r,type:"webm"}))},e.media_recorder.start()}catch(t){return this.video_capture=null,En("error","Scene video capture failed",t),!1}return!0}},{key:"stopVideoCapture",value:function(){var t=this;return this.video_capture?(this.video_capture.promise=new Promise((function(e,i){t.video_capture.resolve=e,t.video_capture.reject=i})),this.video_capture.media_recorder.stop(),this.video_capture.promise):(En("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),t}(),Uf=function(){function t(){vr(this,t),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return _r(t,[{key:"init",value:function(t,e,i,r,n,o,a){return this.setMeshVariantMaxLife(a),this.scene_id=t,this.textureManager=Lo(t),this._worker_id=e,En.setLevel(i),Tn.device_pixel_ratio=r,tu.setElementIndexUint(n),Ho.setPrefix(this._worker_id),this._style_manager=new Mh,this._importExternalScripts(o),cc.id_prefix=e,this._isConfigured=!1,e}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(t){var e;0!==t.length&&(En("debug","loading custom data source scripts in worker:",t),e=Object.getOwnPropertyNames(window),importScripts.apply(void 0,Lr(t)),Object.getOwnPropertyNames(window).forEach((function(t){-1===e.indexOf(t)&&(self[t]=window[t])})))}},{key:"updateConfig",value:function(t,e){var i,r=t.config,n=t.generation,o=t.introspection;for(var a in r=JSON.parse(r),i=e,Object.assign(Hl,i),this._generation=n,this._isConfigured=!1,r.layers)r.layers[a]&&(r.layers[a].data=Tn.stringsToFunctions(r.layers[a].data));this.global=Tn.stringsToFunctions(r.global),this._createDataSources(r),r.styles=Tn.stringsToFunctions(r.styles,yo.wrapFunction),this.styles=this._style_manager.build(r.styles),self.is_fake_worker=ln.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:o,id:this.scene_id}),delete self.is_fake_worker,this.layers=function(t,e){bf={};var i={};for(var r in t){var n=t[r];n&&(i[r]=Mf(r,n,null,e))}return i}(r.layers,this._style_manager.styles),this._configuring=this._syncTextures(r.textures)}},{key:"setMeshVariantMaxLife",value:function(t){this.meshVariantMaxLife=t}},{key:"_createDataSources",value:function(t){var e=this;this._last_config_sources=this._config_sources||{},this._config_sources=t.sources;var i=this.sources,r=[];for(var n in t.sources=Tn.stringsToFunctions(t.sources),this.sources={},self.is_fake_worker=ln.is_main,t.sources)if(JSON.stringify(this._last_config_sources[n])!==JSON.stringify(t.sources[n])){var o=void 0;try{o=Rn.create(Object.assign({},t.sources[n],{name:n}),this.sources)}catch(i){En("error","Error creating source.",i.message,t.sources[n]);continue}o&&(this.sources[n]=o,r.push(n))}else this.sources[n]=i[n];delete self.is_fake_worker,r.forEach((function(t){for(var i in e.tiles)e.tiles[i].source===t&&delete e.tiles[i]}))}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(t){var e=this;if((this._isConfigured=!0)!==t.loaded)t.loading=!0,t.loaded=!1,t.error=null,this._loadTileSourceData(t).then((function(){if(e.getTile(t.id)){t.loading=!1,t.loaded=!0;try{pa.buildGeometry(t,e)}catch(i){t.error=i.toString(),un.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),pa.slice(t))}}else En("trace","stop tile build after data source load because tile was removed. Key: ".concat(t.key,", id: ").concat(t.id))}),(function(i){t.loading=!1,t.loaded=!1,t.error=i.stack,En("error","tile load error for tile with key ".concat(t.key," and id ").concat(t.id,": ").concat(t.error)),un.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),pa.slice(t))}));else{En("trace","used worker cache for tile with key ".concat(t.key," and id ").concat(t.id));try{pa.buildGeometry(t,this)}catch(e){t.error=e.toString(),un.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),pa.slice(t))}}}},{key:"buildTile",value:function(t){var e,i=t.tile,r=this.getTile(i.id);r&&r.loading||(i=this.tiles[i.id]=Object.assign(r||{},i),this._isConfigured?this._onConfig(i):(e=this).awaitConfiguration().then((function(){return e._onConfig(i)})))}},{key:"_loadTileSourceData",value:function(t){return this.sources[t.source]?this.sources[t.source].load(t):(t.source_data={},Promise.resolve(t))}},{key:"getTile",value:function(t){return this.tiles[t]}},{key:"removeTile",value:function(t){var e=this.tiles[t];null!=e&&(!0===e.loading&&(En("trace","cancel tile load for tile id ".concat(t)),e.loading=!1,pa.cancel(e)),delete this.tiles[t],En("trace","remove tile from cache, tile id: ".concat(t)))}},{key:"queryFeatures",value:function(t){var e=this,i=t.filter,r=t.visible,n=t.geometry,o=t.tile_ids,a=[],s=o.map((function(t){return e.tiles[t]})).filter((function(t){return t}));return null!=i&&(i=-1<["{","["].indexOf(i[0])?JSON.parse(i):i,i=Tn.stringsToFunctions(i,yo.wrapFunction)),i=mf(i,kf),s.forEach((function(t){for(var o in t.source_data.layers)!function(o){t.source_data.layers[o].features.forEach((function(s){var l,u;!0===r&&s.generation!==e._generation||!1===r&&s.generation===e._generation||((l=yo.getFeatureParseContext(s,t,e.global)).source=t.source,l.layer=o,i(l)&&(u={type:s.type,properties:s.properties},!0===n&&(u.geometry=Qr.copyGeometry(s.geometry),Qr.tileSpaceToLatlng(u.geometry,t.coords.z,t.min)),a.push(u)))}))}(o)})),a}},{key:"resetFeatureSelection",value:function(){Ho.reset()}},{key:"_syncTextures",value:function(t){var e=[];return t&&e.push.apply(e,Lr(Object.keys(t))),En("trace","sync textures to worker:",e),0<e.length?this.textureManager.syncTexturesToWorker(e):Promise.resolve()}},{key:"profile",value:function(t){console.profile("worker ".concat(this._worker_id,": ").concat(t))}},{key:"profileEnd",value:function(t){console.profileEnd("worker ".concat(this._worker_id,": ").concat(t))}},{key:"terminate",value:function(){this.dispose()}}]),t}();(ln.is_worker||self.H&&self.H.DEBUG)&&un.addTarget("self",new Uf);var Vf=function(){function e(t,i){vr(this,e),i=i||{},Mo(this),this.id=e.id++,this.textureManager=Lo(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new uh(this,i),this.tile_manager=new zf({scene:this,view:this.view}),this.num_workers=i.numWorkers||2,!0===i.disableVertexArrayObjects&&(Jo.disabled=!0),Tn.device_pixel_ratio=i.devicePixelRatio,this.config=null,this.config_source=t,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new Mh,this.building=null,this.dirty=!0,i.preUpdate&&this.subscribe({pre_update:i.preUpdate}),i.postUpdate&&this.subscribe({post_update:i.postUpdate}),this.render_loop=!i.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new Bf,this.selection=null,this.introspection=!0===i.introspection,this.viewport=i.viewport,this.adjustMeshVariantMaxLife(),this.container=i.container,this.canvas=null,this.contextOptions=i.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=e.generation,this.last_complete_generation=e.generation,this.log_level=i.logLevel||"warn",En.setLevel(this.log_level),En.reset()}return _r(e,[{key:"load",value:function(t,e){var i=this,r=0<arguments.length&&void 0!==t?t:null,n=1<arguments.length&&void 0!==e?e:{};return this.initializing||(En.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(n="string"==typeof n?{base_path:n}:n).blocking=void 0===n.blocking||n.blocking,!1!==this.render_loop&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(r,n).then((function(){return i.createWorkers()})).then((function(){i.resetFeatureSelection();var t="object"===gr(i.config_source)||i.hasSubscribersFor("load"),e=i.updateConfig({serialize_funcs:t,normalize:!1,load_event:!0,fade_in:!0});if(!0===n.blocking)return e})).then((function(){i.updating--,i.initializing=null,i.initialized=!0,i.last_valid_config_source=i.config_source,i.last_valid_options={base_path:n.base_path,file_type:n.file_type},i.requestRedraw()})).catch((function(t){var e,r;if(i.initializing=null,i.updating=0,r="YAMLException"===t.name?(e="yaml","Error parsing scene YAML"):"Error initializing scene",i.trigger("error",{type:e,message:r,error:t,url:i.config_source}),r="Scene.load() failed to load ".concat(i.config_source,": ").concat(t.message),i.last_valid_config_source)return En("warn",r,t),En("info","Scene.load() reverting to last valid configuration"),i.load(i.last_valid_config_source,i.last_valid_base_path);throw En("error",r,t),t}))),this.initializing}},{key:"destroy",value:function(){var t;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},Ko.reset(),(t=this.gl.getExtension("WEBGL_lose_context"))&&t.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),En.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Zl.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:Tn.device_pixel_ratio},this.contextOptions)),navigator.appVersion.includes("iPhone")&&this.gl.depthRange(.994,1)}catch(t){throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),Jo.init(this.gl),this.render_states=new Gf(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var e,n;if(void 0!==t&&(n="("+t+")()",r&&""!==i&&(n+="\n//# sourceMappingURL="+r.slice(0,r.lastIndexOf("/")+1)+i),e=Cn(new Blob([n],{type:"application/javascript"}))),!e)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return e}},{key:"updateExternalScripts",value:function(){var t=Lr(this.external_scripts||[]),e=[];if(this.config.scene.scripts)for(var i in this.config.scene.scripts)-1===e.indexOf(this.config.scene.scripts[i])&&e.push(this.config.scene.scripts[i]);for(var r in this.config.sources){var n=this.config.sources[r];if(n.scripts)for(var o in n.scripts)-1===e.indexOf(n.scripts[o])&&e.push(n.scripts[o])}return this.external_scripts=e,!(this.external_scripts.length===t.length&&this.external_scripts.every((function(e,i){return e===t[i]})))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(t){var e=this,i=!!this.gl.getExtension("OES_element_index_uint"),r=[];this._workers=[];for(var n=0;n<this.num_workers;n++)!function(){var o=new Worker(t);e._workers[n]=o,un.addWorker(o),En("debug","Scene.makeWorkers: initializing worker ".concat(n));var a=n;r.push(un.postMessage(o,"self.init",e.id,n,e.log_level,Tn.device_pixel_ratio,i,e.external_scripts,e.meshVariantMaxLife).then((function(t){return En("debug","Scene.makeWorkers: initialized worker ".concat(t)),t}),(function(t){return En("error","Scene.makeWorkers: failed to initialize worker ".concat(a,":"),t),Promise.reject(t)})))}();var o=new Uf;return this._workers.push(o),r.push(o.init(this.id,n,this.log_level,Tn.device_pixel_ratio,i,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(r).then((function(){var i;En.setWorkers(e._workers.slice(0,e.num_workers)),i=t,void 0===Sn&&"function"!=typeof(Sn=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)&&(Sn=null,En("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),Sn&&Sn(i)}))}},{key:"getWorkers",value:function(t){return this._workers.filter((function(e){switch(t){case 0:return e instanceof Worker;case 1:return e instanceof Uf;default:return!0}}))}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(En.setWorkers(null),this._workers.forEach((function(t){t.terminate()})),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||0===Object.keys(this.sources).length)}},{key:"handleViewportUpdate",value:function(){var t=this.viewport,e=t.width,i=t.height;0<e&&0<i&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Zl.resize(this.gl,e,i,Tn.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var t=this.viewport,e=t.width,i=t.height,r=Tn.device_pixel_ratio,n=e/r/256*(i/r/256),o=Math.max(Math.ceil(2*n),8);if(this.meshVariantMaxLife!==o)return this.meshVariantMaxLife=o,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&un.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),To.setState({user_moving_view:this.view.user_input_active}),To.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var t=this;this.render_loop_active||setTimeout((function(){t.renderLoop()}),0)}},{key:"update",value:function(){var t=this.dirty,e=!!this.selection&&this.selection.hasPendingRequests(),i=!(!1===t&&!1===e||!1===this.initialized||0<this.updating||!1===this.ready());return this.trigger("pre_update",i),this.view.update(),i&&(this.dirty=!1,this.render({main:t,selection:e}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",i),!0!==this.animated&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,En("trace","Scene.render()"),!0)}},{key:"render",value:function(t){var e=this,i=t.main,r=t.selection,n=this.gl;if(Object.keys(this.lights).forEach((function(t){return e.lights[t].update()})),i&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),r){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,this.canvas.width,this.canvas.height),n.clearColor.apply(n,Lr(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:r})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(t,e){var i=this,r=0<arguments.length&&void 0!==t?t:"program",n=(1<arguments.length&&void 0!==e?e:{}).allow_blend,o=this.gl;n=null==n||n,this.clearFrame();for(var a,s=ua.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map((function(t){return i.styles[t]})).filter((function(t){return t}))),l=0,u=0,c=0;c<s.length;c++){var h,p,f=s[c],d=u-(h=parseInt(f.name));(f.clean_depth||d)&&(this.render_states.depth_write.value.depth_write?o.clear(o.DEPTH_BUFFER_BIT):(o.depthMask(!0),o.clear(o.DEPTH_BUFFER_BIT),o.depthMask(!1)),d&&(u=h)),f.blend!==a&&(p=Object.assign({},ua.render_states[f.blend],{blend:n&&f.blend}),this.setRenderState(p));var y="translucent"===f.blend&&"program"===r;y&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(f.name,r),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),l+=this.renderStyle(f.name,r),y&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),a=f.blend}return l}},{key:"renderStyle",value:function(t,e){for(var i,r=this,n=this.styles[t],o=!0,a=0,s=this.tile_manager.getRenderableTiles(),l=Math.max.apply(Math,Lr(s.map((function(e){return e.meshes[t]?Math.max.apply(Math,Lr(e.meshes[t].map((function(t){return t.variant.order})))):-1})))),u=0;u<l+1;u++){var c=function(l){for(var u=0;u<s.length;u++){var c=s[u];if(null!=c.meshes[t]&&c.shouldProxyForStyle(t))for(var h=c.meshes[t].filter((function(t){return t.variant.order===l})),p=0,f=h.length;p<f;p+=1){var d=h[p];if(!0===o&&(o=!1,!(i=r.setupStyle(n,e))))return{v:0};r.view.setupTile(c,i),r.selection.setupDiscards(i),n.render(d)&&r.requestRedraw(),a+=d.geometry_count}}}(u);if("object"===gr(c))return c.v}return a}},{key:"setupStyle",value:function(t,e){var i;try{if(!(i=t.getProgram(e)))return}catch(e){return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(t.name),style:t,shader_errors:t.program&&t.program.shader_errors})}for(var r in i.use(),t.setup(),this.view.setupProgram(i),this.lights)this.lights[r].setupProgram(i);return i}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(t){var e,i,r=0<arguments.length&&void 0!==t?t:{},n=r.depth_test,o=r.depth_write,a=r.cull_face,s=r.blend;this.initialized&&(e=this.render_states,n=!1!==n&&e.defaults.depth_test,o=!1!==o&&e.defaults.depth_write,a=!1!==a&&e.defaults.culling,s=null!=s?s:e.defaults.blending,i=this.gl,e.depth_test.set({depth_test:n}),e.depth_write.set({depth_write:o}),e.culling.set({cull:a,face:e.defaults.culling_face}),s&&"opaque"!==s?"overlay"===s||"inlay"===s||"translucent"===s?e.blending.set({blend:!0,src:i.SRC_ALPHA,dst:i.ONE_MINUS_SRC_ALPHA,src_alpha:i.ONE,dst_alpha:i.ONE_MINUS_SRC_ALPHA}):"add"===s?e.blending.set({blend:!0,src:i.ONE,dst:i.ONE}):"multiply"===s&&e.blending.set({blend:!0,src:i.ZERO,dst:i.SRC_COLOR}):e.blending.set({blend:!1}))}},{key:"getFeatureAt",value:function(t,e,i){var r,n=e.radius,o=e.top_most_only;this.initialized?(r={x:t.x/this.view.size.css.width,y:t.y/this.view.size.css.height},n=0<n?{x:n/this.view.size.css.width,y:n/this.view.size.css.height}:null,this.selection.getFeatureAt(r,{radius:n,top_most_only:o},i)):En("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},i=e.filter,r=e.unique,n=void 0===r||r,o=e.group_by,a=void 0===o?null:o,s=e.visible,l=void 0===s?null:s,u=e.geometry,c=void 0!==u&&u,h=(i=Tn.serializeWithFunctions(i),this.tile_manager.getRenderableTiles().map((function(t){return t.id})));return un.postMessage(this._workers,"self.queryFeatures",{filter:i,visible:l,geometry:c,tile_ids:h}).then((function(t){var e=[],i={},r={},o=(n="string"==typeof n?[n]:n)&&function(t){return JSON.stringify(Array.isArray(n)?Yl(t,n):t)},s=(a=("string"==typeof a||Array.isArray(a))&&a)&&function(t){return Array.isArray(a)?JSON.stringify(Yl(t,a)):t[a]};return t.forEach((function(t){return t.forEach((function(t){if(o){var n=o(t);if(i[n])return;i[n]=!0}var a;s?(a=s(t.properties),r[a]=r[a]||[],r[a].push(t)):e.push(t)}))})),s?r:e}))}},{key:"loadScene",value:function(t,e){var i=this,r=0<arguments.length&&void 0!==t?t:null,n=1<arguments.length&&void 0!==e?e:{},o=n.base_path,a=n.file_type;return this.config_source=r||this.config_source,"string"==typeof this.config_source?this.base_path=On(o||this.config_source):this.base_path=On(o),this.config_path=this.base_path,Of.loadScene(this.config_source,{path:this.base_path,type:a}).then((function(t){var e=t.config,r=t.bundle;return i.config=e,i.config_bundle=r,i.config}))}},{key:"createDataSources",value:function(){var t=this,e=[],i=Object.keys(this.sources),r=0;for(var n in this.config.sources){var o=this.config.sources[n],a=this.sources[n];try{var s=Object.assign({},o,{name:n,id:r++});if(this.sources[n]=Rn.create(s,this.sources),!this.sources[n])throw{}}catch(i){delete this.sources[n];var l="Could not create data source: ".concat(i.message);En("warn","Scene: ".concat(l),o),this.trigger("warning",{type:"sources",source:o,message:l})}Rn.sameConfig(this.sources[n],a)||e.push(n)}for(var u in i.forEach((function(i){t.config.sources[i]||(delete t.sources[i],e.push(i))})),0<e.length&&this.tile_manager.removeTiles((function(t){return-1<e.indexOf(t.source.name)})),this.config.layers){var c=this.config.layers[u];!1!==c.enabled&&c.data&&this.sources[c.data.source]&&(this.sources[c.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var t=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then((function(){return t.textureManager.createDefault(t.gl)}))}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var t in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[t].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var t in this.lights={},this.config.lights){var e;this.config.lights[t]&&"object"===gr(this.config.lights[t])&&((e=this.config.lights[t]).name=t.replace("-","_"),e.visible=!1!==e.visible,e.visible&&(this.lights[e.name]=ia.create(this.view,e)))}ia.inject(this.lights)}},{key:"setBackground",value:function(){var t,e=this.config.scene.background;this.background={},e&&e.color&&(this.background.color=yo.parseColor(e.color)),this.background.color||(this.background.color=[0,0,0,0]),1===this.background.color[3]?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map((function(t){return Math.floor(255*t)})).join(", "),")"):this.canvas.style.backgroundColor="transparent",(t=this.gl).clearColor.apply(t,Lr(this.background.color))}},{key:"setIntrospection",value:function(t){var e=this;return t!==this.introspection?(this.introspection=t||!1,this.updating++,this.updateConfig({normalize:!1}).then((function(){return e.updating--}))):Promise.resolve()}},{key:"updateConfig",value:function(t){var i=0<arguments.length&&void 0!==t?t:{},r=i.load_event,n=void 0!==r&&r,o=i.serialize_funcs,a=i.normalize,s=void 0===a||a;i.fade_in,this.generation=++e.generation,this.updating++,this.config=Of.applyGlobalProperties(this.config),s?Of.normalize(this.config,this.config_bundle):(Of.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),Of.normalizeTextures(this.config,this.config_bundle)),this.trigger(n?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),Tc.loadFonts(this.config.fonts),this.updateStyles();var l=this.syncConfigToWorker({serialize_funcs:o});return this.updating--,this.view.updateBounds(),this.requestRedraw(),l}},{key:"syncConfigToWorker",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).serialize_funcs,i=void 0===e||e?Tn.serializeWithFunctions(this.config):JSON.stringify(this.config);return un.postMessage(this._workers,"self.updateConfig",{config:i,generation:this.generation,introspection:this.introspection},ql)}},{key:"createListeners",value:function(){var t=this;this.listeners={},this.listeners.view={move:function(){return t.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return t.dirty=!0},warning:function(e){return t.trigger("warning",Object.assign({type:"textures"},e))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(e){return t.trigger("error",Object.assign({type:"scene"},e))}},Of.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),Of.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&un.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new Ho(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).background,i=void 0===e?"white":e;return this.requestRedraw(),this.media_capture.screenshot({background:i})}},{key:"pixelRatio",value:function(){return Tn.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(t){console.profile("main thread: ".concat(t)),un.postMessage(this._workers,"self.profile",t)}},{key:"_profileEnd",value:function(t){console.profileEnd("main thread: ".concat(t)),un.postMessage(this._workers,"self.profileEnd",t)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var t=this;return void 0!==this.config.scene.animated?this.config.scene.animated:this.tile_manager.getActiveStyles().some((function(e){return t.styles[e]&&t.styles[e].animated}))}}],[{key:"create",value:function(t,i){return new e(t,1<arguments.length&&void 0!==i?i:{})}}]),e}();Vf.id=0,Vf.generation=0;var qf=function(){wr(e,So);var t=Mr(e);function e(i,r,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};vr(this,e);var a=Math.pow(2,o.coords.z),s=Math.abs(Math.floor(o.coords.x/a)),l=Math.abs(a*s-Math.abs(o.coords.x)),u=o.coords;return o.coords={x:l,y:u.y,z:u.z},t.call(this,i,r,n,o)}return _r(e,[{key:"load",value:function(t){var i=this;if(!t||!t.uid)return Ir(xr(e.prototype),"load",this).call(this,t);var r=t.coords,n=new Uint8Array([0,0,0,0]);return this.loading=new Promise((function(e,o){var a=H.map.DataModel.invoke(t.uid,"requestTileAsPromise",[r.x,r.y,r.z])||null;a?a.then((function(e){var r=e.data;i.loaded=!0,!r||r instanceof ArrayBuffer||"IMG"!==r.tagName.toUpperCase()&&"CANVAS"!==r.tagName.toUpperCase()?i.setData(1,1,n,{filtering:"nearest"}):i.setElement(r,t)}),(function(){i.loaded=!1})).then(e,(function(t){return o(t)})):o(new Error("Unable to invoke on target "+t.uid))})),this.loading}}]),e}();Io.register(qf,(function(t){return t&&t.uid})),self.H=self.H||{},self.H.gl={DataSource:Rn,Geo:Qr,MathUtils:Xr,Scene:Vf,Task:To,Tile:pa,WorkerBroker:un,log:En,SceneLoader:Of,yaml:lf}}()},e(),this.H=this.H||{},this.H.venues=function(t){function e(t,e){void 0===e&&(e={});var i,r=e.insertAt;t&&"undefined"!=typeof document&&(i=document.head||document.getElementsByTagName("head")[0],(e=document.createElement("style")).type="text/css","top"===r&&i.firstChild?i.insertBefore(e,i.firstChild):i.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)))}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t,e){var i,r=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)),r}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e,i){return(f=p()?Reflect.construct:function(t,e,i){var r=[null];return r.push.apply(r,e),r=new(Function.bind.apply(t,r)),i&&h(r,i.prototype),r}).apply(null,arguments)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t){var e=p();return function(){var i,r=c(t);return i=e?(i=c(this).constructor,Reflect.construct(r,arguments,i)):r.apply(this,arguments),r=this,!(i=i)||"object"!=typeof i&&"function"!=typeof i?d(r):i}}function g(t,e,i){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){if(t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e),t)return(e=Object.getOwnPropertyDescriptor(t,e)).get?e.get.call(i):e.value})(t,e,i||t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);r=!0);}catch(t){n=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return i}}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}e(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg); }\n\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial; }\n");var w=function(){u(e,H.map.Feature);var t=y(e);function e(i){var n;return r(this,e),(n=t.call(this)).id=i.id,n.model=i,n}return o(e,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var t=(e=v(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),e}(),x=function(){u(e,H.map.Feature);var t=y(e);function e(i){var n;return r(this,e),(n=t.call(this)).id=i.id,n.model=i,n}return o(e,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return f(H.geo.Rect,m(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=v(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(t){return this.getLevels().find((function(e){return e.id===t}))}},{key:"getLevels",value:function(){var t=this.getData().getLevels().map((function(t){return t.getId()}));return this.getVenue().getLevels().filter((function(e){return-1!==t.indexOf(e.id)}))}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getId())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),e}(),E=function(){u(e,H.map.Feature);var t=y(e);function e(i){var n;return r(this,e),(n=t.call(this)).id=i.id,n.model=i,n}return o(e,[{key:"getGeometry",value:function(t){return this.getGeometries().find((function(e){return e.id===t}))}},{key:"getGeometries",value:function(){var t=this.getData().getGeometries().map((function(t){return t.getId()}));return this.getDrawing().getVenue().getGeometries().filter((function(e){return-1!==t.indexOf(e.id)}))}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),e}();function A(t,e,i,r){for(var n,o=r,a=i-e>>1,s=i-e,l=t[e],u=t[e+1],c=t[i],h=t[i+1],p=e+3;p<i;p+=3){var f=function(t,e,i,r,n,o){var a,s=n-i,l=o-r;return 0===s&&0===l||(1<(a=((t-i)*s+(e-r)*l)/(s*s+l*l))?(i=n,r=o):0<a&&(i+=s*a,r+=l*a)),(s=t-i)*s+(l=e-r)*l}(t[p],t[p+1],l,u,c,h);o<f?(n=p,o=f):f!==o||(f=Math.abs(p-a))<s&&(n=p,s=f)}r<o&&(3<n-e&&A(t,e,n,r),t[n+2]=o,3<i-n&&A(t,n,i,r))}function T(t,e,i,r){return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)k(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<e.length;r++)k(t,e[r]);else if("MultiPolygon"===i)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)k(t,e[r][n])}(r={id:void 0===t?null:t,type:e,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),r}function k(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function S(t,e,i,r){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===o)M(n,s);else if("MultiPoint"===o)for(var u=0;u<n.length;u++)M(n[u],s);else if("LineString"===o)I(n,s,a,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(u=0;u<n.length;u++)s=[],I(n[u],s,a,!1),t.push(T(l,"LineString",s,e.properties));return}O(n,s,a,!1)}else if("Polygon"===o)O(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(u=0;u<e.geometry.geometries.length;u++)S(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},i,r);return}for(u=0;u<n.length;u++){var c=[];O(n[u],c,a,!0),s.push(c)}}t.push(T(l,o,s,e.properties))}}function M(t,e){e.push(L(t[0])),e.push(C(t[1])),e.push(0)}function I(t,e,i,r){for(var n,o,a=0,s=0;s<t.length;s++){var l=L(t[s][0]),u=C(t[s][1]);e.push(l),e.push(u),e.push(0),0<s&&(a+=r?(n*u-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(u-o,2))),n=l,o=u}var c=e.length-3;e[2]=1,A(e,0,c,i),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function O(t,e,i,r){for(var n=0;n<t.length;n++){var o=[];I(t[n],o,i,r),e.push(o)}}function L(t){return t/360+.5}function C(t){return t=Math.sin(t*Math.PI/180),(t=.5-.25*Math.log((1+t)/(1-t))/Math.PI)<0?0:1<t?1:t}function R(t,e,i,r,n,o,a,s){if(r/=e,(i/=e)<=o&&a<r)return t;if(a<i||r<=o)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,f=0===n?c.minX:c.minY,d=0===n?c.maxX:c.maxY;if(i<=f&&d<r)l.push(c);else if(!(d<i||r<=f)){var y=[];if("Point"===p||"MultiPoint"===p)!function(t,e,i,r,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];i<=a&&a<=r&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}(h,y,i,r,n);else if("LineString"===p)N(h,y,i,r,n,!1,s.lineMetrics);else if("MultiLineString"===p)j(h,y,i,r,n,!1);else if("Polygon"===p)j(h,y,i,r,n,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var v=[];j(h[g],v,i,r,n,!0),v.length&&y.push(v)}if(y.length)if(s.lineMetrics&&"LineString"===p)for(g=0;g<y.length;g++)l.push(T(c.id,p,y[g],c.tags));else"LineString"!==p&&"MultiLineString"!==p||(1===y.length?(p="LineString",y=y[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===y.length?"Point":"MultiPoint"),l.push(T(c.id,p,y,c.tags))}}return l.length?l:null}function N(t,e,i,r,n,o,a){for(var s,l,u=P(t),c=0===n?z:F,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],y=t[p+2],g=t[p+3],v=t[p+4],m=0===n?f:d,_=0===n?g:v,b=!1;a&&(s=Math.sqrt(Math.pow(f-g,2)+Math.pow(d-v,2))),m<i?i<_&&(l=c(u,f,d,g,v,i),a&&(u.start=h+s*l)):r<m?_<r&&(l=c(u,f,d,g,v,r),a&&(u.start=h+s*l)):D(u,f,d,y),_<i&&i<=m&&(l=c(u,f,d,g,v,i),b=!0),r<_&&m<=r&&(l=c(u,f,d,g,v,r),b=!0),!o&&b&&(a&&(u.end=h+s*l),e.push(u),u=P(t)),a&&(h+=s)}var w=t.length-3;f=t[w],d=t[1+w],y=t[2+w],i<=(m=0===n?f:d)&&m<=r&&D(u,f,d,y),w=u.length-3,o&&3<=w&&(u[w]!==u[0]||u[1+w]!==u[1])&&D(u,u[0],u[1],u[2]),u.length&&e.push(u)}function P(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function j(t,e,i,r,n,o){for(var a=0;a<t.length;a++)N(t[a],e,i,r,n,o,!1)}function D(t,e,i,r){t.push(e),t.push(i),t.push(r)}function z(t,e,i,r,n,o){return e=(o-e)/(r-e),t.push(o),t.push(i+(n-i)*e),t.push(1),e}function F(t,e,i,r,n,o){return i=(o-i)/(n-i),t.push(e+(r-e)*i),t.push(o),t.push(1),i}function G(t,e){for(var i=[],r=0;r<t.length;r++){var n,o=t[r],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=B(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(B(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(B(o.geometry[s][u],e));n.push(l)}i.push(T(o.id,a,n,o.tags))}return i}function B(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var r=0;r<t.length;r+=3)i.push(t[r]+e,t[r+1],t[r+2]);return i}function U(t,e){if(t.transformed)return t;for(var i,r=1<<t.z,n=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],l=s.geometry,u=s.type;if(s.geometry=[],1===u)for(i=0;i<l.length;i+=2)s.geometry.push(V(l[i],l[i+1],e,r,n,o));else for(i=0;i<l.length;i++){for(var c=[],h=0;h<l[i].length;h+=2)c.push(V(l[i][h],l[i][h+1],e,r,n,o));s.geometry.push(c)}}return t.transformed=!0,t}function V(t,e,i,r,n,o){return[Math.round(i*(t*r-n)),Math.round(i*(e*r-o))]}function q(t,e,i,r,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,function(t,e,i,r){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Y(a,n,t,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)Y(a,n[s],t,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++)Y(a,u[s],t,i,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&r.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=n.start/n.size,c.mapbox_clip_end=n.end/n.size}r={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c},null!==e.id&&(r.id=e.id),t.features.push(r)}}(a,t[s],o,n);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Y(t,e,i,r,n,o){var a=r*r;if(0<r&&e.size<(n?a:r))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>a)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;n&&function(t,e){for(var i=0,r=0,n=t.length,o=n-2;r<n;o=r,r+=2)i+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(0<i===e)for(r=0,n=t.length;r<n/2;r+=2){var a=t[r],s=t[r+1];t[r]=t[n-2-r],t[r+1]=t[n-1-r],t[n-2-r]=a,t[n-1-r]=s}}(s,o),t.push(s)}}function W(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r,n,o,a,s=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)S(i,t.features[r],e,r);else"Feature"===t.type?S(i,t,e):S(i,{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(this.stats={},this.total=0),t=R(a=r=s,1,-1-(o=(n=e).buffer/n.extent),o,0,-1,2,n),e=R(r,1,1-o,2+o,0,-1,2,n),(t||e)&&(a=R(r,1,-o,1+o,0,-1,2,n)||[],t&&(a=G(t,1).concat(a)),e&&(a=a.concat(G(e,-1)))),(s=a).length&&this.splitTile(s,0,0,0),i&&s.length}function Z(t,e,i){return 32*((1<<t)*i+e)+t}function K(t){for(var e,i=[],r=[],n=0,o=t.coordinates.length;n<o;n+=1){var a=t.coordinates[n],s=function(t){return t=function(t){for(var e=0,i=t.length,r=0;r<i-1;r+=1){var n=t[r],o=t[r+1];e+=n[0]*o[1]-o[0]*n[1]}return e+(t[i-1][0]*t[0][1]-t[0][0]*t[i-1][1])}(t),0<t?rt:t<0?nt:void 0}(a);null!==s&&(s===(e=e||s)&&r.length&&(i.push(r),r=[]),r.push(a))}return 0<r.length&&i.push(r),1===i.length?(t.type=Q,t.coordinates=i[0]):1<i.length?(t.type=tt,t.coordinates=i):t=null,t}function X(t,e,i,r,n){var o;return n=(o=i,i=r,r=n,e=1<<(n=e),(n=[])[0]=((t=t)[0]/r+o)/e,n[1]=(t[1]/r+i)/e,e=i={x:n[0],y:n[1]}).x,i=e.y,e=360*(n-.5),n=Math.exp(Math.PI*(.5-i)/.25)-1,i=Math.exp(Math.PI*(.5-i)/.25)+1,[e,180*Math.asin(n/i)/Math.PI]}W.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},W.prototype.splitTile=function(t,e,i,r,n,o,a){for(var s=[t,e,i,r],l=this.options,u=l.debug;s.length;){r=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var c,h,p,f,d,y,g,v,m=1<<e,_=Z(e,i,r),b=this.tiles[_];if(b||(b=this.tiles[_]=q(t,e,i,r,l),this.tileCoords.push({z:e,x:i,y:r}),u&&(v="z"+e,this.stats[v]=(this.stats[v]||0)+1,this.total++)),b.source=t,n){if(e===l.maxZoom||e===n)continue;var w=1<<n-e;if(i!==Math.floor(o/w)||r!==Math.floor(a/w))continue}else if(e===l.indexMaxZoom||b.numPoints<=l.indexMaxPoints)continue;b.source=null,0!==t.length&&(h=.5-(c=.5*l.buffer/l.extent),p=1+c,g=f=d=y=null,v=R(t,m,i-c,i+(_=.5+c),0,b.minX,b.maxX,l),w=R(t,m,i+h,i+p,0,b.minX,b.maxX,l),t=null,v&&(g=R(v,m,r-c,r+_,1,b.minY,b.maxY,l),f=R(v,m,r+h,r+p,1,b.minY,b.maxY,l),v=null),w&&(d=R(w,m,r-c,r+_,1,b.minY,b.maxY,l),y=R(w,m,r+h,r+p,1,b.minY,b.maxY,l),w=null),s.push(g||[],e+1,2*i,2*r),s.push(f||[],e+1,2*i,2*r+1),s.push(d||[],e+1,2*i+1,2*r),s.push(y||[],e+1,2*i+1,2*r+1))}},W.prototype.getTile=function(t,e,i){var r=this.options,n=r.extent;if(r.debug,t<0||24<t)return null;if(r=Z(t,e=(e%(r=1<<t)+r)%r,i),this.tiles[r])return U(this.tiles[r],n);for(var o,a=t,s=e,l=i;!o&&0<a;)a--,s=Math.floor(s/2),l=Math.floor(l/2),o=this.tiles[Z(a,s,l)];return o&&o.source?(this.splitTile(o.source,a,s,l,t,e,i),this.tiles[r]?U(this.tiles[r],n):null):null};var J="Point",Q="Polygon",$="MultiLineString",tt="MultiPolygon",et={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},it={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},rt="CW",nt="CCW";function ot(t){var e=void 0===(o=t.addressList)?[]:o,i=void 0===(n=t.geometries)?[]:n,n=void 0===(o=t.entity)?null:o,o=void 0===(o=t.name)?"":o;t=void 0===(t=t.icon)?"":t,r(this,ot),this.addressList=e,this.geometries=i,this.icon=t,this.entity=n,this.name=o}var at,st,lt=(function(t){t.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==i(t)&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){function n(t){return(n="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(t){return i(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":i(t)})(t)}var o=r(1),a=(r=r(7)).get,s=(r.deepValue,r.isArray);function l(t,e){var i=void 0===(p=e.location)?0:p,r=void 0===(b=e.distance)?100:b,n=void 0===(f=e.threshold)?.6:f,o=void 0===(v=e.maxPatternLength)?32:v,s=void 0!==(d=e.caseSensitive)&&d,u=void 0===(_=e.tokenSeparator)?/ +/g:_,c=void 0!==(y=e.findAllMatches)&&y,h=void 0===(m=e.minMatchCharLength)?1:m,p=void 0===(g=e.id)?null:g,f=void 0===(b=e.keys)?[]:b,d=void 0===(v=e.shouldSort)||v,y=void 0===(_=e.getFn)?a:_,g=void 0===(m=e.sortFn)?function(t,e){return t.score-e.score}:m,v=void 0!==(b=e.tokenize)&&b,m=void 0!==(_=e.matchAllTokens)&&_,_=void 0!==(b=e.includeMatches)&&b,b=void 0!==(b=e.includeScore)&&b;e=void 0!==(e=e.verbose)&&e,function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),this.options={location:i,distance:r,threshold:n,maxPatternLength:o,isCaseSensitive:s,tokenSeparator:u,findAllMatches:c,minMatchCharLength:h,id:p,keys:f,includeMatches:_,includeScore:b,shouldSort:d,getFn:y,sortFn:g,verbose:e,tokenize:v,matchAllTokens:m},this.setCollection(t),this._processKeys(f)}(function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}})(l.prototype,[{key:"setCollection",value:function(t){return this.list=t}},{key:"_processKeys",value:function(t){if(this._keyWeights={},this._keyNames=[],t.length&&"string"==typeof t[0])for(var e=0,i=t.length;e<i;e+=1){var r=t[e];this._keyWeights[r]=1,this._keyNames.push(r)}else{for(var n=0,o=0,a=t.length;o<a;o+=1){var s=t[o];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var l=s.name;if(this._keyNames.push(l),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');if((s=s.weight)<0||1<s)throw new Error('"weight" property in key must bein the range of [0, 1)');n+=this._keyWeights[l]=s}if(1<n)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(t,e){var i=1<arguments.length&&void 0!==e?e:{limit:!1};return this._log('---------\nSearch pattern: "'.concat(t,'"')),t=(e=this._prepareSearchers(t)).tokenSearchers,e=e.fullSearcher,e=this._search(t,e),this._computeScore(e),this.options.shouldSort&&this._sort(e),i.limit&&"number"==typeof i.limit&&(e=e.slice(0,i.limit)),this._format(e)}},{key:"_prepareSearchers",value:function(t){t=0<arguments.length&&void 0!==t?t:"";var e=[];if(this.options.tokenize)for(var i=t.split(this.options.tokenSeparator),r=0,n=i.length;r<n;r+=1)e.push(new o(i[r],this.options));return{tokenSearchers:e,fullSearcher:new o(t,this.options)}}},{key:"_search",value:function(t,e){var i=0<arguments.length&&void 0!==t?t:[],r=1<arguments.length?e:void 0,n=this.list,o={},a=[];if("string"==typeof n[0]){for(var s=0,l=n.length;s<l;s+=1)this._analyze({key:"",value:n[s],record:s,index:s},{resultMap:o,results:a,tokenSearchers:i,fullSearcher:r});return a}for(var u=0,c=n.length;u<c;u+=1)for(var h=n[u],p=0,f=this._keyNames.length;p<f;p+=1){var d=this._keyNames[p];this._analyze({key:d,value:this.options.getFn(h,d),record:h,index:u},{resultMap:o,results:a,tokenSearchers:i,fullSearcher:r})}return a}},{key:"_analyze",value:function(t,e){var i=this,r=t.key,n=void 0===(l=t.arrayIndex)?-1:l,o=t.value,a=t.record,l=t.index,u=void 0===(t=e.tokenSearchers)?[]:t,c=e.fullSearcher,h=void 0===(t=e.resultMap)?{}:t,p=void 0===(e=e.results)?[]:e;!function t(e,n,o,a){if(null!=n)if("string"==typeof n){var l=!1,f=-1,d=0;i._log("\nKey: ".concat(""===r?"--":r));var y=c.search(n);if(i._log('Full text: "'.concat(n,'", score: ').concat(y.score)),i.options.tokenize){for(var g=n.split(i.options.tokenSeparator),v=g.length,m=[],_=0,b=u.length;_<b;_+=1){var w=u[_];i._log('\nPattern: "'.concat(w.pattern,'"'));for(var x=!1,E=0;E<v;E+=1){var A=g[E],T=w.search(A),k={};T.isMatch?(k[A]=T.score,x=l=!0,m.push(T.score)):(k[A]=1,i.options.matchAllTokens||m.push(1)),i._log('Token: "'.concat(A,'", score: ').concat(k[A]))}x&&(d+=1)}f=m[0];for(var S=m.length,M=1;M<S;M+=1)f+=m[M];f/=S,i._log("Token score average:",f)}var I=y.score;-1<f&&(I=(I+f)/2),i._log("Score average:",I);var O=!i.options.tokenize||!i.options.matchAllTokens||d>=u.length;i._log("\nCheck Matches: ".concat(O)),(l||y.isMatch)&&O&&(I={key:r,arrayIndex:e,value:n,score:I},i.options.includeMatches&&(I.matchedIndices=y.matchedIndices),(y=h[a])?y.output.push(I):(h[a]={item:o,output:[I]},p.push(h[a])))}else if(s(n))for(var L=0,C=n.length;L<C;L+=1)t(L,n[L],o,a)}(n,o,a,l)}},{key:"_computeScore",value:function(t){this._log("\n\nComputing score:\n");for(var e=this._keyWeights,i=!!Object.keys(e).length,r=0,n=t.length;r<n;r+=1){for(var o=t[r],a=o.output,s=a.length,l=1,u=0;u<s;u+=1){var c=(p=a[u]).key,h=i?e[c]:1,p=0===p.score&&e&&0<e[c]?Number.EPSILON:p.score;l*=Math.pow(p,h)}o.score=l,this._log(o)}}},{key:"_sort",value:function(t){this._log("\n\nSorting...."),t.sort(this.options.sortFn)}},{key:"_format",value:function(t){var e,i=[];this.options.verbose&&(e=[],this._log("\n\nOutput:\n\n",JSON.stringify(t,(function(t,i){if("object"===n(i)&&null!==i){if(-1!==e.indexOf(i))return;e.push(i)}return i}),2)),e=null);var r=[];this.options.includeMatches&&r.push((function(t,e){var i=t.output;e.matches=[];for(var r=0,n=i.length;r<n;r+=1){var o,a=i[r];0!==a.matchedIndices.length&&(o={indices:a.matchedIndices,value:a.value},a.key&&(o.key=a.key),a.hasOwnProperty("arrayIndex")&&-1<a.arrayIndex&&(o.arrayIndex=a.arrayIndex),e.matches.push(o))}})),this.options.includeScore&&r.push((function(t,e){e.score=t.score}));for(var o=0,a=t.length;o<a;o+=1){var s=t[o];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),r.length){for(var l={item:s.item},u=0,c=r.length;u<c;u+=1)r[u](s,l);i.push(l)}else i.push(s.item)}return i}},{key:"_log",value:function(){var t;this.options.verbose&&(t=console).log.apply(t,arguments)}}]),r=l,t.exports=r},function(t,e,i){var r=i(2),n=i(3),o=i(6);function a(t,e){var i=void 0===(h=e.location)?0:h,r=void 0===(l=e.distance)?100:l,n=void 0===(c=e.threshold)?.6:c,s=void 0===(u=e.maxPatternLength)?32:u,l=void 0!==(h=e.isCaseSensitive)&&h,u=void 0===(c=e.tokenSeparator)?/ +/g:c,c=void 0!==(h=e.findAllMatches)&&h,h=void 0===(h=e.minMatchCharLength)?1:h;e=void 0!==(e=e.includeMatches)&&e,function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.options={location:i,distance:r,threshold:n,maxPatternLength:s,isCaseSensitive:l,tokenSeparator:u,findAllMatches:c,includeMatches:e,minMatchCharLength:h},this.pattern=l?t:t.toLowerCase(),this.pattern.length<=s&&(this.patternAlphabet=o(this.pattern))}(function(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}})(a.prototype,[{key:"search",value:function(t){var e=(l=this.options).isCaseSensitive,i=l.includeMatches;if(e||(t=t.toLowerCase()),this.pattern===t){var o={isMatch:!0,score:0};return i&&(o.matchedIndices=[[0,t.length-1]]),o}var a=this.options,s=a.maxPatternLength,l=a.tokenSeparator;return this.pattern.length>s?r(t,this.pattern,l):(o=(e=this.options).location,a=e.distance,s=e.threshold,l=e.findAllMatches,e=e.minMatchCharLength,n(t,this.pattern,this.patternAlphabet,{location:o,distance:a,threshold:s,findAllMatches:l,minMatchCharLength:e,includeMatches:i}))}}]),i=a,t.exports=i},function(t,e){var i=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;t.exports=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g,n=(r=new RegExp(e.replace(i,"\\$&").replace(r,"|")),t.match(r)),o=[];if(r=!!n)for(var a=0,s=n.length;a<s;a+=1){var l=n[a];o.push([t.indexOf(l),l.length-1])}return{score:r?.5:1,isMatch:r,matchedIndices:o}}},function(t,e,i){var r=i(4),n=i(5);t.exports=function(t,e,i,o){for(var a=void 0===(c=o.location)?0:c,s=void 0===(l=o.distance)?100:l,l=void 0===(c=o.threshold)?.6:c,u=void 0!==(c=o.findAllMatches)&&c,c=void 0===(c=o.minMatchCharLength)?1:c,h=(o=void 0!==(o=o.includeMatches)&&o,a),p=t.length,f=l,d=t.indexOf(e,h),y=e.length,g=[],v=0;v<p;v+=1)g[v]=0;-1!==d&&(l=r(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),f=Math.min(l,f),-1!==(d=t.lastIndexOf(e,h+y))&&(L=r(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),f=Math.min(L,f))),d=-1;for(var m=[],_=1,b=y+p,w=1<<(y<=31?y-1:30),x=0;x<y;x+=1){for(var E=0,A=b;E<A;)r(e,{errors:x,currentLocation:h+A,expectedLocation:h,distance:s})<=f?E=A:b=A,A=Math.floor((b-E)/2+E);b=A;var T=Math.max(1,h-A+1),k=u?p:Math.min(h+A,p)+y,S=Array(k+2);S[k+1]=(1<<x)-1;for(var M=k;T<=M;--M){var I=M-1,O=i[t.charAt(I)];if(O&&(g[I]=1),S[M]=(S[M+1]<<1|1)&O,0!==x&&(S[M]|=(m[M+1]|m[M])<<1|1|m[M+1]),S[M]&w&&(_=r(e,{errors:x,currentLocation:I,expectedLocation:h,distance:s}))<=f){if(f=_,(d=I)<=h)break;T=Math.max(1,2*h-d)}}if(r(e,{errors:x+1,currentLocation:h,expectedLocation:h,distance:s})>f)break;m=S}var L={isMatch:0<=d,score:0===_?.001:_};return o&&(L.matchedIndices=n(g,c)),L}},function(t,e){t.exports=function(t,e){var i=void 0===(r=e.errors)?0:r,r=void 0===(n=e.currentLocation)?0:n,n=void 0===(n=e.expectedLocation)?0:n;return e=void 0===(e=e.distance)?100:e,t=i/t.length,r=Math.abs(n-r),e?t+r/e:r?1:t}},function(t,e){t.exports=function(){for(var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=[],n=-1,o=0,a=e.length;o<a;o+=1){var s=e[o];s&&-1===n?n=o:s||-1===n||((t=o-1)-n+1>=i&&r.push([n,t]),n=-1)}return e[o-1]&&i<=o-n&&r.push([n,o-1]),r}},function(t,e){t.exports=function(t){for(var e={},i=t.length,r=0;r<i;r+=1)e[t.charAt(r)]=0;for(var n=0;n<i;n+=1)e[t.charAt(n)]|=1<<i-n-1;return e}},function(t,e){function i(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function r(t){return null==t?"":function(){if("string"==typeof t)return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}()}function n(t){return"string"==typeof t}function o(t){return"number"==typeof t}t.exports={get:function(t,e){var a=[];return function t(e,s){if(s){var l=s.indexOf("."),u=s,c=null;-1!==l&&(u=s.slice(0,l),c=s.slice(l+1));var h=e[u];if(null!=h)if(c||!n(h)&&!o(h))if(i(h))for(var p=0,f=h.length;p<f;p+=1)t(h[p],c);else c&&t(h,c);else a.push(r(h))}else a.push(e)}(t,e),a},isArray:i,isString:n,isNum:o,toString:r}}])}(at={exports:{}}),at.exports),ut=(st=lt)&&st.__esModule&&Object.prototype.hasOwnProperty.call(st,"default")?st.default:st,ct=(lt.Fuse,{keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2}),ht=function(){function t(e){r(this,t),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=e,this.init()}return o(t,[{key:"init",value:function(){var t=this.venueModel.getGeometries().reduce((function(t,e){return t[e.getId()]=e,t}),{});this.initEntityList(this.venueModel.entities),this.initIconList(t),this.levels_=this.venueModel.getLevels().map((function(t){return{levelId:t.getId(),levelName:t.getName(),drawingId:t.getDrawing().getId(),drawingName:t.getDrawing().getName()}})),t=[].concat(m(this.searchListEntities_),m(this.searchListIcons_)),this.searchList_=t.sort((function(t,e){return t.name.localeCompare(e.name)})),this.fuseSearch_=new ut(this.searchList_,ct)}},{key:"initEntityList",value:function(t){t=(0<arguments.length&&void 0!==t?t:[]).map((function(t){return new ot({geometries:t.getGeometries(),addressList:t.getInternalAddress()||[],name:t.getName()||"",entity:t})})),this.searchListEntities_=t}},{key:"initIconList",value:function(t){t=0<arguments.length&&void 0!==t?t:{},this.searchListIcons_=Object.values(t).filter((function(t){return t.getIcon()})).map((function(t){var e=t.getIcon();return new ot({geometries:[t],icon:e.getSVG(),name:e.ar||""})}))}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var t=this.searchListIcons_.reduce((function(t,e){return t[e.name]=e.name,t}),{});return Object.keys(t)}},{key:"find",value:function(t){return""===(t=0<arguments.length&&void 0!==t?t:"")?this.searchList_:this.fuseSearch_.search(t)}},{key:"groupByLevel",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.searchList_;return this.levels_?m(this.levels_.flatMap((function(t){return l(l({},t),{},{results:e.filter((function(e){return i=t,0<(e=e).geometries.length&&e.geometries.find((function(t){return Number(t.getLevel().getId())===Number(i.levelId)}));var i}))})}))):[]}}]),t}(),pt="Point",ft="LineString",dt="Polygon",yt="MultiPoint",gt="MultiLineString",vt="MultiPolygon",mt=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),_t=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),bt=Object.freeze((a(_e={},_t.THEME,"themeUrls"),a(_e,_t.THEME_MAP,"themeMapUrl"),a(_e,_t.PRESETS,"presetsUrl"),a(_e,_t.SDK_STRINGS,"stringsUrl"),_e)),wt=Object.freeze((a(Oe={},_t.THEME,"themeOverrides"),a(Oe,_t.THEME_MAP,"themeMapOverrides"),a(Oe,_t.PRESETS,"presetOverrides"),a(Oe,_t.SDK_STRINGS,"stringsOverrides"),a(Oe,_t.INPUT_COLORS,"inputColorOverrides"),Oe)),xt=(Object.freeze((a(At={},_t.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),a(At,_t.SDK_STRINGS,["Standard","SDK","sdk/standard"]),a(At,_t.V4_THEME_FAMILY,["modern","standard"]),a(At,_t.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),a(At,_t.NAV_THEME,["Factory","MapEditor"]),a(At,_t.ICON,["Multicolor","Standard","TheBase","Factory"]),At)),Object.freeze((a(_e={},_t.THEME,"Modern"),a(_e,_t.THEME_MAP,"Standard"),a(_e,_t.PRESETS,"Standard"),a(_e,_t.SDK_STRINGS,"Standard"),a(_e,_t.ICON_FILE,"Standard"),a(_e,_t.INPUT_COLORS,"Standard"),a(_e,_t.BASE_MAP_INFO,"Standard"),a(_e,_t.CONFIG_PROFILE,"factory"),a(_e,_t.NAV_THEME,"Factory"),a(_e,_t.NAV_NAME_THEME,"FactoryName"),a(_e,_t.NAV_PROP_MAP,"Standard"),a(_e,_t.NAV_STRINGS,"Standard"),a(_e,_t.NAV_THEME_MAP,"Standard"),a(_e,_t.NAV_NAME_THEME_MAP,"StandardName"),a(_e,_t.V4_THEME_FAMILY,"Standard"),a(_e,_t.V4_MAPTYPE_THEME,"Standard"),a(_e,_t.ICON,"Multicolor"),a(_e,_t.MARKER,"Standard"),_e))),Et=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"}),At=Object.freeze((a(Oe={},Et.V5_MAP,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_DIRECTORY:"COMMUNITY_DIRECTORY",COMMUNITY_DETAIL:"COMMUNITY_DETAIL",LEVEL_GEOMETRY:"LEVEL_GEOMETRY",DRAWING_ENTITY:"DRAWING_ENTITY"}),a(Oe,Et.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"}),a(Oe,Et.V5_NAV,{JSON_NAV:"JSON_NAV",BINARY_NAV:"BINARY_NAV",JSON_ENHANCED_NAV:"JSON_ENHANCED_NAV",BINARY_ENHANCED_NAV:"BINARY_ENHANCED_NAV"}),a(Oe,Et.V5_INFO,{GEOMETRY_INFO:"GEOMETRY_INFO"}),a(Oe,Et.SVG,{PLAIN:"PLAIN",PRETTY:"PRETTY",PRETTY_HORIZONTAL_LABEL:"PRETTY_HORIZONTAL_LABEL"}),a(Oe,Et.KML,{RASTER:"RASTER",VECTOR:"VECTOR",RASTER_HORIZONTAL:"RASTER_HORIZONTAL",VECTOR_HORIZONTAL:"VECTOR_HORIZONTAL"}),a(Oe,Et.PNG,{LOW_RESOLUTION:"LOW_RESOLUTION",HIGH_RESOLUTION:"HIGH_RESOLUTION",LOW_RESOLUTION_GEO:"LOW_RESOLUTION_GEO",HIGH_RESOLUTION_GEO:"HIGH_RESOLUTION_GEO",LOW_RESOLUTION_HORIZONTAL:"LOW_RESOLUTION_HORIZONTAL",HIGH_RESOLUTION_HORIZONTAL:"HIGH_RESOLUTION_HORIZONTAL",LOW_RESOLUTION_HORIZONTAL_GEO:"LOW_RESOLUTION_HORIZONTAL_GEO",HIGH_RESOLUTION_HORIZONTAL_GEO:"HIGH_RESOLUTION_HORIZONTAL_GEO"}),Oe));function Tt(){}function kt(){kt.init.call(this)}function St(t){return void 0===t._maxListeners?kt.defaultMaxListeners:t._maxListeners}function Mt(t,e,i,r){var n,o;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');return(n=t._events)?(n.newListener&&(t.emit("newListener",e,i.listener||i),n=t._events),o=n[e]):(n=t._events=new Tt,t._eventsCount=0),o?("function"==typeof o?o=n[e]=r?[i,o]:[o,i]:r?o.unshift(i):o.push(i),o.warned||(r=St(t))&&0<r&&o.length>r&&(o.warned=!0,(r=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",r.emitter=t,r.type=e,r.count=o.length,console.warn)):(o=n[e]=i,++t._eventsCount),t}function It(t,e,i){var r=!1;function n(){t.removeListener(e,n),r||(r=!0,i.apply(t,arguments))}return n.listener=i,n}function Ot(t){var e=this._events;if(e){if("function"==typeof(t=e[t]))return 1;if(t)return t.length}return 0}function Lt(t,e){for(var i=new Array(e);e--;)i[e]=t[e];return i}Tt.prototype=Object.create(null),(kt.EventEmitter=kt).usingDomains=!1,kt.prototype.domain=void 0,kt.prototype._events=void 0,kt.prototype._maxListeners=void 0,kt.defaultMaxListeners=10,kt.init=function(){this.domain=null,kt.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Tt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},kt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},kt.prototype.getMaxListeners=function(){return St(this)},kt.prototype.emit=function(t,e,i,r){var n,o,a,s="error"===t,l=this._events;if(l)s=s&&null==l.error;else if(!s)return!1;if(u=this.domain,s){if(s=e,u)return(s=s||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,s.domain=u,s.domainThrown=!1,u.emit("error",s),!1;if(s instanceof Error)throw s;var u=new Error('Uncaught, unspecified "error" event. ('+s+")");throw u.context=s,u}if(!(n=l[t]))return!1;var c,h="function"==typeof n;switch(c=arguments.length){case 1:!function(t,e,i){if(e)t.call(i);else for(var r=t.length,n=Lt(t,r),o=0;o<r;++o)n[o].call(i)}(n,h,this);break;case 2:!function(t,e,i,r){if(e)t.call(i,r);else for(var n=t.length,o=Lt(t,n),a=0;a<n;++a)o[a].call(i,r)}(n,h,this,e);break;case 3:!function(t,e,i,r,n){if(e)t.call(i,r,n);else for(var o=t.length,a=Lt(t,o),s=0;s<o;++s)a[s].call(i,r,n)}(n,h,this,e,i);break;case 4:!function(t,e,i,r,n,o){if(e)t.call(i,r,n,o);else for(var a=t.length,s=Lt(t,a),l=0;l<a;++l)s[l].call(i,r,n,o)}(n,h,this,e,i,r);break;default:for(o=new Array(c-1),a=1;a<c;a++)o[a-1]=arguments[a];!function(t,e,i,r){if(e)t.apply(i,r);else for(var n=t.length,o=Lt(t,n),a=0;a<n;++a)o[a].apply(i,r)}(n,h,this,o)}return!0},kt.prototype.addListener=function(t,e){return Mt(this,t,e,!1)},kt.prototype.on=kt.prototype.addListener,kt.prototype.prependListener=function(t,e){return Mt(this,t,e,!0)},kt.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,It(this,t,e)),this},kt.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,It(this,t,e)),this},kt.prototype.removeListener=function(t,e){var i,r,n,o,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(i=r[t]))return this;if(i===e||i.listener&&i.listener===e)0==--this._eventsCount?this._events=new Tt:(delete r[t],r.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,o=i.length;0<o--;)if(i[o]===e||i[o].listener&&i[o].listener===e){a=i[o].listener,n=o;break}if(n<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new Tt,this;delete r[t]}else!function(t,e){for(var i=e,r=i+1,n=t.length;r<n;i+=1,r+=1)t[i]=t[r];t.pop()}(i,n);r.removeListener&&this.emit("removeListener",t,a||e)}return this},kt.prototype.removeAllListeners=function(t){var e,i=this._events;if(!i)return this;if(!i.removeListener)return 0===arguments.length?(this._events=new Tt,this._eventsCount=0):i[t]&&(0==--this._eventsCount?this._events=new Tt:delete i[t]),this;if(0===arguments.length){for(var r,n=Object.keys(i),o=0;o<n.length;++o)"removeListener"!==(r=n[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Tt,this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);return this},kt.prototype.listeners=function(t){var e=this._events,i=e&&(i=e[t])?"function"==typeof i?[i.listener||i]:function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(i):[];return i},kt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Ot.call(t,e)},kt.prototype.listenerCount=Ot,kt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var Ct="venues-ui-button--active",Rt="venues-ui-button",Nt="venues-ui__drawings",Pt="data-drawing",jt=function(){function t(e,i,n){var o=this;r(this,t),this.clickHandler=n,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",Nt);var a=document.createElement("div");a.setAttribute("class","trigger ".concat(Rt)),(n=document.createElement("div")).setAttribute("class","arrow arrow--down"),a.appendChild(n),a.addEventListener("click",(function(){a.classList.toggle(Ct),o.containerButtons.classList.toggle("drawings--open")})),this.containerDiv.appendChild(a),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),i&&this.update(i),e.appendChild(this.containerDiv)}return o(t,[{key:"drawButton",value:function(t,e,i){var r=this,n=document.createElement("div");i=Number(i)===Number(t),n.setAttribute("class",i?"".concat(Rt," ").concat(Ct):Rt),n.innerHTML=e,n.setAttribute(Pt,t),n.addEventListener("click",(function(){r.switch(t),r.clickHandler(t)})),this.containerButtons.appendChild(n)}},{key:"switch",value:function(t){this.containerButtons.querySelectorAll(".".concat(Nt," .").concat(Ct)).forEach((function(t){return t.setAttribute("class",Rt)})),(t=this.containerButtons.querySelector("[".concat(Pt,"='").concat(t,"']")))&&t.setAttribute("class","".concat(Rt," ").concat(Ct))}},{key:"update",value:function(t){var e=this;this.containerButtons.innerHTML="";var i=function(t){return t=t.getDrawings(),new Map(t.map((function(t){var e=t.getDisplayName()||t.getName();return[t.getId(),e]})))}(t);0<i.size&&i.forEach((function(i,r){return e.drawButton(r,i,t.getRootDrawing().getId())}))}}]),t}(),Dt="venues-ui-button--active",zt="venues-ui-button",Ft="levels",Gt="data-level",Ht="venues-ui__levels",Bt=function(){function t(e,i,n,o){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4;r(this,t),this.clickHandler=o,this.levelButtonCount=a,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(Ht)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class",Ft),this.containerUI.appendChild(this.containerButtons),i&&this.update(i,n),e.appendChild(this.containerUI)}return o(t,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(t,e){var i=this,r=document.createElement("div");r.innerHTML=e,r.style.fontSize="".concat(Math.max(Math.min(28.8/e.length,11.52),10),"px"),r.style.display="block",r.setAttribute("class",zt),r.setAttribute(Gt,t),r.addEventListener("click",(function(){i.switch(t),i.clickHandler(t)})),this.containerButtons.appendChild(r)}},{key:"drawScrollButtons",value:function(){var t=this;this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(zt," ").concat(zt,"--up"));var e=document.createElement("div");e.setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(e),this.buttonScrollUp.addEventListener("click",(function(){return t.scroll(1)})),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(zt," ").concat(zt,"--down")),(e=document.createElement("div")).setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(e),this.buttonScrollDown.addEventListener("click",(function(){return t.scroll(-1)})),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(t){var e,i=0<arguments.length&&void 0!==t?t:0,r=Array.from(this.containerButtons.querySelectorAll(".".concat(zt))).reverse(),n=[];0<=i?(this.currentScrollIndex=Math.min(this.currentScrollIndex+i,r.length-this.levelButtonCount),t=Math.min(this.currentScrollIndex,r.length-this.levelButtonCount),e=Math.min(this.currentScrollIndex+this.levelButtonCount,r.length),n=r.slice(t,e)):i<0&&(this.currentScrollIndex=Math.max(this.currentScrollIndex+i,0),e=Math.max(0,this.currentScrollIndex),i=Math.min(r.length,this.currentScrollIndex+this.levelButtonCount),n=r.slice(e,i)),r.forEach((function(t){-1!==n.indexOf(t)?t.style.display="block":t.style.display="none"})),this.buttonScrollDown&&(0===this.currentScrollIndex?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===r.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(t){this.containerButtons.querySelectorAll(".".concat(Dt)).forEach((function(t){return t.setAttribute("class",zt)}));var e=this.containerButtons.querySelector(".".concat(Ht," [").concat(Gt,"='").concat(t,"']"));e&&(t=Array.from(this.containerButtons.querySelectorAll(".".concat(zt))).reverse(),e.setAttribute("class","".concat(zt," ").concat(Dt)),((e=t.indexOf(e))<this.currentScrollIndex||e>=this.currentScrollIndex+4)&&this.scroll(e-this.currentScrollIndex))}},{key:"update",value:function(t,e){var i=this,r=(e=function(t){return new Map((0<arguments.length&&void 0!==t?t:[]).map((function(t){return[t.getZIndex(),t.getShortName()||t.getDisplayName()||t.getName()]})))}(function(t,e){return e!==mt.FLATTEN?t.getLevels():(t=t.getVenueModel().getLevelMapFlattenedByZIndex_(),Object.values(t).map((function(t){return t[0]})))}(t,e).sort((function(t,e){return e.getZIndex()-t.getZIndex()}))),t.getMainLevel().getZIndex());this.clear(),e.forEach((function(t,e){return i.drawLevelButton(e,t)})),e.size>this.levelButtonCount&&(e.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(e).reverse().findIndex((function(t){return t[0]===r})),e.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(r)}}]),t}(),Ut={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED"},Vt=(Object.freeze((a(_e={},Ut.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),a(_e,Ut.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),a(_e,Ut.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),a(_e,Ut.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),a(_e,Ut.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),a(_e,Ut.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),a(_e,Ut.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),a(_e,Ut.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),a(_e,Ut.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),_e)),new kt);function qt(t,e){var i,r,n,o,a=0;Object.keys(e).forEach((function(s){for(i=e[s],null==(n=i.priority)&&(n=0),o=!1;!o;)a<t.length?null==(r=(r=t[a]).priority)&&(r=0):r=Number.MAX_VALUE,n<=r&&(t.splice(a,0,i),o=!0),a+=1}))}Vt.EVENT_NAME=Ut,Vt.on("newListener",(function(t){}));var Yt=Math.PI/180,Wt=180/Math.PI,Zt=function(){function t(){r(this,t)}return o(t,null,[{key:"toRadians",value:function(t){return t*Yt}},{key:"toDegrees",value:function(t){return t*Wt}},{key:"getInverseTransform",value:function(t){var e=t[0]*t[3]-t[1]*t[2];return(e=[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,0,0])[4]=-(e[0]*t[4]+e[2]*t[5]),e[5]=-(e[1]*t[4]+e[3]*t[5]),e}},{key:"applyTransformToPoint",value:function(t,e){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}},{key:"transformProduct",value:function(t,e){var i=[0,0,0,0,0,0];return i[0]=e[0]*t[0]+e[2]*t[1],i[1]=e[1]*t[0]+e[3]*t[1],i[2]=e[0]*t[2]+e[2]*t[3],i[3]=e[1]*t[2]+e[3]*t[3],i[4]=e[0]*t[4]+e[2]*t[5]+e[4],i[5]=e[1]*t[4]+e[3]*t[5]+e[5],i}},{key:"convertLonLatToMerc",value:function(t){var e=t[0]*Yt;return t=t[1]*Yt,t=Math.sin(t),[.5+e/(2*Math.PI),.5-Math.log((1+t)/(1-t))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(t){var e=2*Math.PI*(t[0]-.5);return t=Math.atan(Math.sinh(2*Math.PI*(.5-t[1]))),[e/Yt,t/Yt]}},{key:"getTransformScale",value:function(t){return Math.sqrt(t[0]*t[3]-t[1]*t[2])}},{key:"getLonLatToMercTransform",value:function(e){var i=[1/360,0,0,-1/(360*Math.cos(e[1]*Yt)),0,0],r=t.applyTransformToPoint(i,e);return e=t.convertLonLatToMerc(e),i[4]=e[0]-r[0],i[5]=e[1]-r[1],i}},{key:"getNatToMercTransform",value:function(e){var i=[e[4],e[5]];return i=t.getLonLatToMercTransform(i),t.transformProduct(e,i)}},{key:"convertMxMy2LonLat",value:function(e,i){return e.length&&i.length?t.applyTransformToPoint(e,i):[]}},{key:"convertLonLat2MxMy",value:function(e,i){return e.length&&i.length?(e=t.getInverseTransform(e),t.applyTransformToPoint(e,i)):[]}},{key:"getFlattenedQuadraticBezierCurve",value:function(t,e,i,r){var n=[],o=3<arguments.length&&void 0!==r?r:10;o<1&&(o=6);for(var a=0;a<=o;a+=1){var s=(1-(c=a/o))*(1-c),l=2*c*(1-c),u=c*c,c=s*t[0]+l*e[0]+u*i[0];u=s*t[1]+l*e[1]+u*i[1],n.push([c,u])}return n}},{key:"getFlattenedCubicBezierCurve",value:function(t,e,i,r,n){var o=[],a=4<arguments.length&&void 0!==n?n:10;a<1&&(a=6);for(var s=0;s<=a;s+=1){var l=(1-(p=s/a))*(1-p)*(1-p),u=3*p*(1-p)*(1-p),c=3*p*p*(1-p),h=p*p*p,p=l*t[0]+u*e[0]+c*i[0]+h*r[0];h=l*t[1]+u*e[1]+c*i[1]+h*r[1],o.push([p,h])}return o}},{key:"getRectangularCoordinatesOfLabelArea",value:function(e,i,r){var n=!(2<arguments.length&&void 0!==r)||r,o=(u=v(e,6))[0],a=u[1],s=u[2],l=u[3],u=(r=u[5],t.getDeltaLonLatForMeterAtGivenLonLat(o,a));return e=e[4],n?(r&&(e*=-1),null!=i&&(e=(e+=i<0?2*Math.PI+i:i)<0?2*Math.PI+e:e)):e=0,t.getRectVerticesFromSignatureRectRepresentation([o,a],{xLength:s,yLength:l},e,u)}},{key:"getRotatedPoint",value:function(t,e,i,r){var n=!(2<arguments.length&&void 0!==i)||i,o=3<arguments.length&&void 0!==r?r:[0,0],a=Math.cos(e);return i=Math.sin(e),r=t[0]-o[0],e=t[1]-o[1],t=[],[(t=n?[r*a+e*i,e*a-r*i]:[r*a-e*i,e*a+r*i])[0]+o[0],t[1]+o[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(e,i,r,n,o){var a=i.xLength,s=(i=i.yLength,!(4<arguments.length&&void 0!==o)||o),l=(e=v(e,2))[0],u=e[1],c=a/2,h=i/2,p=(n=v(n,2))[0],f=n[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map((function(t){return[t[0]*c,t[1]*h]})).map((function(e){return t.getRotatedPoint(e,r,s)})).map((function(t){return[t[0]*p,t[1]*f]})).map((function(t){return[t[0]+l,t[1]+u]}))}},{key:"getScaleFactorForRectInSpace",value:function(t,e,i,r){return(r=e/r)<(i=t/i)?r:i}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(t,e){return[1/6371e3*(180/Math.PI)/Math.cos(e*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(t){var e=0<arguments.length&&void 0!==t?t:[];return t=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]],e.reduce((function(t,e){return[[Math.min(e[0],t[0][0]),Math.min(e[1],t[0][1])],[Math.max(e[0],t[1][0]),Math.max(e[1],t[1][1])]]}),t)}},{key:"isPointInBoundingBox",value:function(t,e){if(t&&e){var i=(o=v(t,2))[0],r=o[1],n=v(e,2),o=(t=v(n[0],2))[0];return e=t[1],n=(t=v(n[1],2))[0],t=t[1],i<=n&&o<=i&&r<=t&&e<=r}}},{key:"isPointOnLineSegment",value:function(t,e,i){var r=(o=v(t,2))[0],n=o[1],o=(t=(a=v(e,2))[0],a[1]),a=(e=v(i,2))[0];return e=(o-n)*((i=e[1])-n)<=0,t===a?t===r&&e:n-i==(i-o)/(a-t)*(r-a)&&e}},{key:"rayIntersectLineSegment",value:function(t,e,i){var r=(o=v(t,2))[0],n=o[1],o=(t=v(e,2))[0];return e=t[1],i=(t=v(i,2))[0],t=t[1],o!==i&&0<=(o=(r-o)/(i-o))&&o<1&&n<(t-e)*o+e}},{key:"isPointInPolygon",value:function(e,i){var r=(e=v(e,2))[0],n=e[1];if((e=i.length)<3)return!1;var o=0,a=i[e-1];return i.forEach((function(e){t.rayIntersectLineSegment([r,n],a,e)&&(o+=1),a=e})),o%2!=0}},{key:"isPointOnLineString",value:function(e,i){var r=(e=v(e,2))[0],n=e[1],o=i.length;if(o<2)return!1;for(var a=i[o-1],s=0;s<o;s+=1){var l=i[s];if(t.isPointOnLineSegment([r,n],a,l))return!0;a=i[s]}return!1}},{key:"getAreaOfPolygon",value:function(t){var e=t.length;if(e<3)return null;var i=0,r=t[e-1];return t.forEach((function(t){var e,n,o,a;i+=.5*(n=t,a=(o=v(r,2))[0],e=o[1],n=(o=v(n,2))[0],a*o[1]-e*n),r=t})),i}},{key:"getDistanceBetweenPoints",value:function(t,e){t=(i=v(t,2))[0];var i=i[1];return t-=(e=v(e,2))[0],e=i-e[1],Math.sqrt(t*t+e*e)}}]),t}(),Kt=function(){function t(){r(this,t)}return o(t,null,[{key:"get",value:function(t,e){return fetch(t,1<arguments.length&&void 0!==e?e:{method:"GET"}).then((function(e){return e.ok?e.json():Promise.reject(new Error("Call failed for ".concat(t," : ").concat(e.status," ").concat(e.statusText)))}))}}]),t}(),Xt=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];r(this,t),e&&Object.assign(this,e),this.splitIconGeomBasisGeomType_=i,this.splitIconGeomBasisGeomType_&&this.splitMultiGeom()}return o(t,[{key:"flattenIconShape",value:function(t){var e,i=0<arguments.length&&void 0!==t&&t;this.isFlattened||(e=[],(t=this.g)&&t.forEach((function(t){var i,r=[];t.shp&&t.shp.forEach((function(t){var e,n=v(t,7),o=n[0],a=n[1],s=n[2],l=n[3],u=n[4],c=n[5],h=n[6];switch(o){case 0:case 1:r.push(t),i=[a,s];break;case 2:e=Zt.getFlattenedQuadraticBezierCurve(i,[a,s],[l,u]),i=[l,u];break;case 3:e=Zt.getFlattenedCubicBezierCurve(i,[a,s],[l,u],[c,h]),i=[c,h];break;case 4:r.push(t),i=void 0}e&&(e.splice(0,2),e.forEach((function(t){r.push([1].concat(m(t)))})))})),e.push(l(l({},t),{shp:r}))})),i&&(this.g_original=t),this.g=e,this.isFlattened=!0)}},{key:"splitMultiGeom",value:function(){var e=this;if(this.isIconGeomSplittedBasisGeomType)return this.isIconWithHole;this.splitIconGeomBasisGeomType_||(this.splitIconGeomBasisGeomType_=!0);var i=this.g,r=[],n=[],o=!1,a=!0,s=-1;return!!i&&(i.forEach((function(i){var u,c=[],h=[];3===i.gt||(i.shp.forEach((function(t){var e=v(t,7),o=e[0],p=e[1],f=e[2],d=e[3],y=e[4],g=e[5],_=e[6],b=null;switch(o){case 0:c.push([p,f]),u=[p,f],a||1!==s&&0!==s||r.push(l(l({},i),{},{st:2},{gt:s,shp:n})),s=0,a=!(n=[]),n.push(t);break;case 1:c.push([p,f]),u=[p,f],2===s||0!==s&&1!==s||(s=1,n.push(t));break;case 2:(b=Zt.getFlattenedQuadraticBezierCurve(u,[p,f],[d,y],15)).splice(0,2),c.push.apply(c,m(b)),u=[d,y],2===s||0!==s&&1!==s||(s=1,n.push(t));break;case 3:(b=Zt.getFlattenedCubicBezierCurve(u,[p,f],[d,y],[g,_],15)).splice(0,2),c.push.apply(c,m(b)),u=[g,_],2===s||0!==s&&1!==s||(s=1,n.push(t));break;case 4:n.push(t),s=2,a=!0,2<c.length&&h.push({shp:n,area:Zt.getAreaOfPolygon(c),points:c,children:[]}),u=void 0,c=[]}}),e),t.getLinkedParentChildPolygonArray(h).forEach((function(t){var e=[];e.push.apply(e,m(t.shp)),t.children.forEach((function(t){o=!0,e.push.apply(e,m(t.shp))})),r.push(l(l({},i),{},{st:2},{gt:2,shp:e}))})))}),this),this.g=r,this.isIconGeomSplittedBasisGeomType=!0,this.isIconWithHole=o,this.isIconWithHole)}},{key:"getIconWithOriginTranslatedToIconCenter",value:function(){var e=new t(this,this.splitIconGeomBasisGeomType_),i=Number.parseInt(e.w,10)/2*1,r=Number.parseInt(e.h,10)/2*1;return e.g=[],this.g&&this.g.forEach((function(t){var n=[];t.shp&&t.shp.forEach((function(t){var e=v(t,7),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6];switch(o){case 0:case 1:n.push([o,a-i,s-r]);break;case 2:n.push([o,a-i,s-r,l-i,u-r]);break;case 3:n.push([o,a-i,s-r,l-i,u-r,c-i,h-r]);break;case 4:n.push(t)}})),e.g.push(l(l({},t),{shp:n}))})),e}},{key:"getTransformedIconThatFitsInLabelArea",value:function(e,i,r){var n=1<arguments.length&&void 0!==i?i:0,o=(i=!(2<arguments.length&&void 0!==r)||r,r=new t(this,this.splitIconGeomBasisGeomType_),t.getParamForTransformedIconThatFitsInLabelArea(r,e,n,i));i=o.scaleFactor,r.w=i,r.h=i;var a=[];return r.g&&r.g.forEach((function(e){var i=[];e.shp&&e.shp.forEach((function(e){var r=(c=v(e,7))[0],n=c[1],a=c[2],s=c[3],l=c[4],u=c[5],c=c[6],h=(a=v(t.getTransformedIconPointThatFitsInLabelArea([n,a],o),2))[0],p=a[1],f=(l=v(t.getTransformedIconPointThatFitsInLabelArea([s,l],o),2))[0],d=l[1],y=(c=v(t.getTransformedIconPointThatFitsInLabelArea([u,c],o),2))[0],g=c[1];switch(r){case 0:case 1:i.push([r,h,p]);break;case 2:i.push([r,h,p,f,d]);break;case 3:i.push([r,h,p,f,d,y,g]);break;case 4:i.push(e)}})),a.push(l(l({},e),{shp:i}))})),r.g=a,r}},{key:"getSVG",value:function(t){var e,i,r='<?xml version="1.0" encoding="utf-8"?>',n=this.w||50,o=this.h||50,s=this.g;if(r+='<svg viewBox="0 0 '.concat(n," ").concat(o,'" xmlns="http://www.w3.org/2000/svg" width="').concat(n,'" height="').concat(o,'">'),r+="<g>",s&&0<s.length)for(var l=0;l<s.length;l+=1){r+="<path ",s[l].gw&&(r+=' stroke-width="'.concat(s[l].gw,'"')),t?r+=' fill="'.concat(t,'"'):s[l].os&&s[l].os.m?r+=' fill="'.concat(s[l].os.m,'"'):r+=0===l?' fill="#006BB7"':' fill="#ffffff"',r+=' d="';for(var u=0;u<s[l].shp.length;u+=1)for(var c=0;c<s[l].shp[u].length;c+=1)r+=0===c?(e=s[l].shp[u][c],(a(i={},0,"M"),a(i,1,"L"),a(i,2,"Q"),a(i,3,"C"),a(i,4,"Z"),i)[e]):s[l].shp[u][c],0===c||c+1===s[l].shp[u][c].length?r+="":r+=" ";r+='" ></path>'}return(r+="</g>")+"</svg>"}}],[{key:"getParamForTransformedIconThatFitsInLabelArea",value:function(t,e,i,r){var n=2<arguments.length&&void 0!==i?i:0,o=!(3<arguments.length&&void 0!==r)||r,a=(l=v(e,5))[0],s=l[1],l=(i=l[2],r=l[3],e=l[4],(o?0:e)+n);return e=(o=v(Zt.getDeltaLonLatForMeterAtGivenLonLat(a,s),2))[0],n=o[1],{labelCenterX:a,labelCenterY:s,iconWidth:t=(o=[Number.parseInt(t.w,10),Number.parseInt(t.h,10)])[0],iconHeight:o=o[1],deltaLonPerMeter:e,deltaLatPerMeter:n,scaleFactor:Zt.getScaleFactorForRectInSpace(i,r,t,o),effectiveRotation:l}}},{key:"getTransformedIconPointThatFitsInLabelArea",value:function(t,e){var i=(u=v(t,2))[0],r=u[1];if(void 0===i||void 0===r||null===i||null===r)return[];var n=e.labelCenterX,o=e.labelCenterY,a=e.iconWidth,s=e.iconHeight,l=e.deltaLonPerMeter,u=(t=e.deltaLatPerMeter,e.scaleFactor);return e=e.effectiveRotation,i=i,r=r,i-=+a/2,r-=+s/2,r*=-1,l=i*=u*l,t=r*=u*t,i=l*Math.cos(e)+t*Math.sin(e),r=t*Math.cos(e)-l*Math.sin(e),[i+=n,r+=o]}},{key:"getWebGLSuitableCoordinatesOfIconSubGeom",value:function(t){var e,i=t.st,r=t.gt,n=t.shp,o=[];if(2!==i||!n||!r)return o;switch(r){case 2:n.forEach((function(t){var i=v(t,3),r=(t=i[0],i[1]),n=i[2];switch(t){case 0:(e=[]).push([r,n]);break;case 1:e.push([r,n]);break;case 4:o.push(e)}}));break;case 1:n.forEach((function(t){t=(e=v(t,3))[1];var e=e[2];o.push([t,e])}))}return o}},{key:"getLinkedParentChildPolygonArray",value:function(t){var e=[];t.sort((function(t,e){return Math.abs(e.area)-Math.abs(t.area)}));for(var i=0;i<t.length;i+=1){for(var r=null,n=t[i],o=n.points[0],a=i-1;0<=a;--a){var s=t[a];if(n.area*s.area<0&&(Zt.isPointInPolygon(o,s.points)||Zt.isPointOnLineString(o,s.points))){r=s;break}}(r?r.children:e).push(n)}return e}}]),t}(),Jt=Object.freeze({TEXT:"",ICON:"icon:",IMAGE:"icon:"}),Qt=Object.freeze({VALUE:"<value>",SHORT:"<short>",LONG:"<long>",FULL:"<full>"}),$t=Object.freeze({NONE:0,TEXT:1,ICON:2,IMAGE:3}),te=Vt.EVENT_NAME,ee=["resetBaseMetaFileRules_","updateOverridableComponents"],ie=function(){function t(e,i,n){if(r(this,t),!e)throw new Error("one should not instantiate object of this class without apt payload");var o=function(t){var e=[];return ee.forEach((function(i){t[i]||e.push(i)})),0<e.length?e:null}(this);if(o)throw new Error("function definition missing in the implementation ".concat(o.join()));this.metaFileIdentifier=i,this.metaInformation_=n,this.basedata_=l({},e),this.baseOverrides_=[],this.customOverrides_=[],this.resetBaseMetaFileRules_()}return o(t,[{key:"applyOverride",value:function(t,e,i){var r=!(1<arguments.length&&void 0!==e)||e;e=2<arguments.length&&void 0!==i&&i,t&&(e||(r?this.customOverrides_:this.baseOverrides_).push(t),this.updateOverridableComponents(t),i=this.getMetaInformation(),!e&&i&&i.config.emitEventOnOverrideUpdate&&(t={applyOverride:!0,metaFileIdentifier:this.metaFileIdentifier,isCustomOverride:r,metaInformation:i,overrideJson:t},Vt.emit(te.META_DATA_MODEL_UPDATED,t)))}},{key:"undoOverride",value:function(){var t,e,i=this;0!==this.customOverrides_.length&&(e=this.customOverrides_.pop(),this.resetBaseMetaFileRules_(),this.baseOverrides_.forEach((function(t){return i.applyOverride(t,!1,!0)})),this.customOverrides_.forEach((function(t){return i.applyOverride(t,!0,!0)})),(t=this.getMetaInformation())&&t.config.emitEventOnOverrideUpdate&&(e={metaFileIdentifier:this.metaFileIdentifier,undoOverride:!0,metaInformation:t,overrideJson:e},Vt.emit(te.META_DATA_MODEL_UPDATED,e)))}},{key:"getMetaInformation",value:function(){return this.metaInformation_}},{key:"basedata_",get:function(){return this.basedata__},set:function(t){this.basedata__||(this.basedata__=t)}}]),t}(),re=_t.PRESETS,ne=function(){u(e,ie);var t=y(e);function e(i,n){return r(this,e),t.call(this,i,re,n)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){this.property_trees=null,this.named_groups=null,this.named_keys=null,this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(t){this.property_trees=t.property_trees,this.named_groups=t.named_groups,this.named_keys=t.named_keys}},{key:"getPropertyTree",value:function(t){var e,i=this,r=(t=this.property_trees[t],[]);return t.forEach((function(t){switch(t.input){case"named_group":e=i.getNamedGroup(i.getKeyKey(t)),r=[].concat(m(r),m(e));break;case"named_key":var n;(e=i.getKeyName(t))?((n=i.getNamedKey(e)).k=i.getKeyKey(t),n.name=e,r.push(n)):r.push(i.getNamedKey(i.getKeyKey(t)));break;default:r.push(t)}}),this),r}},{key:"getNamedGroup",value:function(t){return this.named_groups[t]}},{key:"getNamedKey",value:function(t){return this.named_keys[t]}}],[{key:"getMetaFileIdentifier",value:function(){return re}}]),e}(),oe=_t.SDK_STRINGS,ae=function(){u(e,ie);var t=y(e);function e(i,n){return r(this,e),t.call(this,i,oe,n)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){this.stringsTable={},this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(t){t&&this.updateTranslationsStringMap(t.translations)}},{key:"updateTranslationsStringMap",value:function(t){var e=this;t&&Object.keys(t).forEach((function(i){e.addToStringsTable(i,t[i])}),this)}},{key:"addToStringsTable",value:function(t,e){this.stringsTable[t]=e}},{key:"translate",value:function(t,e){var i,r=e;return!this.stringsTable||(i=this.stringsTable[t])&&(r=i.en||i.en||(0<(t=Object.keys(i)).length?i[t.pop()]:e)),r}}],[{key:"getMetaFileIdentifier",value:function(){return oe}}]),e}(),se=_t.THEME,le=function(){u(e,ie);var t=y(e);function e(i,n){return r(this,e),t.call(this,i,se,n)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){var t=this.basedata_;this.ft=t.ft,this.name=t.nm,this.iurl=t.iurl,this.styleMap={},this.iconInfoMap={},this.labelStyleMap={},this.markerMap={},this.updateOverridableComponents(t)}},{key:"updateOverridableComponents",value:function(t){t&&(this.updateStyleMap(t.s),this.updateIconInfoMap(t.i,t.iurl),this.updateLabelStyleMap(t.l),this.updateMarkerMap(t.m))}},{key:"updateStyleMap",value:function(t){this.styleMap=l(l({},this.styleMap),t)}},{key:"updateIconInfoMap",value:function(t,e){var i=this;t&&Object.keys(t).forEach((function(r){var n=t[r],o=e||i.iurl;o&&n.rurl&&(n.url=o+n.rurl),i.iconInfoMap[r]=n}),this)}},{key:"updateLabelStyleMap",value:function(t){this.labelStyleMap=l(l({},this.labelStyleMap),t)}},{key:"updateMarkerMap",value:function(t){this.markerMap=l(l({},this.markerMap),t)}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(t){return this.styleMap?this.styleMap[t]:null}},{key:"getGeometryDefaultStyle",value:function(){return this.styleMap?this.styleMap.Object:null}},{key:"getLabelStyle",value:function(t){return this.labelStyleMap?this.labelStyleMap[t]:null}},{key:"getLabelDefaultStyle",value:function(){return this.labelStyleMap?this.labelStyleMap.default:null}},{key:"getMarker",value:function(t){return this.markerMap&&t?this.markerMap[t]:null}},{key:"getIconInfo",value:function(t){return this.iconInfoMap&&t?this.iconInfoMap[t]:null}}],[{key:"getMetaFileIdentifier",value:function(){return se}}]),e}(),ue=function(){function t(){r(this,t)}return o(t,null,[{key:"createShortAddress",value:function(t){return t&&Array.isArray(t)?t[1]:null}},{key:"createLongAddress",value:function(t){return t&&Array.isArray(t)?t[0]+" "+t[1]:null}},{key:"createFullAddress",value:function(t){return t&&Array.isArray(t)?(3===t.length?t[2]+" ":"")+t[0]+" "+t[1]:null}}]),t}(),ce=_t.THEME_MAP,he=function(){u(e,ie);var t=y(e);function e(i,n){return r(this,e),t.call(this,i,ce,n)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){var t=this.basedata_;this.ft=t.ft,this.styleTreeList=[],this.labelTreeList=[],this.updateOverridableComponents(t)}},{key:"updateOverridableComponents",value:function(t){this.updateLabelTreeList(t.label),this.updateStyleTreeList(t.style)}},{key:"updateLabelTreeList",value:function(t){t&&qt(this.labelTreeList,t)}},{key:"updateStyleTreeList",value:function(t){t&&qt(this.styleTreeList,t)}}],[{key:"getMetaFileIdentifier",value:function(){return ce}},{key:"extractThemeMapPayload",value:function(t){return{labelType:t.lt,labelRef:t.r,styleName:t.n}}},{key:"getGeomStyleLookupTag",value:function(t,e){return(t=t?t.styleName:null)===Qt.VALUE?e:t}},{key:"getLabelRefConstructed",value:function(t,e,i){var r=t;switch(t){case Qt.VALUE:r=i;break;case Qt.SHORT:r=ue.createShortAddress(e);break;case Qt.LONG:r=ue.createLongAddress(e);break;case Qt.FULL:r=ue.createFullAddress(e)}return r}},{key:"getLabelInfoConstructed",value:function(t,e,i,r){var n={lt:t,entry:i};switch(t){case $t.NONE:break;case $t.TEXT:i.trans?n.ar=e:n.r=e;break;case $t.ICON:n.iconIdentifier=e,r?n=l(l({},r),n):n.error=!0;break;case $t.IMAGE:n.url=e;break;default:n=null}return n}}]),e}(),pe=_t.THEME,fe=_t.THEME_MAP,de=_t.PRESETS,ye=_t.SDK_STRINGS,ge=function(){function t(){r(this,t),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.iconCache={},this.imageCache={},this.releaseSettings_={}}return o(t,[{key:"instantiateMetaFileAccessor_",value:function(t){for(var e=arguments.length,i=new Array(1<e?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];switch(t){case pe:this[pe]=f(le,i.concat([this]));break;case fe:this[fe]=f(he,i.concat([this]));break;case de:this[de]=f(ne,i.concat([this]));break;case ye:this[ye]=f(ae,i.concat([this]));break;default:return null}return this[t]}},{key:"applyOverride",value:function(t,e){this[t]&&this[t].applyOverride(e)}},{key:"undoOverride",value:function(t){this[t]&&this[t].undoOverride()}},{key:"getTheme",value:function(){return this[pe]||{}}},{key:"getThemeMap",value:function(){return this[fe]||{}}},{key:"getPresets",value:function(){return this[de]||{}}},{key:"getStrings",value:function(){return this[ye]||{}}},{key:"getIcon",value:function(t){return t&&t.iconIdentifier?this.iconCache[t.iconIdentifier]:null}},{key:"getImage",value:function(t){return this.imageCache[t]}},{key:"extractGeomStyle",value:function(t){var e=t.valueEntry;return t=t.value,e=he.extractThemeMapPayload(e),t=he.getGeomStyleLookupTag(e,t),this.getTheme()?this.getTheme().getGeometryStyle(t):null}},{key:"getStyle",value:function(t,e){var i=this,r=1<arguments.length&&void 0!==e&&e,n=this.getThemeMap().styleTreeList,o=this.processValueEntry_.bind(this);if(null===n||0===n.length||!this.getTheme())return null;e=this.getTheme().getGeometryDefaultStyle();var a=this.extractGeomStyle.bind(this),s=t.getAddress(),l=t.getEntities(),u=null,c=null,h={};return l&&0<l.length?n.find((function(e){return c=l.find((function(i){return u=o({geometry:t,entity:i,address:s,valueEntry:e,value:void 0,returnValueFunction:a,valueEntryIdentified:h})}),i)}),this):n.find((function(e){return u=o({geometry:t,entity:c,address:s,valueEntry:e,value:void 0,returnValueFunction:a,valueEntryIdentified:h})}),this),u||r||(u=e),u?JSON.parse(JSON.stringify(u)):void 0}},{key:"getLabelValue",value:function(t){var e=t.address,i=t.valueEntry,r=t.value,n=(t=(n=he.extractThemeMapPayload(i)).labelType,n.labelRef);return e=he.getLabelRefConstructed(n,e,r),r=t===$t.ICON?this.getTheme().getIconInfo(e):null,(r=he.getLabelInfoConstructed(t,e,i,r))?JSON.parse(JSON.stringify(r)):void 0}},{key:"convertLabelToText",value:function(t){if(t){var e,i=t.r,r=t.ar;if(t=t.lt,i)return i;if(r){switch(t){case $t.TEXT:e=Jt.TEXT+r;break;case $t.ICON:e=Jt.ICON+r;break;case $t.IMAGE:e=Jt.IMAGE+r;break;default:return null}return this.getStrings().translate(e,r)}}return null}},{key:"getLabelStyle",value:function(t,e){var i,r=1<arguments.length&&void 0!==e&&e,n=this.getTheme(),o=n.getLabelDefaultStyle(),a={};return t&&(i=t.t,e=t.zmin,t=t.l,i&&(a.t=i),e&&(a.zmin=e),(t=n.getLabelStyle(t))&&(a=l(l({},a),t))),a||r||(a=o),a}},{key:"getLabelConstantsSet_",value:function(){var t=this.getThemeMap().labelTreeList,e=this.processValueEntry_.bind(this);return null==t||0===t.length?{isInsufficientInput:!0}:{labelTreeList:t,returnValueFunction:this.getLabelValue.bind(this),processValueEntry:e}}},{key:"getGeometryLabelInfo",value:function(t){var e=this,i=this.getLabelConstantsSet_(),r=i.isInsufficientInput,n=i.labelTreeList,o=i.returnValueFunction,a=i.processValueEntry;if(r)return null;var s=t.getAddress(),l=null;return n.find((function(i){return(l=a({geometry:t,address:s,valueEntry:i,returnValueFunction:o}))&&(l.r=e.convertLabelToText(l)),l})),l?JSON.parse(JSON.stringify(l)):void 0}},{key:"getEntityLabelInfo",value:function(t){var e=this.getLabelConstantsSet_(),i=e.isInsufficientInput,r=e.labelTreeList,n=e.returnValueFunction,o=e.processValueEntry;if(i)return null;var a=null;return r.find((function(e){return a=o({entity:t,valueEntry:e,returnValueFunction:n})})),a?JSON.parse(JSON.stringify(a)):void 0}},{key:"getLabelInfo",value:function(t){var e=this,i=this.getLabelConstantsSet_(),r=i.isInsufficientInput,n=i.labelTreeList,o=i.returnValueFunction,a=i.processValueEntry;if(r)return null;var s,l,u=t.getAddress(),c=t.getEntities(),h=null;return c&&1<c.length?(s=null,n.find((function(i){var r,n=null,l=!1;return c.forEach((function(t){r=a({entity:t,valueEntry:i,returnValueFunction:o}),(n=e.convertLabelToText(r))&&0<n.length&&(s?s+=", "+n:(s=n,l=!0))}),e),l||(r=a({geometry:t,address:u,valueEntry:i,returnValueFunction:o}),(n=e.convertLabelToText(r))&&0<n.length&&(s?s+=", "+n:s=n,l=!0)),l&&(h={lt:e.TEXT_LABEL_TYPE,r:s}),l}),this)):(l=c?c[0]:null,n.find((function(i){return(h=a({geometry:t,entity:l,address:u,valueEntry:i,returnValueFunction:o}))&&(h.r=e.convertLabelToText(h)),h}),this)),h?JSON.parse(JSON.stringify(h)):void 0}},{key:"processValueEntry_",value:function(t){var e=this,i=t.geometry,r=t.entity,n=t.address,o=t.valueEntry,a=t.value,s=t.returnValueFunction,l=null;return void 0!==(t=o.ks)&&t.find((function(t){var o;if(t.gk&&i?(a=t.gk,o=i.properties[a]):t.ek&&r?(a=t.ek,o=r.properties[a]):t.ak&&n&&(a=t.ak)===n[0]&&(o=v(n,2)[1]),void 0!==o){if(t.v){var a=t.v[o];if(void 0!==a&&void 0!==(l=e.processValueEntry_({geometry:i,entity:r,address:n,valueEntry:a,value:o,returnValueFunction:s})))return!0}if(void 0!==(l=s({geometry:i,entity:r,address:n,valueEntry:t,value:o})))return!0}return!1}),this)?l:s?s({geometry:i,entity:r,address:n,valueEntry:o,value:a}):l}},{key:"setIcon",value:function(t,e){t&&e&&(this.iconCache[t]=e)}},{key:"setReleaseSettings_",value:function(t){this.releaseSettings_=t}}]),t}(),ve=(Oe={NODES_LB:"mfs.micello.com",US_1:"mfs-us-1.micello.com",US_2:"mfs-us-2.micello.com",AU_1:"mfs-au-1.micello.com",AU_2:"mfs-au-2.micello.com",EU_1:"mfs-eu-1.micello.com",SG_1:"mfs-sg-1.micello.com",HUB:"mfs-hub-master.micello.com",PREVIEW:"preview.micello.com/mfs",FACTORY:"factory-mfs.micello.com",CIT:"integration.mfs.hub.venues.ext.here.com",STG:"alpha.mfs.hub.venues.ext.here.com"}).HUB,me=Object.freeze({MFILE:"MFILE",MVAR:"MVAR",MPATH:"MPATH",MKEY:"MKEY",MPATTERN:"MPATTERN",MPACKAGE:"MPACKAGE"}),_e=(Object.freeze((a(_e={},me.MFILE,"/mfile"),a(_e,me.MVAR,"/mvar"),a(_e,me.MPATH,"/mpath"),a(_e,me.MKEY,"/mkey"),a(_e,me.MPATTERN,"/mpattern"),a(_e,me.MPACKAGE,"/mpackage"),_e)),Object.freeze(Object.values(Oe).reduce((function(t,e){return l(l({},t),{},a({},e,{key:null}))}),{}))),be=Object.freeze({apiKey:null,dataApiType:"MFS",fileHost:ve,queryParamMap:_e}),we=Et.GEO_JSON,xe=(Oe=At[we]).COMMUNITY_MAP,Ee=Oe.COMMUNITY_ENTITY,Ae=Oe.GEOJSON_LEVEL_GEOMETRY,Te=function(){function t(e){r(this,t),this.baseApi=e}return o(t,[{key:"getBaseAPI",value:function(){return this.baseApi}},{key:"getCommunityMap",value:function(t,e,i){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,we,xe,null,e,i))}},{key:"getCommunityEntity",value:function(t,e,i){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,we,Ee,null,e,i))}},{key:"getGeoJsonLevelGeometry",value:function(t,e,i,r){return e="/".concat(e),this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,we,Ae,e,i,r))}}]),t}(),ke=Object.freeze({MAP:"MAP",META:"META",CUSTOMER:"CUSTOMER"}),Se=Object.freeze((a(_e={},ke.MAP,"/map"),a(_e,ke.META,"/meta"),a(_e,ke.CUSTOMER,"/customer"),_e)),Me=Object.freeze({METACONFIG:"METACONFIG",OVERRIDES:"OVERRIDES",DATAHOSTS:"DATAHOSTS"}),Ie=Object.freeze((a(At={},Me.METACONFIG,"/metaConfig"),a(At,Me.OVERRIDES,"/overrides"),a(At,Me.DATAHOSTS,"/map/dataHosts"),At)),Oe=Object.freeze({V4:"V4",V5:"V5"}),Le=(Object.freeze((a(_e={},Oe.V4,"/v4"),a(_e,Oe.V5,"/v5"),_e)),Object.freeze((a(At={},_t.THEME,"/theme/v5"),a(At,_t.THEME_MAP,"/thememap/v5"),a(At,_t.PRESETS,"/presets/v5"),a(At,_t.SDK_STRINGS,"/strings/v5"),a(At,_t.ICON_FILE,"/iconfile/v5"),a(At,_t.INPUT_COLORS,"/miceditor/inputcolors"),a(At,_t.BASE_MAP_INFO,"/miceditor/basemapinfo"),a(At,_t.CONFIG_PROFILE,"/miceditor/configprofile"),a(At,_t.NAV_THEME,"/navtheme/v5"),a(At,_t.NAV_NAME_THEME,"/navtheme/v5"),a(At,_t.NAV_PROP_MAP,"/navpropmap/v5"),a(At,_t.NAV_STRINGS,"/strings/v5/nav"),a(At,_t.NAV_THEME_MAP,"/navthememap/v5"),a(At,_t.NAV_NAME_THEME_MAP,"/navthememap/v5"),a(At,_t.V4_THEME_FAMILY,"/theme/v4"),a(At,_t.V4_MAPTYPE_THEME,"/theme/v4"),a(At,_t.ICON,"/theme/icon/v5"),a(At,_t.MARKER,"/theme/marker"),a(At,_t.PERMISSIONS,"/auth/stringroles"),a(At,_t.NAICS_ARRAY,"/naics/2012/array"),a(At,_t.NAICS_MAP,"/naics/2012/map"),At))),Ce=Object.freeze((a(Oe={},Et.GEO_JSON,"/geojson"),a(Oe,Et.V5_MAP,"/v5_map"),a(Oe,Et.V5_NAV,"/v5_nav"),a(Oe,Et.V5_INFO,"/v5_info"),a(Oe,Et.KML,"/kml"),a(Oe,Et.SVG,"/svg"),a(Oe,Et.PNG,"/png"),Oe)),Re=Object.freeze((a(_e={},Et.V5_MAP,{COMMUNITY_MAP:"/com-map",COMMUNITY_DIRECTORY:"/com-dir",COMMUNITY_DETAIL:"/com-detail",LEVEL_GEOMETRY:"/level-geom",DRAWING_ENTITY:"/drawing-entity"}),a(_e,Et.GEO_JSON,{COMMUNITY_MAP:"/com-map",COMMUNITY_ENTITY:"/com-entity",PATH_LEVEL_GEOMETRY:"/path-level-geom",GEOJSON_LEVEL_GEOMETRY:"/geojson-level-geom"}),a(_e,Et.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),a(_e,Et.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),a(_e,Et.V5_INFO,{GEOMETRY_INFO:"/geom-info"}),a(_e,Et.SVG,{PLAIN:"/plain",PRETTY:"/pretty",PRETTY_HORIZONTAL_LABEL:"/pretty"}),a(_e,Et.KML,{RASTER:"/raster",RASTER_HORIZONTAL:"/raster",VECTOR:"/vector",VECTOR_HORIZONTAL:"/vector"}),a(_e,Et.PNG,{LOW_RESOLUTION:"/lo-res",HIGH_RESOLUTION:"/high-res",LOW_RESOLUTION_GEO:"/lo-res-geo",HIGH_RESOLUTION_GEO:"/high-res-geo",LOW_RESOLUTION_HORIZONTAL:"/lo-res",HIGH_RESOLUTION_HORIZONTAL:"/high-res",LOW_RESOLUTION_HORIZONTAL_GEO:"/lo-res-geo",HIGH_RESOLUTION_HORIZONTAL_GEO:"/high-res-geo"}),_e)),Ne=Object.freeze({venueId:null,language:"-",mapVersion:"-",entityVersion:"-",fileVersion:null,themeName:xt[_t.THEME]}),Pe=Object.freeze({MFILE:"MFILE",MPATH:"MPATH",MVAR:"MVAR"}),je=Object.freeze((a(At={},Pe.MFILE,"/mfile"),a(At,Pe.MPATH,"/mpath"),a(At,Pe.MVAR,"/mvar"),At)),De=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.productAPI={},this.hostConfig_=e,this.isHostCustom=!1}return o(t,[{key:"getBaseUrl",value:function(t){return t=!(0<arguments.length&&void 0!==t)||t,(t="".concat(this.hostConfig_.fileHost).concat(t?"/ms/v1":"")).startsWith("https://")||t.startsWith("http://")||(t="https://".concat(t)),t}},{key:"getFileServiceBaseUrl",value:function(t){if(t=0<arguments.length&&void 0!==t?t:Pe.MFILE,Pe[t])return"".concat(this.getBaseUrl()).concat(je[t])}},{key:"getGlobalMetaBaseUrl",value:function(t){var e=Se[ke.META];return t=this.getFileServiceBaseUrl(t),"".concat(t).concat(e)}},{key:"getVenueMapBaseUrl",value:function(t){var e=this.getFileServiceBaseUrl(t);return t=Se[ke.MAP],"".concat(e).concat(t)}},{key:"getGlobalMetaFileUrl",value:function(t,e,i,r){e=1<arguments.length&&void 0!==e?e:xt[t];var n=2<arguments.length?i:void 0,o=(r=3<arguments.length?r:void 0,this.getGlobalMetaBaseUrl(r)),a=Le[t],s=null===e||""===e?"":"/".concat(e);switch(t){case _t.THEME:case _t.THEME_MAP:case _t.PRESETS:case _t.SDK_STRINGS:case _t.ICON_FILE:case _t.INPUT_COLORS:case _t.BASE_MAP_INFO:case _t.CONFIG_PROFILE:case _t.NAV_THEME:case _t.NAV_NAME_THEME:case _t.NAV_PROP_MAP:case _t.NAV_STRINGS:case _t.NAV_THEME_MAP:case _t.NAV_NAME_THEME_MAP:case _t.V4_THEME_FAMILY:o+="".concat(a).concat(s);break;case _t.ICON:case _t.MARKER:case _t.V4_MAPTYPE_THEME:o+=0<s.length&&n&&0<n.length?"".concat(a).concat(s,"/").concat(n):"".concat(a);break;case _t.PERMISSIONS:case _t.NAICS_ARRAY:case _t.NAICS_MAP:o+="".concat(a)}return o}},{key:"getGeoJsonApi",value:function(){return this.productAPI[Et.GEO_JSON]||(this.productAPI[Et.GEO_JSON]=new Te(this)),this.productAPI[Et.GEO_JSON]}},{key:"getMapProductUrlPath",value:function(t,e,i,r){return e=!(1<arguments.length&&void 0!==e)||e,i=2<arguments.length?i:void 0,r=3<arguments.length?r:void 0,r=this.getVersionedVenueUrl(t,e,r),i&&(r+="".concat(Ce[i])),r}},{key:"getMapProductFileUrl",value:function(t,e,i,r,n,o){var a=Re[Et[e]][i];return n=this.getMapProductUrlPath(t,!0,e,n),i&&(n+="".concat(a)),r&&(n+="".concat(r)),!o&&0!==o||(n+="/fv/".concat(o)),n}},{key:"getMetaConfigUrl",value:function(t,e){var i=Ie[Me.METACONFIG];return(e=this.getVersionedVenueUrl(t,!0,e))+"".concat(i)}},{key:"getMetaFileUrl",value:function(t,e,r){var n;if(r=2<arguments.length&&void 0!==r?r:xt[e],t)return"object"===i(t[e=bt[e]])&&t[e][r]?n=new URL(t[e][r]):"string"==typeof t[e]&&(n=new URL(t[e])),n?this.isHostCustom?"".concat(this.getBaseUrl(!1)).concat(n.pathname):n.toString():null}},{key:"getMetaOverrideFileUrls",value:function(t,e,i,r){return r=3<arguments.length&&void 0!==r?r:xt[i],e&&e.communityOverrides&&e.communityOverrides[t]?(i=wt[i],i=e.communityOverrides[t][i]||{},Array.isArray(i)?i:i[r]||[]):[]}},{key:"getVersionedVenueUrl",value:function(e,i,r){return r=2<arguments.length?r:void 0,(r=1<arguments.length&&void 0!==i&&!i?"":this.getFileServiceBaseUrl(r))+t.getVersionedVenuePathSegment(e)}},{key:"getNormalizedUrl",value:function(t){if(this.isHostCustom){var e=new URL(t);return"".concat(this.getBaseUrl(!1)).concat(e.pathname)}return t}},{key:"getMetaConfig",value:function(t){var e=this;if(!t)return null;var r={venueId:t.cid};Object.values(bt).forEach((function(e){t[e]&&("string"==typeof t[e]?r[e]=t[e]:(r[e]={},Object.keys(t[e]).forEach((function(i){r[e][i]=t[e][i]}))))}));var n={},o=t.communityOverrides[r.venueId];return Object.keys(o).forEach((function(t){var r;Array.isArray(o[t])?n[t]=o[t].map((function(t){return"".concat(e.getFileServiceBaseUrl()).concat(t)})):"object"===i(o[t])&&(r={},Object.keys(o[t]).forEach((function(i){Array.isArray(o[t][i])&&(r[i]=o[t][i].map((function(t){return"".concat(e.getFileServiceBaseUrl()).concat(t)})))})),n[t]=r)})),r.communityOverrides=a({},r.venueId,n),l(l({},t),r)}}],[{key:"getVersionedVenuePathSegment",value:function(t,e,i){var r=1<arguments.length&&void 0!==e?e:"-";return e=2<arguments.length&&void 0!==i?i:"-",i=Se[ke.MAP],"".concat(i,"/").concat(t,"/mv/").concat(r,"/ev/").concat(e)}},{key:"getVenueConfig",value:function(t){return(t=l(l({},Ne),t)).mapVersion=Number(t.mapVersion)||"-",t.entityVersion=Number(t.entityVersion)||"-",t.fileVersion=Number(t.fileVersion)||null,t.venueId=Number(t.venueId),t}}]),t}(),ze=function(){u(e,De);var t=y(e);function e(i){var n;return r(this,e),(n=t.call(this,i)).setAndUpdateHostConfig_(i),i.fileHost&&(n.isHostCustom=!0),n}return o(e,[{key:"setAndUpdateHostConfig_",value:function(t){var e=t.apiKey,i=(t=t.fileHost,{});Object.keys(be.queryParamMap).forEach((function(t){i[t]={key:e}})),t&&(i[t]={key:e}),this.hostConfig_={apiKey:e,dataApiType:"MFS",fileHost:t||ve,queryParamMap:l(l({},i),be.QUERY_PARAM_MAP_DEFAULT)}}},{key:"addServer",value:function(t,e){t=-1<t.indexOf("://")?t.split("://")[1]:t;var i=this.hostConfig_.queryParamMap[t]?l(l({},this.hostConfig_.queryParamMap[t]),e):e;Object.keys(i).forEach((function(t){null!==i[t]&&void 0!==i[t]&&""!==i[t]||delete i[t]})),this.hostConfig_.queryParamMap[t]=i}},{key:"appendQueryParams",value:function(t){var i=this.hostConfig_.queryParamMap,r=-1<t.indexOf("://")?t.split("://")[1]:t;return i=i[v(Object.keys(i).filter((function(t){return r.startsWith(t)})).sort((function(t,e){return e.length-t.length})),1)[0]],e.appendParamList(t,i)}},{key:"fetch",value:function(t,e,i,r){return r=3<arguments.length&&void 0!==r&&r,t.startsWith("http://")&&(t=t.replace(/http:\/\//gm,"https://")),r||(t=this.appendQueryParams(t)),Kt.get(t,e,i)}},{key:"getMapProductFileUrl",value:function(t,i,r,n,o,a){return g(c(e.prototype),"getMapProductFileUrl",this).call(this,t,i,r,n,o,a)}},{key:"getGlobalMetaFileUrl",value:function(t,i,r,n,o){return o=4<arguments.length&&void 0!==o?o:0,r=g(c(e.prototype),"getGlobalMetaFileUrl",this).call(this,t,i,r,n),n&&n===me.MPATH&&(r=e.appendParamList(r,{fvhistory:o})),r}}],[{key:"appendParamList",value:function(t,e){if(!e||"object"!==i(e))return t;var r=t.split("?"),n=v(r,2)[1],o=void 0===n?"":n;return Object.keys(e).filter((function(t){return-1===o.indexOf("".concat(t,"="))})).forEach((function(t){o+="&".concat(t,"=").concat(e[t])})),0<(o=o.startsWith("&")?o.substr(1):o).length?"".concat(r[0],"?").concat(o):t}}]),e}(),Fe=function(){function t(){r(this,t)}return o(t,null,[{key:"isPointOnGeoJSONLineString",value:function(t,e){var i=!1;if(e&&1<e.length)for(var r,n,o=1;o<e.length;o+=1)if(r=e[o-1],n=e[o],Zt.isPointOnLineSegment(t,r,n)){i=!0;break}return i}},{key:"isPointOnGeoJSONMultiLineString",value:function(e,i){for(var r=!1,n=0;n<i.length;n+=1)if(t.isPointOnGeoJSONLineString(e,i[n])){r=!0;break}return r}},{key:"isPointInsideGeoJSONPolygon",value:function(t,e){var i=!1;if(Zt.isPointInPolygon(t,e[0])&&(i=!0),i)for(var r=1;r<e.length;r+=1)if(Zt.isPointInPolygon(t,e[r])){i=!1;break}return i}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(e,i){for(var r=i.length,n=0;n<r;n+=1)if(t.isPointInsideGeoJSONPolygon(e,i[n]))return!0;return!1}},{key:"convertIntAddressToGeometryAddressListFormat",value:function(t){if(t&&"string"==typeof t){var e=[];return t.split(" ").forEach((function(t){e.push.apply(e,m(t.split(" ")))})),e}return null}},{key:"getGeometriesByLonLat",value:function(t,e,i){for(var r=2<arguments.length&&void 0!==i&&i,n=[],o=e.filter((function(e){return Zt.isPointInBoundingBox(t,e.getBoundingBox())})),a=0;a<o.length;a+=1){var s=o[a];if(s.isPointInsideGeometry(t,!0)&&(n.push(s),!r))break}return n.sort((function(t,e){return e.getZIndex()-t.getZIndex()}))}}]),t}(),Ge=function(){function t(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;r(this,t),this.venueModel=n,this.id=e,this.properties=l({geometry:[],int_address:[]},i)}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getGeometries",value:function(){var t=this;return this.properties.geometry.filter((function(t){return v(t,2)[1]})).map((function(e){return e=v(e,1)[0],t.venueModel.getGeometryById(e)}))}},{key:"getInternalAddress",value:function(){return this.properties.int_address||[]}},{key:"getName",value:function(){return(Array.isArray(this.properties.name)?this.properties.name[0]:this.properties.name)||""}},{key:"getProperties",value:function(){return this.properties}},{key:"getLabelInfo",value:function(){return this.venueModel.metaInformation_.getEntityLabelInfo(this)}}]),t}(),He=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;r(this,t),this.id=e.id,this.properties=e.properties||{},this.labelArea=e.label_area||[],this.geometry=e.geometry||{},this.location=e.location||{},this.level=i,this.zIndex=n,this.state_={isHighlighted:!1,highlightedStyle:{}}}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getAddress",value:function(){return Fe.convertIntAddressToGeometryAddressListFormat(this.getInternalAddress())}},{key:"getInternalAddress",value:function(){return this.properties.int_address||""}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.getMetaInformation_().getIcon(this.getLabelInfo())}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelInfo",value:function(){return this.getMetaInformation_().getLabelInfo(this)}},{key:"getLabelStyle",value:function(){return l({fill:"#333333"},this.getMetaInformation_().getLabelStyle(this.getStyle()))}},{key:"getGeometryLabelInfo",value:function(){return this.getMetaInformation_().getGeometryLabelInfo(this)}},{key:"getEntities",value:function(){var t=this;return(this.properties.entities||[]).map((function(e){return t.level.getDrawing().getVenueModel().getEntityById(e)}))}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var t=this.getType(),e=this.getCoordinates(),i=[];switch(t){case pt:i=[e,e];break;case yt:case ft:i=e;break;case gt:case dt:i=e.reduce((function(t,e){return t.concat(e)}),[]);break;case vt:i=e.reduce((function(t,e){return t.concat(e)}),[]).reduce((function(t,e){return t.concat(e)}),[])}return Zt.getBoundingBoxVertices(i)}},{key:"isIcon",value:function(){var t=this.getLabelInfo();return t&&t.lt===$t.ICON}},{key:"isPointInsideGeometry",value:function(t,e){var i,r=1<arguments.length&&void 0!==e&&e,n=!1;switch(this.getType()){case pt:i=this.getLabelArea()&&Zt.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),n=Zt.isPointInPolygon(t,i);break;case yt:break;case ft:n=r&&Fe.isPointOnGeoJSONLineString(t,this.getCoordinates());break;case gt:n=r&&Fe.isPointOnGeoJSONMultiLineString(t,this.getCoordinates());break;case dt:n=Fe.isPointInsideGeoJSONPolygon(t,this.getCoordinates());break;case vt:n=Fe.isPointInsideGeoJSONMultiPolygon(t,this.getCoordinates())}return n}},{key:"highlight",value:function(t,e){t=!(0<arguments.length&&void 0!==t)||t,e=1<arguments.length?e:void 0,this.state_.isHighlighted=t,this.state_.highlightedStyle=t?e:{}}},{key:"isHighlighted",value:function(){return Boolean(this.state_.isHighlighted)}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return l({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),t}(),Be=function(){function t(e){var i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length?arguments[3]:void 0;r(this,t),this.id=e,this.properties=l({},n),this.zIndexCount=0,this.geometries=o.map((function(t){return i.zIndexCount+=1,new He(t,i,i.zIndexCount)})),this.drawing=a}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties["short name"]||""}},{key:"getZIndex",value:function(){return Number(this.properties.zlevel)}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map((function(t){return t.toJSON()}))}},{key:"getGeometryById",value:function(t){return this.geometries.find((function(e){return e.getId()===t}))}},{key:"getGeometries",value:function(t){return 0<arguments.length&&void 0!==t&&t?this.geometries.sort((function(t,e){return e.getZIndex()-t.getZIndex()})):this.geometries.sort((function(t,e){return t.getZIndex()-e.getZIndex()}))}},{key:"getGeometriesByAddress",value:function(t){return this.geometries.filter((function(e){return e.getInternalAddress()===t}))}},{key:"isMain",value:function(){return Boolean(this.properties.main)}}]),t}(),Ue=function(){function t(e){var i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],s=4<arguments.length?arguments[4]:void 0;r(this,t),this.venueModel=s,this.levels=a.map((function(t){return new Be(t.id,t.properties,t.features,i)})),this.id=e,this.properties=n,this.frame_=o}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return Boolean(this.properties.is_root)}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){var t=(i=this.frame_).height,e=i.width,i=i.transform;return t=(e=v(Zt.getBoundingBoxVertices([Zt.convertMxMy2LonLat(i,[0,0]),Zt.convertMxMy2LonLat(i,[0,t]),Zt.convertMxMy2LonLat(i,[e,0]),Zt.convertMxMy2LonLat(i,[e,t])]),2))[0],[(e=e[1])[1],t[0],t[1],e[0]]}},{key:"getCenter",value:function(){var t=this.frame_;if(t)return Zt.convertMxMy2LonLat(t.transform,[t.width/2,t.height/2])}},{key:"getGeometryById",value:function(t,e){return e?e.getGeometryById(t):this.getGeometries().find((function(e){return e.getId()===t}))}},{key:"getGeometries",value:function(){return this.levels.flatMap((function(t){return t.getGeometries()}))}},{key:"getLevelById",value:function(t){return this.levels.find((function(e){return e.getId()===t}))}},{key:"getLevelByZIndex",value:function(t){return this.levels.find((function(e){return e.getZIndex()===t}))}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find((function(t){return t.isMain()}))}},{key:"getVenueModel",value:function(){return this.venueModel}}]),t}(),Ve=mt.STANDARD,qe=function(){function t(){var e=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new ge;r(this,t),this.metaInformation_=a,this.id=i.id,this.location=i.location||{},this.properties=l({},i.properties),this.drawings=(i.drawings||[]).map((function(t){var i=t.levels.map((function(t){var e=t.id;return o.find((function(t){return t.id===e}))}));return new Ue(t.id,t.properties,t.ref_frame,i,e)})),this.entities=(n.entities||[]).map((function(t){return new Ge(t.id,t.properties,e)}))}return o(t,[{key:"getDisplaySettings",value:function(){return this.metaInformation_.releaseSettings_.displayOptions.display||Ve}},{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){var t,e=Zt.getBoundingBoxVertices(this.getDrawings().flatMap((function(t){var e=v(t.getBoundingBox(),4);return t=e[0],[[e[1],e[2]],[e[3],t]]})));return e=(t=v(e,2))[0],[(t=t[1])[1],e[0],e[1],t[0]]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getEntityById",value:function(t){return this.entities.find((function(e){return e.id===t}))}},{key:"getGeometryById",value:function(t){return this.getGeometries().find((function(e){return e.getId()===t}))}},{key:"getGeometries",value:function(){return this.getLevels().sort((function(t,e){return t.getZIndex()-e.getZIndex()})).flatMap((function(t){return t.getGeometries()}))}},{key:"getGeometriesByLonLat",value:function(t,e,i){var r=this;return i=!(2<arguments.length&&void 0!==i)||i,0===(e=(1<arguments.length&&void 0!==e?e:[]).map((function(t){return r.getLevelById(t)}))).length&&(e=this.drawings.filter((function(e){return e=e.getBoundingBox(),Zt.isPointInBoundingBox(t,e)})).flatMap((function(t){return t.getLevels()}))),Fe.getGeometriesByLonLat(t,e.flatMap((function(t){return t.getGeometries(!0)})),i)}},{key:"getDrawingById",value:function(t){return this.drawings.find((function(e){return e.getId()===t}))}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find((function(t){return t.isRoot()}))}},{key:"getLevelById",value:function(t){return this.getLevels().find((function(e){return e.getId()===t}))}},{key:"getLevelsByZIndex",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;return this.getLevels().filter((function(t){return Number(t.getZIndex())===Number(e)}))}},{key:"getLevels",value:function(){return this.drawings.flatMap((function(t){return t.getLevels()}))}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce((function(t,e){var i=e.getZIndex();return(t=t)[i]||(t[i]=[]),t[i].push(e),t}),{})}},{key:"getIconsInformation",value:function(){var t=new Map;return this.getGeometries().filter((function(t){return t.isIcon()})).forEach((function(e){e=e.getLabelInfo(),t.set(e.iconIdentifier,e)})),Array.from(t.values())}}]),t}(),Ye=function(){u(e,De);var t=y(e);function e(i){var n=i.apiKey,o=i.fileHost;return i=i.token,r(this,e),i=t.call(this,{apiKey:n,fileHost:o||"vfs.venue.maps.api.here.com",token:i}),o&&(i.isHostCustom=!0),i}return o(e,[{key:"fetch",value:function(t,e,i){var r=(o=this.hostConfig_).apiKey,n=o.token,o=l({method:"GET",headers:{}},e);return(e=t).startsWith("http://")&&(e=e.replace(/http:\/\//gm,"https://")),n?(t="Bearer ",n=n.startsWith(t)?n:"".concat(t).concat(n),o.headers instanceof Headers?o.headers.append("Authorization",n):o.headers.Authorization=n):r&&(e="".concat(e,"?apiKey=").concat(r)),Kt.get(e,o,i)}}]),e}(),We={isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}},Ze=Object.keys(bt).map((function(t){return{identifier:t,name:void 0,url:void 0}})),Ke=function(){function t(e){var i=e.apiKey,n=e.baseUrl,o=e.token;e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r(this,t),o={apiKey:i,fileHost:n,token:o},this.dataApi_=new(e?ze:Ye)(o)}return o(t,[{key:"load",value:function(t,e){var i=this,r=(e=1<arguments.length&&void 0!==e?e:{},(e=l(l({},We),e)).isIconsEnabled),n=e.isMetaEnabled,o=e.iconOptions,a=e.metaOptions;return Promise.resolve().then((function(){return n?i.getMeta_(t,a).catch((function(t){return Promise.resolve()})):new ge})).then((function(e){return i.getVenue_(t,e)})).then((function(e){if(Vt.emit(Ut.VENUE_MAP_DATA_LOADED,{data:e}),r){var n=e.getIconsInformation();return i.getIcons_(t,e.metaInformation_,n,o).then((function(){return e}))}return e}))}},{key:"getVenue_",value:function(t,e){var i=this;return this.getCommunityMap_(t).then((function(e){return Promise.all([Promise.resolve(e),i.getCommunityEntity_(t),i.getLevels_(t,e.drawings.flatMap((function(t){return t.levels.map((function(t){return t.id}))})))])})).then((function(t){var i=(r=v(t,3))[0],r=(t=r[1],r[2]);return new qe(i,t,void 0===r?[]:r,e)}))}},{key:"getCommunityMap_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityMap(t).catch((function(e){return Promise.reject(new Error("Community map load failed for venue id ".concat(t,' with error "\n ').concat(e.message,'"')))}))}},{key:"getCommunityEntity_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityEntity(t).catch((function(e){return Promise.reject(new Error("Community Entity failed for venue id ".concat(t,' with error "').concat(e.message,'"')))}))}},{key:"getLevels_",value:function(t,e){var i=this;return e=1<arguments.length&&void 0!==e?e:[],Promise.all(e.map((function(e){return i.dataApi_.getGeoJsonApi().getGeoJsonLevelGeometry(t,e).catch((function(t){return Promise.reject(new Error("Level load failed for level id ".concat(e,' with error: "').concat(t.message,'"')))}))})))}},{key:"getIcon_",value:function(t,e,i,r){var n=2<arguments.length&&void 0!==i?i:{},o=3<arguments.length&&void 0!==r&&r,a=n.iconIdentifier;return r=n.url,a&&r?this.dataApi_.fetch(this.dataApi_.getNormalizedUrl(r)).then((function(t){return t=new Xt(l(l({},n),t),o),e.setIcon(a,t),t})):Promise.reject(new Error("Issue with icon data, iconIdentifier and url should be available: ".concat(n)))}},{key:"getIcons_",value:function(t,e,i,r){var n=this,o=(i=2<arguments.length&&void 0!==i?i:[],(3<arguments.length&&void 0!==r?r:{}).isMultiObjectToSplit);return Promise.all(i.map((function(i){return n.getIcon_(t,e,i,o).catch((function(t){return Promise.resolve(i)}))}))).catch((function(t){return Promise.resolve()}))}},{key:"getMeta_",value:function(t,e,i){var r=this,n=1<arguments.length&&void 0!==e?e:{},o=2<arguments.length&&void 0!==i?i:Ze,a=new ge;return Promise.resolve().then((function(){return r.getMetaConfig_(t,n).then((function(t){return a.releaseSettings_=t.settings,r.dataApi_.getMetaConfig(t)}))})).then((function(e){return r.getMetaFiles_(e,a,o).then((function(){return r.getMetaOverrides_(t,e,a,o)}))})).then((function(){return a}))}},{key:"getMetaConfig_",value:function(t){return t=this.dataApi_.getMetaConfigUrl(t),this.dataApi_.fetch(t).catch((function(t){return Promise.reject(t)}))}},{key:"getMetaFiles_",value:function(t,e,i,r){var n=this,o=(i=2<arguments.length&&void 0!==i?i:[],!(3<arguments.length&&void 0!==r)||r);return Promise.all(i.map((function(i){var r=i.identifier,a=i.name;return!(i=i.url)&&o&&(i=n.dataApi_.getMetaFileUrl(t,r,a)),i=i||n.dataApi_.getGlobalMetaFileUrl(r,a),n.dataApi_.fetch(i).then((function(t){return e.instantiateMetaFileAccessor_(r,t),t})).catch((function(t){return Promise.resolve()}))})))}},{key:"getMetaOverrides_",value:function(t,e,i,r){var n=this;return r=3<arguments.length&&void 0!==r?r:[],Promise.all(r.map((function(r){var o=r.identifier,a=r.name;return r=o,a=a,a=t&&e&&n.dataApi_.getMetaOverrideFileUrls(t,e,r,a)||[],Promise.all(a.map((function(t){return n.dataApi_.fetch(t).then((function(t){return i[o]&&i[o].applyOverride(t,!1),Promise.resolve()})).catch((function(t){return Promise.resolve()}))})))})))}}]),t}(),Xe="https://meta-indoor-routing.api-gateway.ls.hereapi.com",Je=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(r(this,t),!e.apiKey&&!e.token)throw new Error("API key or Token is missing");this.config_=l({baseUrl:Xe},e)}return o(t,[{key:"calculateRoute",value:function(t){var e=void 0===(n=t.origin)?{}:n,r=void 0===(o=t.destination)?{}:o,n=function(t,e){if(null==t)return{};var i,r=function(t,e){if(null==t)return{};for(var i,r={},n=Object.keys(t),o=0;o<n.length;o++)i=n[o],0<=e.indexOf(i)||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(t),o=0;o<n.length;o++)i=n[o],0<=e.indexOf(i)||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i]);return r}(t,["origin","destination"]);if(!e.coordinates||!r.coordinates)throw new Error("Waypoint coordinates are missing");var o=function(t){var e=t.coordinates,i=t.venueId;return t=t.levelId,e=e.join(","),i&&t?e.concat(";indoorMapId=",i,";levelId=",t):e},a=(t=new URL("".concat(this.config_.baseUrl,"/v1/routes")),new URLSearchParams({origin:o(e),destination:o(r),apiKey:this.config_.apiKey}));return Object.entries(n).forEach((function(t){t=(e=v(t,2))[0];var e=e[1];a.append(t,"object"===i(e)?JSON.stringify(e):e)})),t.search=a,fetch(t,{headers:{"X-Api-Key":this.config_.apiKey}}).then((function(t){return t.json()}))}}]),t}(),Qe=function(){u(e,H.map.Feature);var t=y(e);function e(i){var n;if(r(this,e),n=t.call(this),!(i instanceof qe))throw new Error("It is mandatory to provide valid instance of venueModel");return n.venueModel=i,n.search_=new ht(i),n.status_={activeDrawingId:i.getRootDrawing().getId(),activeLevelIndex:i.getRootDrawing().getMainLevel().getZIndex()},n.mapObjectStore_=n.getDefaultMapObjectsStore_(),n.drawings=i.getDrawings().map((function(t){return(t=new x(t)).setParentEventTarget(d(n)),t})),n.levels=i.getLevels().map((function(t){var e=new E(t);return e.setParentEventTarget(n.drawings.find((function(t){return t.getId()===e.getData().getDrawing().getId()}))),e})),n.geometries=i.getGeometries().map((function(t){var e=new w(t);return e.setParentEventTarget(n.levels.find((function(t){return t.getId()===e.getData().getLevel().getId()}))),e})),n}return o(e,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return f(H.geo.Rect,m(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=v(this.venueModel.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(t){return this.drawings.find((function(e){return e.getId()===t}))}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(t){return this.levels.find((function(e){return e.getId()===t}))}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(t){return this.geometries.find((function(e){return e.getId()===t}))}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var t=this;return this.getData().getDisplaySettings()===mt.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map((function(e){return t.getLevel(e.getId())})):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map((function(e){return t.getLevel(e.getId())}))}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(t){if(this.status_.activeDrawingId!==t){var i=this.venueModel.getDrawingById(t);if(!i)throw new Error("Drawing ".concat(t," was not found"));var r=this.status_.activeDrawingId;this.status_.activeDrawingId=t,this.setActiveLevelIndex(i.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.DRAWING_CHANGE,t,r))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(t){var i;this.venueModel.getLevelsByZIndex(t)&&(i=this.status_.activeLevelIndex,this.status_.activeLevelIndex=t,this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.LEVEL_CHANGE,t,i)))}},{key:"isActive",value:function(){var t=this.getParentEventTarget();return!!t&&this===t.activeVenue}},{key:"getHighlightedGeometries",value:function(){var t=this;return this.venueModel.getGeometries().filter((function(t){return t.isHighlighted()})).map((function(e){return t.getGeometry(e.getId())}))}},{key:"setHighlightedGeometries",value:function(t,i,r){var n=!(0<arguments.length&&void 0!==t)||t,o=(i=1<arguments.length&&void 0!==i?i:[],r=2<arguments.length&&void 0!==r?r:{},(r=l(l({},et),r)).fillColor),a=r.outlineColor,s=r.outlineWidth;i.forEach((function(t){t.getData().highlight(n,{m:o,o:a,w:s})})),this.dispatchEvent(e.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(t,e){return t=0<arguments.length&&void 0!==t?t:this.getActiveLevelIndex(),e=1<arguments.length&&void 0!==e?e:this.getActiveDrawing(),this.mapObjectStore_[t][e.getId()]}},{key:"setMapObjects",value:function(t,e,i){t=0<arguments.length&&void 0!==t?t:[],e=1<arguments.length&&void 0!==e?e:this.getActiveLevelIndex(),i=2<arguments.length&&void 0!==i?i:this.getActiveDrawing(),this.mapObjectStore_[e]&&this.mapObjectStore_[e][i.getId()]&&(this.mapObjectStore_[e][i.getId()]=m(t)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(t){var e=this;return t=0<arguments.length&&void 0!==t?t:"",this.search_.find(t).flatMap((function(t){return t.geometries.map((function(t){return e.getGeometry(t.getId())}))}))}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach((function(t){Object.values(t).forEach((function(t){return t.forEach((function(t){return t.setVisibility(!1)}))}))})),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getId()].forEach((function(t){return t.setVisibility(!0)}))}},{key:"getDefaultMapObjectsStore_",value:function(){var t=this,e=this.getData().getDisplaySettings()===mt.FLATTEN;return this.venueModel.getLevels().reduce((function(i,r){var n=r.getZIndex();return(i=l({},i))[n]||(i[n]={}),i[n][r.getDrawing().getId()]=[],e&&(i[n][t.venueModel.getRootDrawing().getId()]=[]),i}),{})}}]),e}();function $e(t,e,i){return i===hi.ObjectType.SEGMENT_START_MARKER?0===t?si:ui:i===hi.ObjectType.SEGMENT_FINISH_MARKER?1===e.length||t===e.length-1?li:ci:"indoor"===e[t].departure.place.type?oi:ai}Qe.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"};var ti=function(){function t(){r(this,t)}return o(t,null,[{key:"getIconLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.isIcon()&&t.getIcon()})).map((function(t){var e=(n=v(t.getLabelArea(),2))[0],i=n[1],r=t.getLevel(),n=t.getIcon().getSVG();return{type:"Feature",properties:{id:t.getId(),geometryId:t.getId(),levelId:r.getId(),name:t.getDisplayName(),venueId:r.getDrawing().getVenueModel().getId(),url:n?"data:image/svg+xml;utf8,".concat(encodeURIComponent(n)):""},geometry:{type:J,coordinates:[e,i]}}}))}}},{key:"getLabelLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.getDisplayName()&&!t.isIcon()})).map((function(t){var e=(n=v(t.getLabelArea(),2))[0],i=n[1],r=(o=t.getLabelStyle()).fill,n=o.zmin,o=t.getLevel();return{type:"Feature",properties:{id:t.getId(),geometryId:t.getId(),levelId:o.getId(),venueId:o.getDrawing().getVenueModel().getId(),name:t.getDisplayName(),minZoom:n||15,textFillColor:r.toLowerCase()},geometry:{type:J,coordinates:[e,i]}}}))}}},{key:"getGeometryLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.getType()!==J})).map((function(t){var e=(s=t.getHighlightedStyle()||{}).m,i=s.o,r=s.w,n=(u=l({},t.getStyle())).m,o=u.o,a=u.w,s=1,u=t.getLevel();return{type:"Feature",properties:{id:t.getId(),fillColor:(e||n||"#e0e0e0").toLowerCase(),geometryId:t.getId(),levelId:u.getId(),venueId:u.getDrawing().getVenueModel().getId(),outlineColor:(i||o||"#829DB4").toLowerCase(),outlineWidth:Number(((r||a||s)/3).toFixed(2)),zIndex:t.getZIndex()},geometry:{type:t.getType(),coordinates:t.getCoordinates()}}}))}}},{key:"getFootprintLayer",value:function(t){return{type:"FeatureCollection",features:t.flatMap((function(t){var e=t.getData().getRootDrawing().getMainLevel().getId(),i=t.getLevel(e).getData().getGeometries().filter((function(t){return t.getType()===Q}));return[{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getId(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:i.map((function(t){return t.getCoordinates()}))}},{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getId(),zIndex:2,venueName:t.getName()},geometry:{type:"Point",coordinates:t.getCenter().toGeoJSON().coordinates.slice(0,2)}}]}))}}}]),t}(),ei=function(){function t(){r(this,t)}return o(t,null,[{key:"getStyle",value:function(t){var e={styles:[{layer:it.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#613F8E",lineWidth:"2px",renderOrder:1},{layer:it.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#AF91B4",renderOrder:2},{layer:it.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{layer:it.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:["get","fillColor"],renderOrder:["get","zIndex"]},{layer:it.VECTOR,technique:"solid-line",color:["get","outlineColor"],lineWidth:["get","outlineWidth"],renderOrder:["get","zIndex"]},{layer:it.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:13,text:["get","name"],priority:60},{layer:it.ICON,minZoomLevel:18,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,25],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,25],priority:61}],images:{},imageTextures:[]};return(t=0<arguments.length&&void 0!==t?t:[]).forEach((function(t){var i="texture"+t.properties.name;e.images[i]||(e.images[i]={url:t.properties.url,preload:!0},e.imageTextures.push({name:i,image:i}))})),new H.map.render.harp.Style(e)}}]),t}(),ii=function(){function t(){r(this,t)}return o(t,null,[{key:"getIconsTextures",value:function(t){var e={},i={},r=(0<arguments.length&&void 0!==t?t:[]).reduce((function(t,e){var i=e.properties.name;return t[i]||(t[i]=[]),t[i].push(e),t}),{});return Object.keys(r).forEach((function(t){var n="texture".concat(t),o="sprite".concat(t),s=r[t][0].properties.url;e[n]={url:s,sprites:a({},o,[0,0,50,50])},r[t].forEach((function(t){t=t.properties,i["icon".concat(t.name)]={filter:{name:t.name,$zoom:{min:18}},draw:{points:{interactive:!0,priority:1,size:[[15,"5%"],[16,"10%"],[17,"15%"],[18,"25%"],[19,"35%"],[20,"40%"],[21,"50%"]],texture:n,sprite:o}}}}))})),{textures:e,iconLayers:i}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:it.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){return{data:{source:"venues",layer:it.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}}}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:18}},data:{source:"venues",layer:it.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:13},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(t){return l({data:{source:"venues",layer:it.ICON}},t)}},{key:"getStyle",value:function(e){e=(i=t.getIconsTextures(0<arguments.length&&void 0!==e?e:[])).textures;var i=i.iconLayers;return i={venue_footprints:t.getFootprintLayer(),venue_geometries:t.getGeometryLayer(),venue_labels:t.getTextLayer(),venue_icons:t.getIconLayer(i)},e=H.gl.yaml.safeDump({sources:{venues:{max_zoom:24,type:"GeoJSONTileSource"}},layers:i,textures:e}),new H.map.render.webgl.Style(e)}}]),t}(),ri={type:"FeatureCollection",features:[]},ni={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},oi=(Oe=function(){u(e,H.map.provider.RemoteTileProvider);var t=y(e);function e(i){return r(this,e),(i=t.call(this,i)).venues=[],i.activeVenue=null,i.dataLayers_={},i.tileIndexes_={},i.addEventListener(Qe.EVENTS.ACTIVE_VENUE_CHANGE,i.activeVenueChangeHandler_,void 0,d(i)),i}return o(e,[{key:"setStyle",value:function(t){return this.setStyleInternal(t)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(t,e){var i=t.properties;return this.activeVenue&&i.venueId===this.activeVenue.getId()?e!==it.FOOTPRINT&&this.activeVenue.getActiveLevels().some((function(t){return t.id===i.levelId})):!0===i.isFootprint&&e===it.FOOTPRINT}},{key:"requestInternal",value:function(t,e,i,r){function n(r){for(var n=0;n<r.length;n+=1)r[n]=r[n].map((function(r){return X(r,i,t,e,ni.extent)}))}var o=this,a={};return Object.keys(this.tileIndexes_).forEach((function(r){var s=o.tileIndexes_[r].getTile(i,t,e);a[r]=s?function(t){var e=[],i=t&&t.features;if(i)for(var r=0,n=i.length;r<n;r+=1){var o=i[r],a=o.type,s=void 0,l=!1;switch(a){case 1:s={type:"MultiPoint",coordinates:o.geometry.map((function(t){return t.slice()}))};break;case 2:case 3:s={type:$,coordinates:o.geometry.map((function(t){return t.map((function(t){return t.slice()}))}))},3===a&&null==(s=K(s))&&(l=!0);break;default:l=!0}l||e.push({geometry:s,id:o.id,properties:o.tags,type:"Feature"})}return{type:"FeatureCollection",features:e}}(s):ri,a[r].features=a[r].features.filter((function(t){return o.isFeatureVisible_(t,r)}));for(var l=0;l<a[r].features.length;l+=1){var u=a[r].features[l],c=u.geometry.type;if(c===Q||c===$)n(u.geometry.coordinates);else if(c===tt)u.geometry.coordinates.map(n);else for(var h=u.geometry.coordinates,p=0;p<h.length;p+=1)h[p]=X(h[p],i,t,e,ni.extent)}})),r(a),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(t){return t?this.venues.find((function(e){return e.getId()===Number(t)})):this.activeVenue}},{key:"setActiveVenue",value:function(t){var e=this.activeVenue;this.activeVenue=t,this.dispatchEvent(new H.util.ChangeEvent(Qe.EVENTS.ACTIVE_VENUE_CHANGE,t,e)),this.reload()}},{key:"addVenue",value:function(t,e){var i=1<arguments.length&&void 0!==e&&e;if(!(t instanceof Qe))throw new Error("Invalid argument");if(e=t.getId(),this.getVenue(e))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(e," before adding new"));t.setParentEventTarget(this),this.venues.push(t),i||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(t){var e=this;0<(t=0<arguments.length&&void 0!==t?t:[]).length&&(t.forEach((function(t){t instanceof Qe&&e.addVenue(t,!0)})),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(t){var e;t instanceof Qe&&-1<this.venues.indexOf(t)&&(e=t.getId(),this.activeVenue&&this.activeVenue.getId()===e&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(t),1),this.reloadData_(),this.reloadStyle_(),this.reload())}},{key:"getFeatureProxy",value:function(t,e,i){var r=t.geometryId;return t=t.venueId,t=this.getVenue(t),r?i(t.getGeometries().find((function(t){return t.id===r}))):t&&i(t),!0}},{key:"addVenueEventListeners_",value:function(t){t&&(t.addEventListener(Qe.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.addEventListener(Qe.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.addEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(t){t&&(t.removeEventListener(Qe.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.removeEventListener(Qe.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.removeEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(t){var e=t.oldValue;t=t.newValue,e&&(this.removeVenueEventListeners_(e),e.updateMapObjectsVisibility_()),t&&(this.addVenueEventListeners_(t),t.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadData_([it.VECTOR]),this.reload()}},{key:"createDataLayers_",value:function(t){var e=this,i=(t=0<arguments.length&&void 0!==t?t:Object.keys(it),it.FOOTPRINT),r=it.ICON,n=it.TEXT,o=it.VECTOR;t.forEach((function(t){switch(t){case o:e.dataLayers_[o]=ti.getGeometryLayer(e.venues);break;case i:e.dataLayers_[i]=ti.getFootprintLayer(e.venues);break;case r:e.dataLayers_[r]=ti.getIconLayer(e.venues);break;case n:e.dataLayers_[n]=ti.getLabelLayer(e.venues);break;default:throw new Error("Unsupported Layer ".concat(t))}}))}},{key:"createTileIndexes_",value:function(t){var e=this;(0<arguments.length&&void 0!==t?t:Object.keys(it)).forEach((function(t){e.tileIndexes_[t]=new W(e.dataLayers_[t],ni)}))}},{key:"reloadData_",value:function(t){t=0<arguments.length&&void 0!==t?t:Object.keys(it),this.createDataLayers_(t),this.createTileIndexes_(t)}},{key:"reloadStyle_",value:function(){var t=this.dataLayers_[it.ICON]?this.dataLayers_[it.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle(ii.getStyle(t)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(ei.getStyle(t))}},{key:"providesGeoJSON",value:function(){return!0}}]),e}(),new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3})),ai=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),si=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),li=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),ui=null,ci=null,hi=function(){function t(e,i){r(this,t),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(e,i)}return o(t,[{key:"createRouteObjects_",value:function(e,i){var r=this,n=void 0===(e=e.sections)?[]:e,o=1<arguments.length&&void 0!==i?i:$e;this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group;for(var a=function(e){var i,a=n[e],s=(i=a.departure.place).id,u=i.type,c=H.util.flexiblePolyline.decode(a.polyline).polyline,h=void 0,p=void 0;(i=o(e,n,t.ObjectType.SEGMENT_START_MARKER))&&(h=new H.map.Marker(a.departure.place.location,{icon:i})),(i=o(e,n,t.ObjectType.SEGMENT_FINISH_MARKER))&&(p=new H.map.Marker(a.arrival.place.location,{icon:i}));var f,d=o(e,n,t.ObjectType.SEGMENT_POLYLINE);"indoor"===u?(u=function(t){t=0<arguments.length&&void 0!==t?t:[];var e=new Map,i=new H.geo.LineString,r=v(t[0],3)[2];return e.set(r,[i]),t.forEach((function(t){t[2]!==r&&(r=t[2],i=new H.geo.LineString,e.has(r)?e.get(r).push(i):e.set(r,[i])),i.pushLatLngAlt.apply(i,m(t))})),e}(c),f=Array.from(u.keys()).reduce((function(t,e){return t[e]||(t[e]=new H.map.Group),t}),{}),d&&u.forEach((function(t,e){t.forEach((function(t){1<t.getPointCount()&&(t=new H.map.Polyline(t,{style:d}),f[e].addObject(t))}))})),h&&f[a.departure.place.location.lvl].addObject(h),p&&f[a.arrival.place.location.lvl].addObject(p),r.indoorMapObjects_[s]=l(l({},r.indoorMapObjects_[s]||{}),f)):(d&&(c=new H.geo.LineString(c.flatMap((function(t){return[t[0],t[1],0]}))),c=new H.map.Polyline(c,{style:d}),r.outdoorMapObjects_.addObject(c)),h&&r.outdoorMapObjects_.addObject(h),p&&r.outdoorMapObjects_.addObject(p))},s=0;s<n.length;s++)a(s)}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}]),t}();hi.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3};var pi=function(){u(e,H.service.Service);var t=y(e);function e(i){var n;r(this,e),n=t.call(this,e,i);var o={apiKey:i.apikey,baseUrl:i.baseUrl&&i.baseUrl.getHost(),token:i.token},a={apiKey:o.apiKey,token:o.token};o.apiKey||(o.apiKey=n.getUrl().getQuery().apikey);var s=i.useLegacy||!1;return n.venueService_=new Ke(o,s),a.apiKey||(a.apiKey=n.getUrl().getQuery().apikey),i.routingBaseUrl&&(a.baseUrl=i.routingBaseUrl),n.routingService_=new Je(a),n}return o(e,[{key:"loadVenue",value:function(t,e){return e=1<arguments.length&&void 0!==e?e:{},this.venueService_.load(t,e).then((function(t){return new Qe(t)}))}},{key:"calculateRoute",value:function(t){return this.routingService_.calculateRoute(t)}}]),e}();return pi.CONFIG_KEY="venues",H.service.Platform.prototype.getVenuesService=function(t){return this.createService(pi,t)},_e=function(){u(e,H.ui.Control);var t=y(e);function e(i){var n,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(n=t.call(this)).provider_=null,n.levelSelectorUI_=null,n.setAlignment(o&&o.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),n.addClass("venues-ui"),i instanceof Qe&&n.setVenue(i),n}return o(e,[{key:"renderInternal",value:function(t,i){g(c(e.prototype),"renderInternal",this).call(this,t,i),this.createLevelSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof Qe&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new Bt(t,null,null,(function(t){return e.venue.setActiveLevelIndex(t)}))}},{key:"update_",value:function(){var t,e;this.levelSelectorUI_&&(t=this.venue.getActiveDrawing().getData(),e=this.venue.getData().getDisplaySettings(),this.levelSelectorUI_.update(t,e),this.levelChangeHandler_())}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(Qe.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(Qe.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(Qe.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(Qe.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}(),At=function(){u(e,H.ui.Control);var t=y(e);function e(i){var n,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r(this,e),(n=t.call(this)).provider_=null,n.drawingSelectorUI_=null,n.addClass("venues-ui"),n.setAlignment(o&&o.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),i instanceof Qe&&n.setVenue(i),n}return o(e,[{key:"renderInternal",value:function(t,i){g(c(e.prototype),"renderInternal",this).call(this,t,i),this.createDrawingSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof Qe&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(t.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new jt(t,null,(function(t){return e.venue.setActiveDrawing(t)}))}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(Qe.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(Qe.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(Qe.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}(),_e=Object.freeze({__proto__:null,DrawingControl:At,LevelControl:_e}),e(".venues-ui * {\n  font-family: 'Fira Sans', 'Helvetica Neue', Helvetica, sans-serif;\n  color: #0F1621; }\n\n.venues-ui .arrow {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-position: center; }\n  .venues-ui .arrow--up {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n  .venues-ui .arrow--down {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n\n.venues-ui .venues-ui-button {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  font-size: 16px;\n  font-weight: 600;\n  background-color: #fff;\n  border: none;\n  border-bottom: 1px solid #9FA2A6;\n  cursor: pointer;\n  overflow: hidden;\n  color: #6e737a;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap; }\n  .venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {\n    background-color: #f0f0f0;\n    color: #0F1621; }\n\n@keyframes fade {\n  0% {\n    opacity: 0; }\n  100% {\n    opacity: 1; } }\n\n.venues-ui__drawings .drawings {\n  position: absolute;\n  top: 0;\n  right: 45px;\n  display: none;\n  opacity: 0;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .drawings--open {\n    display: block;\n    opacity: 1;\n    animation: fade 1s; }\n  .venues-ui__drawings .drawings .venues-ui-button {\n    width: auto;\n    padding: 0 10px; }\n    .venues-ui__drawings .drawings .venues-ui-button:first-of-type {\n      border-top-left-radius: 5px;\n      border-top-right-radius: 5px; }\n    .venues-ui__drawings .drawings .venues-ui-button:last-of-type {\n      border-bottom-left-radius: 5px;\n      border-bottom-right-radius: 5px; }\n\n.venues-ui__drawings .trigger {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .trigger .arrow {\n    transform: rotate(0);\n    transition: 0.4s; }\n  .venues-ui__drawings .trigger.venues-ui-button--active .arrow {\n    transform: rotate(90deg);\n    transition: 0.4s; }\n\n.venues-ui__levels {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__levels .levels {\n    overflow: hidden; }\n  .venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {\n    border-radius: 0; }\n  .venues-ui__levels .venues-ui-button:first-of-type {\n    border-top-left-radius: 5px;\n    border-top-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button:last-of-type {\n    border-bottom-left-radius: 5px;\n    border-bottom-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {\n    opacity: 0.5; }\n\n.venues-ui__directory {\n  position: absolute;\n  top: 10px;\n  right: 60px;\n  bottom: calc(100% - 45px);\n  width: 350px;\n  overflow: hidden;\n  background: white;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__directory.active {\n    bottom: 10px; }\n  .venues-ui__directory .directory__list {\n    top: 80px;\n    bottom: 20px;\n    position: absolute;\n    overflow-y: scroll;\n    right: 10px;\n    left: 10px;\n    font-size: 12px; }\n    .venues-ui__directory .directory__list svg {\n      width: 25px;\n      height: 25px; }\n  .venues-ui__directory .directory__heading {\n    margin: 8px;\n    font-size: 15px;\n    font-weight: normal;\n    cursor: pointer; }\n  .venues-ui__directory .directory__input {\n    margin: 10px; }\n    .venues-ui__directory .directory__input input {\n      width: 100%;\n      padding: 5px 0; }\n  .venues-ui__directory .directory__trigger {\n    position: absolute;\n    right: 10px;\n    top: 15px;\n    width: 10px;\n    height: 10px; }\n    .venues-ui__directory .directory__trigger .arrow {\n      transform: rotate(0);\n      transition: 0.4s; }\n    .venues-ui__directory .directory__trigger--active .arrow {\n      transform: rotate(-180deg);\n      transition: 0.4s; }\n"),t.Drawing=x,t.Geometry=w,t.Level=E,t.Provider=Oe,t.Route=hi,t.Service=pi,t.Venue=Qe,t.ui=_e,Object.defineProperty(t,"__esModule",{value:!0}),t}({})}.call(self);const __WEBPACK_DEFAULT_EXPORT__=H}}]);